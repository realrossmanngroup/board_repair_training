[
    {
        "post_id":44013,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":2162,
        "username":"zarmin",
        "post_date":"2018-12-28 04:30:59",
        "message":"Hi!\n\n\nI'm writing the whole story, may it contains additional valuable information.\n\nOne day, my macbook pro just switched off while working on it. Nothing trivial helped.\nFortunately I have a decent electronics lab at home.\n\nPPBUS_G3H was missing, because Q7035 continuously shorted it to ground.\nSome reflow with hot air and cleaning with IPA, around U7000 restored the PPBUS_G3H and machine turned on.\n\nA few seconds later, the C7561 cap was started smoking, I've measured a few ohms of permanent resistance on that cap, so I've replaced it (I had only a 100 uF in a same package at home, so I've used that, instead of a 68 uF).\n\nAfter that the machine started successfully, MacOS booted, etc. \n\n\nThe only issue is the battery.\nMy charging light turns to orange even there is no battery connected at all. When I connect it to the charger, it turns green immediately and after a second it changes to orange.\nIf I connect the battery, the machine doesn't recognize it (X battery icon), but also have an orange light.\nI've done SMC \/ PRAM reset already of course.\n\nBut with every 8-10th startup the machine randomly recognizes the battery, displays its percent (29%), but can't charge it and tells me to replace it immediately, unfortunately if I remove the magsafe adapter, the machine turns off immediately.\nI had a replacement battery also, which is also doing the same.\n\n\nThanks"
    },
    {
        "post_id":44017,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":1153,
        "username":"JohnB8812",
        "post_date":"2018-12-28 06:06:02",
        "message":"Voltage on PPBUS_G3H with just the charger no battery?"
    },
    {
        "post_id":44020,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":2162,
        "username":"zarmin",
        "post_date":"2018-12-28 06:23:45",
        "message":"PPBUS_G3H with charge w\/o battery: 12.51V which is somewhat lower than the expected 12.80V, but I think it's acceptable."
    },
    {
        "post_id":44021,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":682,
        "username":"2informaticos",
        "post_date":"2018-12-28 06:41:47",
        "message":"PPBUS_G3H is correct; no idea why you assume 12.8V!\n\nSince 2013 all MacBooks turns MagSafe light to amber, even no battery connected.\nLight goes green only if battery is 100% fully charged.\n\nPost exact value of resistance between pins 17\/18 and 27\/28 of ISL6259.\nAlso post voltage at its pins 9 & 15.\nDid you try original 85W charger?\n\nPost R7080\/81 and R7085\/86 values measured onboard (ohm scale, no power)."
    },
    {
        "post_id":44026,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":1153,
        "username":"JohnB8812",
        "post_date":"2018-12-28 07:31:45",
        "message":"Yep next thing to check is resistance between pins 17\/18 and 27\/28 of the ISL. If it is 12.51, your machine SHOULD be recognizing batteries"
    },
    {
        "post_id":44030,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":2162,
        "username":"zarmin",
        "post_date":"2018-12-28 08:55:24",
        "message":"[B]1.[\/B]\n820-3332-A is a logic board for MBP retina 2012 mid, 15\", 2.3 Ghz, 8 GB RAM (first rMBP)\nSo it's before 2013.\nI don't know when should it show an amber\/orange light.\n\n\n[B]2. [\/B]\nISL 17, 18 pin, battery current sensing: 3.9 ohm\nISL 27, 28 pin, pwr supply current sensing: 21.3 ohm\n\nby my calculations,\n\n17, 18 should be:\n2.2 + 0.005 + 0 = 2.205 ohm (+1.695 ohm diff)\n\n27, 28 should be:\n10 + 10 + 0.020 = 20.02 ohm (+1.28 ohm diff)\n\nI used gold probes and negating the extra resistance on my probes, of course.\n\nI've done some calculations about the possible resistance of PCB traces, and it should be between around 0.5 - 2 ohm, so these can be right values.\n\nAlso tested the intermediate values, so\nbtr current sensing:\nR7051: 2.2 Ohm (should be, 2.2 ohm, 5%)\nR7052: 0.1 Ohm (should be, 0 ohm, 5%) \nR7050: 0.0 Ohm (should be, 0.005 ohm)\n\npower supply current sensing:\nR7021: 9.8 ohm (should be, 10 ohm, 5%)\nR7022: 10.1 ohm (should be, 10 ohm, 5%)\nR7020: 0.0 Ohm (should be, 0.020 ohm)\n\nAside from the measurement inaccuracy, everything in spec. I used Fluke 87V, currently I have no ready-to-use equipment that can measure low resistance precisely.\n\n\n[B]3.[\/B]\nI'm using my genuine apple 85W charger as always.\n\n\n[B]4.[\/B]\nI may have a theory, both of my batteries can be bad.\n- The first battery had one cell which is swollen a bit, it was in my machine when it died (also had the replace the battery warning for days)\n- The second was never used before, I've bought it to replace my old one, because of the warnings."
    },
    {
        "post_id":44031,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":682,
        "username":"2informaticos",
        "post_date":"2018-12-28 09:23:24",
        "message":"Check resistance to ground (diode mode, red probe to ground) for SCL\/SDA lines of battery bus.\nBe sure to have good solders on ISL6259.\n\nDon't bother with exact resistors value; 10% error is OK for our readings, even for voltage.\n\nShould be good to test known good battery; or test one of your batteries in other machine..."
    },
    {
        "post_id":44032,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":2162,
        "username":"zarmin",
        "post_date":"2018-12-28 09:23:44",
        "message":"[B]5.[\/B]\nISL pin 9 - GND: 0.298V\nISL pin 15 - GND: 0.042V\n(\/w power supply + battery)\n\nR7080: 99.6k\nR7081: 61.7k\n\nR7085: 391.4k \nR7086: 306.9k"
    },
    {
        "post_id":44035,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":682,
        "username":"2informaticos",
        "post_date":"2018-12-28 09:32:09",
        "message":"\"Check resistance to ground (diode mode, red probe to ground) for SCL\/SDA lines of battery bus.\"\n???"
    },
    {
        "post_id":44036,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":2162,
        "username":"zarmin",
        "post_date":"2018-12-28 09:32:38",
        "message":"Check resistance to ground (diode mode, red probe to ground) for SCL\/SDA lines of battery bus.\n-> it's 0.530 in diode mode\n\nBe sure to have good solders on ISL6259.\n-> because at the first a quick reflow fixed my PPBUS_G3H voltage, it can be still an issue.\nI'll remove the ISL6259, clean the pads and resolder it tomorrow, if no *easier* option will come until"
    },
    {
        "post_id":44042,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":2162,
        "username":"zarmin",
        "post_date":"2018-12-28 10:10:28",
        "message":"I had a little time, so I've removed, cleaned and resoldered ISL6259, but it's still the same."
    },
    {
        "post_id":44043,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":682,
        "username":"2informaticos",
        "post_date":"2018-12-28 10:12:32",
        "message":"Do you have .530 on both lines?\nLess than 1% difference is required...\n\nCheck again R7085\/86.\nInvert probes and take readings in both ways.\n\nPost voltage for pin 26\/U7000.\n\n\"But with every 8-10th startup the machine randomly recognizes the battery\"\nThis can mean cracked solders\/traces, especially underneath SMC.\nPull it out and reball; with leaded balls, of course."
    },
    {
        "post_id":44049,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":2162,
        "username":"zarmin",
        "post_date":"2018-12-28 10:45:53",
        "message":"I've measured it again\nSDA: 0.526\nSCL: 0.528 \nwhich is round 0.4% difference, so it's below 1%\n\n\nR7086\nCHGR_AGATE_DIV (+), PPDCIN_G3H (-): 307.2 k\nCHGR_AGATE_DIV (-), PPDCIN_G3H (+): 325.4 k\n\nR7085\nCHGR_AGATE_DIV (+), CHGR_AGATE (-): 485.5 k\nCHGR_AGATE_DIV (-), CHGR_AGATE (+): 391.2 k\n\n\n26\/U7000 voltage: 0.023 V \n\n\nI'll try to get an another battery for testing, I'd like to spend my time on reballing the SMC on the last resort :)\n\nAnyway thanks for your sustained and thorough help!"
    },
    {
        "post_id":44118,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":2162,
        "username":"zarmin",
        "post_date":"2018-12-29 09:51:52",
        "message":"After\n- doing some reflow\/cleaning around the SMC (not complete reballing)\n- one of the pins of my battery connector was bent a little bit, so restored it\n- doing PRAM \/ SMC reset\nthe machine reliably recognises my new battery.\n\nMy old battery is not recognized at all, but it was in a 'Replace now' state before and had degraded capacity, so it can be dead at all.\n\nTo check the details I've soldered probe wires to battery connectors i2c SDL\/SCL lines (to the legs of D6950 diode pair) and checked it with my oscilloscope.\nMy old battery didn't produce any valid traffic on it, but my new one has valid i2c communication over it. \n\n\nThis is the output of System information with the new battery:\n\n[FONT=courier new][B]Battery Information:[\/B]\nModel Information:\n  Serial Number: D863105Q0TAF9Y2A5\n  Manufacturer: SMP\n  Device Name: bq20z451\n  Pack Lot Code: 0\n  PCB Lot Code: 0\n  Firmware Version: 511\n  Hardware Revision: 000a\n  Cell Revision: 1150\nCharge Information:\n  Charge Remaining (mAh): 2579\n  Fully Charged: No\n  Charging: No\n  Full Charge Capacity (mAh): 8500\nHealth Information:\n  Cycle Count: 0\n  Condition: Replace Now\nBattery Installed: Yes\nAmperage (mA): 0\nVoltage (mV): 11254[\/FONT]\n\nCan be any issue left on the logic board, that can cause this battery error? Or should it be the battery exclusively?\nBecause of the new year \/ weekend I can only get a new battery to test on next Wednesday."
    },
    {
        "post_id":44119,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":682,
        "username":"2informaticos",
        "post_date":"2018-12-29 09:56:07",
        "message":"If you get proper I2C communication on the battery bus, is time to test new one; or known good one, even older.\nSMC should be OK, as is the master on that bus, and it starts the communication..."
    },
    {
        "post_id":44871,
        "thread_id":44013,
        "title":"820-3332-A , orange light, but battery's not charging",
        "user_id":2162,
        "username":"zarmin",
        "post_date":"2019-01-16 03:58:15",
        "message":"Just wanted to tell, a new battery is working well. Both of my previous batteries were bad. \nSo my machine is working completely fine now. \n\nThanks for all of your help!"
    }
]