"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[9065],{9065:(t,e,n)=>{n.r(e);n.d(e,{Bounds:()=>r_,CanvasHandler:()=>Mw,CanvasRenderer:()=>Rw,DATE:()=>Oe,DAY:()=>Ue,DAYOFYEAR:()=>Pe,Dataflow:()=>Cs,Debug:()=>m.cG,Error:()=>m.jj,EventStream:()=>jo,Gradient:()=>Oy,GroupItem:()=>s_,HOURS:()=>Ie,Handler:()=>Qb,Info:()=>m.kI,Item:()=>o_,MILLISECONDS:()=>Fe,MINUTES:()=>qe,MONTH:()=>Re,Marks:()=>Ub,MultiPulse:()=>vs,None:()=>m.Hq,Operator:()=>Po,Parameters:()=>No,Pulse:()=>ps,QUARTER:()=>ze,RenderType:()=>qk,Renderer:()=>ew,ResourceLoader:()=>a_,SECONDS:()=>Le,SVGHandler:()=>Pw,SVGRenderer:()=>gk,SVGStringRenderer:()=>Rk,Scenegraph:()=>Xb,TIME_UNITS:()=>je,Transform:()=>Us,View:()=>EH,WEEK:()=>Ce,Warn:()=>m.uU,YEAR:()=>Ne,accessor:()=>m.ZE,accessorFields:()=>m.Oj,accessorName:()=>m.el,array:()=>m.IX,ascending:()=>m.j2,bandwidthNRD:()=>oa,bin:()=>sa,bootstrapCI:()=>ua,boundClip:()=>Jk,boundContext:()=>D_,boundItem:()=>Pb,boundMark:()=>qb,boundStroke:()=>c_,changeset:()=>Do,clampRange:()=>m.l$,codegenExpression:()=>eL.YP,compare:()=>m.qu,constant:()=>m.a9,cumulativeLogNormal:()=>Ea,cumulativeNormal:()=>_a,cumulativeUniform:()=>za,dayofyear:()=>Ge,debounce:()=>m.Ds,defaultLocale:()=>Rr,definition:()=>Is,densityLogNormal:()=>Sa,densityNormal:()=>va,densityUniform:()=>Na,domChild:()=>Jb,domClear:()=>Gb,domCreate:()=>Bb,domFind:()=>Yb,dotbin:()=>ca,error:()=>m.vU,expressionFunction:()=>bW,extend:()=>m.l7,extent:()=>m.We,extentIndex:()=>m.dI,falsy:()=>m.k,fastmap:()=>m.Xr,field:()=>m.EP,flush:()=>m.yl,font:()=>Mb,fontFamily:()=>kb,fontSize:()=>mb,format:()=>uo,formatLocale:()=>Mr,formats:()=>co,hasOwnProperty:()=>m.nr,id:()=>m.id,identity:()=>m.yR,inferType:()=>to,inferTypes:()=>eo,ingest:()=>ko,inherits:()=>m.XW,inrange:()=>m.u5,interpolate:()=>Jg,interpolateColors:()=>Xg,interpolateRange:()=>Wg,intersect:()=>jk,intersectBoxLine:()=>L_,intersectPath:()=>U_,intersectPoint:()=>P_,intersectRule:()=>q_,isArray:()=>m.kJ,isBoolean:()=>m.jn,isDate:()=>m.J_,isFunction:()=>m.mf,isIterable:()=>m.TW,isNumber:()=>m.hj,isObject:()=>m.Kn,isRegExp:()=>m.Kj,isString:()=>m.HD,isTuple:()=>xo,key:()=>m.Jy,lerp:()=>m.t7,lineHeight:()=>gb,loader:()=>mo,locale:()=>zr,logger:()=>m.kg,lruCache:()=>m.$m,markup:()=>ak,merge:()=>m.TS,mergeConfig:()=>m.fE,multiLineOffset:()=>_b,one:()=>m.kX,pad:()=>m.vk,panLinear:()=>m.Dw,panLog:()=>m.mJ,panPow:()=>m.QA,panSymlog:()=>m.Zw,parse:()=>YV,parseExpression:()=>eL.BJ,parseSelector:()=>NH.r,path:()=>hf,pathCurves:()=>Py,pathEqual:()=>Kk,pathParse:()=>Wy,pathRectangle:()=>yv,pathRender:()=>iv,pathSymbols:()=>av,pathTrail:()=>vv,peek:()=>m.fj,point:()=>Kb,projection:()=>tN,quantileLogNormal:()=>Ta,quantileNormal:()=>xa,quantileUniform:()=>Ra,quantiles:()=>ia,quantizeInterpolator:()=>Hg,quarter:()=>m.mS,quartiles:()=>ra,random:()=>aa,randomInteger:()=>da,randomKDE:()=>ka,randomLCG:()=>ha,randomLogNormal:()=>$a,randomMixture:()=>Da,randomNormal:()=>wa,randomUniform:()=>Ca,read:()=>ho,regressionExp:()=>Fa,regressionLinear:()=>qa,regressionLoess:()=>Ga,regressionLog:()=>La,regressionPoly:()=>Xa,regressionPow:()=>ja,regressionQuad:()=>Wa,renderModule:()=>Fk,repeat:()=>m.rx,resetDefaultLocale:()=>Cr,resetSVGClipId:()=>n_,resetSVGDefIds:()=>Qk,responseType:()=>fo,runtimeContext:()=>ZW,sampleCurve:()=>tl,sampleLogNormal:()=>Ma,sampleNormal:()=>ya,sampleUniform:()=>Aa,scale:()=>zg,sceneEqual:()=>Vk,sceneFromJSON:()=>jb,scenePickVisit:()=>Z_,sceneToJSON:()=>Fb,sceneVisit:()=>K_,sceneZOrder:()=>V_,scheme:()=>ey,serializeXML:()=>lk,setRandom:()=>la,span:()=>m.yP,splitAccessPath:()=>m._k,stringValue:()=>m.m8,textMetrics:()=>ub,timeBin:()=>Wn,timeFloor:()=>dn,timeFormatLocale:()=>Ar,timeInterval:()=>_n,timeOffset:()=>wn,timeSequence:()=>Sn,timeUnitSpecifier:()=>Be,timeUnits:()=>Xe,toBoolean:()=>m.sw,toDate:()=>m.ZU,toNumber:()=>m.He,toSet:()=>m.Rg,toString:()=>m.BB,transform:()=>qs,transforms:()=>Ps,truncate:()=>m.$G,truthy:()=>m.yb,tupleid:()=>bo,typeParsers:()=>Kr,utcFloor:()=>gn,utcInterval:()=>xn,utcOffset:()=>kn,utcSequence:()=>En,utcdayofyear:()=>en,utcquarter:()=>m.N3,utcweek:()=>nn,version:()=>JV,visitArray:()=>m.FP,week:()=>Ve,writeConfig:()=>m.iL,zero:()=>m.bM,zoomLinear:()=>m.ay,zoomLog:()=>m.dH,zoomPow:()=>m.mK,zoomSymlog:()=>m.bV});var i={};n.r(i);n.d(i,{aggregate:()=>kl,bin:()=>Sl,collect:()=>Tl,compare:()=>$l,countpattern:()=>Al,cross:()=>zl,density:()=>ql,dotbin:()=>Bl,expression:()=>Jl,extent:()=>Vl,facet:()=>Zl,field:()=>Ql,filter:()=>eu,flatten:()=>nu,fold:()=>iu,formula:()=>ru,generate:()=>ou,impute:()=>lu,joinaggregate:()=>hu,kde:()=>du,key:()=>pu,load:()=>gu,lookup:()=>_u,multiextent:()=>xu,multivalues:()=>wu,params:()=>Mu,pivot:()=>Su,prefacet:()=>Du,project:()=>Au,proxy:()=>zu,quantile:()=>Ru,relay:()=>Ou,sample:()=>Uu,sequence:()=>Pu,sieve:()=>Iu,subflow:()=>Kl,timeunit:()=>qu,tupleindex:()=>Fu,values:()=>ju,window:()=>Vu});var r={};n.r(r);n.d(r,{interpolate:()=>bd,interpolateArray:()=>fd,interpolateBasis:()=>Kh,interpolateBasisClosed:()=>Zh,interpolateCubehelix:()=>Bm,interpolateCubehelixLong:()=>Ym,interpolateDate:()=>dd,interpolateDiscrete:()=>jp,interpolateHcl:()=>zm,interpolateHclLong:()=>Rm,interpolateHsl:()=>om,interpolateHslLong:()=>sm,interpolateHue:()=>Wp,interpolateLab:()=>Am,interpolateNumber:()=>pd,interpolateNumberArray:()=>ud,interpolateObject:()=>md,interpolateRgb:()=>od,interpolateRgbBasis:()=>ad,interpolateRgbBasisClosed:()=>ld,interpolateRound:()=>wd,interpolateString:()=>xd,interpolateTransformCss:()=>Kp,interpolateTransformSvg:()=>Zp,interpolateZoom:()=>im,piecewise:()=>Mp,quantize:()=>Jm});var o={};n.r(o);n.d(o,{bound:()=>PM,identifier:()=>LM,mark:()=>jM,overlap:()=>XM,render:()=>ZM,viewlayout:()=>$S});var s={};n.r(s);n.d(s,{axisticks:()=>RS,datajoin:()=>CS,encode:()=>PS,legendentries:()=>IS,linkpath:()=>WS,pie:()=>iE,scale:()=>lE,sortitems:()=>bE,stack:()=>EE});var a={};n.r(a);n.d(a,{contour:()=>AN,geojson:()=>CN,geopath:()=>ON,geopoint:()=>PN,geoshape:()=>IN,graticule:()=>LN,heatmap:()=>FN,isocontour:()=>yN,kde2d:()=>EN,projection:()=>BN});var l={};n.r(l);n.d(l,{force:()=>_R});var u={};n.r(u);n.d(u,{nest:()=>uO,pack:()=>yO,partition:()=>_O,stratify:()=>xO,tree:()=>kO,treelinks:()=>MO,treemap:()=>TO});var c={};n.r(c);n.d(c,{label:()=>dU});var f={};n.r(f);n.d(f,{loess:()=>mU,regression:()=>vU});var h={};n.r(h);n.d(h,{voronoi:()=>kq});var d={};n.r(d);n.d(d,{wordcloud:()=>Fq});var p={};n.r(p);n.d(p,{crossfilter:()=>Qq,resolvefilter:()=>tL});var m=n(48823);var g={},y={},v=34,_=10,x=13;function b(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function w(t,e){var n=b(t);return function(i,r){return e(n(i),r,t)}}function k(t){var e=Object.create(null),n=[];t.forEach((function(t){for(var i in t){if(!(i in e)){n.push(e[i]=i)}}}));return n}function M(t,e){var n=t+"",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function S(t){return t<0?"-"+M(-t,6):t>9999?"+"+M(t,6):M(t,4)}function E(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),i=t.getUTCSeconds(),r=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":S(t.getUTCFullYear(),4)+"-"+M(t.getUTCMonth()+1,2)+"-"+M(t.getUTCDate(),2)+(r?"T"+M(e,2)+":"+M(n,2)+":"+M(i,2)+"."+M(r,3)+"Z":i?"T"+M(e,2)+":"+M(n,2)+":"+M(i,2)+"Z":n||e?"T"+M(e,2)+":"+M(n,2)+"Z":"")}function T(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function i(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?w(t,e):b(t)}));o.columns=i||[];return o}function r(t,e){var i=[],r=t.length,o=0,s=0,a,l=r<=0,u=false;if(t.charCodeAt(r-1)===_)--r;if(t.charCodeAt(r-1)===x)--r;function c(){if(l)return y;if(u)return u=false,g;var e,i=o,s;if(t.charCodeAt(i)===v){while(o++<r&&t.charCodeAt(o)!==v||t.charCodeAt(++o)===v);if((e=o)>=r)l=true;else if((s=t.charCodeAt(o++))===_)u=true;else if(s===x){u=true;if(t.charCodeAt(o)===_)++o}return t.slice(i+1,e-1).replace(/""/g,'"')}while(o<r){if((s=t.charCodeAt(e=o++))===_)u=true;else if(s===x){u=true;if(t.charCodeAt(o)===_)++o}else if(s!==n)continue;return t.slice(i,e)}return l=true,t.slice(i,r)}while((a=c())!==y){var f=[];while(a!==g&&a!==y)f.push(a),a=c();if(e&&(f=e(f,s++))==null)continue;i.push(f)}return i}function o(e,n){return e.map((function(e){return n.map((function(t){return c(e[t])})).join(t)}))}function s(e,n){if(n==null)n=k(e);return[n.map(c).join(t)].concat(o(e,n)).join("\n")}function a(t,e){if(e==null)e=k(t);return o(t,e).join("\n")}function l(t){return t.map(u).join("\n")}function u(e){return e.map(c).join(t)}function c(t){return t==null?"":t instanceof Date?E(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:i,parseRows:r,format:s,formatBody:a,formatRows:l,formatRow:u,formatValue:c}}function $(t,e){var n,i=t.length,r=i-e;while(r<--i)n=t[r],t[r++]=t[i],t[i]=n}function D(t){return t}function A(t){if(t==null)return D;var e,n,i=t.scale[0],r=t.scale[1],o=t.translate[0],s=t.translate[1];return function(t,a){if(!a)e=n=0;var l=2,u=t.length,c=new Array(u);c[0]=(e+=t[0])*i+o;c[1]=(n+=t[1])*r+s;while(l<u)c[l]=t[l],++l;return c}}function N(t,e){if(typeof e==="string")e=t.objects[e];return e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map((function(e){return z(t,e)}))}:z(t,e)}function z(t,e){var n=e.id,i=e.bbox,r=e.properties==null?{}:e.properties,o=R(t,e);return n==null&&i==null?{type:"Feature",properties:r,geometry:o}:i==null?{type:"Feature",id:n,properties:r,geometry:o}:{type:"Feature",id:n,bbox:i,properties:r,geometry:o}}function R(t,e){var n=A(t.transform),i=t.arcs;function r(t,e){if(e.length)e.pop();for(var r=i[t<0?~t:t],o=0,s=r.length;o<s;++o){e.push(n(r[o],o))}if(t<0)$(e,s)}function o(t){return n(t)}function s(t){var e=[];for(var n=0,i=t.length;n<i;++n)r(t[n],e);if(e.length<2)e.push(e[0]);return e}function a(t){var e=s(t);while(e.length<4)e.push(e[0]);return e}function l(t){return t.map(a)}function u(t){var e=t.type,n;switch(e){case"GeometryCollection":return{type:e,geometries:t.geometries.map(u)};case"Point":n=o(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(o);break;case"LineString":n=s(t.arcs);break;case"MultiLineString":n=t.arcs.map(s);break;case"Polygon":n=l(t.arcs);break;case"MultiPolygon":n=t.arcs.map(l);break;default:return null}return{type:e,coordinates:n}}return u(e)}function C(t,e){var n={},i={},r={},o=[],s=-1;e.forEach((function(n,i){var r=t.arcs[n<0?~n:n],o;if(r.length<3&&!r[1][0]&&!r[1][1]){o=e[++s],e[s]=n,e[i]=o}}));e.forEach((function(t){var e=a(t),n=e[0],o=e[1],s,l;if(s=r[n]){delete r[s.end];s.push(t);s.end=o;if(l=i[o]){delete i[l.start];var u=l===s?s:s.concat(l);i[u.start=s.start]=r[u.end=l.end]=u}else{i[s.start]=r[s.end]=s}}else if(s=i[o]){delete i[s.start];s.unshift(t);s.start=n;if(l=r[n]){delete r[l.end];var c=l===s?s:l.concat(s);i[c.start=l.start]=r[c.end=s.end]=c}else{i[s.start]=r[s.end]=s}}else{s=[t];i[s.start=n]=r[s.end=o]=s}}));function a(e){var n=t.arcs[e<0?~e:e],i=n[0],r;if(t.transform)r=[0,0],n.forEach((function(t){r[0]+=t[0],r[1]+=t[1]}));else r=n[n.length-1];return e<0?[r,i]:[i,r]}function l(t,e){for(var i in t){var r=t[i];delete e[r.start];delete r.start;delete r.end;r.forEach((function(t){n[t<0?~t:t]=1}));o.push(r)}}l(r,i);l(i,r);e.forEach((function(t){if(!n[t<0?~t:t])o.push([t])}));return o}function O(t){return R(t,U.apply(this,arguments))}function U(t,e,n){var i,r,o;if(arguments.length>1)i=P(t,e,n);else for(r=0,i=new Array(o=t.arcs.length);r<o;++r)i[r]=r;return{type:"MultiLineString",arcs:C(t,i)}}function P(t,e,n){var i=[],r=[],o;function s(t){var e=t<0?~t:t;(r[e]||(r[e]=[])).push({i:t,g:o})}function a(t){t.forEach(s)}function l(t){t.forEach(a)}function u(t){t.forEach(l)}function c(t){switch(o=t,t.type){case"GeometryCollection":t.geometries.forEach(c);break;case"LineString":a(t.arcs);break;case"MultiLineString":case"Polygon":l(t.arcs);break;case"MultiPolygon":u(t.arcs);break}}c(e);r.forEach(n==null?function(t){i.push(t[0].i)}:function(t){if(n(t[0].g,t[t.length-1].g))i.push(t[0].i)});return i}const I=Math.sqrt(50),q=Math.sqrt(10),L=Math.sqrt(2);function F(t,e,n){const i=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(i)),o=i/Math.pow(10,r),s=o>=I?10:o>=q?5:o>=L?2:1;let a,l,u;if(r<0){u=Math.pow(10,-r)/s;a=Math.round(t*u);l=Math.round(e*u);if(a/u<t)++a;if(l/u>e)--l;u=-u}else{u=Math.pow(10,r)*s;a=Math.round(t/u);l=Math.round(e/u);if(a*u<t)++a;if(l*u>e)--l}if(l<a&&.5<=n&&n<2)return F(t,e,n*2);return[a,l,u]}function j(t,e,n){e=+e,t=+t,n=+n;if(!(n>0))return[];if(t===e)return[t];const i=e<t,[r,o,s]=i?F(e,t,n):F(t,e,n);if(!(o>=r))return[];const a=o-r+1,l=new Array(a);if(i){if(s<0)for(let t=0;t<a;++t)l[t]=(o-t)/-s;else for(let t=0;t<a;++t)l[t]=(o-t)*s}else{if(s<0)for(let t=0;t<a;++t)l[t]=(r+t)/-s;else for(let t=0;t<a;++t)l[t]=(r+t)*s}return l}function W(t,e,n){e=+e,t=+t,n=+n;return F(t,e,n)[2]}function X(t,e,n){e=+e,t=+t,n=+n;const i=e<t,r=i?W(e,t,n):W(t,e,n);return(i?-1:1)*(r<0?1/-r:r)}var H=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function B(t){if(!(e=H.exec(t)))throw new Error("invalid format: "+t);var e;return new Y({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}B.prototype=Y.prototype;function Y(t){this.fill=t.fill===undefined?" ":t.fill+"";this.align=t.align===undefined?">":t.align+"";this.sign=t.sign===undefined?"-":t.sign+"";this.symbol=t.symbol===undefined?"":t.symbol+"";this.zero=!!t.zero;this.width=t.width===undefined?undefined:+t.width;this.comma=!!t.comma;this.precision=t.precision===undefined?undefined:+t.precision;this.trim=!!t.trim;this.type=t.type===undefined?"":t.type+""}Y.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===undefined?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===undefined?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function J(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function G(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function V(t){return t=G(Math.abs(t)),t?t[1]:NaN}function K(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(V(e)/3)))*3-V(Math.abs(t)))}function Z(t,e){t=Math.abs(t),e=Math.abs(e)-t;return Math.max(0,V(e)-V(t))+1}function Q(t){return Math.max(0,-V(Math.abs(t)))}function tt(t,e){return function(n,i){var r=n.length,o=[],s=0,a=t[0],l=0;while(r>0&&a>0){if(l+a+1>i)a=Math.max(1,i-l);o.push(n.substring(r-=a,r+a));if((l+=a+1)>i)break;a=t[s=(s+1)%t.length]}return o.reverse().join(e)}}function et(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}function nt(t){t:for(var e=t.length,n=1,i=-1,r;n<e;++n){switch(t[n]){case".":i=r=n;break;case"0":if(i===0)i=n;r=n;break;default:if(!+t[n])break t;if(i>0)i=0;break}}return i>0?t.slice(0,i)+t.slice(r+1):t}var it;function rt(t,e){var n=G(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(it=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+G(t,Math.max(0,e+o-1))[0]}function ot(t,e){var n=G(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}const st={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:J,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ot(t*100,e),r:ot,s:rt,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function at(t){return t}var lt=Array.prototype.map,ut=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function ct(t){var e=t.grouping===undefined||t.thousands===undefined?at:tt(lt.call(t.grouping,Number),t.thousands+""),n=t.currency===undefined?"":t.currency[0]+"",i=t.currency===undefined?"":t.currency[1]+"",r=t.decimal===undefined?".":t.decimal+"",o=t.numerals===undefined?at:et(lt.call(t.numerals,String)),s=t.percent===undefined?"%":t.percent+"",a=t.minus===undefined?"−":t.minus+"",l=t.nan===undefined?"NaN":t.nan+"";function u(t){t=B(t);var u=t.fill,c=t.align,f=t.sign,h=t.symbol,d=t.zero,p=t.width,m=t.comma,g=t.precision,y=t.trim,v=t.type;if(v==="n")m=true,v="g";else if(!st[v])g===undefined&&(g=12),y=true,v="g";if(d||u==="0"&&c==="=")d=true,u="0",c="=";var _=h==="$"?n:h==="#"&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x=h==="$"?i:/[%p]/.test(v)?s:"";var b=st[v],w=/[defgprs%]/.test(v);g=g===undefined?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function k(t){var n=_,i=x,s,h,k;if(v==="c"){i=b(t)+i;t=""}else{t=+t;var M=t<0||1/t<0;t=isNaN(t)?l:b(Math.abs(t),g);if(y)t=nt(t);if(M&&+t===0&&f!=="+")M=false;n=(M?f==="("?f:a:f==="-"||f==="("?"":f)+n;i=(v==="s"?ut[8+it/3]:"")+i+(M&&f==="("?")":"");if(w){s=-1,h=t.length;while(++s<h){if(k=t.charCodeAt(s),48>k||k>57){i=(k===46?r+t.slice(s+1):t.slice(s))+i;t=t.slice(0,s);break}}}}if(m&&!d)t=e(t,Infinity);var S=n.length+t.length+i.length,E=S<p?new Array(p-S+1).join(u):"";if(m&&d)t=e(E+t,E.length?p-i.length:Infinity),E="";switch(c){case"<":t=n+t+i+E;break;case"=":t=n+E+t+i;break;case"^":t=E.slice(0,S=E.length>>1)+n+t+i+E.slice(S);break;default:t=E+n+t+i;break}return o(t)}k.toString=function(){return t+""};return k}function c(t,e){var n=u((t=B(t),t.type="f",t)),i=Math.max(-8,Math.min(8,Math.floor(V(e)/3)))*3,r=Math.pow(10,-i),o=ut[8+i/3];return function(t){return n(r*t)+o}}return{format:u,formatPrefix:c}}var ft;var ht;var dt;pt({thousands:",",grouping:[3],currency:["$",""]});function pt(t){ft=ct(t);ht=ft.format;dt=ft.formatPrefix;return ft}const mt=new Date,gt=new Date;function yt(t,e,n,i){function r(e){return t(e=arguments.length===0?new Date:new Date(+e)),e}r.floor=e=>(t(e=new Date(+e)),e);r.ceil=n=>(t(n=new Date(n-1)),e(n,1),t(n),n);r.round=t=>{const e=r(t),n=r.ceil(t);return t-e<n-t?e:n};r.offset=(t,n)=>(e(t=new Date(+t),n==null?1:Math.floor(n)),t);r.range=(n,i,o)=>{const s=[];n=r.ceil(n);o=o==null?1:Math.floor(o);if(!(n<i)||!(o>0))return s;let a;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<i);return s};r.filter=n=>yt((e=>{if(e>=e)while(t(e),!n(e))e.setTime(e-1)}),((t,i)=>{if(t>=t){if(i<0)while(++i<=0){while(e(t,-1),!n(t)){}}else while(--i>=0){while(e(t,+1),!n(t)){}}}}));if(n){r.count=(e,i)=>{mt.setTime(+e),gt.setTime(+i);t(mt),t(gt);return Math.floor(n(mt,gt))};r.every=t=>{t=Math.floor(t);return!isFinite(t)||!(t>0)?null:!(t>1)?r:r.filter(i?e=>i(e)%t===0:e=>r.count(0,e)%t===0)}}return r}const vt=1e3;const _t=vt*60;const xt=_t*60;const bt=xt*24;const wt=bt*7;const kt=bt*30;const Mt=bt*365;const St=yt((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*_t)/bt),(t=>t.getDate()-1));const Et=St.range;const Tt=yt((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/bt),(t=>t.getUTCDate()-1));const $t=Tt.range;const Dt=yt((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/bt),(t=>Math.floor(t/bt)));const At=Dt.range;function Nt(t){return yt((e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7);e.setHours(0,0,0,0)}),((t,e)=>{t.setDate(t.getDate()+e*7)}),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*_t)/wt))}const zt=Nt(0);const Rt=Nt(1);const Ct=Nt(2);const Ot=Nt(3);const Ut=Nt(4);const Pt=Nt(5);const It=Nt(6);const qt=zt.range;const Lt=Rt.range;const Ft=Ct.range;const jt=Ot.range;const Wt=Ut.range;const Xt=Pt.range;const Ht=It.range;function Bt(t){return yt((e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7);e.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e*7)}),((t,e)=>(e-t)/wt))}const Yt=Bt(0);const Jt=Bt(1);const Gt=Bt(2);const Vt=Bt(3);const Kt=Bt(4);const Zt=Bt(5);const Qt=Bt(6);const te=Yt.range;const ee=Jt.range;const ne=Gt.range;const ie=Vt.range;const re=Kt.range;const oe=Zt.range;const se=Qt.range;const ae=yt((t=>{t.setMonth(0,1);t.setHours(0,0,0,0)}),((t,e)=>{t.setFullYear(t.getFullYear()+e)}),((t,e)=>e.getFullYear()-t.getFullYear()),(t=>t.getFullYear()));ae.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:yt((e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t);e.setMonth(0,1);e.setHours(0,0,0,0)}),((e,n)=>{e.setFullYear(e.getFullYear()+n*t)}));const le=ae.range;const ue=yt((t=>{t.setUTCMonth(0,1);t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)}),((t,e)=>e.getUTCFullYear()-t.getUTCFullYear()),(t=>t.getUTCFullYear()));ue.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:yt((e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t);e.setUTCMonth(0,1);e.setUTCHours(0,0,0,0)}),((e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)}));const ce=ue.range;const fe=yt((t=>{t.setDate(1);t.setHours(0,0,0,0)}),((t,e)=>{t.setMonth(t.getMonth()+e)}),((t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12),(t=>t.getMonth()));const he=fe.range;const de=yt((t=>{t.setUTCDate(1);t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)}),((t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12),(t=>t.getUTCMonth()));const pe=de.range;const me=yt((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*vt-t.getMinutes()*_t)}),((t,e)=>{t.setTime(+t+e*xt)}),((t,e)=>(e-t)/xt),(t=>t.getHours()));const ge=me.range;const ye=yt((t=>{t.setUTCMinutes(0,0,0)}),((t,e)=>{t.setTime(+t+e*xt)}),((t,e)=>(e-t)/xt),(t=>t.getUTCHours()));const ve=ye.range;const _e=yt((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*vt)}),((t,e)=>{t.setTime(+t+e*_t)}),((t,e)=>(e-t)/_t),(t=>t.getMinutes()));const xe=_e.range;const be=yt((t=>{t.setUTCSeconds(0,0)}),((t,e)=>{t.setTime(+t+e*_t)}),((t,e)=>(e-t)/_t),(t=>t.getUTCMinutes()));const we=be.range;const ke=yt((t=>{t.setTime(t-t.getMilliseconds())}),((t,e)=>{t.setTime(+t+e*vt)}),((t,e)=>(e-t)/vt),(t=>t.getUTCSeconds()));const Me=ke.range;const Se=yt((()=>{}),((t,e)=>{t.setTime(+t+e)}),((t,e)=>e-t));Se.every=t=>{t=Math.floor(t);if(!isFinite(t)||!(t>0))return null;if(!(t>1))return Se;return yt((e=>{e.setTime(Math.floor(e/t)*t)}),((e,n)=>{e.setTime(+e+n*t)}),((e,n)=>(n-e)/t))};const Ee=Se.range;function Te(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function $e(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function De(t){let e,n,i;if(t.length!==2){e=Te;n=(e,n)=>Te(t(e),n);i=(e,n)=>t(e)-n}else{e=t===Te||t===$e?t:Ae;n=t;i=t}function r(t,i,r=0,o=t.length){if(r<o){if(e(i,i)!==0)return o;do{const e=r+o>>>1;if(n(t[e],i)<0)r=e+1;else o=e}while(r<o)}return r}function o(t,i,r=0,o=t.length){if(r<o){if(e(i,i)!==0)return o;do{const e=r+o>>>1;if(n(t[e],i)<=0)r=e+1;else o=e}while(r<o)}return r}function s(t,e,n=0,o=t.length){const s=r(t,e,n,o-1);return s>n&&i(t[s-1],e)>-i(t[s],e)?s-1:s}return{left:r,center:s,right:o}}function Ae(){return 0}const Ne="year";const ze="quarter";const Re="month";const Ce="week";const Oe="date";const Ue="day";const Pe="dayofyear";const Ie="hours";const qe="minutes";const Le="seconds";const Fe="milliseconds";const je=[Ne,ze,Re,Ce,Oe,Ue,Pe,Ie,qe,Le,Fe];const We=je.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function Xe(t){const e=(0,m.IX)(t).slice(),n={};if(!e.length)(0,m.vU)("Missing time unit.");e.forEach((t=>{if((0,m.nr)(We,t)){n[t]=1}else{(0,m.vU)(`Invalid time unit: ${t}.`)}}));const i=(n[Ce]||n[Ue]?1:0)+(n[ze]||n[Re]||n[Oe]?1:0)+(n[Pe]?1:0);if(i>1){(0,m.vU)(`Incompatible time units: ${t}`)}e.sort(((t,e)=>We[t]-We[e]));return e}const He={[Ne]:"%Y ",[ze]:"Q%q ",[Re]:"%b ",[Oe]:"%d ",[Ce]:"W%U ",[Ue]:"%a ",[Pe]:"%j ",[Ie]:"%H:00",[qe]:"00:%M",[Le]:":%S",[Fe]:".%L",[`${Ne}-${Re}`]:"%Y-%m ",[`${Ne}-${Re}-${Oe}`]:"%Y-%m-%d ",[`${Ie}-${qe}`]:"%H:%M"};function Be(t,e){const n=(0,m.l7)({},He,e),i=Xe(t),r=i.length;let o="",s=0,a,l;for(s=0;s<r;){for(a=i.length;a>s;--a){l=i.slice(s,a).join("-");if(n[l]!=null){o+=n[l];s=a;break}}}return o.trim()}const Ye=new Date;function Je(t){Ye.setFullYear(t);Ye.setMonth(0);Ye.setDate(1);Ye.setHours(0,0,0,0);return Ye}function Ge(t){return Ke(new Date(t))}function Ve(t){return Ze(new Date(t))}function Ke(t){return St.count(Je(t.getFullYear())-1,t)}function Ze(t){return zt.count(Je(t.getFullYear())-1,t)}function Qe(t){return Je(t).getDay()}function tn(t,e,n,i,r,o,s){if(0<=t&&t<100){const a=new Date(-1,e,n,i,r,o,s);a.setFullYear(t);return a}return new Date(t,e,n,i,r,o,s)}function en(t){return rn(new Date(t))}function nn(t){return on(new Date(t))}function rn(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Tt.count(e-1,t)}function on(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Yt.count(e-1,t)}function sn(t){Ye.setTime(Date.UTC(t,0,1));return Ye.getUTCDay()}function an(t,e,n,i,r,o,s){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,i,r,o,s));t.setUTCFullYear(n.y);return t}return new Date(Date.UTC(t,e,n,i,r,o,s))}function ln(t,e,n,i,r){const o=e||1,s=(0,m.fj)(t),a=(t,e,r)=>{r=r||t;return un(n[r],i[r],t===s&&o,e)};const l=new Date,u=(0,m.Rg)(t),c=u[Ne]?a(Ne):(0,m.a9)(2012),f=u[Re]?a(Re):u[ze]?a(ze):m.bM,h=u[Ce]&&u[Ue]?a(Ue,1,Ce+Ue):u[Ce]?a(Ce,1):u[Ue]?a(Ue,1):u[Oe]?a(Oe,1):u[Pe]?a(Pe,1):m.kX,d=u[Ie]?a(Ie):m.bM,p=u[qe]?a(qe):m.bM,g=u[Le]?a(Le):m.bM,y=u[Fe]?a(Fe):m.bM;return function(t){l.setTime(+t);const e=c(l);return r(e,f(l),h(l,e),d(l),p(l),g(l),y(l))}}function un(t,e,n,i){const r=n<=1?t:i?(e,r)=>i+n*Math.floor((t(e,r)-i)/n):(e,i)=>n*Math.floor(t(e,i)/n);return e?(t,n)=>e(r(t,n),n):r}function cn(t,e,n){return e+t*7-(n+6)%7}const fn={[Ne]:t=>t.getFullYear(),[ze]:t=>Math.floor(t.getMonth()/3),[Re]:t=>t.getMonth(),[Oe]:t=>t.getDate(),[Ie]:t=>t.getHours(),[qe]:t=>t.getMinutes(),[Le]:t=>t.getSeconds(),[Fe]:t=>t.getMilliseconds(),[Pe]:t=>Ke(t),[Ce]:t=>Ze(t),[Ce+Ue]:(t,e)=>cn(Ze(t),t.getDay(),Qe(e)),[Ue]:(t,e)=>cn(1,t.getDay(),Qe(e))};const hn={[ze]:t=>3*t,[Ce]:(t,e)=>cn(t,0,Qe(e))};function dn(t,e){return ln(t,e||1,fn,hn,tn)}const pn={[Ne]:t=>t.getUTCFullYear(),[ze]:t=>Math.floor(t.getUTCMonth()/3),[Re]:t=>t.getUTCMonth(),[Oe]:t=>t.getUTCDate(),[Ie]:t=>t.getUTCHours(),[qe]:t=>t.getUTCMinutes(),[Le]:t=>t.getUTCSeconds(),[Fe]:t=>t.getUTCMilliseconds(),[Pe]:t=>rn(t),[Ce]:t=>on(t),[Ue]:(t,e)=>cn(1,t.getUTCDay(),sn(e)),[Ce+Ue]:(t,e)=>cn(on(t),t.getUTCDay(),sn(e))};const mn={[ze]:t=>3*t,[Ce]:(t,e)=>cn(t,0,sn(e))};function gn(t,e){return ln(t,e||1,pn,mn,an)}const yn={[Ne]:ae,[ze]:fe.every(3),[Re]:fe,[Ce]:zt,[Oe]:St,[Ue]:St,[Pe]:St,[Ie]:me,[qe]:_e,[Le]:ke,[Fe]:Se};const vn={[Ne]:ue,[ze]:de.every(3),[Re]:de,[Ce]:Yt,[Oe]:Tt,[Ue]:Tt,[Pe]:Tt,[Ie]:ye,[qe]:be,[Le]:ke,[Fe]:Se};function _n(t){return yn[t]}function xn(t){return vn[t]}function bn(t,e,n){return t?t.offset(e,n):undefined}function wn(t,e,n){return bn(_n(t),e,n)}function kn(t,e,n){return bn(xn(t),e,n)}function Mn(t,e,n,i){return t?t.range(e,n,i):undefined}function Sn(t,e,n,i){return Mn(_n(t),e,n,i)}function En(t,e,n,i){return Mn(xn(t),e,n,i)}const Tn=1e3,$n=Tn*60,Dn=$n*60,An=Dn*24,Nn=An*7,zn=An*30,Rn=An*365;const Cn=[Ne,Re,Oe,Ie,qe,Le,Fe],On=Cn.slice(0,-1),Un=On.slice(0,-1),Pn=Un.slice(0,-1),In=Pn.slice(0,-1),qn=[Ne,Ce],Ln=[Ne,Re],Fn=[Ne];const jn=[[On,1,Tn],[On,5,5*Tn],[On,15,15*Tn],[On,30,30*Tn],[Un,1,$n],[Un,5,5*$n],[Un,15,15*$n],[Un,30,30*$n],[Pn,1,Dn],[Pn,3,3*Dn],[Pn,6,6*Dn],[Pn,12,12*Dn],[In,1,An],[qn,1,Nn],[Ln,1,zn],[Ln,3,3*zn],[Fn,1,Rn]];function Wn(t){const e=t.extent,n=t.maxbins||40,i=Math.abs((0,m.yP)(e))/n;let r=De((t=>t[2])).right(jn,i),o,s;if(r===jn.length){o=Fn,s=X(e[0]/Rn,e[1]/Rn,n)}else if(r){r=jn[i/jn[r-1][2]<jn[r][2]/i?r-1:r];o=r[0];s=r[1]}else{o=Cn;s=Math.max(X(e[0],e[1],n),1)}return{units:o,step:s}}function Xn(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);e.setFullYear(t.y);return e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Hn(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));e.setUTCFullYear(t.y);return e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Bn(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Yn(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,o=t.days,s=t.shortDays,a=t.months,l=t.shortMonths;var u=ti(r),c=ei(r),f=ti(o),h=ei(o),d=ti(s),p=ei(s),m=ti(a),g=ei(a),y=ti(l),v=ei(l);var _={a:R,A:C,b:O,B:U,c:null,d:wi,e:wi,f:Ti,g:Ii,G:Li,H:ki,I:Mi,j:Si,L:Ei,m:$i,M:Di,p:P,q:I,Q:ur,s:cr,S:Ai,u:Ni,U:zi,V:Ci,w:Oi,W:Ui,x:null,X:null,y:Pi,Y:qi,Z:Fi,"%":lr};var x={a:q,A:L,b:F,B:j,c:null,d:ji,e:ji,f:Yi,g:rr,G:sr,H:Wi,I:Xi,j:Hi,L:Bi,m:Ji,M:Gi,p:W,q:X,Q:ur,s:cr,S:Vi,u:Ki,U:Zi,V:tr,w:er,W:nr,x:null,X:null,y:ir,Y:or,Z:ar,"%":lr};var b={a:E,A:T,b:$,B:D,c:A,d:hi,e:hi,f:vi,g:li,G:ai,H:pi,I:pi,j:di,L:yi,m:fi,M:mi,p:S,q:ci,Q:xi,s:bi,S:gi,u:ii,U:ri,V:oi,w:ni,W:si,x:N,X:z,y:li,Y:ai,Z:ui,"%":_i};_.x=w(n,_);_.X=w(i,_);_.c=w(e,_);x.x=w(n,x);x.X=w(i,x);x.c=w(e,x);function w(t,e){return function(n){var i=[],r=-1,o=0,s=t.length,a,l,u;if(!(n instanceof Date))n=new Date(+n);while(++r<s){if(t.charCodeAt(r)===37){i.push(t.slice(o,r));if((l=Jn[a=t.charAt(++r)])!=null)a=t.charAt(++r);else l=a==="e"?" ":"0";if(u=e[a])a=u(n,l);i.push(a);o=r+1}}i.push(t.slice(o,r));return i.join("")}}function k(t,e){return function(n){var i=Bn(1900,undefined,1),r=M(i,t,n+="",0),o,s;if(r!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(i.s*1e3+("L"in i?i.L:0));if(e&&!("Z"in i))i.Z=0;if("p"in i)i.H=i.H%12+i.p*12;if(i.m===undefined)i.m="q"in i?i.q:0;if("V"in i){if(i.V<1||i.V>53)return null;if(!("w"in i))i.w=1;if("Z"in i){o=Hn(Bn(i.y,0,1)),s=o.getUTCDay();o=s>4||s===0?Jt.ceil(o):Jt(o);o=Tt.offset(o,(i.V-1)*7);i.y=o.getUTCFullYear();i.m=o.getUTCMonth();i.d=o.getUTCDate()+(i.w+6)%7}else{o=Xn(Bn(i.y,0,1)),s=o.getDay();o=s>4||s===0?Rt.ceil(o):Rt(o);o=St.offset(o,(i.V-1)*7);i.y=o.getFullYear();i.m=o.getMonth();i.d=o.getDate()+(i.w+6)%7}}else if("W"in i||"U"in i){if(!("w"in i))i.w="u"in i?i.u%7:"W"in i?1:0;s="Z"in i?Hn(Bn(i.y,0,1)).getUTCDay():Xn(Bn(i.y,0,1)).getDay();i.m=0;i.d="W"in i?(i.w+6)%7+i.W*7-(s+5)%7:i.w+i.U*7-(s+6)%7}if("Z"in i){i.H+=i.Z/100|0;i.M+=i.Z%100;return Hn(i)}return Xn(i)}}function M(t,e,n,i){var r=0,o=e.length,s=n.length,a,l;while(r<o){if(i>=s)return-1;a=e.charCodeAt(r++);if(a===37){a=e.charAt(r++);l=b[a in Jn?e.charAt(r++):a];if(!l||(i=l(t,n,i))<0)return-1}else if(a!=n.charCodeAt(i++)){return-1}}return i}function S(t,e,n){var i=u.exec(e.slice(n));return i?(t.p=c.get(i[0].toLowerCase()),n+i[0].length):-1}function E(t,e,n){var i=d.exec(e.slice(n));return i?(t.w=p.get(i[0].toLowerCase()),n+i[0].length):-1}function T(t,e,n){var i=f.exec(e.slice(n));return i?(t.w=h.get(i[0].toLowerCase()),n+i[0].length):-1}function $(t,e,n){var i=y.exec(e.slice(n));return i?(t.m=v.get(i[0].toLowerCase()),n+i[0].length):-1}function D(t,e,n){var i=m.exec(e.slice(n));return i?(t.m=g.get(i[0].toLowerCase()),n+i[0].length):-1}function A(t,n,i){return M(t,e,n,i)}function N(t,e,i){return M(t,n,e,i)}function z(t,e,n){return M(t,i,e,n)}function R(t){return s[t.getDay()]}function C(t){return o[t.getDay()]}function O(t){return l[t.getMonth()]}function U(t){return a[t.getMonth()]}function P(t){return r[+(t.getHours()>=12)]}function I(t){return 1+~~(t.getMonth()/3)}function q(t){return s[t.getUTCDay()]}function L(t){return o[t.getUTCDay()]}function F(t){return l[t.getUTCMonth()]}function j(t){return a[t.getUTCMonth()]}function W(t){return r[+(t.getUTCHours()>=12)]}function X(t){return 1+~~(t.getUTCMonth()/3)}return{format:function(t){var e=w(t+="",_);e.toString=function(){return t};return e},parse:function(t){var e=k(t+="",false);e.toString=function(){return t};return e},utcFormat:function(t){var e=w(t+="",x);e.toString=function(){return t};return e},utcParse:function(t){var e=k(t+="",true);e.toString=function(){return t};return e}}}var Jn={"-":"",_:" ",0:"0"},Gn=/^\s*\d+/,Vn=/^%/,Kn=/[\\^$*+?|[\]().{}]/g;function Zn(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(e)+r:r)}function Qn(t){return t.replace(Kn,"\\$&")}function ti(t){return new RegExp("^(?:"+t.map(Qn).join("|")+")","i")}function ei(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function ni(t,e,n){var i=Gn.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function ii(t,e,n){var i=Gn.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function ri(t,e,n){var i=Gn.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function oi(t,e,n){var i=Gn.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function si(t,e,n){var i=Gn.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function ai(t,e,n){var i=Gn.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function li(t,e,n){var i=Gn.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function ui(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function ci(t,e,n){var i=Gn.exec(e.slice(n,n+1));return i?(t.q=i[0]*3-3,n+i[0].length):-1}function fi(t,e,n){var i=Gn.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function hi(t,e,n){var i=Gn.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function di(t,e,n){var i=Gn.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function pi(t,e,n){var i=Gn.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function mi(t,e,n){var i=Gn.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function gi(t,e,n){var i=Gn.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function yi(t,e,n){var i=Gn.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function vi(t,e,n){var i=Gn.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function _i(t,e,n){var i=Vn.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function xi(t,e,n){var i=Gn.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function bi(t,e,n){var i=Gn.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function wi(t,e){return Zn(t.getDate(),e,2)}function ki(t,e){return Zn(t.getHours(),e,2)}function Mi(t,e){return Zn(t.getHours()%12||12,e,2)}function Si(t,e){return Zn(1+St.count(ae(t),t),e,3)}function Ei(t,e){return Zn(t.getMilliseconds(),e,3)}function Ti(t,e){return Ei(t,e)+"000"}function $i(t,e){return Zn(t.getMonth()+1,e,2)}function Di(t,e){return Zn(t.getMinutes(),e,2)}function Ai(t,e){return Zn(t.getSeconds(),e,2)}function Ni(t){var e=t.getDay();return e===0?7:e}function zi(t,e){return Zn(zt.count(ae(t)-1,t),e,2)}function Ri(t){var e=t.getDay();return e>=4||e===0?Ut(t):Ut.ceil(t)}function Ci(t,e){t=Ri(t);return Zn(Ut.count(ae(t),t)+(ae(t).getDay()===4),e,2)}function Oi(t){return t.getDay()}function Ui(t,e){return Zn(Rt.count(ae(t)-1,t),e,2)}function Pi(t,e){return Zn(t.getFullYear()%100,e,2)}function Ii(t,e){t=Ri(t);return Zn(t.getFullYear()%100,e,2)}function qi(t,e){return Zn(t.getFullYear()%1e4,e,4)}function Li(t,e){var n=t.getDay();t=n>=4||n===0?Ut(t):Ut.ceil(t);return Zn(t.getFullYear()%1e4,e,4)}function Fi(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Zn(e/60|0,"0",2)+Zn(e%60,"0",2)}function ji(t,e){return Zn(t.getUTCDate(),e,2)}function Wi(t,e){return Zn(t.getUTCHours(),e,2)}function Xi(t,e){return Zn(t.getUTCHours()%12||12,e,2)}function Hi(t,e){return Zn(1+Tt.count(ue(t),t),e,3)}function Bi(t,e){return Zn(t.getUTCMilliseconds(),e,3)}function Yi(t,e){return Bi(t,e)+"000"}function Ji(t,e){return Zn(t.getUTCMonth()+1,e,2)}function Gi(t,e){return Zn(t.getUTCMinutes(),e,2)}function Vi(t,e){return Zn(t.getUTCSeconds(),e,2)}function Ki(t){var e=t.getUTCDay();return e===0?7:e}function Zi(t,e){return Zn(Yt.count(ue(t)-1,t),e,2)}function Qi(t){var e=t.getUTCDay();return e>=4||e===0?Kt(t):Kt.ceil(t)}function tr(t,e){t=Qi(t);return Zn(Kt.count(ue(t),t)+(ue(t).getUTCDay()===4),e,2)}function er(t){return t.getUTCDay()}function nr(t,e){return Zn(Jt.count(ue(t)-1,t),e,2)}function ir(t,e){return Zn(t.getUTCFullYear()%100,e,2)}function rr(t,e){t=Qi(t);return Zn(t.getUTCFullYear()%100,e,2)}function or(t,e){return Zn(t.getUTCFullYear()%1e4,e,4)}function sr(t,e){var n=t.getUTCDay();t=n>=4||n===0?Kt(t):Kt.ceil(t);return Zn(t.getUTCFullYear()%1e4,e,4)}function ar(){return"+0000"}function lr(){return"%"}function ur(t){return+t}function cr(t){return Math.floor(+t/1e3)}var fr;var hr;var dr;var pr;var mr;gr({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function gr(t){fr=Yn(t);hr=fr.format;dr=fr.parse;pr=fr.utcFormat;mr=fr.utcParse;return fr}function yr(t){const e={};return n=>e[n]||(e[n]=t(n))}function vr(t,e){return n=>{const i=t(n),r=i.indexOf(e);if(r<0)return i;let o=_r(i,r);const s=o<i.length?i.slice(o):"";while(--o>r)if(i[o]!=="0"){++o;break}return i.slice(0,o)+s}}function _r(t,e){let n=t.lastIndexOf("e"),i;if(n>0)return n;for(n=t.length;--n>e;){i=t.charCodeAt(n);if(i>=48&&i<=57)return n+1}}function xr(t){const e=yr(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=B(t||",");if(n.precision==null){n.precision=12;switch(n.type){case"%":n.precision-=2;break;case"e":n.precision-=1;break}return vr(e(n),e(".1f")(1)[1])}else{return e(n)}},formatSpan(t,i,r,o){o=B(o==null?",f":o);const s=X(t,i,r),a=Math.max(Math.abs(t),Math.abs(i));let l;if(o.precision==null){switch(o.type){case"s":{if(!isNaN(l=K(s,a))){o.precision=l}return n(o,a)}case"":case"e":case"g":case"p":case"r":{if(!isNaN(l=Z(s,a))){o.precision=l-(o.type==="e")}break}case"f":case"%":{if(!isNaN(l=Q(s))){o.precision=l-(o.type==="%")*2}break}}}return e(o)}}}let br;wr();function wr(){return br=xr({format:ht,formatPrefix:dt})}function kr(t){return xr(ct(t))}function Mr(t){return arguments.length?br=kr(t):br}function Sr(t,e,n){n=n||{};if(!(0,m.Kn)(n)){(0,m.vU)(`Invalid time multi-format specifier: ${n}`)}const i=e(Le),r=e(qe),o=e(Ie),s=e(Oe),a=e(Ce),l=e(Re),u=e(ze),c=e(Ne),f=t(n[Fe]||".%L"),h=t(n[Le]||":%S"),d=t(n[qe]||"%I:%M"),p=t(n[Ie]||"%I %p"),g=t(n[Oe]||n[Ue]||"%a %d"),y=t(n[Ce]||"%b %d"),v=t(n[Re]||"%B"),_=t(n[ze]||"%B"),x=t(n[Ne]||"%Y");return t=>(i(t)<t?f:r(t)<t?h:o(t)<t?d:s(t)<t?p:l(t)<t?a(t)<t?g:y:c(t)<t?u(t)<t?v:_:x)(t)}function Er(t){const e=yr(t.format),n=yr(t.utcFormat);return{timeFormat:t=>(0,m.HD)(t)?e(t):Sr(e,_n,t),utcFormat:t=>(0,m.HD)(t)?n(t):Sr(n,xn,t),timeParse:yr(t.parse),utcParse:yr(t.utcParse)}}let Tr;$r();function $r(){return Tr=Er({format:hr,parse:dr,utcFormat:pr,utcParse:mr})}function Dr(t){return Er(Yn(t))}function Ar(t){return arguments.length?Tr=Dr(t):Tr}const Nr=(t,e)=>(0,m.l7)({},t,e);function zr(t,e){const n=t?kr(t):Mr();const i=e?Dr(e):Ar();return Nr(n,i)}function Rr(t,e){const n=arguments.length;if(n&&n!==2){(0,m.vU)("defaultLocale expects either zero or two arguments.")}return n?Nr(Mr(t),Ar(e)):Nr(Mr(),Ar())}function Cr(){wr();$r();return Rr()}const Or=/^(data:|([A-Za-z]+:)?\/\/)/;const Ur=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i;const Pr=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;const Ir="file://";function qr(t,e){return n=>({options:n||{},sanitize:Fr,load:Lr,fileAccess:!!e,file:jr(e),http:Xr(t)})}async function Lr(t,e){const n=await this.sanitize(t,e),i=n.href;return n.localFile?this.file(i):this.http(i,e)}async function Fr(t,e){e=(0,m.l7)({},this.options,e);const n=this.fileAccess,i={href:null};let r,o,s;const a=Ur.test(t.replace(Pr,""));if(t==null||typeof t!=="string"||!a){(0,m.vU)("Sanitize failure, invalid URI: "+(0,m.m8)(t))}const l=Or.test(t);if((s=e.baseURL)&&!l){if(!t.startsWith("/")&&!s.endsWith("/")){t="/"+t}t=s+t}o=(r=t.startsWith(Ir))||e.mode==="file"||e.mode!=="http"&&!l&&n;if(r){t=t.slice(Ir.length)}else if(t.startsWith("//")){if(e.defaultProtocol==="file"){t=t.slice(2);o=true}else{t=(e.defaultProtocol||"http")+":"+t}}Object.defineProperty(i,"localFile",{value:!!o});i.href=t;if(e.target){i.target=e.target+""}if(e.rel){i.rel=e.rel+""}if(e.context==="image"&&e.crossOrigin){i.crossOrigin=e.crossOrigin+""}return i}function jr(t){return t?e=>new Promise(((n,i)=>{t.readFile(e,((t,e)=>{if(t)i(t);else n(e)}))})):Wr}async function Wr(){(0,m.vU)("No file system access.")}function Xr(t){return t?async function(e,n){const i=(0,m.l7)({},this.options.http,n),r=n&&n.response,o=await t(e,i);return!o.ok?(0,m.vU)(o.status+""+o.statusText):(0,m.mf)(o[r])?o[r]():o.text()}:Hr}async function Hr(){(0,m.vU)("No HTTP fetch method available.")}const Br=t=>t!=null&&t===t;const Yr=t=>t==="true"||t==="false"||t===true||t===false;const Jr=t=>!Number.isNaN(Date.parse(t));const Gr=t=>!Number.isNaN(+t)&&!(t instanceof Date);const Vr=t=>Gr(t)&&Number.isInteger(+t);const Kr={boolean:m.sw,integer:m.He,number:m.He,date:m.ZU,string:m.BB,unknown:m.yR};const Zr=[Yr,Vr,Gr,Jr];const Qr=["boolean","integer","number","date"];function to(t,e){if(!t||!t.length)return"unknown";const n=t.length,i=Zr.length,r=Zr.map(((t,e)=>e+1));for(let o=0,s=0,a,l;o<n;++o){l=e?t[o][e]:t[o];for(a=0;a<i;++a){if(r[a]&&Br(l)&&!Zr[a](l)){r[a]=0;++s;if(s===Zr.length)return"string"}}}return Qr[r.reduce(((t,e)=>t===0?e:t),0)-1]}function eo(t,e){return e.reduce(((e,n)=>{e[n]=to(t,n);return e}),{})}function no(t){const e=function(e,n){const i={delimiter:t};return io(e,n?(0,m.l7)(n,i):i)};e.responseType="text";return e}function io(t,e){if(e.header){t=e.header.map(m.m8).join(e.delimiter)+"\n"+t}return T(e.delimiter).parse(t+"")}io.responseType="text";function ro(t){return typeof Buffer==="function"&&(0,m.mf)(Buffer.isBuffer)?Buffer.isBuffer(t):false}function oo(t,e){const n=e&&e.property?(0,m.EP)(e.property):m.yR;return(0,m.Kn)(t)&&!ro(t)?so(n(t),e):n(JSON.parse(t))}oo.responseType="json";function so(t,e){if(!(0,m.kJ)(t)&&(0,m.TW)(t)){t=[...t]}return e&&e.copy?JSON.parse(JSON.stringify(t)):t}const ao={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function lo(t,e){let n,i,r,o;t=oo(t,e);if(e&&e.feature){n=N;r=e.feature}else if(e&&e.mesh){n=O;r=e.mesh;o=ao[e.filter]}else{(0,m.vU)("Missing TopoJSON feature or mesh parameter.")}i=(i=t.objects[r])?n(t,i,o):(0,m.vU)("Invalid TopoJSON object: "+r);return i&&i.features||[i]}lo.responseType="json";const uo={dsv:io,csv:no(","),tsv:no("\t"),json:oo,topojson:lo};function co(t,e){if(arguments.length>1){uo[t]=e;return this}else{return(0,m.nr)(uo,t)?uo[t]:null}}function fo(t){const e=co(t);return e&&e.responseType||"text"}function ho(t,e,n,i){e=e||{};const r=co(e.type||"json");if(!r)(0,m.vU)("Unknown data format type: "+e.type);t=r(t,e);if(e.parse)po(t,e.parse,n,i);if((0,m.nr)(t,"columns"))delete t.columns;return t}function po(t,e,n,i){if(!t.length)return;const r=Ar();n=n||r.timeParse;i=i||r.utcParse;let o=t.columns||Object.keys(t[0]),s,a,l,u,c,f;if(e==="auto")e=eo(t,o);o=Object.keys(e);const h=o.map((t=>{const r=e[t];let o,s;if(r&&(r.startsWith("date:")||r.startsWith("utc:"))){o=r.split(/:(.+)?/,2);s=o[1];if(s[0]==="'"&&s[s.length-1]==="'"||s[0]==='"'&&s[s.length-1]==='"'){s=s.slice(1,-1)}const t=o[0]==="utc"?i:n;return t(s)}if(!Kr[r]){throw Error("Illegal format pattern: "+t+":"+r)}return Kr[r]}));for(l=0,c=t.length,f=o.length;l<c;++l){s=t[l];for(u=0;u<f;++u){a=o[u];s[a]=h[u](s[a])}}}const mo=qr(typeof fetch!=="undefined"&&fetch,null);function go(t){const e=t||m.yR,n=[],i={};n.add=t=>{const r=e(t);if(!i[r]){i[r]=1;n.push(t)}return n};n.remove=t=>{const r=e(t);if(i[r]){i[r]=0;const e=n.indexOf(t);if(e>=0)n.splice(e,1)}return n};return n}async function yo(t,e){try{await e(t)}catch(n){t.error(n)}}const vo=Symbol("vega_id");let _o=1;function xo(t){return!!(t&&bo(t))}function bo(t){return t[vo]}function wo(t,e){t[vo]=e;return t}function ko(t){const e=t===Object(t)?t:{data:t};return bo(e)?e:wo(e,_o++)}function Mo(t){return So(t,ko({}))}function So(t,e){for(const n in t)e[n]=t[n];return e}function Eo(t,e){return wo(e,bo(t))}function To(t,e){return!t?null:e?(n,i)=>t(n,i)||bo(e(n))-bo(e(i)):(e,n)=>t(e,n)||bo(e)-bo(n)}function $o(t){return t&&t.constructor===Do}function Do(){const t=[],e=[],n=[],i=[],r=[];let o=null,s=false;return{constructor:Do,insert(e){const n=(0,m.IX)(e),i=n.length;for(let r=0;r<i;++r)t.push(n[r]);return this},remove(t){const n=(0,m.mf)(t)?i:e,r=(0,m.IX)(t),o=r.length;for(let e=0;e<o;++e)n.push(r[e]);return this},modify(t,e,i){const o={field:e,value:(0,m.a9)(i)};if((0,m.mf)(t)){o.filter=t;r.push(o)}else{o.tuple=t;n.push(o)}return this},encode(t,e){if((0,m.mf)(t))r.push({filter:t,field:e});else n.push({tuple:t,field:e});return this},clean(t){o=t;return this},reflow(){s=true;return this},pulse(a,l){const u={},c={};let f,h,d,p,m,g;for(f=0,h=l.length;f<h;++f){u[bo(l[f])]=1}for(f=0,h=e.length;f<h;++f){m=e[f];u[bo(m)]=-1}for(f=0,h=i.length;f<h;++f){p=i[f];l.forEach((t=>{if(p(t))u[bo(t)]=-1}))}for(f=0,h=t.length;f<h;++f){m=t[f];g=bo(m);if(u[g]){u[g]=1}else{a.add.push(ko(t[f]))}}for(f=0,h=l.length;f<h;++f){m=l[f];if(u[bo(m)]<0)a.rem.push(m)}function y(t,e,n){if(n){t[e]=n(t)}else{a.encode=e}if(!s)c[bo(t)]=t}for(f=0,h=n.length;f<h;++f){d=n[f];m=d.tuple;p=d.field;g=u[bo(m)];if(g>0){y(m,p,d.value);a.modifies(p)}}for(f=0,h=r.length;f<h;++f){d=r[f];p=d.filter;l.forEach((t=>{if(p(t)&&u[bo(t)]>0){y(t,d.field,d.value)}}));a.modifies(d.field)}if(s){a.mod=e.length||i.length?l.filter((t=>u[bo(t)]>0)):l.slice()}else{for(g in c)a.mod.push(c[g])}if(o||o==null&&(e.length||i.length)){a.clean(true)}return a}}}const Ao="_:mod:_";function No(){Object.defineProperty(this,Ao,{writable:true,value:{}})}No.prototype={set(t,e,n,i){const r=this,o=r[t],s=r[Ao];if(e!=null&&e>=0){if(o[e]!==n||i){o[e]=n;s[e+":"+t]=-1;s[t]=-1}}else if(o!==n||i){r[t]=n;s[t]=(0,m.kJ)(n)?1+n.length:-1}return r},modified(t,e){const n=this[Ao];if(!arguments.length){for(const t in n){if(n[t])return true}return false}else if((0,m.kJ)(t)){for(let e=0;e<t.length;++e){if(n[t[e]])return true}return false}return e!=null&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){this[Ao]={};return this}};let zo=0;const Ro="pulse",Co=new No;const Oo=1,Uo=2;function Po(t,e,n,i){this.id=++zo;this.value=t;this.stamp=-1;this.rank=-1;this.qrank=-1;this.flags=0;if(e){this._update=e}if(n)this.parameters(n,i)}function Io(t){return function(e){const n=this.flags;if(arguments.length===0)return!!(n&t);this.flags=e?n|t:n&~t;return this}}Po.prototype={targets(){return this._targets||(this._targets=go(m.id))},set(t){if(this.value!==t){this.value=t;return 1}else{return 0}},skip:Io(Oo),modified:Io(Uo),parameters(t,e,n){e=e!==false;const i=this._argval=this._argval||new No,r=this._argops=this._argops||[],o=[];let s,a,l,u;const c=(t,n,s)=>{if(s instanceof Po){if(s!==this){if(e)s.targets().add(this);o.push(s)}r.push({op:s,name:t,index:n})}else{i.set(t,n,s)}};for(s in t){a=t[s];if(s===Ro){(0,m.IX)(a).forEach((t=>{if(!(t instanceof Po)){(0,m.vU)("Pulse parameters must be operator instances.")}else if(t!==this){t.targets().add(this);o.push(t)}}));this.source=a}else if((0,m.kJ)(a)){i.set(s,-1,Array(l=a.length));for(u=0;u<l;++u)c(s,u,a[u])}else{c(s,-1,a)}}this.marshall().clear();if(n)r.initonly=true;return o},marshall(t){const e=this._argval||Co,n=this._argops;let i,r,o,s;if(n){const a=n.length;for(r=0;r<a;++r){i=n[r];o=i.op;s=o.modified()&&o.stamp===t;e.set(i.name,i.index,o.value,s)}if(n.initonly){for(r=0;r<a;++r){i=n[r];i.op.targets().remove(this)}this._argops=null;this._update=null}}return e},detach(){const t=this._argops;let e,n,i,r;if(t){for(e=0,n=t.length;e<n;++e){i=t[e];r=i.op;if(r._targets){r._targets.remove(this)}}}this.pulse=null;this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),i=e.call(this,n,t);n.clear();if(i!==this.value){this.value=i}else if(!this.modified()){return t.StopPropagation}}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;if(this.skip()){this.skip(false);e=0}else{e=this.evaluate(t)}return this.pulse=e||t}};function qo(t,e,n,i){let r=1,o;if(t instanceof Po){o=t}else if(t&&t.prototype instanceof Po){o=new t}else if((0,m.mf)(t)){o=new Po(null,t)}else{r=0;o=new Po(t,e)}this.rank(o);if(r){i=n;n=e}if(n)this.connect(o,o.parameters(n,i));this.touch(o);return o}function Lo(t,e){const n=t.rank,i=e.length;for(let r=0;r<i;++r){if(n<e[r].rank){this.rerank(t);return}}}let Fo=0;function jo(t,e,n){this.id=++Fo;this.value=null;if(n)this.receive=n;if(t)this._filter=t;if(e)this._apply=e}function Wo(t,e,n){return new jo(t,e,n)}jo.prototype={_filter:m.yb,_apply:m.yR,targets(){return this._targets||(this._targets=go(m.id))},consume(t){if(!arguments.length)return!!this._consume;this._consume=!!t;return this},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,i=n?n.length:0;for(let t=0;t<i;++t)n[t].receive(e);if(this._consume){t.preventDefault();t.stopPropagation()}}},filter(t){const e=Wo(t);this.targets().add(e);return e},apply(t){const e=Wo(null,t);this.targets().add(e);return e},merge(){const t=Wo();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e){arguments[e].targets().add(t)}return t},throttle(t){let e=-1;return this.filter((()=>{const n=Date.now();if(n-e>t){e=n;return 1}else{return 0}}))},debounce(t){const e=Wo();this.targets().add(Wo(null,null,(0,m.Ds)(t,(t=>{const n=t.dataflow;e.receive(t);if(n&&n.run)n.run()}))));return e},between(t,e){let n=false;t.targets().add(Wo(null,null,(()=>n=true)));e.targets().add(Wo(null,null,(()=>n=false)));return this.filter((()=>n))},detach(){this._filter=m.yb;this._targets=null}};function Xo(t,e,n,i){const r=this,o=Wo(n,i),s=function(t){t.dataflow=r;try{o.receive(t)}catch(e){r.error(e)}finally{r.run()}};let a;if(typeof t==="string"&&typeof document!=="undefined"){a=document.querySelectorAll(t)}else{a=(0,m.IX)(t)}const l=a.length;for(let u=0;u<l;++u){a[u].addEventListener(e,s)}return o}function Ho(t,e){const n=this.locale();return ho(t,e,n.timeParse,n.utcParse)}function Bo(t,e,n){e=this.parse(e,n);return this.pulse(t,this.changeset().insert(e))}async function Yo(t,e){const n=this;let i=0,r;try{r=await n.loader().load(t,{context:"dataflow",response:fo(e&&e.type)});try{r=n.parse(r,e)}catch(o){i=-2;n.warn("Data ingestion failed",t,o)}}catch(o){i=-1;n.warn("Loading failed",t,o)}return{data:r,status:i}}async function Jo(t,e,n){const i=this,r=i._pending||Go(i);r.requests+=1;const o=await i.request(e,n);i.pulse(t,i.changeset().remove(m.yb).insert(o.data||[]));r.done();return o}function Go(t){let e;const n=new Promise((t=>e=t));n.requests=0;n.done=()=>{if(--n.requests===0){t._pending=null;e(t)}};return t._pending=n}const Vo={skip:true};function Ko(t,e,n,i,r){const o=t instanceof Po?Qo:Zo;o(this,t,e,n,i,r);return this}function Zo(t,e,n,i,r,o){const s=(0,m.l7)({},o,Vo);let a,l;if(!(0,m.mf)(n))n=(0,m.a9)(n);if(i===undefined){a=e=>t.touch(n(e))}else if((0,m.mf)(i)){l=new Po(null,i,r,false);a=e=>{l.evaluate(e);const i=n(e),r=l.value;$o(r)?t.pulse(i,r,o):t.update(i,r,s)}}else{a=e=>t.update(n(e),i,s)}e.apply(a)}function Qo(t,e,n,i,r,o){if(i===undefined){e.targets().add(n)}else{const s=o||{},a=new Po(null,ts(n,i),r,false);a.modified(s.force);a.rank=e.rank;e.targets().add(a);if(n){a.skip(true);a.value=n.value;a.targets().add(n);t.connect(n,[a])}}}function ts(t,e){e=(0,m.mf)(e)?e:(0,m.a9)(e);return t?function(n,i){const r=e(n,i);if(!t.skip()){t.skip(r!==this.value).value=r}return r}:e}function es(t){t.rank=++this._rank}function ns(t){const e=[t];let n,i,r;while(e.length){this.rank(n=e.pop());if(i=n._targets){for(r=i.length;--r>=0;){e.push(n=i[r]);if(n===t)(0,m.vU)("Cycle detected in dataflow graph.")}}}}const is={};const rs=1<<0,os=1<<1,ss=1<<2,as=rs|os,ls=rs|ss,us=rs|os|ss,cs=1<<3,fs=1<<4,hs=1<<5,ds=1<<6;function ps(t,e,n){this.dataflow=t;this.stamp=e==null?-1:e;this.add=[];this.rem=[];this.mod=[];this.fields=null;this.encode=n||null}function ms(t,e){const n=[];(0,m.FP)(t,e,(t=>n.push(t)));return n}function gs(t,e){const n={};t.visit(e,(t=>{n[bo(t)]=1}));return t=>n[bo(t)]?null:t}function ys(t,e){return t?(n,i)=>t(n,i)&&e(n,i):e}ps.prototype={StopPropagation:is,ADD:rs,REM:os,MOD:ss,ADD_REM:as,ADD_MOD:ls,ALL:us,REFLOW:cs,SOURCE:fs,NO_SOURCE:hs,NO_FIELDS:ds,fork(t){return new ps(this.dataflow).init(this,t)},clone(){const t=this.fork(us);t.add=t.add.slice();t.rem=t.rem.slice();t.mod=t.mod.slice();if(t.source)t.source=t.source.slice();return t.materialize(us|fs)},addAll(){let t=this;const e=!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length;if(e){return t}else{t=new ps(this.dataflow).init(this);t.add=t.source;t.rem=[];return t}},init(t,e){const n=this;n.stamp=t.stamp;n.encode=t.encode;if(t.fields&&!(e&ds)){n.fields=t.fields}if(e&rs){n.addF=t.addF;n.add=t.add}else{n.addF=null;n.add=[]}if(e&os){n.remF=t.remF;n.rem=t.rem}else{n.remF=null;n.rem=[]}if(e&ss){n.modF=t.modF;n.mod=t.mod}else{n.modF=null;n.mod=[]}if(e&hs){n.srcF=null;n.source=null}else{n.srcF=t.srcF;n.source=t.source;if(t.cleans)n.cleans=t.cleans}return n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||us;return e&rs&&this.add.length||e&os&&this.rem.length||e&ss&&this.mod.length},reflow(t){if(t)return this.fork(us).reflow();const e=this.add.length,n=this.source&&this.source.length;if(n&&n!==e){this.mod=this.source;if(e)this.filter(ss,gs(this,rs))}return this},clean(t){if(arguments.length){this.cleans=!!t;return this}else{return this.cleans}},modifies(t){const e=this.fields||(this.fields={});if((0,m.kJ)(t)){t.forEach((t=>e[t]=true))}else{e[t]=true}return this},modified(t,e){const n=this.fields;return!((e||this.mod.length)&&n)?false:!arguments.length?!!n:(0,m.kJ)(t)?t.some((t=>n[t])):n[t]},filter(t,e){const n=this;if(t&rs)n.addF=ys(n.addF,e);if(t&os)n.remF=ys(n.remF,e);if(t&ss)n.modF=ys(n.modF,e);if(t&fs)n.srcF=ys(n.srcF,e);return n},materialize(t){t=t||us;const e=this;if(t&rs&&e.addF){e.add=ms(e.add,e.addF);e.addF=null}if(t&os&&e.remF){e.rem=ms(e.rem,e.remF);e.remF=null}if(t&ss&&e.modF){e.mod=ms(e.mod,e.modF);e.modF=null}if(t&fs&&e.srcF){e.source=e.source.filter(e.srcF);e.srcF=null}return e},visit(t,e){const n=this,i=e;if(t&fs){(0,m.FP)(n.source,n.srcF,i);return n}if(t&rs)(0,m.FP)(n.add,n.addF,i);if(t&os)(0,m.FP)(n.rem,n.remF,i);if(t&ss)(0,m.FP)(n.mod,n.modF,i);const r=n.source;if(t&cs&&r){const t=n.add.length+n.mod.length;if(t===r.length);else if(t){(0,m.FP)(r,gs(n,ls),i)}else{(0,m.FP)(r,n.srcF,i)}}return n}};function vs(t,e,n,i){const r=this;let o=0;this.dataflow=t;this.stamp=e;this.fields=null;this.encode=i||null;this.pulses=n;for(const s of n){if(s.stamp!==e)continue;if(s.fields){const t=r.fields||(r.fields={});for(const e in s.fields){t[e]=1}}if(s.changed(r.ADD))o|=r.ADD;if(s.changed(r.REM))o|=r.REM;if(s.changed(r.MOD))o|=r.MOD}this.changes=o}(0,m.XW)(vs,ps,{fork(t){const e=new ps(this.dataflow).init(this,t&this.NO_FIELDS);if(t!==undefined){if(t&e.ADD)this.visit(e.ADD,(t=>e.add.push(t)));if(t&e.REM)this.visit(e.REM,(t=>e.rem.push(t)));if(t&e.MOD)this.visit(e.MOD,(t=>e.mod.push(t)))}return e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return!(n&&e.changes&e.MOD)?0:(0,m.kJ)(t)?t.some((t=>n[t])):n[t]},filter(){(0,m.vU)("MultiPulse does not support filtering.")},materialize(){(0,m.vU)("MultiPulse does not support materialization.")},visit(t,e){const n=this,i=n.pulses,r=i.length;let o=0;if(t&n.SOURCE){for(;o<r;++o){i[o].visit(t,e)}}else{for(;o<r;++o){if(i[o].stamp===n.stamp){i[o].visit(t,e)}}}return n}});async function _s(t,e,n){const i=this,r=[];if(i._pulse)return ks(i);if(i._pending)await i._pending;if(e)await yo(i,e);if(!i._touched.length){i.debug("Dataflow invoked, but nothing to do.");return i}const o=++i._clock;i._pulse=new ps(i,o,t);i._touched.forEach((t=>i._enqueue(t,true)));i._touched=go(m.id);let s=0,a,l,u;try{while(i._heap.size()>0){a=i._heap.pop();if(a.rank!==a.qrank){i._enqueue(a,true);continue}l=a.run(i._getPulse(a,t));if(l.then){l=await l}else if(l.async){r.push(l.async);l=is}if(l!==is){if(a._targets)a._targets.forEach((t=>i._enqueue(t)))}++s}}catch(c){i._heap.clear();u=c}i._input={};i._pulse=null;i.debug(`Pulse ${o}: ${s} operators`);if(u){i._postrun=[];i.error(u)}if(i._postrun.length){const t=i._postrun.sort(((t,e)=>e.priority-t.priority));i._postrun=[];for(let e=0;e<t.length;++e){await yo(i,t[e].callback)}}if(n)await yo(i,n);if(r.length){Promise.all(r).then((t=>i.runAsync(null,(()=>{t.forEach((t=>{try{t(i)}catch(c){i.error(c)}}))}))))}return i}async function xs(t,e,n){while(this._running)await this._running;const i=()=>this._running=null;(this._running=this.evaluate(t,e,n)).then(i,i);return this._running}function bs(t,e,n){return this._pulse?ks(this):(this.evaluate(t,e,n),this)}function ws(t,e,n){if(this._pulse||e){this._postrun.push({priority:n||0,callback:t})}else{try{t(this)}catch(i){this.error(i)}}}function ks(t){t.error("Dataflow already running. Use runAsync() to chain invocations.");return t}function Ms(t,e){const n=t.stamp<this._clock;if(n)t.stamp=this._clock;if(n||e){t.qrank=t.rank;this._heap.push(t)}}function Ss(t,e){const n=t.source,i=this._clock;return n&&(0,m.kJ)(n)?new vs(this,i,n.map((t=>t.pulse)),e):this._input[t.id]||Es(this._pulse,n&&n.pulse)}function Es(t,e){if(e&&e.stamp===t.stamp){return e}t=t.fork();if(e&&e!==is){t.source=e.source}return t}const Ts={skip:false,force:false};function $s(t,e){const n=e||Ts;if(this._pulse){this._enqueue(t)}else{this._touched.add(t)}if(n.skip)t.skip(true);return this}function Ds(t,e,n){const i=n||Ts;if(t.set(e)||i.force){this.touch(t,i)}return this}function As(t,e,n){this.touch(t,n||Ts);const i=new ps(this,this._clock+(this._pulse?0:1)),r=t.pulse&&t.pulse.source||[];i.target=t;this._input[t.id]=e.pulse(i,r);return this}function Ns(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>{e.push(n);return zs(e,0,e.length-1,t)},pop:()=>{const n=e.pop();let i;if(e.length){i=e[0];e[0]=n;Rs(e,0,t)}else{i=n}return i}}}function zs(t,e,n,i){let r,o;const s=t[n];while(n>e){o=n-1>>1;r=t[o];if(i(s,r)<0){t[n]=r;n=o;continue}break}return t[n]=s}function Rs(t,e,n){const i=e,r=t.length,o=t[e];let s=(e<<1)+1,a;while(s<r){a=s+1;if(a<r&&n(t[s],t[a])>=0){s=a}t[e]=t[s];e=s;s=(e<<1)+1}t[e]=o;return zs(t,i,e,n)}function Cs(){this.logger((0,m.kg)());this.logLevel(m.jj);this._clock=0;this._rank=0;this._locale=Rr();try{this._loader=mo()}catch(t){}this._touched=go(m.id);this._input={};this._pulse=null;this._heap=Ns(((t,e)=>t.qrank-e.qrank));this._postrun=[]}function Os(t){return function(){return this._log[t].apply(this,arguments)}}Cs.prototype={stamp(){return this._clock},loader(t){if(arguments.length){this._loader=t;return this}else{return this._loader}},locale(t){if(arguments.length){this._locale=t;return this}else{return this._locale}},logger(t){if(arguments.length){this._log=t;return this}else{return this._log}},error:Os("error"),warn:Os("warn"),info:Os("info"),debug:Os("debug"),logLevel:Os("level"),cleanThreshold:1e4,add:qo,connect:Lo,rank:es,rerank:ns,pulse:As,touch:$s,update:Ds,changeset:Do,ingest:Bo,parse:Ho,preload:Jo,request:Yo,events:Xo,on:Ko,evaluate:_s,run:bs,runAsync:xs,runAfter:ws,_enqueue:Ms,_getPulse:Ss};function Us(t,e){Po.call(this,t,null,e)}(0,m.XW)(Us,Po,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;if(this.skip()){this.skip(false)}else{e=this.evaluate(t)}e=e||t;if(e.then){e=e.then((t=>this.pulse=t))}else if(e!==t.StopPropagation){this.pulse=e}return e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);e.clear();return n},transform(){}});const Ps={};function Is(t){const e=qs(t);return e&&e.Definition||null}function qs(t){t=t&&t.toLowerCase();return(0,m.nr)(Ps,t)?Ps[t]:null}function Ls(t,e){let n;if(e===undefined){for(const e of t){if(e!=null&&(n<e||n===undefined&&e>=e)){n=e}}}else{let i=-1;for(let r of t){if((r=e(r,++i,t))!=null&&(n<r||n===undefined&&r>=r)){n=r}}}return n}function Fs(t,e){let n;if(e===undefined){for(const e of t){if(e!=null&&(n>e||n===undefined&&e>=e)){n=e}}}else{let i=-1;for(let r of t){if((r=e(r,++i,t))!=null&&(n>r||n===undefined&&r>=r)){n=r}}}return n}function js(t,...e){if(typeof t[Symbol.iterator]!=="function")throw new TypeError("values is not iterable");t=Array.from(t);let[n]=e;if(n&&n.length!==2||e.length>1){const i=Uint32Array.from(t,((t,e)=>e));if(e.length>1){e=e.map((e=>t.map(e)));i.sort(((t,n)=>{for(const i of e){const e=Xs(i[t],i[n]);if(e)return e}}))}else{n=t.map(n);i.sort(((t,e)=>Xs(n[t],n[e])))}return permute(t,i)}return t.sort(Ws(n))}function Ws(t=Te){if(t===Te)return Xs;if(typeof t!=="function")throw new TypeError("compare is not a function");return(e,n)=>{const i=t(e,n);if(i||i===0)return i;return(t(n,n)===0)-(t(e,e)===0)}}function Xs(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}function Hs(t,e,n=0,i=Infinity,r){e=Math.floor(e);n=Math.floor(Math.max(0,n));i=Math.floor(Math.min(t.length-1,i));if(!(n<=e&&e<=i))return t;r=r===undefined?Xs:Ws(r);while(i>n){if(i-n>600){const o=i-n+1;const s=e-n+1;const a=Math.log(o);const l=.5*Math.exp(2*a/3);const u=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1);const c=Math.max(n,Math.floor(e-s*l/o+u));const f=Math.min(i,Math.floor(e+(o-s)*l/o+u));Hs(t,e,c,f,r)}const o=t[e];let s=n;let a=i;Bs(t,n,e);if(r(t[i],o)>0)Bs(t,n,i);while(s<a){Bs(t,s,a),++s,--a;while(r(t[s],o)<0)++s;while(r(t[a],o)>0)--a}if(r(t[n],o)===0)Bs(t,n,a);else++a,Bs(t,a,i);if(a<=e)n=a+1;if(e<=a)i=a-1}return t}function Bs(t,e,n){const i=t[e];t[e]=t[n];t[n]=i}function Ys(t){return t===null?NaN:+t}function*Js(t,e){if(e===undefined){for(let e of t){if(e!=null&&(e=+e)>=e){yield e}}}else{let n=-1;for(let i of t){if((i=e(i,++n,t))!=null&&(i=+i)>=i){yield i}}}}function Gs(t,e,n){t=Float64Array.from(Js(t,n));if(!(i=t.length)||isNaN(e=+e))return;if(e<=0||i<2)return Fs(t);if(e>=1)return Ls(t);var i,r=(i-1)*e,o=Math.floor(r),s=Ls(Hs(t,o).subarray(0,o+1)),a=Fs(t.subarray(o+1));return s+(a-s)*(r-o)}function Vs(t,e,n=Ys){if(!(i=t.length)||isNaN(e=+e))return;if(e<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,r=(i-1)*e,o=Math.floor(r),s=+n(t[o],o,t),a=+n(t[o+1],o+1,t);return s+(a-s)*(r-o)}function Ks(t,e,n){t=Float64Array.from(numbers(t,n));if(!(i=t.length)||isNaN(e=+e))return;if(e<=0||i<2)return minIndex(t);if(e>=1)return maxIndex(t);var i,r=Math.floor((i-1)*e),o=(e,n)=>ascendingDefined(t[e],t[n]),s=quickselect(Uint32Array.from(t,((t,e)=>e)),r,0,i-1,o);return greatest(s.subarray(0,r+1),(e=>t[e]))}function Zs(t,e){let n=0;let i;let r=0;let o=0;if(e===undefined){for(let e of t){if(e!=null&&(e=+e)>=e){i=e-r;r+=i/++n;o+=i*(e-r)}}}else{let s=-1;for(let a of t){if((a=e(a,++s,t))!=null&&(a=+a)>=a){i=a-r;r+=i/++n;o+=i*(a-r)}}}if(n>1)return o/(n-1)}function Qs(t,e){const n=Zs(t,e);return n?Math.sqrt(n):n}function ta(t,e){return Gs(t,.5,e)}function ea(t,e){return quantileIndex(t,.5,e)}function*na(t,e){if(e==null){for(let e of t){if(e!=null&&e!==""&&(e=+e)>=e){yield e}}}else{let n=-1;for(let i of t){i=e(i,++n,t);if(i!=null&&i!==""&&(i=+i)>=i){yield i}}}}function ia(t,e,n){const i=Float64Array.from(na(t,n));i.sort(Te);return e.map((t=>Vs(i,t)))}function ra(t,e){return ia(t,[.25,.5,.75],e)}function oa(t,e){const n=t.length,i=Qs(t,e),r=ra(t,e),o=(r[2]-r[0])/1.34,s=Math.min(i,o)||i||Math.abs(r[0])||1;return 1.06*s*Math.pow(n,-.2)}function sa(t){const e=t.maxbins||20,n=t.base||10,i=Math.log(n),r=t.divide||[5,2];let o=t.extent[0],s=t.extent[1],a,l,u,c,f,h;const d=t.span||s-o||Math.abs(o)||1;if(t.step){a=t.step}else if(t.steps){c=d/e;for(f=0,h=t.steps.length;f<h&&t.steps[f]<c;++f);a=t.steps[Math.max(0,f-1)]}else{l=Math.ceil(Math.log(e)/i);u=t.minstep||0;a=Math.max(u,Math.pow(n,Math.round(Math.log(d)/i)-l));while(Math.ceil(d/a)>e){a*=n}for(f=0,h=r.length;f<h;++f){c=a/r[f];if(c>=u&&d/c<=e)a=c}}c=Math.log(a);const p=c>=0?0:~~(-c/i)+1,m=Math.pow(n,-p-1);if(t.nice||t.nice===undefined){c=Math.floor(o/a+m)*a;o=o<c?c-a:c;s=Math.ceil(s/a)*a}return{start:o,stop:s===o?o+a:s,step:a}}var aa=Math.random;function la(t){aa=t}function ua(t,e,n,i){if(!t.length)return[undefined,undefined];const r=Float64Array.from(na(t,i)),o=r.length,s=e;let a,l,u,c;for(u=0,c=Array(s);u<s;++u){for(a=0,l=0;l<o;++l){a+=r[~~(aa()*o)]}c[u]=a/o}c.sort(Te);return[Gs(c,n/2),Gs(c,1-n/2)]}function ca(t,e,n,i){i=i||(t=>t);const r=t.length,o=new Float64Array(r);let s=0,a=1,l=i(t[0]),u=l,c=l+e,f;for(;a<r;++a){f=i(t[a]);if(f>=c){u=(l+u)/2;for(;s<a;++s)o[s]=u;c=f+e;l=f}u=f}u=(l+u)/2;for(;s<a;++s)o[s]=u;return n?fa(o,e+e/4):o}function fa(t,e){const n=t.length;let i=0,r=1,o,s;while(t[i]===t[r])++r;while(r<n){o=r+1;while(t[r]===t[o])++o;if(t[r]-t[r-1]<e){s=r+(i+o-r-r>>1);while(s<r)t[s++]=t[r];while(s>r)t[s--]=t[i]}i=r;r=o}return t}function ha(t){return function(){t=(1103515245*t+12345)%2147483647;return t/2147483647}}function da(t,e){if(e==null){e=t;t=0}let n,i,r;const o={min(t){if(arguments.length){n=t||0;r=i-n;return o}else{return n}},max(t){if(arguments.length){i=t||0;r=i-n;return o}else{return i}},sample(){return n+Math.floor(r*aa())},pdf(t){return t===Math.floor(t)&&t>=n&&t<i?1/r:0},cdf(t){const e=Math.floor(t);return e<n?0:e>=i?1:(e-n+1)/r},icdf(t){return t>=0&&t<=1?n-1+Math.floor(t*r):NaN}};return o.min(t).max(e)}const pa=Math.sqrt(2*Math.PI);const ma=Math.SQRT2;let ga=NaN;function ya(t,e){t=t||0;e=e==null?1:e;let n=0,i=0,r,o;if(ga===ga){n=ga;ga=NaN}else{do{n=aa()*2-1;i=aa()*2-1;r=n*n+i*i}while(r===0||r>1);o=Math.sqrt(-2*Math.log(r)/r);n*=o;ga=i*o}return t+n*e}function va(t,e,n){n=n==null?1:n;const i=(t-(e||0))/n;return Math.exp(-.5*i*i)/(n*pa)}function _a(t,e,n){e=e||0;n=n==null?1:n;const i=(t-e)/n,r=Math.abs(i);let o;if(r>37){o=0}else{const t=Math.exp(-r*r/2);let e;if(r<7.07106781186547){e=.0352624965998911*r+.700383064443688;e=e*r+6.37396220353165;e=e*r+33.912866078383;e=e*r+112.079291497871;e=e*r+221.213596169931;e=e*r+220.206867912376;o=t*e;e=.0883883476483184*r+1.75566716318264;e=e*r+16.064177579207;e=e*r+86.7807322029461;e=e*r+296.564248779674;e=e*r+637.333633378831;e=e*r+793.826512519948;e=e*r+440.413735824752;o=o/e}else{e=r+.65;e=r+4/e;e=r+3/e;e=r+2/e;e=r+1/e;o=t/e/2.506628274631}}return i>0?1-o:o}function xa(t,e,n){if(t<0||t>1)return NaN;return(e||0)+(n==null?1:n)*ma*ba(2*t-1)}function ba(t){let e=-Math.log((1-t)*(1+t)),n;if(e<6.25){e-=3.125;n=-364441206401782e-35;n=-16850591381820166e-35+n*e;n=128584807152564e-32+n*e;n=11157877678025181e-33+n*e;n=-1333171662854621e-31+n*e;n=20972767875968562e-33+n*e;n=6637638134358324e-30+n*e;n=-4054566272975207e-29+n*e;n=-8151934197605472e-29+n*e;n=26335093153082323e-28+n*e;n=-12975133253453532e-27+n*e;n=-5415412054294628e-26+n*e;n=1.0512122733215323e-9+n*e;n=-4.112633980346984e-9+n*e;n=-2.9070369957882005e-8+n*e;n=4.2347877827932404e-7+n*e;n=-13654692000834679e-22+n*e;n=-13882523362786469e-21+n*e;n=.00018673420803405714+n*e;n=-.000740702534166267+n*e;n=-.006033670871430149+n*e;n=.24015818242558962+n*e;n=1.6536545626831027+n*e}else if(e<16){e=Math.sqrt(e)-3.25;n=2.2137376921775787e-9;n=9.075656193888539e-8+n*e;n=-2.7517406297064545e-7+n*e;n=1.8239629214389228e-8+n*e;n=15027403968909828e-22+n*e;n=-4013867526981546e-21+n*e;n=29234449089955446e-22+n*e;n=12475304481671779e-21+n*e;n=-47318229009055734e-21+n*e;n=6828485145957318e-20+n*e;n=24031110387097894e-21+n*e;n=-.0003550375203628475+n*e;n=.0009532893797373805+n*e;n=-.0016882755560235047+n*e;n=.002491442096107851+n*e;n=-.003751208507569241+n*e;n=.005370914553590064+n*e;n=1.0052589676941592+n*e;n=3.0838856104922208+n*e}else if(Number.isFinite(e)){e=Math.sqrt(e)-5;n=-27109920616438573e-27;n=-2.555641816996525e-10+n*e;n=1.5076572693500548e-9+n*e;n=-3.789465440126737e-9+n*e;n=7.61570120807834e-9+n*e;n=-1.496002662714924e-8+n*e;n=2.914795345090108e-8+n*e;n=-6.771199775845234e-8+n*e;n=2.2900482228026655e-7+n*e;n=-9.9298272942317e-7+n*e;n=4526062597223154e-21+n*e;n=-1968177810553167e-20+n*e;n=7599527703001776e-20+n*e;n=-.00021503011930044477+n*e;n=-.00013871931833623122+n*e;n=1.0103004648645344+n*e;n=4.849906401408584+n*e}else{n=Infinity}return n*t}function wa(t,e){let n,i;const r={mean(t){if(arguments.length){n=t||0;return r}else{return n}},stdev(t){if(arguments.length){i=t==null?1:t;return r}else{return i}},sample:()=>ya(n,i),pdf:t=>va(t,n,i),cdf:t=>_a(t,n,i),icdf:t=>xa(t,n,i)};return r.mean(t).stdev(e)}function ka(t,e){const n=wa();let i=0;const r={data(n){if(arguments.length){t=n;i=n?n.length:0;return r.bandwidth(e)}else{return t}},bandwidth(n){if(!arguments.length)return e;e=n;if(!e&&t)e=oa(t);return r},sample(){return t[~~(aa()*i)]+e*n.sample()},pdf(r){let o=0,s=0;for(;s<i;++s){o+=n.pdf((r-t[s])/e)}return o/e/i},cdf(r){let o=0,s=0;for(;s<i;++s){o+=n.cdf((r-t[s])/e)}return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(t)}function Ma(t,e){t=t||0;e=e==null?1:e;return Math.exp(t+ya()*e)}function Sa(t,e,n){if(t<=0)return 0;e=e||0;n=n==null?1:n;const i=(Math.log(t)-e)/n;return Math.exp(-.5*i*i)/(n*pa*t)}function Ea(t,e,n){return _a(Math.log(t),e,n)}function Ta(t,e,n){return Math.exp(xa(t,e,n))}function $a(t,e){let n,i;const r={mean(t){if(arguments.length){n=t||0;return r}else{return n}},stdev(t){if(arguments.length){i=t==null?1:t;return r}else{return i}},sample:()=>Ma(n,i),pdf:t=>Sa(t,n,i),cdf:t=>Ea(t,n,i),icdf:t=>Ta(t,n,i)};return r.mean(t).stdev(e)}function Da(t,e){let n=0,i;function r(t){const e=[];let i=0,r;for(r=0;r<n;++r){i+=e[r]=t[r]==null?1:+t[r]}for(r=0;r<n;++r){e[r]/=i}return e}const o={weights(t){if(arguments.length){i=r(e=t||[]);return o}return e},distributions(i){if(arguments.length){if(i){n=i.length;t=i}else{n=0;t=[]}return o.weights(e)}return t},sample(){const e=aa();let r=t[n-1],o=i[0],s=0;for(;s<n-1;o+=i[++s]){if(e<o){r=t[s];break}}return r.sample()},pdf(e){let r=0,o=0;for(;o<n;++o){r+=i[o]*t[o].pdf(e)}return r},cdf(e){let r=0,o=0;for(;o<n;++o){r+=i[o]*t[o].cdf(e)}return r},icdf(){throw Error("Mixture icdf not supported.")}};return o.distributions(t).weights(e)}function Aa(t,e){if(e==null){e=t==null?1:t;t=0}return t+(e-t)*aa()}function Na(t,e,n){if(n==null){n=e==null?1:e;e=0}return t>=e&&t<=n?1/(n-e):0}function za(t,e,n){if(n==null){n=e==null?1:e;e=0}return t<e?0:t>n?1:(t-e)/(n-e)}function Ra(t,e,n){if(n==null){n=e==null?1:e;e=0}return t>=0&&t<=1?e+t*(n-e):NaN}function Ca(t,e){let n,i;const r={min(t){if(arguments.length){n=t||0;return r}else{return n}},max(t){if(arguments.length){i=t==null?1:t;return r}else{return i}},sample:()=>Aa(n,i),pdf:t=>Na(t,n,i),cdf:t=>za(t,n,i),icdf:t=>Ra(t,n,i)};if(e==null){e=t==null?1:t;t=0}return r.min(t).max(e)}function Oa(t,e,n,i){const r=i-t*t,o=Math.abs(r)<1e-24?0:(n-t*e)/r,s=e-o*t;return[s,o]}function Ua(t,e,n,i){t=t.filter((t=>{let i=e(t),r=n(t);return i!=null&&(i=+i)>=i&&r!=null&&(r=+r)>=r}));if(i){t.sort(((t,n)=>e(t)-e(n)))}const r=t.length,o=new Float64Array(r),s=new Float64Array(r);let a=0,l=0,u=0,c,f,h;for(h of t){o[a]=c=+e(h);s[a]=f=+n(h);++a;l+=(c-l)/a;u+=(f-u)/a}for(a=0;a<r;++a){o[a]-=l;s[a]-=u}return[o,s,l,u]}function Pa(t,e,n,i){let r=-1,o,s;for(const a of t){o=e(a);s=n(a);if(o!=null&&(o=+o)>=o&&s!=null&&(s=+s)>=s){i(o,s,++r)}}}function Ia(t,e,n,i,r){let o=0,s=0;Pa(t,e,n,((t,e)=>{const n=e-r(t),a=e-i;o+=n*n;s+=a*a}));return 1-o/s}function qa(t,e,n){let i=0,r=0,o=0,s=0,a=0;Pa(t,e,n,((t,e)=>{++a;i+=(t-i)/a;r+=(e-r)/a;o+=(t*e-o)/a;s+=(t*t-s)/a}));const l=Oa(i,r,o,s),u=t=>l[0]+l[1]*t;return{coef:l,predict:u,rSquared:Ia(t,e,n,r,u)}}function La(t,e,n){let i=0,r=0,o=0,s=0,a=0;Pa(t,e,n,((t,e)=>{++a;t=Math.log(t);i+=(t-i)/a;r+=(e-r)/a;o+=(t*e-o)/a;s+=(t*t-s)/a}));const l=Oa(i,r,o,s),u=t=>l[0]+l[1]*Math.log(t);return{coef:l,predict:u,rSquared:Ia(t,e,n,r,u)}}function Fa(t,e,n){const[i,r,o,s]=Ua(t,e,n);let a=0,l=0,u=0,c=0,f=0,h,d,p;Pa(t,e,n,((t,e)=>{h=i[f++];d=Math.log(e);p=h*e;a+=(e*d-a)/f;l+=(p-l)/f;u+=(p*d-u)/f;c+=(h*p-c)/f}));const[m,g]=Oa(l/s,a/s,u/s,c/s),y=t=>Math.exp(m+g*(t-o));return{coef:[Math.exp(m-g*o),g],predict:y,rSquared:Ia(t,e,n,s,y)}}function ja(t,e,n){let i=0,r=0,o=0,s=0,a=0,l=0;Pa(t,e,n,((t,e)=>{const n=Math.log(t),u=Math.log(e);++l;i+=(n-i)/l;r+=(u-r)/l;o+=(n*u-o)/l;s+=(n*n-s)/l;a+=(e-a)/l}));const u=Oa(i,r,o,s),c=t=>u[0]*Math.pow(t,u[1]);u[0]=Math.exp(u[0]);return{coef:u,predict:c,rSquared:Ia(t,e,n,a,c)}}function Wa(t,e,n){const[i,r,o,s]=Ua(t,e,n),a=i.length;let l=0,u=0,c=0,f=0,h=0,d,p,m,g;for(d=0;d<a;){p=i[d];m=r[d++];g=p*p;l+=(g-l)/d;u+=(g*p-u)/d;c+=(g*g-c)/d;f+=(p*m-f)/d;h+=(g*m-h)/d}const y=c-l*l,v=l*y-u*u,_=(h*l-f*u)/v,x=(f*y-h*u)/v,b=-_*l,w=t=>{t=t-o;return _*t*t+x*t+b+s};return{coef:[b-x*o+_*o*o+s,x-2*_*o,_],predict:w,rSquared:Ia(t,e,n,s,w)}}function Xa(t,e,n,i){if(i===1)return qa(t,e,n);if(i===2)return Wa(t,e,n);const[r,o,s,a]=Ua(t,e,n),l=r.length,u=[],c=[],f=i+1;let h,d,p,m,g;for(h=0;h<f;++h){for(p=0,m=0;p<l;++p){m+=Math.pow(r[p],h)*o[p]}u.push(m);g=new Float64Array(f);for(d=0;d<f;++d){for(p=0,m=0;p<l;++p){m+=Math.pow(r[p],h+d)}g[d]=m}c.push(g)}c.push(u);const y=Ba(c),v=t=>{t-=s;let e=a+y[0]+y[1]*t+y[2]*t*t;for(h=3;h<f;++h)e+=y[h]*Math.pow(t,h);return e};return{coef:Ha(f,y,-s,a),predict:v,rSquared:Ia(t,e,n,a,v)}}function Ha(t,e,n,i){const r=Array(t);let o,s,a,l;for(o=0;o<t;++o)r[o]=0;for(o=t-1;o>=0;--o){a=e[o];l=1;r[o]+=a;for(s=1;s<=o;++s){l*=(o+1-s)/s;r[o-s]+=a*Math.pow(n,s)*l}}r[0]+=i;return r}function Ba(t){const e=t.length-1,n=[];let i,r,o,s,a;for(i=0;i<e;++i){s=i;for(r=i+1;r<e;++r){if(Math.abs(t[i][r])>Math.abs(t[i][s])){s=r}}for(o=i;o<e+1;++o){a=t[o][i];t[o][i]=t[o][s];t[o][s]=a}for(r=i+1;r<e;++r){for(o=e;o>=i;o--){t[o][r]-=t[o][i]*t[i][r]/t[i][i]}}}for(r=e-1;r>=0;--r){a=0;for(o=r+1;o<e;++o){a+=t[o][r]*n[o]}n[r]=(t[e][r]-a)/t[r][r]}return n}const Ya=2,Ja=1e-12;function Ga(t,e,n,i){const[r,o,s,a]=Ua(t,e,n,true),l=r.length,u=Math.max(2,~~(i*l)),c=new Float64Array(l),f=new Float64Array(l),h=new Float64Array(l).fill(1);for(let d=-1;++d<=Ya;){const t=[0,u-1];for(let n=0;n<l;++n){const e=r[n],i=t[0],s=t[1],a=e-r[i]>r[s]-e?i:s;let l=0,u=0,d=0,p=0,m=0;const g=1/Math.abs(r[a]-e||1);for(let t=i;t<=s;++t){const n=r[t],i=o[t],s=Va(Math.abs(e-n)*g)*h[t],a=n*s;l+=s;u+=a;d+=i*s;p+=i*a;m+=n*a}const[y,v]=Oa(u/l,d/l,p/l,m/l);c[n]=y+v*e;f[n]=Math.abs(o[n]-c[n]);Ka(r,n+1,t)}if(d===Ya){break}const e=ta(f);if(Math.abs(e)<Ja)break;for(let n=0,i,r;n<l;++n){i=f[n]/(6*e);h[n]=i>=1?Ja:(r=1-i*i)*r}}return Za(r,c,s,a)}function Va(t){return(t=1-t*t*t)*t*t}function Ka(t,e,n){const i=t[e];let r=n[0],o=n[1]+1;if(o>=t.length)return;while(e>r&&t[o]-i<=i-t[r]){n[0]=++r;n[1]=o;++o}}function Za(t,e,n,i){const r=t.length,o=[];let s=0,a=0,l=[],u;for(;s<r;++s){u=t[s]+n;if(l[0]===u){l[1]+=(e[s]-l[1])/++a}else{a=0;l[1]+=i;l=[u,e[s]];o.push(l)}}l[1]+=i;return o}const Qa=.5*Math.PI/180;function tl(t,e,n,i){n=n||25;i=Math.max(n,i||200);const r=e=>[e,t(e)],o=e[0],s=e[1],a=s-o,l=a/i,u=[r(o)],c=[];if(n===i){for(let t=1;t<i;++t){u.push(r(o+t/n*a))}u.push(r(s));return u}else{c.push(r(s));for(let t=n;--t>0;){c.push(r(o+t/n*a))}}let f=u[0];let h=c[c.length-1];const d=1/a;const p=el(f[1],c);while(h){const t=r((f[0]+h[0])/2);const e=t[0]-f[0]>=l;if(e&&nl(f,t,h,d,p)>Qa){c.push(t)}else{f=h;u.push(h);c.pop()}h=c[c.length-1]}return u}function el(t,e){let n=t;let i=t;const r=e.length;for(let o=0;o<r;++o){const t=e[o][1];if(t<n)n=t;if(t>i)i=t}return 1/(i-n)}function nl(t,e,n,i,r){const o=Math.atan2(r*(n[1]-t[1]),i*(n[0]-t[0])),s=Math.atan2(r*(e[1]-t[1]),i*(e[0]-t[0]));return Math.abs(o-s)}function il(t,e){let n=0;let i=0;if(e===undefined){for(let e of t){if(e!=null&&(e=+e)>=e){++n,i+=e}}}else{let r=-1;for(let o of t){if((o=e(o,++r,t))!=null&&(o=+o)>=o){++n,i+=o}}}if(n)return i/n}function rl(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(r);while(++i<r){o[i]=t+i*n}return o}function ol(t){return e=>{const n=t.length;let i=1,r=String(t[0](e));for(;i<n;++i){r+="|"+t[i](e)}return r}}function sl(t){return!t||!t.length?function(){return""}:t.length===1?t[0]:ol(t)}function al(t,e,n){return n||t+(!e?"":"_"+e)}const ll=()=>{};const ul={init:ll,add:ll,rem:ll,idx:0};const cl={values:{init:t=>t.cell.store=true,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:undefined,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:undefined,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:undefined,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):undefined,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:undefined,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):undefined,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):undefined,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):undefined,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=undefined,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{if(e<t.min||t.min===undefined)t.min=e},rem:(t,e)=>{if(e<=t.min)t.min=NaN},req:["values"],idx:4},max:{init:t=>t.max=undefined,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{if(e>t.max||t.max===undefined)t.max=e},rem:(t,e)=>{if(e>=t.max)t.max=NaN},req:["values"],idx:4},argmin:{init:t=>t.argmin=undefined,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{if(e<t.min)t.argmin=n},rem:(t,e)=>{if(e<=t.min)t.argmin=undefined},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=undefined,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{if(e>t.max)t.argmax=n},rem:(t,e)=>{if(e>=t.max)t.argmax=undefined},req:["max","values"],idx:3}};const fl=Object.keys(cl).filter((t=>t!=="__count__"));function hl(t,e){return n=>(0,m.l7)({name:t,out:n||t},ul,e)}[...fl,"__count__"].forEach((t=>{cl[t]=hl(t,cl[t])}));function dl(t,e){return cl[t](e)}function pl(t,e){return t.idx-e.idx}function ml(t){const e={};t.forEach((t=>e[t.name]=t));const n=t=>{if(!t.req)return;t.req.forEach((t=>{if(!e[t])n(e[t]=cl[t]())}))};t.forEach(n);return Object.values(e).sort(pl)}function gl(){this.valid=0;this.missing=0;this._ops.forEach((t=>t.init(this)))}function yl(t,e){if(t==null||t===""){++this.missing;return}if(t!==t)return;++this.valid;this._ops.forEach((n=>n.add(this,t,e)))}function vl(t,e){if(t==null||t===""){--this.missing;return}if(t!==t)return;--this.valid;this._ops.forEach((n=>n.rem(this,t,e)))}function _l(t){this._out.forEach((e=>t[e.out]=e.value(this)));return t}function xl(t,e){const n=e||m.yR,i=ml(t),r=t.slice().sort(pl);function o(t){this._ops=i;this._out=r;this.cell=t;this.init()}o.prototype.init=gl;o.prototype.add=yl;o.prototype.rem=vl;o.prototype.set=_l;o.prototype.get=n;o.fields=t.map((t=>t.out));return o}function bl(t){this._key=t?(0,m.EP)(t):bo;this.reset()}const wl=bl.prototype;wl.reset=function(){this._add=[];this._rem=[];this._ext=null;this._get=null;this._q=null};wl.add=function(t){this._add.push(t)};wl.rem=function(t){this._rem.push(t)};wl.values=function(){this._get=null;if(this._rem.length===0)return this._add;const t=this._add,e=this._rem,n=this._key,i=t.length,r=e.length,o=Array(i-r),s={};let a,l,u;for(a=0;a<r;++a){s[n(e[a])]=1}for(a=0,l=0;a<i;++a){if(s[n(u=t[a])]){s[n(u)]=0}else{o[l++]=u}}this._rem=[];return this._add=o};wl.distinct=function(t){const e=this.values(),n={};let i=e.length,r=0,o;while(--i>=0){o=t(e[i])+"";if(!(0,m.nr)(n,o)){n[o]=1;++r}}return r};wl.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=(0,m.dI)(e,t);this._ext=[e[n[0]],e[n[1]]];this._get=t}return this._ext};wl.argmin=function(t){return this.extent(t)[0]||{}};wl.argmax=function(t){return this.extent(t)[1]||{}};wl.min=function(t){const e=this.extent(t)[0];return e!=null?t(e):undefined};wl.max=function(t){const e=this.extent(t)[1];return e!=null?t(e):undefined};wl.quartile=function(t){if(this._get!==t||!this._q){this._q=ra(this.values(),t);this._get=t}return this._q};wl.q1=function(t){return this.quartile(t)[0]};wl.q2=function(t){return this.quartile(t)[1]};wl.q3=function(t){return this.quartile(t)[2]};wl.ci=function(t){if(this._get!==t||!this._ci){this._ci=ua(this.values(),1e3,.05,t);this._get=t}return this._ci};wl.ci0=function(t){return this.ci(t)[0]};wl.ci1=function(t){return this.ci(t)[1]};function kl(t){Us.call(this,null,t);this._adds=[];this._mods=[];this._alen=0;this._mlen=0;this._drop=true;this._cross=false;this._dims=[];this._dnames=[];this._measures=[];this._countOnly=false;this._counts=null;this._prev=null;this._inputs=null;this._outputs=null}kl.Definition={type:"Aggregate",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:fl},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"drop",type:"boolean",default:true},{name:"cross",type:"boolean",default:false},{name:"key",type:"field"}]};(0,m.XW)(kl,Us,{transform(t,e){const n=this,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.modified();n.stamp=i.stamp;if(n.value&&(r||e.modified(n._inputs,true))){n._prev=n.value;n.value=r?n.init(t):{};e.visit(e.SOURCE,(t=>n.add(t)))}else{n.value=n.value||n.init(t);e.visit(e.REM,(t=>n.rem(t)));e.visit(e.ADD,(t=>n.add(t)))}i.modifies(n._outputs);n._drop=t.drop!==false;if(t.cross&&n._dims.length>1){n._drop=false;n.cross()}if(e.clean()&&n._drop){i.clean(true).runAfter((()=>this.clean()))}return n.changes(i)},cross(){const t=this,e=t.value,n=t._dnames,i=n.map((()=>({}))),r=n.length;function o(t){let e,o,s,a;for(e in t){s=t[e].tuple;for(o=0;o<r;++o){i[o][a=s[n[o]]]=a}}}o(t._prev);o(e);function s(o,a,l){const u=n[l],c=i[l++];for(const n in c){const i=o?o+"|"+n:n;a[u]=c[n];if(l<r)s(i,a,l);else if(!e[i])t.cell(i,a)}}s("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],i={};function r(t){const n=(0,m.IX)((0,m.Oj)(t)),r=n.length;let o=0,s;for(;o<r;++o){if(!i[s=n[o]]){i[s]=1;e.push(s)}}}this._dims=(0,m.IX)(t.groupby);this._dnames=this._dims.map((t=>{const e=(0,m.el)(t);r(t);n.push(e);return e}));this.cellkey=t.key?t.key:sl(this._dims);this._countOnly=true;this._counts=[];this._measures=[];const o=t.fields||[null],s=t.ops||["count"],a=t.as||[],l=o.length,u={};let c,f,h,d,p,g;if(l!==s.length){(0,m.vU)("Unmatched number of fields and aggregate ops.")}for(g=0;g<l;++g){c=o[g];f=s[g];if(c==null&&f!=="count"){(0,m.vU)("Null aggregate field specified.")}d=(0,m.el)(c);p=al(f,d,a[g]);n.push(p);if(f==="count"){this._counts.push(p);continue}h=u[d];if(!h){r(c);h=u[d]=[];h.field=c;this._measures.push(h)}if(f!=="count")this._countOnly=false;h.push(dl(f,p))}this._measures=this._measures.map((t=>xl(t,t.field)));return{}},cellkey:sl(),cell(t,e){let n=this.value[t];if(!n){n=this.value[t]=this.newcell(t,e);this._adds[this._alen++]=n}else if(n.num===0&&this._drop&&n.stamp<this.stamp){n.stamp=this.stamp;this._adds[this._alen++]=n}else if(n.stamp<this.stamp){n.stamp=this.stamp;this._mods[this._mlen++]=n}return n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:false};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let i=0;i<e;++i){n.agg[i]=new t[i](n)}}if(n.store){n.data=new bl}return n},newtuple(t,e){const n=this._dnames,i=this._dims,r=i.length,o={};for(let s=0;s<r;++s){o[n[s]]=i[s](t)}return e?Eo(e.tuple,o):ko(o)},clean(){const t=this.value;for(const e in t){if(t[e].num===0){delete t[e]}}},add(t){const e=this.cellkey(t),n=this.cell(e,t);n.num+=1;if(this._countOnly)return;if(n.store)n.data.add(t);const i=n.agg;for(let r=0,o=i.length;r<o;++r){i[r].add(i[r].get(t),t)}},rem(t){const e=this.cellkey(t),n=this.cell(e,t);n.num-=1;if(this._countOnly)return;if(n.store)n.data.rem(t);const i=n.agg;for(let r=0,o=i.length;r<o;++r){i[r].rem(i[r].get(t),t)}},celltuple(t){const e=t.tuple,n=this._counts;if(t.store){t.data.values()}for(let i=0,r=n.length;i<r;++i){e[n[i]]=t.num}if(!this._countOnly){const n=t.agg;for(let t=0,i=n.length;t<i;++t){n[t].set(e)}}return e},changes(t){const e=this._adds,n=this._mods,i=this._prev,r=this._drop,o=t.add,s=t.rem,a=t.mod;let l,u,c,f;if(i)for(u in i){l=i[u];if(!r||l.num)s.push(l.tuple)}for(c=0,f=this._alen;c<f;++c){o.push(this.celltuple(e[c]));e[c]=null}for(c=0,f=this._mlen;c<f;++c){l=n[c];(l.num===0&&r?s:a).push(this.celltuple(l));n[c]=null}this._alen=this._mlen=0;this._prev=null;return t}});const Ml=1e-14;function Sl(t){Us.call(this,null,t)}Sl.Definition={type:"Bin",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"interval",type:"boolean",default:true},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:true,default:[5,2]},{name:"extent",type:"number",array:true,length:2,required:true},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:true},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:true},{name:"name",type:"string"},{name:"as",type:"string",array:true,length:2,default:["bin0","bin1"]}]};(0,m.XW)(Sl,Us,{transform(t,e){const n=t.interval!==false,i=this._bins(t),r=i.start,o=i.step,s=t.as||["bin0","bin1"],a=s[0],l=s[1];let u;if(t.modified()){e=e.reflow(true);u=e.SOURCE}else{u=e.modified((0,m.Oj)(t.field))?e.ADD_MOD:e.ADD}e.visit(u,n?t=>{const e=i(t);t[a]=e;t[l]=e==null?null:r+o*(1+(e-r)/o)}:t=>t[a]=i(t));return e.modifies(n?s:a)},_bins(t){if(this.value&&!t.modified()){return this.value}const e=t.field,n=sa(t),i=n.step;let r=n.start,o=r+Math.ceil((n.stop-r)/i)*i,s,a;if((s=t.anchor)!=null){a=s-(r+i*Math.floor((s-r)/i));r+=a;o+=a}const l=function(t){let n=(0,m.He)(e(t));return n==null?null:n<r?-Infinity:n>o?+Infinity:(n=Math.max(r,Math.min(n,o-i)),r+i*Math.floor(Ml+(n-r)/i))};l.start=r;l.stop=n.stop;l.step=i;return this.value=(0,m.ZE)(l,(0,m.Oj)(e),t.name||"bin_"+(0,m.el)(e))}});function El(t,e,n){const i=t;let r=e||[],o=n||[],s={},a=0;return{add:t=>o.push(t),remove:t=>s[i(t)]=++a,size:()=>r.length,data:(t,e)=>{if(a){r=r.filter((t=>!s[i(t)]));s={};a=0}if(e&&t){r.sort(t)}if(o.length){r=t?(0,m.TS)(t,r,o.sort(t)):r.concat(o);o=[]}return r}}}function Tl(t){Us.call(this,[],t)}Tl.Definition={type:"Collect",metadata:{source:true},params:[{name:"sort",type:"compare"}]};(0,m.XW)(Tl,Us,{transform(t,e){const n=e.fork(e.ALL),i=El(bo,this.value,n.materialize(n.ADD).add),r=t.sort,o=e.changed()||r&&(t.modified("sort")||e.modified(r.fields));n.visit(n.REM,i.remove);this.modified(o);this.value=n.source=i.data(To(r),o);if(e.source&&e.source.root){this.value.root=e.source.root}return n}});function $l(t){Po.call(this,null,Dl,t)}(0,m.XW)($l,Po);function Dl(t){return this.value&&!t.modified()?this.value:(0,m.qu)(t.fields,t.orders)}function Al(t){Us.call(this,null,t)}Al.Definition={type:"CountPattern",metadata:{generates:true,changes:true},params:[{name:"field",type:"field",required:true},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:true,length:2,default:["text","count"]}]};function Nl(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase();break}return t.match(n)}(0,m.XW)(Al,Us,{transform(t,e){const n=e=>n=>{var i=Nl(a(n),t.case,o)||[],r;for(var l=0,u=i.length;l<u;++l){if(!s.test(r=i[l]))e(r)}};const i=this._parameterCheck(t,e),r=this._counts,o=this._match,s=this._stop,a=t.field,l=t.as||["text","count"],u=n((t=>r[t]=1+(r[t]||0))),c=n((t=>r[t]-=1));if(i){e.visit(e.SOURCE,u)}else{e.visit(e.ADD,u);e.visit(e.REM,c)}return this._finish(e,l)},_parameterCheck(t,e){let n=false;if(t.modified("stopwords")||!this._stop){this._stop=new RegExp("^"+(t.stopwords||"")+"$","i");n=true}if(t.modified("pattern")||!this._match){this._match=new RegExp(t.pattern||"[\\w']+","g");n=true}if(t.modified("field")||e.modified(t.field.fields)){n=true}if(n)this._counts={};return n},_finish(t,e){const n=this._counts,i=this._tuples||(this._tuples={}),r=e[0],o=e[1],s=t.fork(t.NO_SOURCE|t.NO_FIELDS);let a,l,u;for(a in n){l=i[a];u=n[a]||0;if(!l&&u){i[a]=l=ko({});l[r]=a;l[o]=u;s.add.push(l)}else if(u===0){if(l)s.rem.push(l);n[a]=null;i[a]=null}else if(l[o]!==u){l[o]=u;s.mod.push(l)}}return s.modifies(e)}});function zl(t){Us.call(this,null,t)}zl.Definition={type:"Cross",metadata:{generates:true},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:true,length:2,default:["a","b"]}]};(0,m.XW)(zl,Us,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.as||["a","b"],r=i[0],o=i[1],s=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let a=this.value;if(s){if(a)n.rem=a;a=e.materialize(e.SOURCE).source;n.add=this.value=Rl(a,r,o,t.filter||m.yb)}else{n.mod=a}n.source=this.value;return n.modifies(i)}});function Rl(t,e,n,i){var r=[],o={},s=t.length,a=0,l,u;for(;a<s;++a){o[e]=u=t[a];for(l=0;l<s;++l){o[n]=t[l];if(i(o)){r.push(ko(o));o={};o[e]=u}}}return r}const Cl={kde:ka,mixture:Da,normal:wa,lognormal:$a,uniform:Ca};const Ol="distributions",Ul="function",Pl="field";function Il(t,e){const n=t[Ul];if(!(0,m.nr)(Cl,n)){(0,m.vU)("Unknown distribution function: "+n)}const i=Cl[n]();for(const r in t){if(r===Pl){i.data((t.from||e()).map(t[r]))}else if(r===Ol){i[r](t[r].map((t=>Il(t,e))))}else if(typeof i[r]===Ul){i[r](t[r])}}return i}function ql(t){Us.call(this,null,t)}const Ll=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:true},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];const Fl={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:true,params:Ll},{name:"weights",type:"number",array:true}]};ql.Definition={type:"Density",metadata:{generates:true},params:[{name:"extent",type:"number",array:true,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Ll.concat(Fl)},{name:"as",type:"string",array:true,default:["value","density"]}]};(0,m.XW)(ql,Us,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=Il(t.distribution,jl(e)),r=t.steps||t.minsteps||25,o=t.steps||t.maxsteps||200;let s=t.method||"pdf";if(s!=="pdf"&&s!=="cdf"){(0,m.vU)("Invalid density method: "+s)}if(!t.extent&&!i.data){(0,m.vU)("Missing density extent parameter.")}s=i[s];const a=t.as||["value","density"],l=t.extent||(0,m.We)(i.data()),u=tl(s,l,r,o).map((t=>{const e={};e[a[0]]=t[0];e[a[1]]=t[1];return ko(e)}));if(this.value)n.rem=this.value;this.value=n.add=n.source=u}return n}});function jl(t){return()=>t.materialize(t.SOURCE).source}function Wl(t,e){if(!t)return null;return t.map(((t,n)=>e[n]||(0,m.el)(t)))}function Xl(t,e,n){const i=[],r=t=>t(l);let o,s,a,l,u,c;if(e==null){i.push(t.map(n))}else{for(o={},s=0,a=t.length;s<a;++s){l=t[s];u=e.map(r);c=o[u];if(!c){o[u]=c=[];c.dims=u;i.push(c)}c.push(n(l))}}return i}const Hl="bin";function Bl(t){Us.call(this,null,t)}Bl.Definition={type:"DotBin",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:false},{name:"as",type:"string",default:Hl}]};const Yl=(t,e)=>(0,m.yP)((0,m.We)(t,e))/30;(0,m.XW)(Bl,Us,{transform(t,e){if(this.value&&!(t.modified()||e.changed())){return e}const n=e.materialize(e.SOURCE).source,i=Xl(e.source,t.groupby,m.yR),r=t.smooth||false,o=t.field,s=t.step||Yl(n,o),a=To(((t,e)=>o(t)-o(e))),l=t.as||Hl,u=i.length;let c=Infinity,f=-Infinity,h=0,d;for(;h<u;++h){const t=i[h].sort(a);d=-1;for(const e of ca(t,s,r,o)){if(e<c)c=e;if(e>f)f=e;t[++d][l]=e}}this.value={start:c,stop:f,step:s};return e.reflow(true).modifies(l)}});function Jl(t){Po.call(this,null,Gl,t);this.modified(true)}(0,m.XW)(Jl,Po);function Gl(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:(0,m.ZE)((n=>e(n,t)),(0,m.Oj)(e),(0,m.el)(e))}function Vl(t){Us.call(this,[undefined,undefined],t)}Vl.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:true}]};(0,m.XW)(Vl,Us,{transform(t,e){const n=this.value,i=t.field,r=e.changed()||e.modified(i.fields)||t.modified("field");let o=n[0],s=n[1];if(r||o==null){o=+Infinity;s=-Infinity}e.visit(r?e.SOURCE:e.ADD,(t=>{const e=(0,m.He)(i(t));if(e!=null){if(e<o)o=e;if(e>s)s=e}}));if(!Number.isFinite(o)||!Number.isFinite(s)){let t=(0,m.el)(i);if(t)t=` for field "${t}"`;e.dataflow.warn(`Infinite extent${t}: [${o}, ${s}]`);o=s=undefined}this.value=[o,s]}});function Kl(t,e){Po.call(this,t);this.parent=e;this.count=0}(0,m.XW)(Kl,Po,{connect(t){this.detachSubflow=t.detachSubflow;this.targets().add(t);return t.source=this},add(t){this.count+=1;this.value.add.push(t)},rem(t){this.count-=1;this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}});function Zl(t){Us.call(this,{},t);this._keys=(0,m.Xr)();const e=this._targets=[];e.active=0;e.forEach=t=>{for(let n=0,i=e.active;n<i;++n){t(e[n],n,e)}}}(0,m.XW)(Zl,Us,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,i){const r=this.value;let o=(0,m.nr)(r,t)&&r[t],s,a;if(!o){a=i||(a=this._group[t])&&a.tuple;s=n.dataflow;o=new Kl(n.fork(n.NO_SOURCE),this);s.add(o).connect(e(s,t,a));r[t]=o;this.activate(o)}else if(o.value.stamp<n.stamp){o.init(n);this.activate(o)}return o},clean(){const t=this.value;let e=0;for(const n in t){if(t[n].count===0){const i=t[n].detachSubflow;if(i)i();delete t[n];++e}}if(e){const t=this._targets.filter((t=>t&&t.count>0));this.initTargets(t)}},initTargets(t){const e=this._targets,n=e.length,i=t?t.length:0;let r=0;for(;r<i;++r){e[r]=t[r]}for(;r<n&&e[r]!=null;++r){e[r]=null}e.active=i},transform(t,e){const n=e.dataflow,i=t.key,r=t.subflow,o=this._keys,s=t.modified("key"),a=t=>this.subflow(t,r,e);this._group=t.group||{};this.initTargets();e.visit(e.REM,(t=>{const e=bo(t),n=o.get(e);if(n!==undefined){o.delete(e);a(n).rem(t)}}));e.visit(e.ADD,(t=>{const e=i(t);o.set(bo(t),e);a(e).add(t)}));if(s||e.modified(i.fields)){e.visit(e.MOD,(t=>{const e=bo(t),n=o.get(e),r=i(t);if(n===r){a(r).mod(t)}else{o.set(e,r);a(n).rem(t);a(r).add(t)}}))}else if(e.changed(e.MOD)){e.visit(e.MOD,(t=>{a(o.get(bo(t))).mod(t)}))}if(s){e.visit(e.REFLOW,(t=>{const e=bo(t),n=o.get(e),r=i(t);if(n!==r){o.set(e,r);a(n).rem(t);a(r).add(t)}}))}if(e.clean()){n.runAfter((()=>{this.clean();o.clean()}))}else if(o.empty>n.cleanThreshold){n.runAfter(o.clean)}return e}});function Ql(t){Po.call(this,null,tu,t)}(0,m.XW)(Ql,Po);function tu(t){return this.value&&!t.modified()?this.value:(0,m.kJ)(t.name)?(0,m.IX)(t.name).map((t=>(0,m.EP)(t))):(0,m.EP)(t.name,t.as)}function eu(t){Us.call(this,(0,m.Xr)(),t)}eu.Definition={type:"Filter",metadata:{changes:true},params:[{name:"expr",type:"expr",required:true}]};(0,m.XW)(eu,Us,{transform(t,e){const n=e.dataflow,i=this.value,r=e.fork(),o=r.add,s=r.rem,a=r.mod,l=t.expr;let u=true;e.visit(e.REM,(t=>{const e=bo(t);if(!i.has(e))s.push(t);else i.delete(e)}));e.visit(e.ADD,(e=>{if(l(e,t))o.push(e);else i.set(bo(e),1)}));function c(e){const n=bo(e),r=l(e,t),c=i.get(n);if(r&&c){i.delete(n);o.push(e)}else if(!r&&!c){i.set(n,1);s.push(e)}else if(u&&r&&!c){a.push(e)}}e.visit(e.MOD,c);if(t.modified()){u=false;e.visit(e.REFLOW,c)}if(i.empty>n.cleanThreshold)n.runAfter(i.clean);return r}});function nu(t){Us.call(this,[],t)}nu.Definition={type:"Flatten",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"index",type:"string"},{name:"as",type:"string",array:true}]};(0,m.XW)(nu,Us,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.fields,r=Wl(i,t.as||[]),o=t.index||null,s=r.length;n.rem=this.value;e.visit(e.SOURCE,(t=>{const e=i.map((e=>e(t))),a=e.reduce(((t,e)=>Math.max(t,e.length)),0);let l=0,u,c,f;for(;l<a;++l){c=Mo(t);for(u=0;u<s;++u){c[r[u]]=(f=e[u][l])==null?null:f}if(o){c[o]=l}n.add.push(c)}}));this.value=n.source=n.add;if(o)n.modifies(o);return n.modifies(r)}});function iu(t){Us.call(this,[],t)}iu.Definition={type:"Fold",metadata:{generates:true},params:[{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true,length:2,default:["key","value"]}]};(0,m.XW)(iu,Us,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.fields,r=i.map(m.el),o=t.as||["key","value"],s=o[0],a=o[1],l=i.length;n.rem=this.value;e.visit(e.SOURCE,(t=>{for(let e=0,o;e<l;++e){o=Mo(t);o[s]=r[e];o[a]=i[e](t);n.add.push(o)}}));this.value=n.source=n.add;return n.modifies(o)}});function ru(t){Us.call(this,null,t)}ru.Definition={type:"Formula",metadata:{modifies:true},params:[{name:"expr",type:"expr",required:true},{name:"as",type:"string",required:true},{name:"initonly",type:"boolean"}]};(0,m.XW)(ru,Us,{transform(t,e){const n=t.expr,i=t.as,r=t.modified(),o=t.initonly?e.ADD:r?e.SOURCE:e.modified(n.fields)||e.modified(i)?e.ADD_MOD:e.ADD;if(r){e=e.materialize().reflow(true)}if(!t.initonly){e.modifies(i)}return e.visit(o,(e=>e[i]=n(e,t)))}});function ou(t){Us.call(this,[],t)}(0,m.XW)(ou,Us,{transform(t,e){const n=e.fork(e.ALL),i=t.generator;let r=this.value,o=t.size-r.length,s,a,l;if(o>0){for(s=[];--o>=0;){s.push(l=ko(i(t)));r.push(l)}n.add=n.add.length?n.materialize(n.ADD).add.concat(s):s}else{a=r.slice(0,-o);n.rem=n.rem.length?n.materialize(n.REM).rem.concat(a):a;r=r.slice(-o)}n.source=this.value=r;return n}});const su={value:"value",median:ta,mean:il,min:Fs,max:Ls};const au=[];function lu(t){Us.call(this,[],t)}lu.Definition={type:"Impute",metadata:{changes:true},params:[{name:"field",type:"field",required:true},{name:"key",type:"field",required:true},{name:"keyvals",array:true},{name:"groupby",type:"field",array:true},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function uu(t){var e=t.method||su.value,n;if(su[e]==null){(0,m.vU)("Unrecognized imputation method: "+e)}else if(e===su.value){n=t.value!==undefined?t.value:0;return()=>n}else{return su[e]}}function cu(t){const e=t.field;return t=>t?e(t):NaN}(0,m.XW)(lu,Us,{transform(t,e){var n=e.fork(e.ALL),i=uu(t),r=cu(t),o=(0,m.el)(t.field),s=(0,m.el)(t.key),a=(t.groupby||[]).map(m.el),l=fu(e.source,t.groupby,t.key,t.keyvals),u=[],c=this.value,f=l.domain.length,h,d,p,g,y,v,_,x,b,w;for(y=0,x=l.length;y<x;++y){h=l[y];p=h.values;d=NaN;for(_=0;_<f;++_){if(h[_]!=null)continue;g=l.domain[_];w={_impute:true};for(v=0,b=p.length;v<b;++v)w[a[v]]=p[v];w[s]=g;w[o]=Number.isNaN(d)?d=i(h,r):d;u.push(ko(w))}}if(u.length)n.add=n.materialize(n.ADD).add.concat(u);if(c.length)n.rem=n.materialize(n.REM).rem.concat(c);this.value=u;return n}});function fu(t,e,n,i){var r=t=>t(g),o=[],s=i?i.slice():[],a={},l={},u,c,f,h,d,p,m,g;s.forEach(((t,e)=>a[t]=e+1));for(h=0,m=t.length;h<m;++h){g=t[h];p=n(g);d=a[p]||(a[p]=s.push(p));c=(u=e?e.map(r):au)+"";if(!(f=l[c])){f=l[c]=[];o.push(f);f.values=u}f[d-1]=g}o.domain=s;return o}function hu(t){kl.call(this,t)}hu.Definition={type:"JoinAggregate",metadata:{modifies:true},params:[{name:"groupby",type:"field",array:true},{name:"fields",type:"field",null:true,array:true},{name:"ops",type:"enum",array:true,values:fl},{name:"as",type:"string",null:true,array:true},{name:"key",type:"field"}]};(0,m.XW)(hu,kl,{transform(t,e){const n=this,i=t.modified();let r;if(n.value&&(i||e.modified(n._inputs,true))){r=n.value=i?n.init(t):{};e.visit(e.SOURCE,(t=>n.add(t)))}else{r=n.value=n.value||this.init(t);e.visit(e.REM,(t=>n.rem(t)));e.visit(e.ADD,(t=>n.add(t)))}n.changes();e.visit(e.SOURCE,(t=>{(0,m.l7)(t,r[n.cellkey(t)].tuple)}));return e.reflow(i).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n){this.celltuple(t[n]);t[n]=null}for(n=0,i=this._mlen;n<i;++n){this.celltuple(e[n]);e[n]=null}this._alen=this._mlen=0}});function du(t){Us.call(this,null,t)}du.Definition={type:"KDE",metadata:{generates:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"cumulative",type:"boolean",default:false},{name:"counts",type:"boolean",default:false},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:true,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:true,default:["value","density"]}]};(0,m.XW)(du,Us,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=e.materialize(e.SOURCE).source,r=Xl(i,t.groupby,t.field),o=(t.groupby||[]).map(m.el),s=t.bandwidth,a=t.cumulative?"cdf":"pdf",l=t.as||["value","density"],u=[];let c=t.extent,f=t.steps||t.minsteps||25,h=t.steps||t.maxsteps||200;if(a!=="pdf"&&a!=="cdf"){(0,m.vU)("Invalid density method: "+a)}if(t.resolve==="shared"){if(!c)c=(0,m.We)(i,t.field);f=h=t.steps||h}r.forEach((e=>{const n=ka(e,s)[a],i=t.counts?e.length:1,r=c||(0,m.We)(e);tl(n,r,f,h).forEach((t=>{const n={};for(let i=0;i<o.length;++i){n[o[i]]=e.dims[i]}n[l[0]]=t[0];n[l[1]]=t[1]*i;u.push(ko(n))}))}));if(this.value)n.rem=this.value;this.value=n.add=n.source=u}return n}});function pu(t){Po.call(this,null,mu,t)}(0,m.XW)(pu,Po);function mu(t){return this.value&&!t.modified()?this.value:(0,m.Jy)(t.fields,t.flat)}function gu(t){Us.call(this,[],t);this._pending=null}(0,m.XW)(gu,Us,{transform(t,e){const n=e.dataflow;if(this._pending){return vu(this,e,this._pending)}if(yu(t))return e.StopPropagation;if(t.values){return vu(this,e,n.parse(t.values,t.format))}else if(t.async){const e=n.request(t.url,t.format).then((t=>{this._pending=(0,m.IX)(t.data);return t=>t.touch(this)}));return{async:e}}else{return n.request(t.url,t.format).then((t=>vu(this,e,(0,m.IX)(t.data))))}}});function yu(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}function vu(t,e,n){n.forEach(ko);const i=e.fork(e.NO_FIELDS&e.NO_SOURCE);i.rem=t.value;t.value=i.source=i.add=n;t._pending=null;if(i.rem.length)i.clean(true);return i}function _u(t){Us.call(this,{},t)}_u.Definition={type:"Lookup",metadata:{modifies:true},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:true},{name:"key",type:"field",required:true}]},{name:"values",type:"field",array:true},{name:"fields",type:"field",array:true,required:true},{name:"as",type:"string",array:true},{name:"default",default:null}]};(0,m.XW)(_u,Us,{transform(t,e){const n=t.fields,i=t.index,r=t.values,o=t.default==null?null:t.default,s=t.modified(),a=n.length;let l=s?e.SOURCE:e.ADD,u=e,c=t.as,f,h,d;if(r){h=r.length;if(a>1&&!c){(0,m.vU)('Multi-field lookup requires explicit "as" parameter.')}if(c&&c.length!==a*h){(0,m.vU)('The "as" parameter has too few output field names.')}c=c||r.map(m.el);f=function(t){for(var e=0,s=0,l,u;e<a;++e){u=i.get(n[e](t));if(u==null)for(l=0;l<h;++l,++s)t[c[s]]=o;else for(l=0;l<h;++l,++s)t[c[s]]=r[l](u)}}}else{if(!c){(0,m.vU)("Missing output field names.")}f=function(t){for(var e=0,r;e<a;++e){r=i.get(n[e](t));t[c[e]]=r==null?o:r}}}if(s){u=e.reflow(true)}else{d=n.some((t=>e.modified(t.fields)));l|=d?e.MOD:0}e.visit(l,f);return u.modifies(c)}});function xu(t){Po.call(this,null,bu,t)}(0,m.XW)(xu,Po);function bu(t){if(this.value&&!t.modified()){return this.value}const e=t.extents,n=e.length;let i=+Infinity,r=-Infinity,o,s;for(o=0;o<n;++o){s=e[o];if(s[0]<i)i=s[0];if(s[1]>r)r=s[1]}return[i,r]}function wu(t){Po.call(this,null,ku,t)}(0,m.XW)(wu,Po);function ku(t){return this.value&&!t.modified()?this.value:t.values.reduce(((t,e)=>t.concat(e)),[])}function Mu(t){Us.call(this,null,t)}(0,m.XW)(Mu,Us,{transform(t,e){this.modified(t.modified());this.value=t;return e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function Su(t){kl.call(this,t)}Su.Definition={type:"Pivot",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"value",type:"field",required:true},{name:"op",type:"enum",values:fl,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};(0,m.XW)(Su,kl,{_transform:kl.prototype.transform,transform(t,e){return this._transform(Eu(t,e),e)}});function Eu(t,e){const n=t.field,i=t.value,r=(t.op==="count"?"__count__":t.op)||"sum",o=(0,m.Oj)(n).concat((0,m.Oj)(i)),s=$u(n,t.limit||0,e);if(e.changed())t.set("__pivot__",null,null,true);return{key:t.key,groupby:t.groupby,ops:s.map((()=>r)),fields:s.map((t=>Tu(t,n,i,o))),as:s.map((t=>t+"")),modified:t.modified.bind(t)}}function Tu(t,e,n,i){return(0,m.ZE)((i=>e(i)===t?n(i):NaN),i,t+"")}function $u(t,e,n){const i={},r=[];n.visit(n.SOURCE,(e=>{const n=t(e);if(!i[n]){i[n]=1;r.push(n)}}));r.sort(m.j2);return e?r.slice(0,e):r}function Du(t){Zl.call(this,t)}(0,m.XW)(Du,Zl,{transform(t,e){const n=t.subflow,i=t.field,r=t=>this.subflow(bo(t),n,e,t);if(t.modified("field")||i&&e.modified((0,m.Oj)(i))){(0,m.vU)("PreFacet does not support field modification.")}this.initTargets();if(i){e.visit(e.MOD,(t=>{const e=r(t);i(t).forEach((t=>e.mod(t)))}));e.visit(e.ADD,(t=>{const e=r(t);i(t).forEach((t=>e.add(ko(t))))}));e.visit(e.REM,(t=>{const e=r(t);i(t).forEach((t=>e.rem(t)))}))}else{e.visit(e.MOD,(t=>r(t).mod(t)));e.visit(e.ADD,(t=>r(t).add(t)));e.visit(e.REM,(t=>r(t).rem(t)))}if(e.clean()){e.runAfter((()=>this.clean()))}return e}});function Au(t){Us.call(this,null,t)}Au.Definition={type:"Project",metadata:{generates:true,changes:true},params:[{name:"fields",type:"field",array:true},{name:"as",type:"string",null:true,array:true}]};(0,m.XW)(Au,Us,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.fields,r=Wl(t.fields,t.as||[]),o=i?(t,e)=>Nu(t,e,i,r):So;let s;if(this.value){s=this.value}else{e=e.addAll();s=this.value={}}e.visit(e.REM,(t=>{const e=bo(t);n.rem.push(s[e]);s[e]=null}));e.visit(e.ADD,(t=>{const e=o(t,ko({}));s[bo(t)]=e;n.add.push(e)}));e.visit(e.MOD,(t=>{n.mod.push(o(t,s[bo(t)]))}));return n}});function Nu(t,e,n,i){for(let r=0,o=n.length;r<o;++r){e[i[r]]=n[r](t)}return e}function zu(t){Us.call(this,null,t)}(0,m.XW)(zu,Us,{transform(t,e){this.value=t.value;return t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});function Ru(t){Us.call(this,null,t)}Ru.Definition={type:"Quantile",metadata:{generates:true,changes:true},params:[{name:"groupby",type:"field",array:true},{name:"field",type:"field",required:true},{name:"probs",type:"number",array:true},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:true,default:["prob","value"]}]};const Cu=1e-14;(0,m.XW)(Ru,Us,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed()){n.source=this.value;return n}const r=e.materialize(e.SOURCE).source,o=Xl(r,t.groupby,t.field),s=(t.groupby||[]).map(m.el),a=[],l=t.step||.01,u=t.probs||rl(l/2,1-Cu,l),c=u.length;o.forEach((t=>{const e=ia(t,u);for(let n=0;n<c;++n){const r={};for(let e=0;e<s.length;++e){r[s[e]]=t.dims[e]}r[i[0]]=u[n];r[i[1]]=e[n];a.push(ko(r))}}));if(this.value)n.rem=this.value;this.value=n.add=n.source=a;return n}});function Ou(t){Us.call(this,null,t)}(0,m.XW)(Ou,Us,{transform(t,e){let n,i;if(this.value){i=this.value}else{n=e=e.addAll();i=this.value={}}if(t.derive){n=e.fork(e.NO_SOURCE);e.visit(e.REM,(t=>{const e=bo(t);n.rem.push(i[e]);i[e]=null}));e.visit(e.ADD,(t=>{const e=Mo(t);i[bo(t)]=e;n.add.push(e)}));e.visit(e.MOD,(t=>{const e=i[bo(t)];for(const i in t){e[i]=t[i];n.modifies(i)}n.mod.push(e)}))}return n}});function Uu(t){Us.call(this,[],t);this.count=0}Uu.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};(0,m.XW)(Uu,Us,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.modified("size"),r=t.size,o=this.value.reduce(((t,e)=>(t[bo(e)]=1,t)),{});let s=this.value,a=this.count,l=0;function u(t){let e,i;if(s.length<r){s.push(t)}else{i=~~((a+1)*aa());if(i<s.length&&i>=l){e=s[i];if(o[bo(e)])n.rem.push(e);s[i]=t}}++a}if(e.rem.length){e.visit(e.REM,(t=>{const e=bo(t);if(o[e]){o[e]=-1;n.rem.push(t)}--a}));s=s.filter((t=>o[bo(t)]!==-1))}if((e.rem.length||i)&&s.length<r&&e.source){l=a=s.length;e.visit(e.SOURCE,(t=>{if(!o[bo(t)])u(t)}));l=-1}if(i&&s.length>r){const t=s.length-r;for(let e=0;e<t;++e){o[bo(s[e])]=-1;n.rem.push(s[e])}s=s.slice(t)}if(e.mod.length){e.visit(e.MOD,(t=>{if(o[bo(t)])n.mod.push(t)}))}if(e.add.length){e.visit(e.ADD,u)}if(e.add.length||l<0){n.add=s.filter((t=>!o[bo(t)]))}this.count=a;this.value=n.source=s;return n}});function Pu(t){Us.call(this,null,t)}Pu.Definition={type:"Sequence",metadata:{generates:true,changes:true},params:[{name:"start",type:"number",required:true},{name:"stop",type:"number",required:true},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};(0,m.XW)(Pu,Us,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),i=t.as||"data";n.rem=this.value?e.rem.concat(this.value):e.rem;this.value=rl(t.start,t.stop,t.step||1).map((t=>{const e={};e[i]=t;return ko(e)}));n.add=e.add.concat(this.value);return n}});function Iu(t){Us.call(this,null,t);this.modified(true)}(0,m.XW)(Iu,Us,{transform(t,e){this.value=e.source;return e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});function qu(t){Us.call(this,null,t)}const Lu=["unit0","unit1"];qu.Definition={type:"TimeUnit",metadata:{modifies:true},params:[{name:"field",type:"field",required:true},{name:"interval",type:"boolean",default:true},{name:"units",type:"enum",values:je,array:true},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:true},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:true,length:2,default:Lu}]};(0,m.XW)(qu,Us,{transform(t,e){const n=t.field,i=t.interval!==false,r=t.timezone==="utc",o=this._floor(t,e),s=(r?xn:_n)(o.unit).offset,a=t.as||Lu,l=a[0],u=a[1],c=o.step;let f=o.start||Infinity,h=o.stop||-Infinity,d=e.ADD;if(t.modified()||e.changed(e.REM)||e.modified((0,m.Oj)(n))){e=e.reflow(true);d=e.SOURCE;f=Infinity;h=-Infinity}e.visit(d,(t=>{const e=n(t);let r,a;if(e==null){t[l]=null;if(i)t[u]=null}else{t[l]=r=a=o(e);if(i)t[u]=a=s(r,c);if(r<f)f=r;if(a>h)h=a}}));o.start=f;o.stop=h;return e.modifies(i?a:l)},_floor(t,e){const n=t.timezone==="utc";const{units:i,step:r}=t.units?{units:t.units,step:t.step||1}:Wn({extent:t.extent||(0,m.We)(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins});const o=Xe(i),s=this.value||{},a=(n?gn:dn)(o,r);a.unit=(0,m.fj)(o);a.units=o;a.step=r;a.start=s.start;a.stop=s.stop;return this.value=a}});function Fu(t){Us.call(this,(0,m.Xr)(),t)}(0,m.XW)(Fu,Us,{transform(t,e){const n=e.dataflow,i=t.field,r=this.value,o=t=>r.set(i(t),t);let s=true;if(t.modified("field")||e.modified(i.fields)){r.clear();e.visit(e.SOURCE,o)}else if(e.changed()){e.visit(e.REM,(t=>r.delete(i(t))));e.visit(e.ADD,o)}else{s=false}this.modified(s);if(r.empty>n.cleanThreshold)n.runAfter(r.clean);return e.fork()}});function ju(t){Us.call(this,null,t)}(0,m.XW)(ju,Us,{transform(t,e){const n=!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields);if(n){this.value=(t.sort?e.source.slice().sort(To(t.sort)):e.source).map(t.field)}}});function Wu(t,e,n,i){const r=Xu[t](e,n);return{init:r.init||m.bM,update:function(t,e){e[i]=r.next(t)}}}const Xu={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,i=e.data;return n&&e.compare(i[n-1],i[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,i=e.data;return n&&e.compare(i[n-1],i[n])?++t:t}}},percent_rank:function(){const t=Xu.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,i=e.compare;let r=e.index;if(t<r){while(r+1<n.length&&!i(n[r],n[r+1]))++r;t=r}return(1+t)/n.length}}},ntile:function(t,e){e=+e;if(!(e>0))(0,m.vU)("ntile num must be greater than zero.");const n=Xu.cume_dist(),i=n.next;return{init:n.init,next:t=>Math.ceil(e*i(t))}},lag:function(t,e){e=+e||1;return{next:n=>{const i=n.index-e;return i>=0?t(n.data[i]):null}}},lead:function(t,e){e=+e||1;return{next:n=>{const i=n.index+e,r=n.data;return i<r.length?t(r[i]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){e=+e;if(!(e>0))(0,m.vU)("nth_value nth must be greater than zero.");return{next:n=>{const i=n.i0+(e-1);return i<n.i1?t(n.data[i]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const i=t(n.data[n.index]);return i!=null?e=i:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:i=>{const r=i.data;return i.index<=n?e:(n=Hu(t,r,i.index))<0?(n=r.length,e=null):e=t(r[n])}}}};function Hu(t,e,n){for(let i=e.length;n<i;++n){const i=t(e[n]);if(i!=null)return n}return-1}const Bu=Object.keys(Xu);function Yu(t){const e=(0,m.IX)(t.ops),n=(0,m.IX)(t.fields),i=(0,m.IX)(t.params),r=(0,m.IX)(t.as),o=this.outputs=[],s=this.windows=[],a={},l={},u=[],c=[];let f=true;function h(t){(0,m.IX)((0,m.Oj)(t)).forEach((t=>a[t]=1))}h(t.sort);e.forEach(((t,e)=>{const a=n[e],d=(0,m.el)(a),p=al(t,d,r[e]);h(a);o.push(p);if((0,m.nr)(Xu,t)){s.push(Wu(t,n[e],i[e],p))}else{if(a==null&&t!=="count"){(0,m.vU)("Null aggregate field specified.")}if(t==="count"){u.push(p);return}f=false;let e=l[d];if(!e){e=l[d]=[];e.field=a;c.push(e)}e.push(dl(t,p))}}));if(u.length||c.length){this.cell=Gu(c,u,f)}this.inputs=Object.keys(a)}const Ju=Yu.prototype;Ju.init=function(){this.windows.forEach((t=>t.init()));if(this.cell)this.cell.init()};Ju.update=function(t,e){const n=this.cell,i=this.windows,r=t.data,o=i&&i.length;let s;if(n){for(s=t.p0;s<t.i0;++s)n.rem(r[s]);for(s=t.p1;s<t.i1;++s)n.add(r[s]);n.set(e)}for(s=0;s<o;++s)i[s].update(t,e)};function Gu(t,e,n){t=t.map((t=>xl(t,t.field)));const i={num:0,agg:null,store:false,count:e};if(!n){var r=t.length,o=i.agg=Array(r),s=0;for(;s<r;++s)o[s]=new t[s](i)}if(i.store){var a=i.data=new bl}i.add=function(t){i.num+=1;if(n)return;if(a)a.add(t);for(let e=0;e<r;++e){o[e].add(o[e].get(t),t)}};i.rem=function(t){i.num-=1;if(n)return;if(a)a.rem(t);for(let e=0;e<r;++e){o[e].rem(o[e].get(t),t)}};i.set=function(t){let r,s;if(a)a.values();for(r=0,s=e.length;r<s;++r)t[e[r]]=i.num;if(!n)for(r=0,s=o.length;r<s;++r)o[r].set(t)};i.init=function(){i.num=0;if(a)a.reset();for(let t=0;t<r;++t)o[t].init()};return i}function Vu(t){Us.call(this,{},t);this._mlen=0;this._mods=[]}Vu.Definition={type:"Window",metadata:{modifies:true},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:true},{name:"ops",type:"enum",array:true,values:Bu.concat(fl)},{name:"params",type:"number",null:true,array:true},{name:"fields",type:"field",null:true,array:true},{name:"as",type:"string",null:true,array:true},{name:"frame",type:"number",null:true,array:true,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:false}]};(0,m.XW)(Vu,Us,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),i=To(t.sort),r=sl(t.groupby),o=t=>this.group(r(t));let s=this.state;if(!s||n){s=this.state=new Yu(t)}if(n||e.modified(s.inputs)){this.value={};e.visit(e.SOURCE,(t=>o(t).add(t)))}else{e.visit(e.REM,(t=>o(t).remove(t)));e.visit(e.ADD,(t=>o(t).add(t)))}for(let a=0,l=this._mlen;a<l;++a){Ku(this._mods[a],s,i,t)}this._mlen=0;this._mods=[];return e.reflow(n).modifies(s.outputs)},group(t){let e=this.value[t];if(!e){e=this.value[t]=El(bo);e.stamp=-1}if(e.stamp<this.stamp){e.stamp=this.stamp;this._mods[this._mlen++]=e}return e}});function Ku(t,e,n,i){const r=i.sort,o=r&&!i.ignorePeers,s=i.frame||[null,0],a=t.data(n),l=a.length,u=o?De(r):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:r||(0,m.a9)(-1)};e.init();for(let f=0;f<l;++f){Zu(c,s,f,l);if(o)Qu(c,u);e.update(c,a[f])}}function Zu(t,e,n,i){t.p0=t.i0;t.p1=t.i1;t.i0=e[0]==null?0:Math.max(0,n-Math.abs(e[0]));t.i1=e[1]==null?i:Math.min(i,n+Math.abs(e[1])+1);t.index=n}function Qu(t,e){const n=t.i0,i=t.i1-1,r=t.compare,o=t.data,s=o.length-1;if(n>0&&!r(o[n],o[n-1]))t.i0=e.left(o,o[n]);if(i<s&&!r(o[i],o[i+1]))t.i1=e.right(o,o[i])}function tc(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function ec(t){this._context=t}ec.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){switch(this._point){case 3:tc(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:tc(this,t,e);break}this._x0=this._x1,this._x1=t;this._y0=this._y1,this._y1=e}};function nc(t){return new ec(t)}function ic(){}function rc(t){this._context=t}rc.prototype={areaStart:ic,areaEnd:ic,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2);this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3);this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3);this._context.closePath();break}case 3:{this.point(this._x2,this._y2);this.point(this._x3,this._y3);this.point(this._x4,this._y4);break}}},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._x2=t,this._y2=e;break;case 1:this._point=2;this._x3=t,this._y3=e;break;case 2:this._point=3;this._x4=t,this._y4=e;this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:tc(this,t,e);break}this._x0=this._x1,this._x1=t;this._y0=this._y1,this._y1=e}};function oc(t){return new rc(t)}function sc(t){this._context=t}sc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:tc(this,t,e);break}this._x0=this._x1,this._x1=t;this._y0=this._y1,this._y1=e}};function ac(t){return new sc(t)}function lc(t,e){this._basis=new ec(t);this._beta=e}lc.prototype={lineStart:function(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0){var i=t[0],r=e[0],o=t[n]-i,s=e[n]-r,a=-1,l;while(++a<=n){l=a/n;this._basis.point(this._beta*t[a]+(1-this._beta)*(i+l*o),this._beta*e[a]+(1-this._beta)*(r+l*s))}}this._x=this._y=null;this._basis.lineEnd()},point:function(t,e){this._x.push(+t);this._y.push(+e)}};const uc=function t(e){function n(t){return e===1?new ec(t):new lc(t,e)}n.beta=function(e){return t(+e)};return n}(.85);function cc(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function fc(t,e){this._context=t;this._k=(1-e)/6}fc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:cc(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;this._x1=t,this._y1=e;break;case 2:this._point=3;default:cc(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const hc=function t(e){function n(t){return new fc(t,e)}n.tension=function(e){return t(+e)};return n}(0);function dc(t,e){this._context=t;this._k=(1-e)/6}dc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:cc(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const pc=function t(e){function n(t){return new dc(t,e)}n.tension=function(e){return t(+e)};return n}(0);function mc(t,e){this._context=t;this._k=(1-e)/6}mc.prototype={areaStart:ic,areaEnd:ic,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._x3=t,this._y3=e;break;case 1:this._point=2;this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3;this._x5=t,this._y5=e;break;default:cc(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const gc=function t(e){function n(t){return new mc(t,e)}n.tension=function(e){return t(+e)};return n}(0);const yc=Math.abs;const vc=Math.atan2;const _c=Math.cos;const xc=Math.max;const bc=Math.min;const wc=Math.sin;const kc=Math.sqrt;const Mc=1e-12;const Sc=Math.PI;const Ec=Sc/2;const Tc=2*Sc;function $c(t){return t>1?0:t<-1?Sc:Math.acos(t)}function Dc(t){return t>=1?Ec:t<=-1?-Ec:Math.asin(t)}function Ac(t,e,n){var i=t._x1,r=t._y1,o=t._x2,s=t._y2;if(t._l01_a>Mc){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/l;r=(r*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>Mc){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*u+t._x1*t._l23_2a-e*t._l12_2a)/c;s=(s*u+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(i,r,o,s,t._x2,t._y2)}function Nc(t,e){this._context=t;this._alpha=e}Nc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;if(this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Ac(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const zc=function t(e){function n(t){return e?new Nc(t,e):new fc(t,0)}n.alpha=function(e){return t(+e)};return n}(.5);function Rc(t,e){this._context=t;this._alpha=e}Rc.prototype={areaStart:ic,areaEnd:ic,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(t,e){t=+t,e=+e;if(this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=t,this._y3=e;break;case 1:this._point=2;this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3;this._x5=t,this._y5=e;break;default:Ac(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Cc=function t(e){function n(t){return e?new Rc(t,e):new mc(t,0)}n.alpha=function(e){return t(+e)};return n}(.5);function Oc(t,e){this._context=t;this._alpha=e}Oc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;if(this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ac(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=t;this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Uc=function t(e){function n(t){return e?new Oc(t,e):new dc(t,0)}n.alpha=function(e){return t(+e)};return n}(.5);function Pc(t){this._context=t}Pc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Ic(t){return new Pc(t)}function qc(t){this._context=t}qc.prototype={areaStart:ic,areaEnd:ic,lineStart:function(){this._point=0},lineEnd:function(){if(this._point)this._context.closePath()},point:function(t,e){t=+t,e=+e;if(this._point)this._context.lineTo(t,e);else this._point=1,this._context.moveTo(t,e)}};function Lc(t){return new qc(t)}function Fc(t){return t<0?-1:1}function jc(t,e,n){var i=t._x1-t._x0,r=e-t._x1,o=(t._y1-t._y0)/(i||r<0&&-0),s=(n-t._y1)/(r||i<0&&-0),a=(o*r+s*i)/(i+r);return(Fc(o)+Fc(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function Wc(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Xc(t,e,n){var i=t._x0,r=t._y0,o=t._x1,s=t._y1,a=(o-i)/3;t._context.bezierCurveTo(i+a,r+a*e,o-a,s-a*n,o,s)}function Hc(t){this._context=t}Hc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Xc(this,this._t0,Wc(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(t,e){var n=NaN;t=+t,e=+e;if(t===this._x1&&e===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;Xc(this,Wc(this,n=jc(this,t,e)),n);break;default:Xc(this,this._t0,n=jc(this,t,e));break}this._x0=this._x1,this._x1=t;this._y0=this._y1,this._y1=e;this._t0=n}};function Bc(t){this._context=new Yc(t)}(Bc.prototype=Object.create(Hc.prototype)).point=function(t,e){Hc.prototype.point.call(this,e,t)};function Yc(t){this._context=t}Yc.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,o){this._context.bezierCurveTo(e,t,i,n,o,r)}};function Jc(t){return new Hc(t)}function Gc(t){return new Bc(t)}function Vc(t){this._context=t}Vc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[];this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n){this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]);if(n===2){this._context.lineTo(t[1],e[1])}else{var i=Kc(t),r=Kc(e);for(var o=0,s=1;s<n;++o,++s){this._context.bezierCurveTo(i[0][o],r[0][o],i[1][o],r[1][o],t[s],e[s])}}}if(this._line||this._line!==0&&n===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function(t,e){this._x.push(+t);this._y.push(+e)}};function Kc(t){var e,n=t.length-1,i,r=new Array(n),o=new Array(n),s=new Array(n);r[0]=0,o[0]=2,s[0]=t[0]+2*t[1];for(e=1;e<n-1;++e)r[e]=1,o[e]=4,s[e]=4*t[e]+2*t[e+1];r[n-1]=2,o[n-1]=7,s[n-1]=8*t[n-1]+t[n];for(e=1;e<n;++e)i=r[e]/o[e-1],o[e]-=i,s[e]-=i*s[e-1];r[n-1]=s[n-1]/o[n-1];for(e=n-2;e>=0;--e)r[e]=(s[e]-r[e+1])/o[e];o[n-1]=(t[n]+r[n-1])/2;for(e=0;e<n-1;++e)o[e]=2*t[e+1]-r[e+1];return[r,o]}function Zc(t){return new Vc(t)}function Qc(t,e){this._context=t;this._t=e}Qc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN;this._point=0},lineEnd:function(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function(t,e){t=+t,e=+e;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,e);this._context.lineTo(t,e)}else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y);this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function tf(t){return new Qc(t,.5)}function ef(t){return new Qc(t,0)}function nf(t){return new Qc(t,1)}function rf(t){return function e(){return t}}const of=Math.PI,sf=2*of,af=1e-6,lf=sf-af;function uf(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e){this._+=arguments[e]+t[e]}}function cf(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return uf;const n=10**e;return function(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e){this._+=Math.round(arguments[e]*n)/n+t[e]}}}class ff{constructor(t){this._x0=this._y0=this._x1=this._y1=null;this._="";this._append=t==null?uf:cf(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._append`Z`}}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,i){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,e,n,i,r,o){this._append`C${+t},${+e},${+n},${+i},${this._x1=+r},${this._y1=+o}`}arcTo(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;if(r<0)throw new Error(`negative radius: ${r}`);let o=this._x1,s=this._y1,a=n-t,l=i-e,u=o-t,c=s-e,f=u*u+c*c;if(this._x1===null){this._append`M${this._x1=t},${this._y1=e}`}else if(!(f>af));else if(!(Math.abs(c*a-l*u)>af)||!r){this._append`L${this._x1=t},${this._y1=e}`}else{let h=n-o,d=i-s,p=a*a+l*l,m=h*h+d*d,g=Math.sqrt(p),y=Math.sqrt(f),v=r*Math.tan((of-Math.acos((p+f-m)/(2*g*y)))/2),_=v/y,x=v/g;if(Math.abs(_-1)>af){this._append`L${t+_*u},${e+_*c}`}this._append`A${r},${r},0,0,${+(c*h>u*d)},${this._x1=t+x*a},${this._y1=e+x*l}`}}arc(t,e,n,i,r,o){t=+t,e=+e,n=+n,o=!!o;if(n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(i),a=n*Math.sin(i),l=t+s,u=e+a,c=1^o,f=o?i-r:r-i;if(this._x1===null){this._append`M${l},${u}`}else if(Math.abs(this._x1-l)>af||Math.abs(this._y1-u)>af){this._append`L${l},${u}`}if(!n)return;if(f<0)f=f%sf+sf;if(f>lf){this._append`A${n},${n},0,1,${c},${t-s},${e-a}A${n},${n},0,1,${c},${this._x1=l},${this._y1=u}`}else if(f>af){this._append`A${n},${n},0,${+(f>=of)},${c},${this._x1=t+n*Math.cos(r)},${this._y1=e+n*Math.sin(r)}`}}rect(t,e,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function hf(){return new ff}hf.prototype=ff.prototype;function df(t=3){return new ff(+t)}function pf(t){let e=3;t.digits=function(n){if(!arguments.length)return e;if(n==null){e=null}else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return t};return()=>new ff(e)}function mf(t){return t.innerRadius}function gf(t){return t.outerRadius}function yf(t){return t.startAngle}function vf(t){return t.endAngle}function _f(t){return t&&t.padAngle}function xf(t,e,n,i,r,o,s,a){var l=n-t,u=i-e,c=s-r,f=a-o,h=f*l-c*u;if(h*h<Mc)return;h=(c*(e-o)-f*(t-r))/h;return[t+h*l,e+h*u]}function bf(t,e,n,i,r,o,s){var a=t-n,l=e-i,u=(s?o:-o)/kc(a*a+l*l),c=u*l,f=-u*a,h=t+c,d=e+f,p=n+c,m=i+f,g=(h+p)/2,y=(d+m)/2,v=p-h,_=m-d,x=v*v+_*_,b=r-o,w=h*m-p*d,k=(_<0?-1:1)*kc(xc(0,b*b*x-w*w)),M=(w*_-v*k)/x,S=(-w*v-_*k)/x,E=(w*_+v*k)/x,T=(-w*v+_*k)/x,$=M-g,D=S-y,A=E-g,N=T-y;if($*$+D*D>A*A+N*N)M=E,S=T;return{cx:M,cy:S,x01:-c,y01:-f,x11:M*(r/b-1),y11:S*(r/b-1)}}function wf(){var t=mf,e=gf,n=rf(0),i=null,r=yf,o=vf,s=_f,a=null,l=pf(u);function u(){var u,c,f=+t.apply(this,arguments),h=+e.apply(this,arguments),d=r.apply(this,arguments)-Ec,p=o.apply(this,arguments)-Ec,m=yc(p-d),g=p>d;if(!a)a=u=l();if(h<f)c=h,h=f,f=c;if(!(h>Mc))a.moveTo(0,0);else if(m>Tc-Mc){a.moveTo(h*_c(d),h*wc(d));a.arc(0,0,h,d,p,!g);if(f>Mc){a.moveTo(f*_c(p),f*wc(p));a.arc(0,0,f,p,d,g)}}else{var y=d,v=p,_=d,x=p,b=m,w=m,k=s.apply(this,arguments)/2,M=k>Mc&&(i?+i.apply(this,arguments):kc(f*f+h*h)),S=bc(yc(h-f)/2,+n.apply(this,arguments)),E=S,T=S,$,D;if(M>Mc){var A=Dc(M/f*wc(k)),N=Dc(M/h*wc(k));if((b-=A*2)>Mc)A*=g?1:-1,_+=A,x-=A;else b=0,_=x=(d+p)/2;if((w-=N*2)>Mc)N*=g?1:-1,y+=N,v-=N;else w=0,y=v=(d+p)/2}var z=h*_c(y),R=h*wc(y),C=f*_c(x),O=f*wc(x);if(S>Mc){var U=h*_c(v),P=h*wc(v),I=f*_c(_),q=f*wc(_),L;if(m<Sc){if(L=xf(z,R,I,q,U,P,C,O)){var F=z-L[0],j=R-L[1],W=U-L[0],X=P-L[1],H=1/wc($c((F*W+j*X)/(kc(F*F+j*j)*kc(W*W+X*X)))/2),B=kc(L[0]*L[0]+L[1]*L[1]);E=bc(S,(f-B)/(H-1));T=bc(S,(h-B)/(H+1))}else{E=T=0}}}if(!(w>Mc))a.moveTo(z,R);else if(T>Mc){$=bf(I,q,z,R,h,T,g);D=bf(U,P,C,O,h,T,g);a.moveTo($.cx+$.x01,$.cy+$.y01);if(T<S)a.arc($.cx,$.cy,T,vc($.y01,$.x01),vc(D.y01,D.x01),!g);else{a.arc($.cx,$.cy,T,vc($.y01,$.x01),vc($.y11,$.x11),!g);a.arc(0,0,h,vc($.cy+$.y11,$.cx+$.x11),vc(D.cy+D.y11,D.cx+D.x11),!g);a.arc(D.cx,D.cy,T,vc(D.y11,D.x11),vc(D.y01,D.x01),!g)}}else a.moveTo(z,R),a.arc(0,0,h,y,v,!g);if(!(f>Mc)||!(b>Mc))a.lineTo(C,O);else if(E>Mc){$=bf(C,O,U,P,f,-E,g);D=bf(z,R,I,q,f,-E,g);a.lineTo($.cx+$.x01,$.cy+$.y01);if(E<S)a.arc($.cx,$.cy,E,vc($.y01,$.x01),vc(D.y01,D.x01),!g);else{a.arc($.cx,$.cy,E,vc($.y01,$.x01),vc($.y11,$.x11),!g);a.arc(0,0,f,vc($.cy+$.y11,$.cx+$.x11),vc(D.cy+D.y11,D.cx+D.x11),g);a.arc(D.cx,D.cy,E,vc(D.y11,D.x11),vc(D.y01,D.x01),!g)}}else a.arc(0,0,f,x,_,g)}a.closePath();if(u)return a=null,u+""||null}u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,i=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-Sc/2;return[_c(i)*n,wc(i)*n]};u.innerRadius=function(e){return arguments.length?(t=typeof e==="function"?e:rf(+e),u):t};u.outerRadius=function(t){return arguments.length?(e=typeof t==="function"?t:rf(+t),u):e};u.cornerRadius=function(t){return arguments.length?(n=typeof t==="function"?t:rf(+t),u):n};u.padRadius=function(t){return arguments.length?(i=t==null?null:typeof t==="function"?t:rf(+t),u):i};u.startAngle=function(t){return arguments.length?(r=typeof t==="function"?t:rf(+t),u):r};u.endAngle=function(t){return arguments.length?(o=typeof t==="function"?t:rf(+t),u):o};u.padAngle=function(t){return arguments.length?(s=typeof t==="function"?t:rf(+t),u):s};u.context=function(t){return arguments.length?(a=t==null?null:t,u):a};return u}var kf=Array.prototype.slice;function Mf(t){return typeof t==="object"&&"length"in t?t:Array.from(t)}function Sf(t){return t[0]}function Ef(t){return t[1]}function Tf(t,e){var n=rf(true),i=null,r=Ic,o=null,s=pf(a);t=typeof t==="function"?t:t===undefined?Sf:rf(t);e=typeof e==="function"?e:e===undefined?Ef:rf(e);function a(a){var l,u=(a=Mf(a)).length,c,f=false,h;if(i==null)o=r(h=s());for(l=0;l<=u;++l){if(!(l<u&&n(c=a[l],l,a))===f){if(f=!f)o.lineStart();else o.lineEnd()}if(f)o.point(+t(c,l,a),+e(c,l,a))}if(h)return o=null,h+""||null}a.x=function(e){return arguments.length?(t=typeof e==="function"?e:rf(+e),a):t};a.y=function(t){return arguments.length?(e=typeof t==="function"?t:rf(+t),a):e};a.defined=function(t){return arguments.length?(n=typeof t==="function"?t:rf(!!t),a):n};a.curve=function(t){return arguments.length?(r=t,i!=null&&(o=r(i)),a):r};a.context=function(t){return arguments.length?(t==null?i=o=null:o=r(i=t),a):i};return a}function $f(t,e,n){var i=null,r=rf(true),o=null,s=Ic,a=null,l=pf(u);t=typeof t==="function"?t:t===undefined?Sf:rf(+t);e=typeof e==="function"?e:e===undefined?rf(0):rf(+e);n=typeof n==="function"?n:n===undefined?Ef:rf(+n);function u(u){var c,f,h,d=(u=Mf(u)).length,p,m=false,g,y=new Array(d),v=new Array(d);if(o==null)a=s(g=l());for(c=0;c<=d;++c){if(!(c<d&&r(p=u[c],c,u))===m){if(m=!m){f=c;a.areaStart();a.lineStart()}else{a.lineEnd();a.lineStart();for(h=c-1;h>=f;--h){a.point(y[h],v[h])}a.lineEnd();a.areaEnd()}}if(m){y[c]=+t(p,c,u),v[c]=+e(p,c,u);a.point(i?+i(p,c,u):y[c],n?+n(p,c,u):v[c])}}if(g)return a=null,g+""||null}function c(){return Tf().defined(r).curve(s).context(o)}u.x=function(e){return arguments.length?(t=typeof e==="function"?e:rf(+e),i=null,u):t};u.x0=function(e){return arguments.length?(t=typeof e==="function"?e:rf(+e),u):t};u.x1=function(t){return arguments.length?(i=t==null?null:typeof t==="function"?t:rf(+t),u):i};u.y=function(t){return arguments.length?(e=typeof t==="function"?t:rf(+t),n=null,u):e};u.y0=function(t){return arguments.length?(e=typeof t==="function"?t:rf(+t),u):e};u.y1=function(t){return arguments.length?(n=t==null?null:typeof t==="function"?t:rf(+t),u):n};u.lineX0=u.lineY0=function(){return c().x(t).y(e)};u.lineY1=function(){return c().x(t).y(n)};u.lineX1=function(){return c().x(i).y(e)};u.defined=function(t){return arguments.length?(r=typeof t==="function"?t:rf(!!t),u):r};u.curve=function(t){return arguments.length?(s=t,o!=null&&(a=s(o)),u):s};u.context=function(t){return arguments.length?(t==null?o=a=null:a=s(o=t),u):o};return u}const Df=kc(3);const Af={draw(t,e){const n=kc(e+bc(e/28,.75))*.59436;const i=n/2;const r=i*Df;t.moveTo(0,n);t.lineTo(0,-n);t.moveTo(-r,-i);t.lineTo(r,i);t.moveTo(-r,i);t.lineTo(r,-i)}};const Nf={draw(t,e){const n=kc(e/Sc);t.moveTo(n,0);t.arc(0,0,n,0,Tc)}};const zf={draw(t,e){const n=kc(e/5)/2;t.moveTo(-3*n,-n);t.lineTo(-n,-n);t.lineTo(-n,-3*n);t.lineTo(n,-3*n);t.lineTo(n,-n);t.lineTo(3*n,-n);t.lineTo(3*n,n);t.lineTo(n,n);t.lineTo(n,3*n);t.lineTo(-n,3*n);t.lineTo(-n,n);t.lineTo(-3*n,n);t.closePath()}};const Rf=kc(1/3);const Cf=Rf*2;const Of={draw(t,e){const n=kc(e/Cf);const i=n*Rf;t.moveTo(0,-n);t.lineTo(i,0);t.lineTo(0,n);t.lineTo(-i,0);t.closePath()}};const Uf={draw(t,e){const n=kc(e)*.62625;t.moveTo(0,-n);t.lineTo(n,0);t.lineTo(0,n);t.lineTo(-n,0);t.closePath()}};const Pf={draw(t,e){const n=kc(e-bc(e/7,2))*.87559;t.moveTo(-n,0);t.lineTo(n,0);t.moveTo(0,n);t.lineTo(0,-n)}};const If={draw(t,e){const n=kc(e);const i=-n/2;t.rect(i,i,n,n)}};const qf={draw(t,e){const n=kc(e)*.4431;t.moveTo(n,n);t.lineTo(n,-n);t.lineTo(-n,-n);t.lineTo(-n,n);t.closePath()}};const Lf=.8908130915292852;const Ff=wc(Sc/10)/wc(7*Sc/10);const jf=wc(Tc/10)*Ff;const Wf=-_c(Tc/10)*Ff;const Xf={draw(t,e){const n=kc(e*Lf);const i=jf*n;const r=Wf*n;t.moveTo(0,-n);t.lineTo(i,r);for(let o=1;o<5;++o){const e=Tc*o/5;const s=_c(e);const a=wc(e);t.lineTo(a*n,-s*n);t.lineTo(s*i-a*r,a*i+s*r)}t.closePath()}};const Hf=kc(3);const Bf={draw(t,e){const n=-kc(e/(Hf*3));t.moveTo(0,n*2);t.lineTo(-Hf*n,-n);t.lineTo(Hf*n,-n);t.closePath()}};const Yf=kc(3);const Jf={draw(t,e){const n=kc(e)*.6824;const i=n/2;const r=n*Yf/2;t.moveTo(0,-n);t.lineTo(r,i);t.lineTo(-r,i);t.closePath()}};const Gf=-.5;const Vf=kc(3)/2;const Kf=1/kc(12);const Zf=(Kf/2+1)*3;const Qf={draw(t,e){const n=kc(e/Zf);const i=n/2,r=n*Kf;const o=i,s=n*Kf+n;const a=-o,l=s;t.moveTo(i,r);t.lineTo(o,s);t.lineTo(a,l);t.lineTo(Gf*i-Vf*r,Vf*i+Gf*r);t.lineTo(Gf*o-Vf*s,Vf*o+Gf*s);t.lineTo(Gf*a-Vf*l,Vf*a+Gf*l);t.lineTo(Gf*i+Vf*r,Gf*r-Vf*i);t.lineTo(Gf*o+Vf*s,Gf*s-Vf*o);t.lineTo(Gf*a+Vf*l,Gf*l-Vf*a);t.closePath()}};const th={draw(t,e){const n=kc(e-bc(e/6,1.7))*.6189;t.moveTo(-n,-n);t.lineTo(n,n);t.moveTo(-n,n);t.lineTo(n,-n)}};const eh=[Nf,zf,Of,If,Xf,Bf,Qf];const nh=[Nf,Pf,th,Jf,Af,qf,Uf];function ih(t,e){let n=null,i=pf(r);t=typeof t==="function"?t:rf(t||Nf);e=typeof e==="function"?e:rf(e===undefined?64:+e);function r(){let r;if(!n)n=r=i();t.apply(this,arguments).draw(n,+e.apply(this,arguments));if(r)return n=null,r+""||null}r.type=function(e){return arguments.length?(t=typeof e==="function"?e:rf(e),r):t};r.size=function(t){return arguments.length?(e=typeof t==="function"?t:rf(+t),r):e};r.context=function(t){return arguments.length?(n=t==null?null:t,r):n};return r}function rh(t,e){if(typeof document!=="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext){n.width=t;n.height=e;return n}}return null}const oh=()=>typeof Image!=="undefined"?Image:null;const sh=De(Te);const ah=sh.right;const lh=sh.left;const uh=De(Ys).center;const ch=ah;function fh(t,e,n){t.prototype=e.prototype=n;n.constructor=t}function hh(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function dh(){}var ph=.7;var mh=1/ph;var gh="\\s*([+-]?\\d+)\\s*",yh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",vh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_h=/^#([0-9a-f]{3,8})$/,xh=new RegExp(`^rgb\\(${gh},${gh},${gh}\\)$`),bh=new RegExp(`^rgb\\(${vh},${vh},${vh}\\)$`),wh=new RegExp(`^rgba\\(${gh},${gh},${gh},${yh}\\)$`),kh=new RegExp(`^rgba\\(${vh},${vh},${vh},${yh}\\)$`),Mh=new RegExp(`^hsl\\(${yh},${vh},${vh}\\)$`),Sh=new RegExp(`^hsla\\(${yh},${vh},${vh},${yh}\\)$`);var Eh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};fh(dh,Nh,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Th,formatHex:Th,formatHex8:$h,formatHsl:Dh,formatRgb:Ah,toString:Ah});function Th(){return this.rgb().formatHex()}function $h(){return this.rgb().formatHex8()}function Dh(){return Xh(this).formatHsl()}function Ah(){return this.rgb().formatRgb()}function Nh(t){var e,n;t=(t+"").trim().toLowerCase();return(e=_h.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?zh(e):n===3?new Uh(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Rh(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Rh(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=xh.exec(t))?new Uh(e[1],e[2],e[3],1):(e=bh.exec(t))?new Uh(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=wh.exec(t))?Rh(e[1],e[2],e[3],e[4]):(e=kh.exec(t))?Rh(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Mh.exec(t))?Wh(e[1],e[2]/100,e[3]/100,1):(e=Sh.exec(t))?Wh(e[1],e[2]/100,e[3]/100,e[4]):Eh.hasOwnProperty(t)?zh(Eh[t]):t==="transparent"?new Uh(NaN,NaN,NaN,0):null}function zh(t){return new Uh(t>>16&255,t>>8&255,t&255,1)}function Rh(t,e,n,i){if(i<=0)t=e=n=NaN;return new Uh(t,e,n,i)}function Ch(t){if(!(t instanceof dh))t=Nh(t);if(!t)return new Uh;t=t.rgb();return new Uh(t.r,t.g,t.b,t.opacity)}function Oh(t,e,n,i){return arguments.length===1?Ch(t):new Uh(t,e,n,i==null?1:i)}function Uh(t,e,n,i){this.r=+t;this.g=+e;this.b=+n;this.opacity=+i}fh(Uh,Oh,hh(dh,{brighter(t){t=t==null?mh:Math.pow(mh,t);return new Uh(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){t=t==null?ph:Math.pow(ph,t);return new Uh(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Uh(Fh(this.r),Fh(this.g),Fh(this.b),Lh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&(-.5<=this.g&&this.g<255.5)&&(-.5<=this.b&&this.b<255.5)&&(0<=this.opacity&&this.opacity<=1)},hex:Ph,formatHex:Ph,formatHex8:Ih,formatRgb:qh,toString:qh}));function Ph(){return`#${jh(this.r)}${jh(this.g)}${jh(this.b)}`}function Ih(){return`#${jh(this.r)}${jh(this.g)}${jh(this.b)}${jh((isNaN(this.opacity)?1:this.opacity)*255)}`}function qh(){const t=Lh(this.opacity);return`${t===1?"rgb(":"rgba("}${Fh(this.r)}, ${Fh(this.g)}, ${Fh(this.b)}${t===1?")":`, ${t})`}`}function Lh(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Fh(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function jh(t){t=Fh(t);return(t<16?"0":"")+t.toString(16)}function Wh(t,e,n,i){if(i<=0)t=e=n=NaN;else if(n<=0||n>=1)t=e=NaN;else if(e<=0)t=NaN;return new Bh(t,e,n,i)}function Xh(t){if(t instanceof Bh)return new Bh(t.h,t.s,t.l,t.opacity);if(!(t instanceof dh))t=Nh(t);if(!t)return new Bh;if(t instanceof Bh)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),s=NaN,a=o-r,l=(o+r)/2;if(a){if(e===o)s=(n-i)/a+(n<i)*6;else if(n===o)s=(i-e)/a+2;else s=(e-n)/a+4;a/=l<.5?o+r:2-o-r;s*=60}else{a=l>0&&l<1?0:s}return new Bh(s,a,l,t.opacity)}function Hh(t,e,n,i){return arguments.length===1?Xh(t):new Bh(t,e,n,i==null?1:i)}function Bh(t,e,n,i){this.h=+t;this.s=+e;this.l=+n;this.opacity=+i}fh(Bh,Hh,hh(dh,{brighter(t){t=t==null?mh:Math.pow(mh,t);return new Bh(this.h,this.s,this.l*t,this.opacity)},darker(t){t=t==null?ph:Math.pow(ph,t);return new Bh(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Uh(Gh(t>=240?t-240:t+120,r,i),Gh(t,r,i),Gh(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Bh(Yh(this.h),Jh(this.s),Jh(this.l),Lh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&(0<=this.l&&this.l<=1)&&(0<=this.opacity&&this.opacity<=1)},formatHsl(){const t=Lh(this.opacity);return`${t===1?"hsl(":"hsla("}${Yh(this.h)}, ${Jh(this.s)*100}%, ${Jh(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Yh(t){t=(t||0)%360;return t<0?t+360:t}function Jh(t){return Math.max(0,Math.min(1,t||0))}function Gh(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Vh(t,e,n,i,r){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*i+s*r)/6}function Kh(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],o=t[i+1],s=i>0?t[i-1]:2*r-o,a=i<e-1?t[i+2]:2*o-r;return Vh((n-i/e)*e,s,r,o,a)}}function Zh(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],o=t[i%e],s=t[(i+1)%e],a=t[(i+2)%e];return Vh((n-i/e)*e,r,o,s,a)}}const Qh=t=>()=>t;function td(t,e){return function(n){return t+n*e}}function ed(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function nd(t,e){var n=e-t;return n?td(t,n>180||n<-180?n-360*Math.round(n/360):n):Qh(isNaN(t)?e:t)}function id(t){return(t=+t)===1?rd:function(e,n){return n-e?ed(e,n,t):Qh(isNaN(e)?n:e)}}function rd(t,e){var n=e-t;return n?td(t,n):Qh(isNaN(t)?e:t)}const od=function t(e){var n=id(e);function i(t,e){var i=n((t=Oh(t)).r,(e=Oh(e)).r),r=n(t.g,e.g),o=n(t.b,e.b),s=rd(t.opacity,e.opacity);return function(e){t.r=i(e);t.g=r(e);t.b=o(e);t.opacity=s(e);return t+""}}i.gamma=t;return i}(1);function sd(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),o=new Array(n),s,a;for(s=0;s<n;++s){a=Oh(e[s]);i[s]=a.r||0;r[s]=a.g||0;o[s]=a.b||0}i=t(i);r=t(r);o=t(o);a.opacity=1;return function(t){a.r=i(t);a.g=r(t);a.b=o(t);return a+""}}}var ad=sd(Kh);var ld=sd(Zh);function ud(t,e){if(!e)e=[];var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(o){for(r=0;r<n;++r)i[r]=t[r]*(1-o)+e[r]*o;return i}}function cd(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function fd(t,e){return(cd(e)?ud:hd)(t,e)}function hd(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),o=new Array(n),s;for(s=0;s<i;++s)r[s]=bd(t[s],e[s]);for(;s<n;++s)o[s]=e[s];return function(t){for(s=0;s<i;++s)o[s]=r[s](t);return o}}function dd(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function pd(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function md(t,e){var n={},i={},r;if(t===null||typeof t!=="object")t={};if(e===null||typeof e!=="object")e={};for(r in e){if(r in t){n[r]=bd(t[r],e[r])}else{i[r]=e[r]}}return function(t){for(r in n)i[r]=n[r](t);return i}}var gd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yd=new RegExp(gd.source,"g");function vd(t){return function(){return t}}function _d(t){return function(e){return t(e)+""}}function xd(t,e){var n=gd.lastIndex=yd.lastIndex=0,i,r,o,s=-1,a=[],l=[];t=t+"",e=e+"";while((i=gd.exec(t))&&(r=yd.exec(e))){if((o=r.index)>n){o=e.slice(n,o);if(a[s])a[s]+=o;else a[++s]=o}if((i=i[0])===(r=r[0])){if(a[s])a[s]+=r;else a[++s]=r}else{a[++s]=null;l.push({i:s,x:pd(i,r)})}n=yd.lastIndex}if(n<e.length){o=e.slice(n);if(a[s])a[s]+=o;else a[++s]=o}return a.length<2?l[0]?_d(l[0].x):vd(e):(e=l.length,function(t){for(var n=0,i;n<e;++n)a[(i=l[n]).i]=i.x(t);return a.join("")})}function bd(t,e){var n=typeof e,i;return e==null||n==="boolean"?Qh(e):(n==="number"?pd:n==="string"?(i=Nh(e))?(e=i,od):xd:e instanceof Nh?od:e instanceof Date?dd:cd(e)?ud:Array.isArray(e)?hd:typeof e.valueOf!=="function"&&typeof e.toString!=="function"||isNaN(e)?md:pd)(t,e)}function wd(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function kd(t){return function(){return t}}function Md(t){return+t}var Sd=[0,1];function Ed(t){return t}function Td(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:kd(isNaN(e)?NaN:.5)}function $d(t,e){var n;if(t>e)n=t,t=e,e=n;return function(n){return Math.max(t,Math.min(e,n))}}function Dd(t,e,n){var i=t[0],r=t[1],o=e[0],s=e[1];if(r<i)i=Td(r,i),o=n(s,o);else i=Td(i,r),o=n(o,s);return function(t){return o(i(t))}}function Ad(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),o=new Array(i),s=-1;if(t[i]<t[0]){t=t.slice().reverse();e=e.slice().reverse()}while(++s<i){r[s]=Td(t[s],t[s+1]);o[s]=n(e[s],e[s+1])}return function(e){var n=ch(t,e,1,i)-1;return o[n](r[n](e))}}function Nd(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function zd(){var t=Sd,e=Sd,n=bd,i,r,o,s=Ed,a,l,u;function c(){var n=Math.min(t.length,e.length);if(s!==Ed)s=$d(t[0],t[n-1]);a=n>2?Ad:Dd;l=u=null;return f}function f(r){return r==null||isNaN(r=+r)?o:(l||(l=a(t.map(i),e,n)))(i(s(r)))}f.invert=function(n){return s(r((u||(u=a(e,t.map(i),pd)))(n)))};f.domain=function(e){return arguments.length?(t=Array.from(e,Md),c()):t.slice()};f.range=function(t){return arguments.length?(e=Array.from(t),c()):e.slice()};f.rangeRound=function(t){return e=Array.from(t),n=wd,c()};f.clamp=function(t){return arguments.length?(s=t?true:Ed,c()):s!==Ed};f.interpolate=function(t){return arguments.length?(n=t,c()):n};f.unknown=function(t){return arguments.length?(o=t,f):o};return function(t,e){i=t,r=e;return c()}}function Rd(){return zd()(Ed,Ed)}function Cd(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Od(t,e){switch(arguments.length){case 0:break;case 1:{if(typeof t==="function")this.interpolator(t);else this.range(t);break}default:{this.domain(t);if(typeof e==="function")this.interpolator(e);else this.range(e);break}}return this}function Ud(t,e,n,i){var r=X(t,e,n),o;i=B(i==null?",f":i);switch(i.type){case"s":{var s=Math.max(Math.abs(t),Math.abs(e));if(i.precision==null&&!isNaN(o=K(r,s)))i.precision=o;return dt(i,s)}case"":case"e":case"g":case"p":case"r":{if(i.precision==null&&!isNaN(o=Z(r,Math.max(Math.abs(t),Math.abs(e)))))i.precision=o-(i.type==="e");break}case"f":case"%":{if(i.precision==null&&!isNaN(o=Q(r)))i.precision=o-(i.type==="%")*2;break}}return ht(i)}function Pd(t){var e=t.domain;t.ticks=function(t){var n=e();return j(n[0],n[n.length-1],t==null?10:t)};t.tickFormat=function(t,n){var i=e();return Ud(i[0],i[i.length-1],t==null?10:t,n)};t.nice=function(n){if(n==null)n=10;var i=e();var r=0;var o=i.length-1;var s=i[r];var a=i[o];var l;var u;var c=10;if(a<s){u=s,s=a,a=u;u=r,r=o,o=u}while(c-- >0){u=W(s,a,n);if(u===l){i[r]=s;i[o]=a;return e(i)}else if(u>0){s=Math.floor(s/u)*u;a=Math.ceil(a/u)*u}else if(u<0){s=Math.ceil(s*u)/u;a=Math.floor(a*u)/u}else{break}l=u}return t};return t}function Id(){var t=Rd();t.copy=function(){return Nd(t,Id())};Cd.apply(t,arguments);return Pd(t)}function qd(t){var e;function n(t){return t==null||isNaN(t=+t)?e:t}n.invert=n;n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,Md),n):t.slice()};n.unknown=function(t){return arguments.length?(e=t,n):e};n.copy=function(){return qd(t).unknown(e)};t=arguments.length?Array.from(t,Md):[0,1];return Pd(n)}function Ld(t,e){t=t.slice();var n=0,i=t.length-1,r=t[n],o=t[i],s;if(o<r){s=n,n=i,i=s;s=r,r=o,o=s}t[n]=e.floor(r);t[i]=e.ceil(o);return t}function Fd(t){return Math.log(t)}function jd(t){return Math.exp(t)}function Wd(t){return-Math.log(-t)}function Xd(t){return-Math.exp(-t)}function Hd(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Bd(t){return t===10?Hd:t===Math.E?Math.exp:e=>Math.pow(t,e)}function Yd(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Jd(t){return(e,n)=>-t(-e,n)}function Gd(t){const e=t(Fd,jd);const n=e.domain;let i=10;let r;let o;function s(){r=Yd(i),o=Bd(i);if(n()[0]<0){r=Jd(r),o=Jd(o);t(Wd,Xd)}else{t(Fd,jd)}return e}e.base=function(t){return arguments.length?(i=+t,s()):i};e.domain=function(t){return arguments.length?(n(t),s()):n()};e.ticks=t=>{const e=n();let s=e[0];let a=e[e.length-1];const l=a<s;if(l)[s,a]=[a,s];let u=r(s);let c=r(a);let f;let h;const d=t==null?10:+t;let p=[];if(!(i%1)&&c-u<d){u=Math.floor(u),c=Math.ceil(c);if(s>0)for(;u<=c;++u){for(f=1;f<i;++f){h=u<0?f/o(-u):f*o(u);if(h<s)continue;if(h>a)break;p.push(h)}}else for(;u<=c;++u){for(f=i-1;f>=1;--f){h=u>0?f/o(-u):f*o(u);if(h<s)continue;if(h>a)break;p.push(h)}}if(p.length*2<d)p=j(s,a,d)}else{p=j(u,c,Math.min(c-u,d)).map(o)}return l?p.reverse():p};e.tickFormat=(t,n)=>{if(t==null)t=10;if(n==null)n=i===10?"s":",";if(typeof n!=="function"){if(!(i%1)&&(n=B(n)).precision==null)n.trim=true;n=ht(n)}if(t===Infinity)return n;const s=Math.max(1,i*t/e.ticks().length);return t=>{let e=t/o(Math.round(r(t)));if(e*i<i-.5)e*=i;return e<=s?n(t):""}};e.nice=()=>n(Ld(n(),{floor:t=>o(Math.floor(r(t))),ceil:t=>o(Math.ceil(r(t)))}));return e}function Vd(){const t=Gd(zd()).domain([1,10]);t.copy=()=>Nd(t,Vd()).base(t.base());Cd.apply(t,arguments);return t}function Kd(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Zd(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Qd(t){return t<0?-t*t:t*t}function tp(t){var e=t(Ed,Ed),n=1;function i(){return n===1?t(Ed,Ed):n===.5?t(Zd,Qd):t(Kd(n),Kd(1/n))}e.exponent=function(t){return arguments.length?(n=+t,i()):n};return Pd(e)}function ep(){var t=tp(zd());t.copy=function(){return Nd(t,ep()).exponent(t.exponent())};Cd.apply(t,arguments);return t}function np(){return ep.apply(null,arguments).exponent(.5)}function ip(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function rp(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function op(t){var e=1,n=t(ip(e),rp(e));n.constant=function(n){return arguments.length?t(ip(e=+n),rp(e)):e};return Pd(n)}function sp(){var t=op(zd());t.copy=function(){return Nd(t,sp()).constant(t.constant())};return Cd.apply(t,arguments)}function ap(t,e,n,i,r,o){const s=[[ke,1,vt],[ke,5,5*vt],[ke,15,15*vt],[ke,30,30*vt],[o,1,_t],[o,5,5*_t],[o,15,15*_t],[o,30,30*_t],[r,1,xt],[r,3,3*xt],[r,6,6*xt],[r,12,12*xt],[i,1,bt],[i,2,2*bt],[n,1,wt],[e,1,kt],[e,3,3*kt],[t,1,Mt]];function a(t,e,n){const i=e<t;if(i)[t,e]=[e,t];const r=n&&typeof n.range==="function"?n:l(t,e,n);const o=r?r.range(t,+e+1):[];return i?o.reverse():o}function l(e,n,i){const r=Math.abs(n-e)/i;const o=De((([,,t])=>t)).right(s,r);if(o===s.length)return t.every(X(e/Mt,n/Mt,i));if(o===0)return Se.every(Math.max(X(e,n,i),1));const[a,l]=s[r/s[o-1][2]<s[o][2]/r?o-1:o];return a.every(l)}return[a,l]}const[lp,up]=ap(ue,de,Yt,Dt,ye,be);const[cp,fp]=ap(ae,fe,zt,St,me,_e);function hp(t){return new Date(t)}function dp(t){return t instanceof Date?+t:+new Date(+t)}function pp(t,e,n,i,r,o,s,a,l,u){var c=Rd(),f=c.invert,h=c.domain;var d=u(".%L"),p=u(":%S"),m=u("%I:%M"),g=u("%I %p"),y=u("%a %d"),v=u("%b %d"),_=u("%B"),x=u("%Y");function b(t){return(l(t)<t?d:a(t)<t?p:s(t)<t?m:o(t)<t?g:i(t)<t?r(t)<t?y:v:n(t)<t?_:x)(t)}c.invert=function(t){return new Date(f(t))};c.domain=function(t){return arguments.length?h(Array.from(t,dp)):h().map(hp)};c.ticks=function(e){var n=h();return t(n[0],n[n.length-1],e==null?10:e)};c.tickFormat=function(t,e){return e==null?b:u(e)};c.nice=function(t){var n=h();if(!t||typeof t.range!=="function")t=e(n[0],n[n.length-1],t==null?10:t);return t?h(Ld(n,t)):c};c.copy=function(){return Nd(c,pp(t,e,n,i,r,o,s,a,l,u))};return c}function mp(){return Cd.apply(pp(cp,fp,ae,fe,zt,St,me,_e,ke,hr).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function gp(){return Cd.apply(pp(lp,up,ue,de,Yt,Tt,ye,be,ke,pr).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function yp(){var t=0,e=1,n,i,r,o,s=Ed,a=false,l;function u(t){return t==null||isNaN(t=+t)?l:s(r===0?.5:(t=(o(t)-n)*r,a?Math.max(0,Math.min(1,t)):t))}u.domain=function(s){return arguments.length?([t,e]=s,n=o(t=+t),i=o(e=+e),r=n===i?0:1/(i-n),u):[t,e]};u.clamp=function(t){return arguments.length?(a=!!t,u):a};u.interpolator=function(t){return arguments.length?(s=t,u):s};function c(t){return function(e){var n,i;return arguments.length?([n,i]=e,s=t(n,i),u):[s(0),s(1)]}}u.range=c(bd);u.rangeRound=c(wd);u.unknown=function(t){return arguments.length?(l=t,u):l};return function(s){o=s,n=s(t),i=s(e),r=n===i?0:1/(i-n);return u}}function vp(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function _p(){var t=Pd(yp()(Ed));t.copy=function(){return vp(t,_p())};return Od.apply(t,arguments)}function xp(){var t=Gd(yp()).domain([1,10]);t.copy=function(){return vp(t,xp()).base(t.base())};return Od.apply(t,arguments)}function bp(){var t=op(yp());t.copy=function(){return vp(t,bp()).constant(t.constant())};return Od.apply(t,arguments)}function wp(){var t=tp(yp());t.copy=function(){return vp(t,wp()).exponent(t.exponent())};return Od.apply(t,arguments)}function kp(){return wp.apply(null,arguments).exponent(.5)}function Mp(t,e){if(e===undefined)e=t,t=bd;var n=0,i=e.length-1,r=e[0],o=new Array(i<0?0:i);while(n<i)o[n]=t(r,r=e[++n]);return function(t){var e=Math.max(0,Math.min(i-1,Math.floor(t*=i)));return o[e](t-e)}}function Sp(){var t=0,e=.5,n=1,i=1,r,o,s,a,l,u=Ed,c,f=false,h;function d(t){return isNaN(t=+t)?h:(t=.5+((t=+c(t))-o)*(i*t<i*o?a:l),u(f?Math.max(0,Math.min(1,t)):t))}d.domain=function(u){return arguments.length?([t,e,n]=u,r=c(t=+t),o=c(e=+e),s=c(n=+n),a=r===o?0:.5/(o-r),l=o===s?0:.5/(s-o),i=o<r?-1:1,d):[t,e,n]};d.clamp=function(t){return arguments.length?(f=!!t,d):f};d.interpolator=function(t){return arguments.length?(u=t,d):u};function p(t){return function(e){var n,i,r;return arguments.length?([n,i,r]=e,u=Mp(t,[n,i,r]),d):[u(0),u(.5),u(1)]}}d.range=p(bd);d.rangeRound=p(wd);d.unknown=function(t){return arguments.length?(h=t,d):h};return function(u){c=u,r=u(t),o=u(e),s=u(n),a=r===o?0:.5/(o-r),l=o===s?0:.5/(s-o),i=o<r?-1:1;return d}}function Ep(){var t=Pd(Sp()(Ed));t.copy=function(){return vp(t,Ep())};return Od.apply(t,arguments)}function Tp(){var t=Gd(Sp()).domain([.1,1,10]);t.copy=function(){return vp(t,Tp()).base(t.base())};return Od.apply(t,arguments)}function $p(){var t=op(Sp());t.copy=function(){return vp(t,$p()).constant(t.constant())};return Od.apply(t,arguments)}function Dp(){var t=tp(Sp());t.copy=function(){return vp(t,Dp()).exponent(t.exponent())};return Od.apply(t,arguments)}function Ap(){return Dp.apply(null,arguments).exponent(.5)}function Np(){var t=[],e=[],n=[],i;function r(){var i=0,r=Math.max(1,e.length);n=new Array(r-1);while(++i<r)n[i-1]=Vs(t,i/r);return o}function o(t){return t==null||isNaN(t=+t)?i:e[ch(n,t)]}o.invertExtent=function(i){var r=e.indexOf(i);return r<0?[NaN,NaN]:[r>0?n[r-1]:t[0],r<n.length?n[r]:t[t.length-1]]};o.domain=function(e){if(!arguments.length)return t.slice();t=[];for(let n of e)if(n!=null&&!isNaN(n=+n))t.push(n);t.sort(Te);return r()};o.range=function(t){return arguments.length?(e=Array.from(t),r()):e.slice()};o.unknown=function(t){return arguments.length?(i=t,o):i};o.quantiles=function(){return n.slice()};o.copy=function(){return Np().domain(t).range(e).unknown(i)};return Cd.apply(o,arguments)}function zp(){var t=0,e=1,n=1,i=[.5],r=[0,1],o;function s(t){return t!=null&&t<=t?r[ch(i,t,0,n)]:o}function a(){var r=-1;i=new Array(n);while(++r<n)i[r]=((r+1)*e-(r-n)*t)/(n+1);return s}s.domain=function(n){return arguments.length?([t,e]=n,t=+t,e=+e,a()):[t,e]};s.range=function(t){return arguments.length?(n=(r=Array.from(t)).length-1,a()):r.slice()};s.invertExtent=function(o){var s=r.indexOf(o);return s<0?[NaN,NaN]:s<1?[t,i[0]]:s>=n?[i[n-1],e]:[i[s-1],i[s]]};s.unknown=function(t){return arguments.length?(o=t,s):s};s.thresholds=function(){return i.slice()};s.copy=function(){return zp().domain([t,e]).range(r).unknown(o)};return Cd.apply(Pd(s),arguments)}function Rp(){var t=[.5],e=[0,1],n,i=1;function r(r){return r!=null&&r<=r?e[ch(t,r,0,i)]:n}r.domain=function(n){return arguments.length?(t=Array.from(n),i=Math.min(t.length,e.length-1),r):t.slice()};r.range=function(n){return arguments.length?(e=Array.from(n),i=Math.min(t.length,e.length-1),r):e.slice()};r.invertExtent=function(n){var i=e.indexOf(n);return[t[i-1],t[i]]};r.unknown=function(t){return arguments.length?(n=t,r):n};r.copy=function(){return Rp().domain(t).range(e).unknown(n)};return Cd.apply(r,arguments)}class Cp extends Map{constructor(t,e=qp){super();Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}});if(t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(Up(this,t))}has(t){return super.has(Up(this,t))}set(t,e){return super.set(Pp(this,t),e)}delete(t){return super.delete(Ip(this,t))}}class Op extends Set{constructor(t,e=qp){super();Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}});if(t!=null)for(const n of t)this.add(n)}has(t){return super.has(Up(this,t))}add(t){return super.add(Pp(this,t))}delete(t){return super.delete(Ip(this,t))}}function Up({_intern:t,_key:e},n){const i=e(n);return t.has(i)?t.get(i):n}function Pp({_intern:t,_key:e},n){const i=e(n);if(t.has(i))return t.get(i);t.set(i,n);return n}function Ip({_intern:t,_key:e},n){const i=e(n);if(t.has(i)){n=t.get(i);t.delete(i)}return n}function qp(t){return t!==null&&typeof t==="object"?t.valueOf():t}const Lp=Symbol("implicit");function Fp(){var t=new Cp,e=[],n=[],i=Lp;function r(r){let o=t.get(r);if(o===undefined){if(i!==Lp)return i;t.set(r,o=e.push(r)-1)}return n[o%n.length]}r.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Cp;for(const i of n){if(t.has(i))continue;t.set(i,e.push(i)-1)}return r};r.range=function(t){return arguments.length?(n=Array.from(t),r):n.slice()};r.unknown=function(t){return arguments.length?(i=t,r):i};r.copy=function(){return Fp(e,n).unknown(i)};Cd.apply(r,arguments);return r}function jp(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Wp(t,e){var n=nd(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}var Xp=180/Math.PI;var Hp={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Bp(t,e,n,i,r,o){var s,a,l;if(s=Math.sqrt(t*t+e*e))t/=s,e/=s;if(l=t*n+e*i)n-=t*l,i-=e*l;if(a=Math.sqrt(n*n+i*i))n/=a,i/=a,l/=a;if(t*i<e*n)t=-t,e=-e,l=-l,s=-s;return{translateX:r,translateY:o,rotate:Math.atan2(e,t)*Xp,skewX:Math.atan(l)*Xp,scaleX:s,scaleY:a}}var Yp;function Jp(t){const e=new(typeof DOMMatrix==="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Hp:Bp(e.a,e.b,e.c,e.d,e.e,e.f)}function Gp(t){if(t==null)return Hp;if(!Yp)Yp=document.createElementNS("http://www.w3.org/2000/svg","g");Yp.setAttribute("transform",t);if(!(t=Yp.transform.baseVal.consolidate()))return Hp;t=t.matrix;return Bp(t.a,t.b,t.c,t.d,t.e,t.f)}function Vp(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}function o(t,i,r,o,s,a){if(t!==r||i!==o){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:pd(t,r)},{i:l-2,x:pd(i,o)})}else if(r||o){s.push("translate("+r+e+o+n)}}function s(t,e,n,o){if(t!==e){if(t-e>180)e+=360;else if(e-t>180)t+=360;o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:pd(t,e)})}else if(e){n.push(r(n)+"rotate("+e+i)}}function a(t,e,n,o){if(t!==e){o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:pd(t,e)})}else if(e){n.push(r(n)+"skewX("+e+i)}}function l(t,e,n,i,o,s){if(t!==n||e!==i){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:pd(t,n)},{i:a-2,x:pd(e,i)})}else if(n!==1||i!==1){o.push(r(o)+"scale("+n+","+i+")")}}return function(e,n){var i=[],r=[];e=t(e),n=t(n);o(e.translateX,e.translateY,n.translateX,n.translateY,i,r);s(e.rotate,n.rotate,i,r);a(e.skewX,n.skewX,i,r);l(e.scaleX,e.scaleY,n.scaleX,n.scaleY,i,r);e=n=null;return function(t){var e=-1,n=r.length,o;while(++e<n)i[(o=r[e]).i]=o.x(t);return i.join("")}}}var Kp=Vp(Jp,"px, ","px)","deg)");var Zp=Vp(Gp,", ",")",")");var Qp=1e-12;function tm(t){return((t=Math.exp(t))+1/t)/2}function em(t){return((t=Math.exp(t))-1/t)/2}function nm(t){return((t=Math.exp(2*t))-1)/(t+1)}const im=function t(e,n,i){function r(t,r){var o=t[0],s=t[1],a=t[2],l=r[0],u=r[1],c=r[2],f=l-o,h=u-s,d=f*f+h*h,p,m;if(d<Qp){m=Math.log(c/a)/e;p=function(t){return[o+t*f,s+t*h,a*Math.exp(e*t*m)]}}else{var g=Math.sqrt(d),y=(c*c-a*a+i*d)/(2*a*n*g),v=(c*c-a*a-i*d)/(2*c*n*g),_=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);m=(x-_)/e;p=function(t){var i=t*m,r=tm(_),l=a/(n*g)*(r*nm(e*i+_)-em(_));return[o+l*f,s+l*h,a*r/tm(e*i+_)]}}p.duration=m*1e3*e/Math.SQRT2;return p}r.rho=function(e){var n=Math.max(.001,+e),i=n*n,r=i*i;return t(n,i,r)};return r}(Math.SQRT2,2,4);function rm(t){return function(e,n){var i=t((e=Hh(e)).h,(n=Hh(n)).h),r=rd(e.s,n.s),o=rd(e.l,n.l),s=rd(e.opacity,n.opacity);return function(t){e.h=i(t);e.s=r(t);e.l=o(t);e.opacity=s(t);return e+""}}}const om=rm(nd);var sm=rm(rd);const am=Math.PI/180;const lm=180/Math.PI;const um=18,cm=.96422,fm=1,hm=.82521,dm=4/29,pm=6/29,mm=3*pm*pm,gm=pm*pm*pm;function ym(t){if(t instanceof xm)return new xm(t.l,t.a,t.b,t.opacity);if(t instanceof $m)return Dm(t);if(!(t instanceof Uh))t=Ch(t);var e=Mm(t.r),n=Mm(t.g),i=Mm(t.b),r=bm((.2225045*e+.7168786*n+.0606169*i)/fm),o,s;if(e===n&&n===i)o=s=r;else{o=bm((.4360747*e+.3850649*n+.1430804*i)/cm);s=bm((.0139322*e+.0971045*n+.7141733*i)/hm)}return new xm(116*r-16,500*(o-r),200*(r-s),t.opacity)}function vm(t,e){return new xm(t,0,0,e==null?1:e)}function _m(t,e,n,i){return arguments.length===1?ym(t):new xm(t,e,n,i==null?1:i)}function xm(t,e,n,i){this.l=+t;this.a=+e;this.b=+n;this.opacity=+i}fh(xm,_m,hh(dh,{brighter(t){return new xm(this.l+um*(t==null?1:t),this.a,this.b,this.opacity)},darker(t){return new xm(this.l-um*(t==null?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;e=cm*wm(e);t=fm*wm(t);n=hm*wm(n);return new Uh(km(3.1338561*e-1.6168667*t-.4906146*n),km(-.9787684*e+1.9161415*t+.033454*n),km(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function bm(t){return t>gm?Math.pow(t,1/3):t/mm+dm}function wm(t){return t>pm?t*t*t:mm*(t-dm)}function km(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Mm(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Sm(t){if(t instanceof $m)return new $m(t.h,t.c,t.l,t.opacity);if(!(t instanceof xm))t=ym(t);if(t.a===0&&t.b===0)return new $m(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*lm;return new $m(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Em(t,e,n,i){return arguments.length===1?Sm(t):new $m(n,e,t,i==null?1:i)}function Tm(t,e,n,i){return arguments.length===1?Sm(t):new $m(t,e,n,i==null?1:i)}function $m(t,e,n,i){this.h=+t;this.c=+e;this.l=+n;this.opacity=+i}function Dm(t){if(isNaN(t.h))return new xm(t.l,0,0,t.opacity);var e=t.h*am;return new xm(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}fh($m,Tm,hh(dh,{brighter(t){return new $m(this.h,this.c,this.l+um*(t==null?1:t),this.opacity)},darker(t){return new $m(this.h,this.c,this.l-um*(t==null?1:t),this.opacity)},rgb(){return Dm(this).rgb()}}));function Am(t,e){var n=rd((t=_m(t)).l,(e=_m(e)).l),i=rd(t.a,e.a),r=rd(t.b,e.b),o=rd(t.opacity,e.opacity);return function(e){t.l=n(e);t.a=i(e);t.b=r(e);t.opacity=o(e);return t+""}}function Nm(t){return function(e,n){var i=t((e=Tm(e)).h,(n=Tm(n)).h),r=rd(e.c,n.c),o=rd(e.l,n.l),s=rd(e.opacity,n.opacity);return function(t){e.h=i(t);e.c=r(t);e.l=o(t);e.opacity=s(t);return e+""}}}const zm=Nm(nd);var Rm=Nm(rd);var Cm=-.14861,Om=+1.78277,Um=-.29227,Pm=-.90649,Im=+1.97294,qm=Im*Pm,Lm=Im*Om,Fm=Om*Um-Pm*Cm;function jm(t){if(t instanceof Xm)return new Xm(t.h,t.s,t.l,t.opacity);if(!(t instanceof Uh))t=Ch(t);var e=t.r/255,n=t.g/255,i=t.b/255,r=(Fm*i+qm*e-Lm*n)/(Fm+qm-Lm),o=i-r,s=(Im*(n-r)-Um*o)/Pm,a=Math.sqrt(s*s+o*o)/(Im*r*(1-r)),l=a?Math.atan2(s,o)*lm-120:NaN;return new Xm(l<0?l+360:l,a,r,t.opacity)}function Wm(t,e,n,i){return arguments.length===1?jm(t):new Xm(t,e,n,i==null?1:i)}function Xm(t,e,n,i){this.h=+t;this.s=+e;this.l=+n;this.opacity=+i}fh(Xm,Wm,hh(dh,{brighter(t){t=t==null?mh:Math.pow(mh,t);return new Xm(this.h,this.s,this.l*t,this.opacity)},darker(t){t=t==null?ph:Math.pow(ph,t);return new Xm(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*am,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),r=Math.sin(t);return new Uh(255*(e+n*(Cm*i+Om*r)),255*(e+n*(Um*i+Pm*r)),255*(e+n*(Im*i)),this.opacity)}}));function Hm(t){return function e(n){n=+n;function i(e,i){var r=t((e=Wm(e)).h,(i=Wm(i)).h),o=rd(e.s,i.s),s=rd(e.l,i.l),a=rd(e.opacity,i.opacity);return function(t){e.h=r(t);e.s=o(t);e.l=s(Math.pow(t,n));e.opacity=a(t);return e+""}}i.gamma=e;return i}(1)}const Bm=Hm(nd);var Ym=Hm(rd);function Jm(t,e){var n=new Array(e);for(var i=0;i<e;++i)n[i]=t(i/(e-1));return n}function Gm(t,e,n){const i=t-e+n*2;return t?i>0?i:1:0}const Vm="identity";const Km="linear";const Zm="log";const Qm="pow";const tg="sqrt";const eg="symlog";const ng="time";const ig="utc";const rg="sequential";const og="diverging";const sg="quantile";const ag="quantize";const lg="threshold";const ug="ordinal";const cg="point";const fg="band";const hg="bin-ordinal";const dg="continuous";const pg="discrete";const mg="discretizing";const gg="interpolating";const yg="temporal";function vg(t){return function(e){let n=e[0],i=e[1],r;if(i<n){r=n;n=i;i=r}return[t.invert(n),t.invert(i)]}}function _g(t){return function(e){const n=t.range();let i=e[0],r=e[1],o=-1,s,a,l,u;if(r<i){a=i;i=r;r=a}for(l=0,u=n.length;l<u;++l){if(n[l]>=i&&n[l]<=r){if(o<0)o=l;s=l}}if(o<0)return undefined;i=t.invertExtent(n[o]);r=t.invertExtent(n[s]);return[i[0]===undefined?i[1]:i[0],r[1]===undefined?r[0]:r[1]]}}function xg(){const t=Fp().unknown(undefined),e=t.domain,n=t.range;let i=[0,1],r,o,s=false,a=0,l=0,u=.5;delete t.unknown;function c(){const t=e().length,c=i[1]<i[0],f=i[1-c],h=Gm(t,a,l);let d=i[c-0];r=(f-d)/(h||1);if(s){r=Math.floor(r)}d+=(f-d-r*(t-a))*u;o=r*(1-a);if(s){d=Math.round(d);o=Math.round(o)}const p=rl(t).map((t=>d+r*t));return n(c?p.reverse():p)}t.domain=function(t){if(arguments.length){e(t);return c()}else{return e()}};t.range=function(t){if(arguments.length){i=[+t[0],+t[1]];return c()}else{return i.slice()}};t.rangeRound=function(t){i=[+t[0],+t[1]];s=true;return c()};t.bandwidth=function(){return o};t.step=function(){return r};t.round=function(t){if(arguments.length){s=!!t;return c()}else{return s}};t.padding=function(t){if(arguments.length){l=Math.max(0,Math.min(1,t));a=l;return c()}else{return a}};t.paddingInner=function(t){if(arguments.length){a=Math.max(0,Math.min(1,t));return c()}else{return a}};t.paddingOuter=function(t){if(arguments.length){l=Math.max(0,Math.min(1,t));return c()}else{return l}};t.align=function(t){if(arguments.length){u=Math.max(0,Math.min(1,t));return c()}else{return u}};t.invertRange=function(t){if(t[0]==null||t[1]==null)return;const r=i[1]<i[0],s=r?n().reverse():n(),a=s.length-1;let l=+t[0],u=+t[1],c,f,h;if(l!==l||u!==u)return;if(u<l){h=l;l=u;u=h}if(u<s[0]||l>i[1-r])return;c=Math.max(0,ah(s,l)-1);f=l===u?c:ah(s,u)-1;if(l-s[c]>o+1e-10)++c;if(r){h=c;c=a-f;f=a-h}return c>f?undefined:e().slice(c,f+1)};t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n};t.copy=function(){return xg().domain(e()).range(i).round(s).paddingInner(a).paddingOuter(l).align(u)};return c()}function bg(t){const e=t.copy;t.padding=t.paddingOuter;delete t.paddingInner;t.copy=function(){return bg(e())};return t}function wg(){return bg(xg().paddingInner(1))}var kg=Array.prototype.map;function Mg(t){return kg.call(t,m.He)}const Sg=Array.prototype.slice;function Eg(){let t=[],e=[];function n(n){return n==null||n!==n?undefined:e[(ch(t,n)-1)%e.length]}n.domain=function(e){if(arguments.length){t=Mg(e);return n}else{return t.slice()}};n.range=function(t){if(arguments.length){e=Sg.call(t);return n}else{return e.slice()}};n.tickFormat=function(e,n){return Ud(t[0],(0,m.fj)(t),e==null?10:e,n)};n.copy=function(){return Eg().domain(n.domain()).range(n.range())};return n}const Tg=new Map;const $g=Symbol("vega_scale");function Dg(t){t[$g]=true;return t}function Ag(t){return t&&t[$g]===true}function Ng(t,e,n){const i=function n(){const i=e();if(!i.invertRange){i.invertRange=i.invert?vg(i):i.invertExtent?_g(i):undefined}i.type=t;return Dg(i)};i.metadata=(0,m.Rg)((0,m.IX)(n));return i}function zg(t,e,n){if(arguments.length>1){Tg.set(t,Ng(t,e,n));return this}else{return Rg(t)?Tg.get(t):undefined}}zg(Vm,qd);zg(Km,Id,dg);zg(Zm,Vd,[dg,Zm]);zg(Qm,ep,dg);zg(tg,np,dg);zg(eg,sp,dg);zg(ng,mp,[dg,yg]);zg(ig,gp,[dg,yg]);zg(rg,_p,[dg,gg]);zg(`${rg}-${Km}`,_p,[dg,gg]);zg(`${rg}-${Zm}`,xp,[dg,gg,Zm]);zg(`${rg}-${Qm}`,wp,[dg,gg]);zg(`${rg}-${tg}`,kp,[dg,gg]);zg(`${rg}-${eg}`,bp,[dg,gg]);zg(`${og}-${Km}`,Ep,[dg,gg]);zg(`${og}-${Zm}`,Tp,[dg,gg,Zm]);zg(`${og}-${Qm}`,Dp,[dg,gg]);zg(`${og}-${tg}`,Ap,[dg,gg]);zg(`${og}-${eg}`,$p,[dg,gg]);zg(sg,Np,[mg,sg]);zg(ag,zp,mg);zg(lg,Rp,mg);zg(hg,Eg,[pg,mg]);zg(ug,Fp,pg);zg(fg,xg,pg);zg(cg,wg,pg);function Rg(t){return Tg.has(t)}function Cg(t,e){const n=Tg.get(t);return n&&n.metadata[e]}function Og(t){return Cg(t,dg)}function Ug(t){return Cg(t,pg)}function Pg(t){return Cg(t,mg)}function Ig(t){return Cg(t,Zm)}function qg(t){return Cg(t,yg)}function Lg(t){return Cg(t,gg)}function Fg(t){return Cg(t,sg)}const jg=["clamp","base","constant","exponent"];function Wg(t,e){const n=e[0],i=(0,m.fj)(e)-n;return function(e){return t(n+e*i)}}function Xg(t,e,n){return Mp(Jg(e||"rgb",n),t)}function Hg(t,e){const n=new Array(e),i=e+1;for(let r=0;r<e;)n[r]=t(++r/i);return n}function Bg(t){const e=t.type,n=t.copy();n.type=e;return n}function Yg(t,e,n){const i=n-e;let r,o,s;if(!i||!Number.isFinite(i)){return(0,m.a9)(.5)}else{r=(o=t.type).indexOf("-");o=r<0?o:o.slice(r+1);s=zg(o)().domain([e,n]).range([0,1]);jg.forEach((e=>t[e]?s[e](t[e]()):0));return s}}function Jg(t,e){const n=r[Gg(t)];return e!=null&&n&&n.gamma?n.gamma(e):n}function Gg(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}const Vg={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"};const Kg={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function Zg(t){const e=t.length/6|0,n=new Array(e);for(let i=0;i<e;){n[i]="#"+t.slice(i*6,++i*6)}return n}function Qg(t,e){for(const n in t)ey(n,e(t[n]))}const ty={};Qg(Kg,Zg);Qg(Vg,(t=>Xg(Zg(t))));function ey(t,e){t=t&&t.toLowerCase();if(arguments.length>1){ty[t]=e;return this}else{return ty[t]}}const ny="symbol";const iy="discrete";const ry="gradient";const oy=t=>(0,m.kJ)(t)?t.map((t=>String(t))):String(t);const sy=(t,e)=>t[1]-e[1];const ay=(t,e)=>e[1]-t[1];function ly(t,e,n){let i;if((0,m.hj)(e)){if(t.bins){e=Math.max(e,t.bins.length)}if(n!=null){e=Math.min(e,Math.floor((0,m.yP)(t.domain())/n||1))}}if((0,m.Kn)(e)){i=e.step;e=e.interval}if((0,m.HD)(e)){e=t.type===ng?_n(e):t.type==ig?xn(e):(0,m.vU)("Only time and utc scales accept interval strings.");if(i)e=e.every(i)}return e}function uy(t,e,n){let i=t.range(),r=i[0],o=(0,m.fj)(i),s=sy;if(r>o){i=o;o=r;r=i;s=ay}r=Math.floor(r);o=Math.ceil(o);e=e.map((e=>[e,t(e)])).filter((t=>r<=t[1]&&t[1]<=o)).sort(s).map((t=>t[0]));if(n>0&&e.length>1){const t=[e[0],(0,m.fj)(e)];while(e.length>n&&e.length>=3){e=e.filter(((t,e)=>!(e%2)))}if(e.length<3){e=t}}return e}function cy(t,e){return t.bins?uy(t,t.bins):t.ticks?t.ticks(e):t.domain()}function fy(t,e,n,i,r,o){const s=e.type;let a=oy;if(s===ng||r===ng){a=t.timeFormat(i)}else if(s===ig||r===ig){a=t.utcFormat(i)}else if(Ig(s)){const r=t.formatFloat(i);if(o||e.bins){a=r}else{const t=hy(e,n,false);a=e=>t(e)?r(e):""}}else if(e.tickFormat){const r=e.domain();a=t.formatSpan(r[0],r[r.length-1],n,i)}else if(i){a=t.format(i)}return a}function hy(t,e,n){const i=cy(t,e),r=t.base(),o=Math.log(r),s=Math.max(1,r*e/i.length);const a=t=>{let e=t/Math.pow(r,Math.round(Math.log(t)/o));if(e*r<r-.5)e*=r;return e<=s};return n?i.filter(a):a}const dy={[sg]:"quantiles",[ag]:"thresholds",[lg]:"domain"};const py={[sg]:"quantiles",[ag]:"domain"};function my(t,e){return t.bins?vy(t.bins):t.type===Zm?hy(t,e,true):dy[t.type]?yy(t[dy[t.type]]()):cy(t,e)}function gy(t,e,n){const i=e[py[e.type]](),r=i.length;let o=r>1?i[1]-i[0]:i[0],s;for(s=1;s<r;++s){o=Math.min(o,i[s]-i[s-1])}return t.formatSpan(0,o,3*10,n)}function yy(t){const e=[-Infinity].concat(t);e.max=+Infinity;return e}function vy(t){const e=t.slice(0,-1);e.max=(0,m.fj)(t);return e}const _y=t=>dy[t.type]||t.bins;function xy(t,e,n,i,r,o,s){const a=py[e.type]&&o!==ng&&o!==ig?gy(t,e,r):fy(t,e,n,r,o,s);return i===ny&&_y(e)?by(a):i===iy?ky(a):My(a)}const by=t=>(e,n,i)=>{const r=wy(i[n+1],wy(i.max,+Infinity)),o=Sy(e,t),s=Sy(r,t);return o&&s?o+" – "+s:s?"< "+s:"≥ "+o};const wy=(t,e)=>t!=null?t:e;const ky=t=>(e,n)=>n?t(e):null;const My=t=>e=>t(e);const Sy=(t,e)=>Number.isFinite(t)?e(t):null;function Ey(t){const e=t.domain(),n=e.length-1;let i=+e[0],r=+(0,m.fj)(e),o=r-i;if(t.type===lg){const t=n?o/n:.1;i-=t;r+=t;o=r-i}return t=>(t-i)/o}function Ty(t,e,n,i){const r=i||e.type;if((0,m.HD)(n)&&qg(r)){n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")}return!n&&r===ng?t.timeFormat("%A, %d %B %Y, %X"):!n&&r===ig?t.utcFormat("%A, %d %B %Y, %X UTC"):xy(t,e,5,null,n,i,true)}function $y(t,e,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=Ty(t,e,n.format,n.formatType);if(Pg(e.type)){const t=my(e).slice(1).map(r),n=t.length;return`${n} boundar${n===1?"y":"ies"}: ${t.join(", ")}`}else if(Ug(e.type)){const t=e.domain(),n=t.length,o=n>i?t.slice(0,i-2).map(r).join(", ")+", ending with "+t.slice(-1).map(r):t.map(r).join(", ");return`${n} value${n===1?"":"s"}: ${o}`}else{const t=e.domain();return`values from ${r(t[0])} to ${r((0,m.fj)(t))}`}}let Dy=0;function Ay(){Dy=0}const Ny="p_";function zy(t){return t&&t.gradient}function Ry(t,e,n){const i=t.gradient;let r=t.id,o=i==="radial"?Ny:"";if(!r){r=t.id="gradient_"+Dy++;if(i==="radial"){t.x1=Cy(t.x1,.5);t.y1=Cy(t.y1,.5);t.r1=Cy(t.r1,0);t.x2=Cy(t.x2,.5);t.y2=Cy(t.y2,.5);t.r2=Cy(t.r2,.5);o=Ny}else{t.x1=Cy(t.x1,0);t.y1=Cy(t.y1,0);t.x2=Cy(t.x2,1);t.y2=Cy(t.y2,0)}}e[r]=t;return"url("+(n||"")+"#"+o+r+")"}function Cy(t,e){return t!=null?t:e}function Oy(t,e){var n=[],i;return i={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:n,stop:function(t,e){n.push({offset:t,color:e});return i}}}const Uy={basis:{curve:nc},"basis-closed":{curve:oc},"basis-open":{curve:ac},bundle:{curve:uc,tension:"beta",value:.85},cardinal:{curve:hc,tension:"tension",value:0},"cardinal-open":{curve:pc,tension:"tension",value:0},"cardinal-closed":{curve:gc,tension:"tension",value:0},"catmull-rom":{curve:zc,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Cc,tension:"alpha",value:.5},"catmull-rom-open":{curve:Uc,tension:"alpha",value:.5},linear:{curve:Ic},"linear-closed":{curve:Lc},monotone:{horizontal:Gc,vertical:Jc},natural:{curve:Zc},step:{curve:tf},"step-after":{curve:nf},"step-before":{curve:ef}};function Py(t,e,n){var i=(0,m.nr)(Uy,t)&&Uy[t],r=null;if(i){r=i.curve||i[e||"vertical"];if(i.tension&&n!=null){r=r[i.tension](n)}}return r}const Iy={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7};const qy=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi;const Ly=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/;const Fy=/^((\s+,?\s*)|(,\s*))/;const jy=/^[01]/;function Wy(t){const e=[];const n=t.match(qy)||[];n.forEach((t=>{let n=t[0];const i=n.toLowerCase();const r=Iy[i];const o=Xy(i,r,t.slice(1).trim());const s=o.length;if(s<r||s&&s%r!==0){throw Error("Invalid SVG path, incorrect parameter count")}e.push([n,...o.slice(0,r)]);if(s===r){return}if(i==="m"){n=n==="M"?"L":"l"}for(let a=r;a<s;a+=r){e.push([n,...o.slice(a,a+r)])}}));return e}function Xy(t,e,n){const i=[];for(let r=0;e&&r<n.length;){for(let o=0;o<e;++o){const e=t==="a"&&(o===3||o===4)?jy:Ly;const s=n.slice(r).match(e);if(s===null){throw Error("Invalid SVG path, incorrect parameter type")}r+=s[0].length;i.push(+s[0]);const a=n.slice(r).match(Fy);if(a!==null){r+=a[0].length}}}return i}const Hy=Math.PI/180;const By=1e-14;const Yy=Math.PI/2;const Jy=Math.PI*2;const Gy=Math.sqrt(3)/2;var Vy={};var Ky={};var Zy=[].join;function Qy(t,e,n,i,r,o,s,a,l){const u=Zy.call(arguments);if(Vy[u]){return Vy[u]}const c=s*Hy;const f=Math.sin(c);const h=Math.cos(c);n=Math.abs(n);i=Math.abs(i);const d=h*(a-t)*.5+f*(l-e)*.5;const p=h*(l-e)*.5-f*(a-t)*.5;let m=d*d/(n*n)+p*p/(i*i);if(m>1){m=Math.sqrt(m);n*=m;i*=m}const g=h/n;const y=f/n;const v=-f/i;const _=h/i;const x=g*a+y*l;const b=v*a+_*l;const w=g*t+y*e;const k=v*t+_*e;const M=(w-x)*(w-x)+(k-b)*(k-b);let S=1/M-.25;if(S<0)S=0;let E=Math.sqrt(S);if(o==r)E=-E;const T=.5*(x+w)-E*(k-b);const $=.5*(b+k)+E*(w-x);const D=Math.atan2(b-$,x-T);const A=Math.atan2(k-$,w-T);let N=A-D;if(N<0&&o===1){N+=Jy}else if(N>0&&o===0){N-=Jy}const z=Math.ceil(Math.abs(N/(Yy+.001)));const R=[];for(let C=0;C<z;++C){const t=D+C*N/z;const e=D+(C+1)*N/z;R[C]=[T,$,t,e,n,i,f,h]}return Vy[u]=R}function tv(t){const e=Zy.call(t);if(Ky[e]){return Ky[e]}var n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],l=t[6],u=t[7];const c=u*s;const f=-l*a;const h=l*s;const d=u*a;const p=Math.cos(r);const m=Math.sin(r);const g=Math.cos(o);const y=Math.sin(o);const v=.5*(o-r);const _=Math.sin(v*.5);const x=8/3*_*_/Math.sin(v);const b=n+p-x*m;const w=i+m+x*p;const k=n+g;const M=i+y;const S=k+x*y;const E=M-x*g;return Ky[e]=[c*b+f*w,h*b+d*w,c*S+f*E,h*S+d*E,c*k+f*M,h*k+d*M]}const ev=["l",0,0,0,0,0,0,0];function nv(t,e,n){const i=ev[0]=t[0];if(i==="a"||i==="A"){ev[1]=e*t[1];ev[2]=n*t[2];ev[3]=t[3];ev[4]=t[4];ev[5]=t[5];ev[6]=e*t[6];ev[7]=n*t[7]}else if(i==="h"||i==="H"){ev[1]=e*t[1]}else if(i==="v"||i==="V"){ev[1]=n*t[1]}else{for(var r=1,o=t.length;r<o;++r){ev[r]=(r%2==1?e:n)*t[r]}}return ev}function iv(t,e,n,i,r,o){var s,a=null,l=0,u=0,c=0,f=0,h,d,p,m,g=0,y=0;if(n==null)n=0;if(i==null)i=0;if(r==null)r=1;if(o==null)o=r;if(t.beginPath)t.beginPath();for(var v=0,_=e.length;v<_;++v){s=e[v];if(r!==1||o!==1){s=nv(s,r,o)}switch(s[0]){case"l":l+=s[1];u+=s[2];t.lineTo(l+n,u+i);break;case"L":l=s[1];u=s[2];t.lineTo(l+n,u+i);break;case"h":l+=s[1];t.lineTo(l+n,u+i);break;case"H":l=s[1];t.lineTo(l+n,u+i);break;case"v":u+=s[1];t.lineTo(l+n,u+i);break;case"V":u=s[1];t.lineTo(l+n,u+i);break;case"m":l+=s[1];u+=s[2];g=l;y=u;t.moveTo(l+n,u+i);break;case"M":l=s[1];u=s[2];g=l;y=u;t.moveTo(l+n,u+i);break;case"c":h=l+s[5];d=u+s[6];c=l+s[3];f=u+s[4];t.bezierCurveTo(l+s[1]+n,u+s[2]+i,c+n,f+i,h+n,d+i);l=h;u=d;break;case"C":l=s[5];u=s[6];c=s[3];f=s[4];t.bezierCurveTo(s[1]+n,s[2]+i,c+n,f+i,l+n,u+i);break;case"s":h=l+s[3];d=u+s[4];c=2*l-c;f=2*u-f;t.bezierCurveTo(c+n,f+i,l+s[1]+n,u+s[2]+i,h+n,d+i);c=l+s[1];f=u+s[2];l=h;u=d;break;case"S":h=s[3];d=s[4];c=2*l-c;f=2*u-f;t.bezierCurveTo(c+n,f+i,s[1]+n,s[2]+i,h+n,d+i);l=h;u=d;c=s[1];f=s[2];break;case"q":h=l+s[3];d=u+s[4];c=l+s[1];f=u+s[2];t.quadraticCurveTo(c+n,f+i,h+n,d+i);l=h;u=d;break;case"Q":h=s[3];d=s[4];t.quadraticCurveTo(s[1]+n,s[2]+i,h+n,d+i);l=h;u=d;c=s[1];f=s[2];break;case"t":h=l+s[1];d=u+s[2];if(a[0].match(/[QqTt]/)===null){c=l;f=u}else if(a[0]==="t"){c=2*l-p;f=2*u-m}else if(a[0]==="q"){c=2*l-c;f=2*u-f}p=c;m=f;t.quadraticCurveTo(c+n,f+i,h+n,d+i);l=h;u=d;c=l+s[1];f=u+s[2];break;case"T":h=s[1];d=s[2];c=2*l-c;f=2*u-f;t.quadraticCurveTo(c+n,f+i,h+n,d+i);l=h;u=d;break;case"a":rv(t,l+n,u+i,[s[1],s[2],s[3],s[4],s[5],s[6]+l+n,s[7]+u+i]);l+=s[6];u+=s[7];break;case"A":rv(t,l+n,u+i,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+i]);l=s[6];u=s[7];break;case"z":case"Z":l=g;u=y;t.closePath();break}a=s}}function rv(t,e,n,i){const r=Qy(i[5],i[6],i[0],i[1],i[3],i[4],i[2],e,n);for(let o=0;o<r.length;++o){const e=tv(r[o]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const ov=.5773502691896257;const sv={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0);t.arc(0,0,n,0,Jy)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/2.5;t.moveTo(-n,-i);t.lineTo(-n,i);t.lineTo(-i,i);t.lineTo(-i,n);t.lineTo(i,n);t.lineTo(i,i);t.lineTo(n,i);t.lineTo(n,-i);t.lineTo(i,-i);t.lineTo(i,-n);t.lineTo(-i,-n);t.lineTo(-i,-i);t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0);t.lineTo(0,-n);t.lineTo(n,0);t.lineTo(0,n);t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/7,r=n/2.5,o=n/8;t.moveTo(-i,n);t.lineTo(i,n);t.lineTo(i,-o);t.lineTo(r,-o);t.lineTo(0,-n);t.lineTo(-r,-o);t.lineTo(-i,-o);t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,i=Gy*n,r=i-n*ov,o=n/4;t.moveTo(0,-i-r);t.lineTo(-o,i-r);t.lineTo(o,i-r);t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,i=Gy*n,r=i-n*ov;t.moveTo(0,-i-r);t.lineTo(-n,i-r);t.lineTo(n,i-r);t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Gy*n;t.moveTo(0,-i);t.lineTo(-n,i);t.lineTo(n,i);t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Gy*n;t.moveTo(0,i);t.lineTo(-n,-i);t.lineTo(n,-i);t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Gy*n;t.moveTo(i,0);t.lineTo(-i,-n);t.lineTo(-i,n);t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,i=Gy*n;t.moveTo(-i,0);t.lineTo(i,-n);t.lineTo(i,n);t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0);t.lineTo(n,0)}}};function av(t){return(0,m.nr)(sv,t)?sv[t]:uv(t)}var lv={};function uv(t){if(!(0,m.nr)(lv,t)){const e=Wy(t);lv[t]={draw:function(t,n){iv(t,e,0,0,Math.sqrt(n)/2)}}}return lv[t]}const cv=.448084975506;function fv(t){return t.x}function hv(t){return t.y}function dv(t){return t.width}function pv(t){return t.height}function mv(t){return typeof t==="function"?t:()=>+t}function gv(t,e,n){return Math.max(e,Math.min(t,n))}function yv(){var t=fv,e=hv,n=dv,i=pv,r=mv(0),o=r,s=r,a=r,l=null;function u(u,c,f){var h,d=c!=null?c:+t.call(this,u),p=f!=null?f:+e.call(this,u),m=+n.call(this,u),g=+i.call(this,u),y=Math.min(m,g)/2,v=gv(+r.call(this,u),0,y),_=gv(+o.call(this,u),0,y),x=gv(+s.call(this,u),0,y),b=gv(+a.call(this,u),0,y);if(!l)l=h=hf();if(v<=0&&_<=0&&x<=0&&b<=0){l.rect(d,p,m,g)}else{var w=d+m,k=p+g;l.moveTo(d+v,p);l.lineTo(w-_,p);l.bezierCurveTo(w-cv*_,p,w,p+cv*_,w,p+_);l.lineTo(w,k-b);l.bezierCurveTo(w,k-cv*b,w-cv*b,k,w-b,k);l.lineTo(d+x,k);l.bezierCurveTo(d+cv*x,k,d,k-cv*x,d,k-x);l.lineTo(d,p+v);l.bezierCurveTo(d,p+cv*v,d+cv*v,p,d+v,p);l.closePath()}if(h){l=null;return h+""||null}}u.x=function(e){if(arguments.length){t=mv(e);return u}else{return t}};u.y=function(t){if(arguments.length){e=mv(t);return u}else{return e}};u.width=function(t){if(arguments.length){n=mv(t);return u}else{return n}};u.height=function(t){if(arguments.length){i=mv(t);return u}else{return i}};u.cornerRadius=function(t,e,n,i){if(arguments.length){r=mv(t);o=e!=null?mv(e):r;a=n!=null?mv(n):r;s=i!=null?mv(i):o;return u}else{return r}};u.context=function(t){if(arguments.length){l=t==null?null:t;return u}else{return l}};return u}function vv(){var t,e,n,i,r=null,o,s,a,l;function u(t,e,n){const i=n/2;if(o){var u=a-e,c=t-s;if(u||c){var f=Math.sqrt(u*u+c*c),h=(u/=f)*l,d=(c/=f)*l,p=Math.atan2(c,u);r.moveTo(s-h,a-d);r.lineTo(t-u*i,e-c*i);r.arc(t,e,i,p-Math.PI,p);r.lineTo(s+h,a+d);r.arc(s,a,l,p,p+Math.PI)}else{r.arc(t,e,i,0,Jy)}r.closePath()}else{o=1}s=t;a=e;l=i}function c(s){var a,l=s.length,c,f=false,h;if(r==null)r=h=hf();for(a=0;a<=l;++a){if(!(a<l&&i(c=s[a],a,s))===f){if(f=!f)o=0}if(f)u(+t(c,a,s),+e(c,a,s),+n(c,a,s))}if(h){r=null;return h+""||null}}c.x=function(e){if(arguments.length){t=e;return c}else{return t}};c.y=function(t){if(arguments.length){e=t;return c}else{return e}};c.size=function(t){if(arguments.length){n=t;return c}else{return n}};c.defined=function(t){if(arguments.length){i=t;return c}else{return i}};c.context=function(t){if(arguments.length){if(t==null){r=null}else{r=t}return c}else{return r}};return c}function _v(t,e){return t!=null?t:e}const xv=t=>t.x||0,bv=t=>t.y||0,wv=t=>t.width||0,kv=t=>t.height||0,Mv=t=>(t.x||0)+(t.width||0),Sv=t=>(t.y||0)+(t.height||0),Ev=t=>t.startAngle||0,Tv=t=>t.endAngle||0,$v=t=>t.padAngle||0,Dv=t=>t.innerRadius||0,Av=t=>t.outerRadius||0,Nv=t=>t.cornerRadius||0,zv=t=>_v(t.cornerRadiusTopLeft,t.cornerRadius)||0,Rv=t=>_v(t.cornerRadiusTopRight,t.cornerRadius)||0,Cv=t=>_v(t.cornerRadiusBottomRight,t.cornerRadius)||0,Ov=t=>_v(t.cornerRadiusBottomLeft,t.cornerRadius)||0,Uv=t=>_v(t.size,64),Pv=t=>t.size||1,Iv=t=>!(t.defined===false),qv=t=>av(t.shape||"circle");const Lv=wf().startAngle(Ev).endAngle(Tv).padAngle($v).innerRadius(Dv).outerRadius(Av).cornerRadius(Nv),Fv=$f().x(xv).y1(bv).y0(Sv).defined(Iv),jv=$f().y(bv).x1(xv).x0(Mv).defined(Iv),Wv=Tf().x(xv).y(bv).defined(Iv),Xv=yv().x(xv).y(bv).width(wv).height(kv).cornerRadius(zv,Rv,Cv,Ov),Hv=ih().type(qv).size(Uv),Bv=vv().x(xv).y(bv).defined(Iv).size(Pv);function Yv(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function Jv(t,e){return Lv.context(t)(e)}function Gv(t,e){const n=e[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?jv:Fv).curve(Py(i,n.orient,n.tension)).context(t)(e)}function Vv(t,e){const n=e[0],i=n.interpolate||"linear";return Wv.curve(Py(i,n.orient,n.tension)).context(t)(e)}function Kv(t,e,n,i){return Xv.context(t)(e,n,i)}function Zv(t,e){return(e.mark.shape||e.shape).context(t)(e)}function Qv(t,e){return Hv.context(t)(e)}function t_(t,e){return Bv.context(t)(e)}var e_=1;function n_(){e_=1}function i_(t,e,n){var i=e.clip,r=t._defs,o=e.clip_id||(e.clip_id="clip"+e_++),s=r.clipping[o]||(r.clipping[o]={id:o});if((0,m.mf)(i)){s.path=i(null)}else if(Yv(n)){s.path=Kv(null,n,0,0)}else{s.width=n.width||0;s.height=n.height||0}return"url(#"+o+")"}function r_(t){this.clear();if(t)this.union(t)}r_.prototype={clone(){return new r_(this)},clear(){this.x1=+Number.MAX_VALUE;this.y1=+Number.MAX_VALUE;this.x2=-Number.MAX_VALUE;this.y2=-Number.MAX_VALUE;return this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,i){if(n<t){this.x2=t;this.x1=n}else{this.x1=t;this.x2=n}if(i<e){this.y2=e;this.y1=i}else{this.y1=e;this.y2=i}return this},add(t,e){if(t<this.x1)this.x1=t;if(e<this.y1)this.y1=e;if(t>this.x2)this.x2=t;if(e>this.y2)this.y2=e;return this},expand(t){this.x1-=t;this.y1-=t;this.x2+=t;this.y2+=t;return this},round(){this.x1=Math.floor(this.x1);this.y1=Math.floor(this.y1);this.x2=Math.ceil(this.x2);this.y2=Math.ceil(this.y2);return this},scale(t){this.x1*=t;this.y1*=t;this.x2*=t;this.y2*=t;return this},translate(t,e){this.x1+=t;this.x2+=t;this.y1+=e;this.y2+=e;return this},rotate(t,e,n){const i=this.rotatedPoints(t,e,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(t,e,n){var{x1:i,y1:r,x2:o,y2:s}=this,a=Math.cos(t),l=Math.sin(t),u=e-e*a+n*l,c=n-e*l-n*a;return[a*i-l*r+u,l*i+a*r+c,a*i-l*s+u,l*i+a*s+c,a*o-l*r+u,l*o+a*r+c,a*o-l*s+u,l*o+a*s+c]},union(t){if(t.x1<this.x1)this.x1=t.x1;if(t.y1<this.y1)this.y1=t.y1;if(t.x2>this.x2)this.x2=t.x2;if(t.y2>this.y2)this.y2=t.y2;return this},intersect(t){if(t.x1>this.x1)this.x1=t.x1;if(t.y1>this.y1)this.y1=t.y1;if(t.x2<this.x2)this.x2=t.x2;if(t.y2<this.y2)this.y2=t.y2;return this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function o_(t){this.mark=t;this.bounds=this.bounds||new r_}function s_(t){o_.call(this,t);this.items=this.items||[]}(0,m.XW)(s_,o_);function a_(t){this._pending=0;this._loader=t||mo()}function l_(t){t._pending+=1}function u_(t){t._pending-=1}a_.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;l_(e);return e._loader.sanitize(t,{context:"href"}).then((t=>{u_(e);return t})).catch((()=>{u_(e);return null}))},loadImage(t){const e=this,n=oh();l_(e);return e._loader.sanitize(t,{context:"image"}).then((t=>{const i=t.href;if(!i||!n)throw{url:i};const r=new n;const o=(0,m.nr)(t,"crossOrigin")?t.crossOrigin:"anonymous";if(o!=null)r.crossOrigin=o;r.onload=()=>u_(e);r.onerror=()=>u_(e);r.src=i;return r})).catch((t=>{u_(e);return{complete:false,width:0,height:0,src:t&&t.url||""}}))},ready(){const t=this;return new Promise((e=>{function n(i){if(!t.pending())e(i);else setTimeout((()=>{n(true)}),10)}n(false)}))}};function c_(t,e,n){if(e.stroke&&e.opacity!==0&&e.strokeOpacity!==0){const i=e.strokeWidth!=null?+e.strokeWidth:1;t.expand(i+(n?f_(e,i):0))}return t}function f_(t,e){return t.strokeJoin&&t.strokeJoin!=="miter"?0:e}const h_=Jy-1e-8;let d_,p_,m_,g_,y_,v_,__,x_;const b_=(t,e)=>d_.add(t,e);const w_=(t,e)=>b_(p_=t,m_=e);const k_=t=>b_(t,d_.y1);const M_=t=>b_(d_.x1,t);const S_=(t,e)=>y_*t+__*e;const E_=(t,e)=>v_*t+x_*e;const T_=(t,e)=>b_(S_(t,e),E_(t,e));const $_=(t,e)=>w_(S_(t,e),E_(t,e));function D_(t,e){d_=t;if(e){g_=e*Hy;y_=x_=Math.cos(g_);v_=Math.sin(g_);__=-v_}else{y_=x_=1;g_=v_=__=0}return A_}const A_={beginPath(){},closePath(){},moveTo:$_,lineTo:$_,rect(t,e,n,i){if(g_){T_(t+n,e);T_(t+n,e+i);T_(t,e+i);$_(t,e)}else{b_(t+n,e+i);w_(t,e)}},quadraticCurveTo(t,e,n,i){const r=S_(t,e),o=E_(t,e),s=S_(n,i),a=E_(n,i);N_(p_,r,s,k_);N_(m_,o,a,M_);w_(s,a)},bezierCurveTo(t,e,n,i,r,o){const s=S_(t,e),a=E_(t,e),l=S_(n,i),u=E_(n,i),c=S_(r,o),f=E_(r,o);z_(p_,s,l,c,k_);z_(m_,a,u,f,M_);w_(c,f)},arc(t,e,n,i,r,o){i+=g_;r+=g_;p_=n*Math.cos(r)+t;m_=n*Math.sin(r)+e;if(Math.abs(r-i)>h_){b_(t-n,e-n);b_(t+n,e+n)}else{const s=i=>b_(n*Math.cos(i)+t,n*Math.sin(i)+e);let a,l;s(i);s(r);if(r!==i){i=i%Jy;if(i<0)i+=Jy;r=r%Jy;if(r<0)r+=Jy;if(r<i){o=!o;a=i;i=r;r=a}if(o){r-=Jy;a=i-i%Yy;for(l=0;l<4&&a>r;++l,a-=Yy)s(a)}else{a=i-i%Yy+Yy;for(l=0;l<4&&a<r;++l,a=a+Yy)s(a)}}}}};function N_(t,e,n,i){const r=(t-e)/(t+n-2*e);if(0<r&&r<1)i(t+(e-t)*r)}function z_(t,e,n,i,r){const o=i-t+3*e-3*n,s=t+n-2*e,a=t-e;let l=0,u=0,c;if(Math.abs(o)>By){c=s*s+a*o;if(c>=0){c=Math.sqrt(c);l=(-s+c)/o;u=(-s-c)/o}}else{l=.5*a/s}if(0<l&&l<1)r(R_(l,t,e,n,i));if(0<u&&u<1)r(R_(u,t,e,n,i))}function R_(t,e,n,i,r){const o=1-t,s=o*o,a=t*t;return s*o*e+3*s*t*n+3*o*a*i+a*t*r}var C_=(C_=rh(1,1))?C_.getContext("2d"):null;const O_=new r_;function U_(t){return function(e,n){if(!C_)return true;t(C_,e);O_.clear().union(e.bounds).intersect(n).round();const{x1:i,y1:r,x2:o,y2:s}=O_;for(let t=r;t<=s;++t){for(let e=i;e<=o;++e){if(C_.isPointInPath(e,t)){return true}}}return false}}function P_(t,e){return e.contains(t.x||0,t.y||0)}function I_(t,e){const n=t.x||0,i=t.y||0,r=t.width||0,o=t.height||0;return e.intersects(O_.set(n,i,n+r,i+o))}function q_(t,e){const n=t.x||0,i=t.y||0,r=t.x2!=null?t.x2:n,o=t.y2!=null?t.y2:i;return L_(e,n,i,r,o)}function L_(t,e,n,i,r){const{x1:o,y1:s,x2:a,y2:l}=t,u=i-e,c=r-n;let f=0,h=1,d,p,m,g;for(g=0;g<4;++g){if(g===0){d=-u;p=-(o-e)}if(g===1){d=u;p=a-e}if(g===2){d=-c;p=-(s-n)}if(g===3){d=c;p=l-n}if(Math.abs(d)<1e-10&&p<0)return false;m=p/d;if(d<0){if(m>h)return false;else if(m>f)f=m}else if(d>0){if(m<f)return false;else if(m<h)h=m}}return true}function F_(t,e){t.globalCompositeOperation=e.blend||"source-over"}function j_(t,e){return t==null?e:t}function W_(t,e){const n=e.length;for(let i=0;i<n;++i){t.addColorStop(e[i].offset,e[i].color)}return t}function X_(t,e,n){const i=n.width(),r=n.height();let o;if(e.gradient==="radial"){o=t.createRadialGradient(n.x1+j_(e.x1,.5)*i,n.y1+j_(e.y1,.5)*r,Math.max(i,r)*j_(e.r1,0),n.x1+j_(e.x2,.5)*i,n.y1+j_(e.y2,.5)*r,Math.max(i,r)*j_(e.r2,.5))}else{const s=j_(e.x1,0),a=j_(e.y1,0),l=j_(e.x2,1),u=j_(e.y2,0);if(s===l||a===u||i===r){o=t.createLinearGradient(n.x1+s*i,n.y1+a*r,n.x1+l*i,n.y1+u*r)}else{const n=rh(Math.ceil(i),Math.ceil(r)),o=n.getContext("2d");o.scale(i,r);o.fillStyle=W_(o.createLinearGradient(s,a,l,u),e.stops);o.fillRect(0,0,i,r);return t.createPattern(n,"no-repeat")}}return W_(o,e.stops)}function H_(t,e,n){return zy(n)?X_(t,n,e.bounds):n}function B_(t,e,n){n*=e.fillOpacity==null?1:e.fillOpacity;if(n>0){t.globalAlpha=n;t.fillStyle=H_(t,e,e.fill);return true}else{return false}}var Y_=[];function J_(t,e,n){var i=(i=e.strokeWidth)!=null?i:1;if(i<=0)return false;n*=e.strokeOpacity==null?1:e.strokeOpacity;if(n>0){t.globalAlpha=n;t.strokeStyle=H_(t,e,e.stroke);t.lineWidth=i;t.lineCap=e.strokeCap||"butt";t.lineJoin=e.strokeJoin||"miter";t.miterLimit=e.strokeMiterLimit||10;if(t.setLineDash){t.setLineDash(e.strokeDash||Y_);t.lineDashOffset=e.strokeDashOffset||0}return true}else{return false}}function G_(t,e){return t.zindex-e.zindex||t.index-e.index}function V_(t){if(!t.zdirty)return t.zitems;var e=t.items,n=[],i,r,o;for(r=0,o=e.length;r<o;++r){i=e[r];i.index=r;if(i.zindex)n.push(i)}t.zdirty=false;return t.zitems=n.sort(G_)}function K_(t,e){var n=t.items,i,r;if(!n||!n.length)return;const o=V_(t);if(o&&o.length){for(i=0,r=n.length;i<r;++i){if(!n[i].zindex)e(n[i])}n=o}for(i=0,r=n.length;i<r;++i){e(n[i])}}function Z_(t,e){var n=t.items,i,r;if(!n||!n.length)return null;const o=V_(t);if(o&&o.length)n=o;for(r=n.length;--r>=0;){if(i=e(n[r]))return i}if(n===o){for(n=t.items,r=n.length;--r>=0;){if(!n[r].zindex){if(i=e(n[r]))return i}}}return null}function Q_(t){return function(e,n,i){K_(n,(n=>{if(!i||i.intersects(n.bounds)){ex(t,e,n,n)}}))}}function tx(t){return function(e,n,i){if(n.items.length&&(!i||i.intersects(n.bounds))){ex(t,e,n.items[0],n.items)}}}function ex(t,e,n,i){var r=n.opacity==null?1:n.opacity;if(r===0)return;if(t(e,i))return;F_(e,n);if(n.fill&&B_(e,n,r)){e.fill()}if(n.stroke&&J_(e,n,r)){e.stroke()}}function nx(t){t=t||m.yb;return function(e,n,i,r,o,s){i*=e.pixelRatio;r*=e.pixelRatio;return Z_(n,(n=>{const a=n.bounds;if(a&&!a.contains(o,s)||!a)return;if(t(e,n,i,r,o,s))return n}))}}function ix(t,e){return function(n,i,r,o){var s=Array.isArray(i)?i[0]:i,a=e==null?s.fill:e,l=s.stroke&&n.isPointInStroke,u,c;if(l){u=s.strokeWidth;c=s.strokeCap;n.lineWidth=u!=null?u:1;n.lineCap=c!=null?c:"butt"}return t(n,i)?false:a&&n.isPointInPath(r,o)||l&&n.isPointInStroke(r,o)}}function rx(t){return nx(ix(t))}function ox(t,e){return"translate("+t+","+e+")"}function sx(t){return"rotate("+t+")"}function ax(t,e){return"scale("+t+","+e+")"}function lx(t){return ox(t.x||0,t.y||0)}function ux(t){return ox(t.x||0,t.y||0)+(t.angle?" "+sx(t.angle):"")}function cx(t){return ox(t.x||0,t.y||0)+(t.angle?" "+sx(t.angle):"")+(t.scaleX||t.scaleY?" "+ax(t.scaleX||1,t.scaleY||1):"")}function fx(t,e,n){function i(t,n){t("transform",ux(n));t("d",e(null,n))}function r(t,n){e(D_(t,n.angle),n);return c_(t,n).translate(n.x||0,n.y||0)}function o(t,n){var i=n.x||0,r=n.y||0,o=n.angle||0;t.translate(i,r);if(o)t.rotate(o*=Hy);t.beginPath();e(t,n);if(o)t.rotate(-o);t.translate(-i,-r)}return{type:t,tag:"path",nested:false,attr:i,bound:r,draw:Q_(o),pick:rx(o),isect:n||U_(o)}}var hx=fx("arc",Jv);function dx(t,e){var n=t[0].orient==="horizontal"?e[1]:e[0],i=t[0].orient==="horizontal"?"y":"x",r=t.length,o=+Infinity,s,a;while(--r>=0){if(t[r].defined===false)continue;a=Math.abs(t[r][i]-n);if(a<o){o=a;s=t[r]}}return s}function px(t,e){var n=Math.pow(t[0].strokeWidth||1,2),i=t.length,r,o,s;while(--i>=0){if(t[i].defined===false)continue;r=t[i].x-e[0];o=t[i].y-e[1];s=r*r+o*o;if(s<n)return t[i]}return null}function mx(t,e){var n=t.length,i,r,o;while(--n>=0){if(t[n].defined===false)continue;i=t[n].x-e[0];r=t[n].y-e[1];o=i*i+r*r;i=t[n].size||1;if(o<i*i)return t[n]}return null}function gx(t,e,n){function i(t,n){var i=n.mark.items;if(i.length)t("d",e(null,i))}function r(t,n){var i=n.items;if(i.length===0){return t}else{e(D_(t),i);return c_(t,i[0])}}function o(t,n){t.beginPath();e(t,n)}const s=ix(o);function a(t,e,n,i,r,o){var a=e.items,l=e.bounds;if(!a||!a.length||l&&!l.contains(r,o)){return null}n*=t.pixelRatio;i*=t.pixelRatio;return s(t,a,n,i)?a[0]:null}return{type:t,tag:"path",nested:true,attr:i,bound:r,draw:tx(o),pick:a,isect:P_,tip:n}}var yx=gx("area",Gv,dx);function vx(t,e){var n=e.clip;t.save();if((0,m.mf)(n)){t.beginPath();n(t);t.clip()}else{_x(t,e.group)}}function _x(t,e){t.beginPath();Yv(e)?Kv(t,e,0,0):t.rect(0,0,e.width||0,e.height||0);t.clip()}function xx(t){const e=j_(t.strokeWidth,1);return t.strokeOffset!=null?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function bx(t,e){t("transform",lx(e))}function wx(t,e){const n=xx(e);t("d",Kv(null,e,n,n))}function kx(t,e){t("class","background");t("aria-hidden",true);wx(t,e)}function Mx(t,e){t("class","foreground");t("aria-hidden",true);if(e.strokeForeground){wx(t,e)}else{t("d","")}}function Sx(t,e,n){const i=e.clip?i_(n,e,e):null;t("clip-path",i)}function Ex(t,e){if(!e.clip&&e.items){const n=e.items,i=n.length;for(let e=0;e<i;++e){t.union(n[e].bounds)}}if((e.clip||e.width||e.height)&&!e.noBound){t.add(0,0).add(e.width||0,e.height||0)}c_(t,e);return t.translate(e.x||0,e.y||0)}function Tx(t,e,n,i){const r=xx(e);t.beginPath();Kv(t,e,(n||0)+r,(i||0)+r)}const $x=ix(Tx);const Dx=ix(Tx,false);const Ax=ix(Tx,true);function Nx(t,e,n){K_(e,(e=>{const i=e.x||0,r=e.y||0,o=e.strokeForeground,s=e.opacity==null?1:e.opacity;if((e.stroke||e.fill)&&s){Tx(t,e,i,r);F_(t,e);if(e.fill&&B_(t,e,s)){t.fill()}if(e.stroke&&!o&&J_(t,e,s)){t.stroke()}}t.save();t.translate(i,r);if(e.clip)_x(t,e);if(n)n.translate(-i,-r);K_(e,(e=>{this.draw(t,e,n)}));if(n)n.translate(i,r);t.restore();if(o&&e.stroke&&s){Tx(t,e,i,r);F_(t,e);if(J_(t,e,s)){t.stroke()}}}))}function zx(t,e,n,i,r,o){if(e.bounds&&!e.bounds.contains(r,o)||!e.items){return null}const s=n*t.pixelRatio,a=i*t.pixelRatio;return Z_(e,(l=>{let u,c,f;const h=l.bounds;if(h&&!h.contains(r,o))return;c=l.x||0;f=l.y||0;const d=c+(l.width||0),p=f+(l.height||0),m=l.clip;if(m&&(r<c||r>d||o<f||o>p))return;t.save();t.translate(c,f);c=r-c;f=o-f;if(m&&Yv(l)&&!Ax(t,l,s,a)){t.restore();return null}const g=l.strokeForeground,y=e.interactive!==false;if(y&&g&&l.stroke&&Dx(t,l,s,a)){t.restore();return l}u=Z_(l,(t=>Rx(t,c,f)?this.pick(t,n,i,c,f):null));if(!u&&y&&(l.fill||!g&&l.stroke)&&$x(t,l,s,a)){u=l}t.restore();return u||null}))}function Rx(t,e,n){return(t.interactive!==false||t.marktype==="group")&&t.bounds&&t.bounds.contains(e,n)}var Cx={type:"group",tag:"g",nested:false,attr:bx,bound:Ex,draw:Nx,pick:zx,isect:I_,content:Sx,background:kx,foreground:Mx};var Ox={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Ux(t,e){var n=t.image;if(!n||t.url&&t.url!==n.url){n={complete:false,width:0,height:0};e.loadImage(t.url).then((e=>{t.image=e;t.image.url=t.url}))}return n}function Px(t,e){return t.width!=null?t.width:!e||!e.width?0:t.aspect!==false&&t.height?t.height*e.width/e.height:e.width}function Ix(t,e){return t.height!=null?t.height:!e||!e.height?0:t.aspect!==false&&t.width?t.width*e.height/e.width:e.height}function qx(t,e){return t==="center"?e/2:t==="right"?e:0}function Lx(t,e){return t==="middle"?e/2:t==="bottom"?e:0}function Fx(t,e,n){const i=Ux(e,n),r=Px(e,i),o=Ix(e,i),s=(e.x||0)-qx(e.align,r),a=(e.y||0)-Lx(e.baseline,o),l=!i.src&&i.toDataURL?i.toDataURL():i.src||"";t("href",l,Ox["xmlns:xlink"],"xlink:href");t("transform",ox(s,a));t("width",r);t("height",o);t("preserveAspectRatio",e.aspect===false?"none":"xMidYMid")}function jx(t,e){const n=e.image,i=Px(e,n),r=Ix(e,n),o=(e.x||0)-qx(e.align,i),s=(e.y||0)-Lx(e.baseline,r);return t.set(o,s,o+i,s+r)}function Wx(t,e,n){K_(e,(e=>{if(n&&!n.intersects(e.bounds))return;const i=Ux(e,this);let r=Px(e,i);let o=Ix(e,i);if(r===0||o===0)return;let s=(e.x||0)-qx(e.align,r),a=(e.y||0)-Lx(e.baseline,o),l,u,c,f;if(e.aspect!==false){u=i.width/i.height;c=e.width/e.height;if(u===u&&c===c&&u!==c){if(c<u){f=r/u;a+=(o-f)/2;o=f}else{f=o*u;s+=(r-f)/2;r=f}}}if(i.complete||i.toDataURL){F_(t,e);t.globalAlpha=(l=e.opacity)!=null?l:1;t.imageSmoothingEnabled=e.smooth!==false;t.drawImage(i,s,a,r,o)}}))}var Xx={type:"image",tag:"image",nested:false,attr:Fx,bound:jx,draw:Wx,pick:nx(),isect:m.yb,get:Ux,xOffset:qx,yOffset:Lx};var Hx=gx("line",Vv,px);function Bx(t,e){var n=e.scaleX||1,i=e.scaleY||1;if(n!==1||i!==1){t("vector-effect","non-scaling-stroke")}t("transform",cx(e));t("d",e.path)}function Yx(t,e){var n=e.path;if(n==null)return true;var i=e.x||0,r=e.y||0,o=e.scaleX||1,s=e.scaleY||1,a=(e.angle||0)*Hy,l=e.pathCache;if(!l||l.path!==n){(e.pathCache=l=Wy(n)).path=n}if(a&&t.rotate&&t.translate){t.translate(i,r);t.rotate(a);iv(t,l,0,0,o,s);t.rotate(-a);t.translate(-i,-r)}else{iv(t,l,i,r,o,s)}}function Jx(t,e){return Yx(D_(t,e.angle),e)?t.set(0,0,0,0):c_(t,e,true)}var Gx={type:"path",tag:"path",nested:false,attr:Bx,bound:Jx,draw:Q_(Yx),pick:rx(Yx),isect:U_(Yx)};function Vx(t,e){t("d",Kv(null,e))}function Kx(t,e){var n,i;return c_(t.set(n=e.x||0,i=e.y||0,n+e.width||0,i+e.height||0),e)}function Zx(t,e){t.beginPath();Kv(t,e)}var Qx={type:"rect",tag:"path",nested:false,attr:Vx,bound:Kx,draw:Q_(Zx),pick:rx(Zx),isect:I_};function tb(t,e){t("transform",lx(e));t("x2",e.x2!=null?e.x2-(e.x||0):0);t("y2",e.y2!=null?e.y2-(e.y||0):0)}function eb(t,e){var n,i;return c_(t.set(n=e.x||0,i=e.y||0,e.x2!=null?e.x2:n,e.y2!=null?e.y2:i),e)}function nb(t,e,n){var i,r,o,s;if(e.stroke&&J_(t,e,n)){i=e.x||0;r=e.y||0;o=e.x2!=null?e.x2:i;s=e.y2!=null?e.y2:r;t.beginPath();t.moveTo(i,r);t.lineTo(o,s);return true}return false}function ib(t,e,n){K_(e,(e=>{if(n&&!n.intersects(e.bounds))return;var i=e.opacity==null?1:e.opacity;if(i&&nb(t,e,i)){F_(t,e);t.stroke()}}))}function rb(t,e,n,i){if(!t.isPointInStroke)return false;return nb(t,e,1)&&t.isPointInStroke(n,i)}var ob={type:"rule",tag:"line",nested:false,attr:tb,bound:eb,draw:ib,pick:nx(rb),isect:q_};var sb=fx("shape",Zv);var ab=fx("symbol",Qv,P_);const lb=(0,m.$m)();var ub={height:mb,measureWidth:db,estimateWidth:fb,width:fb,canvas:cb};cb(true);function cb(t){ub.width=t&&C_?db:fb}function fb(t,e){return hb(xb(t,e),mb(t))}function hb(t,e){return~~(.8*t.length*e)}function db(t,e){return mb(t)<=0||!(e=xb(t,e))?0:pb(e,Mb(t))}function pb(t,e){const n=`(${e}) ${t}`;let i=lb.get(n);if(i===undefined){C_.font=e;i=C_.measureText(t).width;lb.set(n,i)}return i}function mb(t){return t.fontSize!=null?+t.fontSize||0:11}function gb(t){return t.lineHeight!=null?t.lineHeight:mb(t)+2}function yb(t){return(0,m.kJ)(t)?t.length>1?t:t[0]:t}function vb(t){return yb(t.lineBreak&&t.text&&!(0,m.kJ)(t.text)?t.text.split(t.lineBreak):t.text)}function _b(t){const e=vb(t);return((0,m.kJ)(e)?e.length-1:0)*gb(t)}function xb(t,e){const n=e==null?"":(e+"").trim();return t.limit>0&&n.length?wb(t,n):n}function bb(t){if(ub.width===db){const e=Mb(t);return t=>pb(t,e)}else{const e=mb(t);return t=>hb(t,e)}}function wb(t,e){var n=+t.limit,i=bb(t);if(i(e)<n)return e;var r=t.ellipsis||"…",o=t.dir==="rtl",s=0,a=e.length,l;n-=i(r);if(o){while(s<a){l=s+a>>>1;if(i(e.slice(l))>n)s=l+1;else a=l}return r+e.slice(s)}else{while(s<a){l=1+(s+a>>>1);if(i(e.slice(0,l))<n)s=l;else a=l-1}return e.slice(0,s)+r}}function kb(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Mb(t,e){return""+(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+mb(t)+"px "+kb(t,e)}function Sb(t){var e=t.baseline,n=mb(t);return Math.round(e==="top"?.79*n:e==="middle"?.3*n:e==="bottom"?-.21*n:e==="line-top"?.29*n+.5*gb(t):e==="line-bottom"?.29*n-.5*gb(t):0)}const Eb={left:"start",center:"middle",right:"end"};const Tb=new r_;function $b(t){var e=t.x||0,n=t.y||0,i=t.radius||0,r;if(i){r=(t.theta||0)-Yy;e+=i*Math.cos(r);n+=i*Math.sin(r)}Tb.x1=e;Tb.y1=n;return Tb}function Db(t,e){var n=e.dx||0,i=(e.dy||0)+Sb(e),r=$b(e),o=r.x1,s=r.y1,a=e.angle||0,l;t("text-anchor",Eb[e.align]||"start");if(a){l=ox(o,s)+" "+sx(a);if(n||i)l+=" "+ox(n,i)}else{l=ox(o+n,s+i)}t("transform",l)}function Ab(t,e,n){var i=ub.height(e),r=e.align,o=$b(e),s=o.x1,a=o.y1,l=e.dx||0,u=(e.dy||0)+Sb(e)-Math.round(.8*i),c=vb(e),f;if((0,m.kJ)(c)){i+=gb(e)*(c.length-1);f=c.reduce(((t,n)=>Math.max(t,ub.width(e,n))),0)}else{f=ub.width(e,c)}if(r==="center"){l-=f/2}else if(r==="right"){l-=f}else;t.set(l+=s,u+=a,l+f,u+i);if(e.angle&&!n){t.rotate(e.angle*Hy,s,a)}else if(n===2){return t.rotatedPoints(e.angle*Hy,s,a)}return t}function Nb(t,e,n){K_(e,(e=>{var i=e.opacity==null?1:e.opacity,r,o,s,a,l,u,c;if(n&&!n.intersects(e.bounds)||i===0||e.fontSize<=0||e.text==null||e.text.length===0)return;t.font=Mb(e);t.textAlign=e.align||"left";r=$b(e);o=r.x1,s=r.y1;if(e.angle){t.save();t.translate(o,s);t.rotate(e.angle*Hy);o=s=0}o+=e.dx||0;s+=(e.dy||0)+Sb(e);u=vb(e);F_(t,e);if((0,m.kJ)(u)){l=gb(e);for(a=0;a<u.length;++a){c=xb(e,u[a]);if(e.fill&&B_(t,e,i)){t.fillText(c,o,s)}if(e.stroke&&J_(t,e,i)){t.strokeText(c,o,s)}s+=l}}else{c=xb(e,u);if(e.fill&&B_(t,e,i)){t.fillText(c,o,s)}if(e.stroke&&J_(t,e,i)){t.strokeText(c,o,s)}}if(e.angle)t.restore()}))}function zb(t,e,n,i,r,o){if(e.fontSize<=0)return false;if(!e.angle)return true;var s=$b(e),a=s.x1,l=s.y1,u=Ab(Tb,e,1),c=-e.angle*Hy,f=Math.cos(c),h=Math.sin(c),d=f*r-h*o+(a-f*a+h*l),p=h*r+f*o+(l-h*a-f*l);return u.contains(d,p)}function Rb(t,e){const n=Ab(Tb,t,2);return L_(e,n[0],n[1],n[2],n[3])||L_(e,n[0],n[1],n[4],n[5])||L_(e,n[4],n[5],n[6],n[7])||L_(e,n[2],n[3],n[6],n[7])}var Cb={type:"text",tag:"text",nested:false,attr:Db,bound:Ab,draw:Nb,pick:nx(zb),isect:Rb};var Ob=gx("trail",t_,mx);var Ub={arc:hx,area:yx,group:Cx,image:Xx,line:Hx,path:Gx,rect:Qx,rule:ob,shape:sb,symbol:ab,text:Cb,trail:Ob};function Pb(t,e,n){var i=Ub[t.mark.marktype],r=e||i.bound;if(i.nested)t=t.mark;return r(t.bounds||(t.bounds=new r_),t,n)}var Ib={mark:null};function qb(t,e,n){var i=Ub[t.marktype],r=i.bound,o=t.items,s=o&&o.length,a,l,u,c;if(i.nested){if(s){u=o[0]}else{Ib.mark=t;u=Ib}c=Pb(u,r,n);e=e&&e.union(c)||c;return e}e=e||t.bounds&&t.bounds.clear()||new r_;if(s){for(a=0,l=o.length;a<l;++a){e.union(Pb(o[a],r,n))}}return t.bounds=e}const Lb=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Fb(t,e){return JSON.stringify(t,Lb,e)}function jb(t){const e=typeof t==="string"?JSON.parse(t):t;return Wb(e)}function Wb(t){var e=t.marktype,n=t.items,i,r,o;if(n){for(r=0,o=n.length;r<o;++r){i=e?"mark":"group";n[r][i]=t;if(n[r].zindex)n[r][i].zdirty=true;if("group"===(e||i))Wb(n[r])}}if(e)qb(t);return t}function Xb(t){if(arguments.length){this.root=jb(t)}else{this.root=Hb({marktype:"group",name:"root",role:"frame"});this.root.items=[new s_(this.root)]}}Xb.prototype={toJSON(t){return Fb(this.root,t||0)},mark(t,e,n){e=e||this.root.items[0];const i=Hb(t,e);e.items[n]=i;if(i.zindex)i.group.zdirty=true;return i}};function Hb(t,e){const n={bounds:new r_,clip:!!t.clip,group:e,interactive:t.interactive===false?false:true,items:[],marktype:t.marktype,name:t.name||undefined,role:t.role||undefined,zindex:t.zindex||0};if(t.aria!=null){n.aria=t.aria}if(t.description){n.description=t.description}return n}function Bb(t,e,n){if(!t&&typeof document!=="undefined"&&document.createElement){t=document}return t?n?t.createElementNS(n,e):t.createElement(e):null}function Yb(t,e){e=e.toLowerCase();var n=t.childNodes,i=0,r=n.length;for(;i<r;++i)if(n[i].tagName.toLowerCase()===e){return n[i]}}function Jb(t,e,n,i){var r=t.childNodes[e],o;if(!r||r.tagName.toLowerCase()!==n.toLowerCase()){o=r||null;r=Bb(t.ownerDocument,n,i);t.insertBefore(r,o)}return r}function Gb(t,e){var n=t.childNodes,i=n.length;while(i>e)t.removeChild(n[--i]);return t}function Vb(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function Kb(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function Zb(t,e,n,i){var r=t&&t.mark,o,s;if(r&&(o=Ub[r.marktype]).tip){s=Kb(e,n);s[0]-=i[0];s[1]-=i[1];while(t=t.mark.group){s[0]-=t.x||0;s[1]-=t.y||0}t=o.tip(r.items,s)}return t}function Qb(t,e){this._active=null;this._handlers={};this._loader=t||mo();this._tooltip=e||tw}function tw(t,e,n,i){t.element().setAttribute("title",i||"")}Qb.prototype={initialize(t,e,n){this._el=t;this._obj=n||null;return this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){if(arguments.length){this._origin=t||[0,0];return this}else{return this._origin.slice()}},scene(t){if(!arguments.length)return this._scene;this._scene=t;return this},on(){},off(){},_handlerIndex(t,e,n){for(let i=t?t.length:0;--i>=0;){if(t[i].type===e&&(!n||t[i].handler===n)){return i}}return-1},handlers(t){const e=this._handlers,n=[];if(t){n.push(...e[this.eventName(t)])}else{for(const t in e){n.push(...e[t])}}return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),i=Bb(null,"a");for(const t in e)i.setAttribute(t,e[t]);i.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&e.tooltip!=null){e=Zb(e,t,this.canvas(),this._origin);const i=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,i)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),i=this._origin,r=t.bounds,o=r.width(),s=r.height();let a=r.x1+i[0]+n.left,l=r.y1+i[1]+n.top;while(t.mark&&(t=t.mark.group)){a+=t.x||0;l+=t.y||0}return{x:a,y:l,width:o,height:s,left:a,top:l,right:a+o,bottom:l+s}}};function ew(t){this._el=null;this._bgcolor=null;this._loader=new a_(t)}ew.prototype={initialize(t,e,n,i,r){this._el=t;return this.resize(e,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){if(arguments.length===0)return this._bgcolor;this._bgcolor=t;return this},resize(t,e,n,i){this._width=t;this._height=e;this._origin=n||[0,0];this._scale=i||1;return this},dirty(){},render(t){const e=this;e._call=function(){e._render(t)};e._call();e._call=null;return e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then((()=>e)):Promise.resolve(e)},_load(t,e){var n=this,i=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{if(e)t();n._ready=null}))}return i},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const nw="keydown";const iw="keypress";const rw="keyup";const ow="dragenter";const sw="dragleave";const aw="dragover";const lw="mousedown";const uw="mouseup";const cw="mousemove";const fw="mouseout";const hw="mouseover";const dw="click";const pw="dblclick";const mw="wheel";const gw="mousewheel";const yw="touchstart";const vw="touchmove";const _w="touchend";const xw=[nw,iw,rw,ow,sw,aw,lw,uw,cw,fw,hw,dw,pw,mw,gw,yw,vw,_w];const bw=cw;const ww=fw;const kw=dw;function Mw(t,e){Qb.call(this,t,e);this._down=null;this._touch=null;this._first=true;this._events={}}const Sw=t=>t===yw||t===vw||t===_w?[yw,vw,_w]:[t];function Ew(t,e){Sw(e).forEach((e=>Tw(t,e)))}function Tw(t,e){const n=t.canvas();if(n&&!t._events[e]){t._events[e]=1;n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n))}}function $w(t,e,n){return function(i){const r=this._active,o=this.pickEvent(i);if(o===r){this.fire(t,i)}else{if(!r||!r.exit){this.fire(n,i)}this._active=o;this.fire(e,i);this.fire(t,i)}}}function Dw(t){return function(e){this.fire(t,e);this._active=null}}(0,m.XW)(Mw,Qb,{initialize(t,e,n){this._canvas=t&&Yb(t,"canvas");[dw,lw,cw,fw,sw].forEach((t=>Ew(this,t)));return Qb.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:xw,DOMMouseScroll(t){this.fire(gw,t)},mousemove:$w(cw,hw,fw),dragover:$w(aw,ow,sw),mouseout:Dw(fw),dragleave:Dw(sw),mousedown(t){this._down=this._active;this.fire(lw,t)},click(t){if(this._down===this._active){this.fire(dw,t);this._down=null}},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]);if(this._first){this._active=this._touch;this._first=false}this.fire(yw,t,true)},touchmove(t){this.fire(vw,t,true)},touchend(t){this.fire(_w,t,true);this._touch=null},fire(t,e,n){const i=n?this._touch:this._active,r=this._handlers[t];e.vegaType=t;if(t===kw&&i&&i.href){this.handleHref(e,i,i.href)}else if(t===bw||t===ww){this.handleTooltip(e,i,t!==ww)}if(r){for(let t=0,n=r.length;t<n;++t){r[t].handler.call(this._obj,e,i)}}},on(t,e){const n=this.eventName(t),i=this._handlers,r=this._handlerIndex(i[n],t,e);if(r<0){Ew(this,t);(i[n]||(i[n]=[])).push({type:t,handler:e})}return this},off(t,e){const n=this.eventName(t),i=this._handlers[n],r=this._handlerIndex(i,t,e);if(r>=0){i.splice(r,1)}return this},pickEvent(t){const e=Kb(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,i,r){const o=this.context(),s=Ub[t.marktype];return s.pick.call(this,o,t,e,n,i,r)}});function Aw(){return typeof window!=="undefined"?window.devicePixelRatio||1:1}var Nw=Aw();function zw(t,e,n,i,r,o){const s=typeof HTMLElement!=="undefined"&&t instanceof HTMLElement&&t.parentNode!=null,a=t.getContext("2d"),l=s?Nw:r;t.width=e*l;t.height=n*l;for(const u in o){a[u]=o[u]}if(s&&l!==1){t.style.width=e+"px";t.style.height=n+"px"}a.pixelRatio=l;a.setTransform(l,0,0,l,l*i[0],l*i[1]);return t}function Rw(t){ew.call(this,t);this._options={};this._redraw=false;this._dirty=new r_;this._tempb=new r_}const Cw=ew.prototype;const Ow=(t,e,n)=>(new r_).set(0,0,e,n).translate(-t[0],-t[1]);function Uw(t,e,n){e.expand(1).round();if(t.pixelRatio%1){e.scale(t.pixelRatio).round().scale(1/t.pixelRatio)}e.translate(-(n[0]%1),-(n[1]%1));t.beginPath();t.rect(e.x1,e.y1,e.width(),e.height());t.clip();return e}(0,m.XW)(Rw,ew,{initialize(t,e,n,i,r,o){this._options=o||{};this._canvas=this._options.externalContext?null:rh(1,1,this._options.type);if(t&&this._canvas){Gb(t,0).appendChild(this._canvas);this._canvas.setAttribute("class","marks")}return Cw.initialize.call(this,t,e,n,i,r)},resize(t,e,n,i){Cw.resize.call(this,t,e,n,i);if(this._canvas){zw(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context)}else{const t=this._options.externalContext;if(!t)(0,m.vU)("CanvasRenderer is missing a valid canvas or context");t.scale(this._scale,this._scale);t.translate(this._origin[0],this._origin[1])}this._redraw=true;return this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;while(n){e.translate(n.x||0,n.y||0);n=n.mark.group}this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,i=this._width,r=this._height,o=this._dirty,s=Ow(n,i,r);e.save();const a=this._redraw||o.empty()?(this._redraw=false,s.expand(1)):Uw(e,s.intersect(o),n);this.clear(-n[0],-n[1],i,r);this.draw(e,t,a);e.restore();o.clear();return this},draw(t,e,n){const i=Ub[e.marktype];if(e.clip)vx(t,e);i.draw.call(this,t,e,n);if(e.clip)t.restore()},clear(t,e,n,i){const r=this._options,o=this.context();if(r.type!=="pdf"&&!r.externalContext){o.clearRect(t,e,n,i)}if(this._bgcolor!=null){o.fillStyle=this._bgcolor;o.fillRect(t,e,n,i)}}});function Pw(t,e){Qb.call(this,t,e);const n=this;n._hrefHandler=Iw(n,((t,e)=>{if(e&&e.href)n.handleHref(t,e,e.href)}));n._tooltipHandler=Iw(n,((t,e)=>{n.handleTooltip(t,e,t.type!==ww)}))}const Iw=(t,e)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i;n.vegaType=n.type;e.call(t._obj,n,i)};(0,m.XW)(Pw,Qb,{initialize(t,e,n){let i=this._svg;if(i){i.removeEventListener(kw,this._hrefHandler);i.removeEventListener(bw,this._tooltipHandler);i.removeEventListener(ww,this._tooltipHandler)}this._svg=i=t&&Yb(t,"svg");if(i){i.addEventListener(kw,this._hrefHandler);i.addEventListener(bw,this._tooltipHandler);i.addEventListener(ww,this._tooltipHandler)}return Qb.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),i=this._handlers,r=this._handlerIndex(i[n],t,e);if(r<0){const r={type:t,handler:e,listener:Iw(this,e)};(i[n]||(i[n]=[])).push(r);if(this._svg){this._svg.addEventListener(n,r.listener)}}return this},off(t,e){const n=this.eventName(t),i=this._handlers[n],r=this._handlerIndex(i,t,e);if(r>=0){if(this._svg){this._svg.removeEventListener(n,i[r].listener)}i.splice(r,1)}return this}});const qw="aria-hidden";const Lw="aria-label";const Fw="role";const jw="aria-roledescription";const Ww="graphics-object";const Xw="graphics-symbol";const Hw=(t,e,n)=>({[Fw]:t,[jw]:e,[Lw]:n||undefined});const Bw=(0,m.Rg)(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]);const Yw={axis:{desc:"axis",caption:tk},legend:{desc:"legend",caption:ek},"title-text":{desc:"title",caption:t=>`Title text '${Qw(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${Qw(t)}'`}};const Jw={ariaRole:Fw,ariaRoleDescription:jw,description:Lw};function Gw(t,e){const n=e.aria===false;t(qw,n||undefined);if(n||e.description==null){for(const e in Jw){t(Jw[e],undefined)}}else{const n=e.mark.marktype;t(Lw,e.description);t(Fw,e.ariaRole||(n==="group"?Ww:Xw));t(jw,e.ariaRoleDescription||`${n} mark`)}}function Vw(t){return t.aria===false?{[qw]:true}:Bw[t.role]?null:Yw[t.role]?Zw(t,Yw[t.role]):Kw(t)}function Kw(t){const e=t.marktype;const n=e==="group"||e==="text"||t.items.some((t=>t.description!=null&&t.aria!==false));return Hw(n?Ww:Xw,`${e} mark container`,t.description)}function Zw(t,e){try{const n=t.items[0],i=e.caption||(()=>"");return Hw(e.role||Xw,e.desc,n.description||i(n))}catch(n){return null}}function Qw(t){return(0,m.IX)(t.text).join(" ")}function tk(t){const e=t.datum,n=t.orient,i=e.title?nk(t):null,r=t.context,o=r.scales[e.scale].value,s=r.dataflow.locale(),a=o.type,l=n==="left"||n==="right"?"Y":"X";return`${l}-axis`+(i?` titled '${i}'`:"")+` for a ${Ug(a)?"discrete":a} scale`+` with ${$y(s,o,t)}`}function ek(t){const e=t.datum,n=e.title?nk(t):null,i=`${e.type||""} legend`.trim(),r=e.scales,o=Object.keys(r),s=t.context,a=s.scales[r[o[0]]].value,l=s.dataflow.locale();return rk(i)+(n?` titled '${n}'`:"")+` for ${ik(o)}`+` with ${$y(l,a,t)}`}function nk(t){try{return(0,m.IX)((0,m.fj)(t.items).items[0].text).join(" ")}catch(e){return null}}function ik(t){t=t.map((t=>t+(t==="fill"||t==="stroke"?" color":"")));return t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+(0,m.fj)(t)}function rk(t){return t.length?t[0].toUpperCase()+t.slice(1):t}const ok=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");const sk=t=>ok(t).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function ak(){let t="",e="",n="";const i=[],r=()=>e=n="",o=o=>{if(e){t+=`${e}>${n}`;r()}i.push(o)},s=(t,n)=>{if(n!=null)e+=` ${t}="${sk(n)}"`;return a},a={open(t){o(t);e="<"+t;for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++){i[r-1]=arguments[r]}for(const e of i){for(const t in e)s(t,e[t])}return a},close(){const o=i.pop();if(e){t+=e+(n?`>${n}</${o}>`:"/>")}else{t+=`</${o}>`}r();return a},attr:s,text:t=>(n+=ok(t),a),toString:()=>t};return a}const lk=t=>uk(ak(),t)+"";function uk(t,e){t.open(e.tagName);if(e.hasAttributes()){const n=e.attributes,i=n.length;for(let e=0;e<i;++e){t.attr(n[e].name,n[e].value)}}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n){e.nodeType===3?t.text(e.nodeValue):uk(t,e)}}return t.close()}const ck={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"};const fk={blend:"mix-blend-mode"};const hk={fill:"none","stroke-miterlimit":10};const dk=0,pk="http://www.w3.org/2000/xmlns/",mk=Ox.xmlns;function gk(t){ew.call(this,t);this._dirtyID=0;this._dirty=[];this._svg=null;this._root=null;this._defs=null}const yk=ew.prototype;(0,m.XW)(gk,ew,{initialize(t,e,n,i,r){this._defs={};this._clearDefs();if(t){this._svg=Jb(t,0,"svg",mk);this._svg.setAttributeNS(pk,"xmlns",mk);this._svg.setAttributeNS(pk,"xmlns:xlink",Ox["xmlns:xlink"]);this._svg.setAttribute("version",Ox["version"]);this._svg.setAttribute("class","marks");Gb(t,1);this._root=Jb(this._svg,dk,"g",mk);Dk(this._root,hk);Gb(this._svg,dk+1)}this.background(this._bgcolor);return yk.initialize.call(this,t,e,n,i,r)},background(t){if(arguments.length&&this._svg){this._svg.style.setProperty("background-color",t)}return yk.background.apply(this,arguments)},resize(t,e,n,i){yk.resize.call(this,t,e,n,i);if(this._svg){Dk(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`});this._root.setAttribute("transform",`translate(${this._origin})`)}this._dirty=[];return this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;if(e){t.removeAttribute("style");n=Jb(t,dk,"rect",mk);Dk(n,{width:this._width,height:this._height,fill:e})}const i=lk(t);if(e){t.removeChild(n);this._svg.style.setProperty("background-color",e)}return i},_render(t){if(this._dirtyCheck()){if(this._dirtyAll)this._clearDefs();this.mark(this._root,t);Gb(this._root,1)}this.defs();this._dirty=[];++this._dirtyID;return this},dirty(t){if(t.dirty!==this._dirtyID){t.dirty=this._dirtyID;this._dirty.push(t)}},isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=true;const t=this._dirty;if(!t.length||!this._dirtyID)return true;const e=++this._dirtyID;let n,i,r,o,s,a,l;for(s=0,a=t.length;s<a;++s){n=t[s];i=n.mark;if(i.marktype!==r){r=i.marktype;o=Ub[r]}if(i.zdirty&&i.dirty!==e){this._dirtyAll=false;vk(n,e);i.items.forEach((t=>{t.dirty=e}))}if(i.zdirty)continue;if(n.exit){if(o.nested&&i.items.length){l=i.items[0];if(l._svg)this._update(o,l._svg,l)}else if(n._svg){l=n._svg.parentNode;if(l)l.removeChild(n._svg)}n._svg=null;continue}n=o.nested?i.items[0]:n;if(n._update===e)continue;if(!n._svg||!n._svg.ownerSVGElement){this._dirtyAll=false;vk(n,e)}else{this._update(o,n._svg,n)}n._update=e}return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e)){return e._svg}const i=this._svg,r=Ub[e.marktype],o=e.interactive===false?"none":null,s=r.tag==="g";const a=wk(e,t,n,"g",i);a.setAttribute("class",Vb(e));const l=Vw(e);for(const h in l)Ak(a,h,l[h]);if(!s){Ak(a,"pointer-events",o)}Ak(a,"clip-path",e.clip?i_(this,e,e.group):null);let u=null,c=0;const f=t=>{const e=this.isDirty(t),n=wk(t,a,u,r.tag,i);if(e){this._update(r,n,t);if(s)bk(this,n,t)}u=n;++c};if(r.nested){if(e.items.length)f(e.items[0])}else{K_(e,f)}Gb(a,c);return a},_update(t,e,n){Mk=e;Sk=e.__values__;Gw(Tk,n);t.attr(Tk,n,this);const i=Ek[t.type];if(i)i.call(this,t,e,n);if(Mk)this.style(Mk,n)},style(t,e){if(e==null)return;for(const n in ck){let i=n==="font"?kb(e):e[n];if(i===Sk[n])continue;const r=ck[n];if(i==null){t.removeAttribute(r)}else{if(zy(i)){i=Ry(i,this._defs.gradient,zk())}t.setAttribute(r,i+"")}Sk[n]=i}for(const n in fk){$k(t,fk[n],e[n])}},defs(){const t=this._svg,e=this._defs;let n=e.el,i=0;for(const r in e.gradient){if(!n)e.el=n=Jb(t,dk+1,"defs",mk);i=_k(n,e.gradient[r],i)}for(const r in e.clipping){if(!n)e.el=n=Jb(t,dk+1,"defs",mk);i=xk(n,e.clipping[r],i)}if(n){i===0?(t.removeChild(n),e.el=null):Gb(n,i)}},_clearDefs(){const t=this._defs;t.gradient={};t.clipping={}}});function vk(t,e){for(;t&&t.dirty!==e;t=t.mark.group){t.dirty=e;if(t.mark&&t.mark.dirty!==e){t.mark.dirty=e}else return}}function _k(t,e,n){let i,r,o;if(e.gradient==="radial"){let i=Jb(t,n++,"pattern",mk);Dk(i,{id:Ny+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"});i=Jb(i,0,"rect",mk);Dk(i,{width:1,height:1,fill:`url(${zk()}#${e.id})`});t=Jb(t,n++,"radialGradient",mk);Dk(t,{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else{t=Jb(t,n++,"linearGradient",mk);Dk(t,{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2})}for(i=0,r=e.stops.length;i<r;++i){o=Jb(t,i,"stop",mk);o.setAttribute("offset",e.stops[i].offset);o.setAttribute("stop-color",e.stops[i].color)}Gb(t,i);return n}function xk(t,e,n){let i;t=Jb(t,n,"clipPath",mk);t.setAttribute("id",e.id);if(e.path){i=Jb(t,0,"path",mk);i.setAttribute("d",e.path)}else{i=Jb(t,0,"rect",mk);Dk(i,{x:0,y:0,width:e.width,height:e.height})}Gb(t,1);return n+1}function bk(t,e,n){e=e.lastChild.previousSibling;let i,r=0;K_(n,(n=>{i=t.mark(e,n,i);++r}));Gb(e,1+r)}function wk(t,e,n,i,r){let o=t._svg,s;if(!o){s=e.ownerDocument;o=Bb(s,i,mk);t._svg=o;if(t.mark){o.__data__=t;o.__values__={fill:"default"};if(i==="g"){const e=Bb(s,"path",mk);o.appendChild(e);e.__data__=t;const n=Bb(s,"g",mk);o.appendChild(n);n.__data__=t;const i=Bb(s,"path",mk);o.appendChild(i);i.__data__=t;i.__values__={fill:"default"}}}}if(o.ownerSVGElement!==r||kk(o,n)){e.insertBefore(o,n?n.nextSibling:e.firstChild)}return o}function kk(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}let Mk=null,Sk=null;const Ek={group(t,e,n){const i=Mk=e.childNodes[2];Sk=i.__values__;t.foreground(Tk,n,this);Sk=e.__values__;Mk=e.childNodes[1];t.content(Tk,n,this);const r=Mk=e.childNodes[0];t.background(Tk,n,this);const o=n.mark.interactive===false?"none":null;if(o!==Sk.events){Ak(i,"pointer-events",o);Ak(r,"pointer-events",o);Sk.events=o}if(n.strokeForeground&&n.stroke){const t=n.fill;Ak(i,"display",null);this.style(r,n);Ak(r,"stroke",null);if(t)n.fill=null;Sk=i.__values__;this.style(i,n);if(t)n.fill=t;Mk=null}else{Ak(i,"display","none")}},image(t,e,n){if(n.smooth===false){$k(e,"image-rendering","optimizeSpeed");$k(e,"image-rendering","pixelated")}else{$k(e,"image-rendering",null)}},text(t,e,n){const i=vb(n);let r,o,s,a;if((0,m.kJ)(i)){o=i.map((t=>xb(n,t)));r=o.join("\n");if(r!==Sk.text){Gb(e,0);s=e.ownerDocument;a=gb(n);o.forEach(((t,i)=>{const r=Bb(s,"tspan",mk);r.__data__=n;r.textContent=t;if(i){r.setAttribute("x",0);r.setAttribute("dy",a)}e.appendChild(r)}));Sk.text=r}}else{o=xb(n,i);if(o!==Sk.text){e.textContent=o;Sk.text=o}}Ak(e,"font-family",kb(n));Ak(e,"font-size",mb(n)+"px");Ak(e,"font-style",n.fontStyle);Ak(e,"font-variant",n.fontVariant);Ak(e,"font-weight",n.fontWeight)}};function Tk(t,e,n){if(e===Sk[t])return;if(n){Nk(Mk,t,e,n)}else{Ak(Mk,t,e)}Sk[t]=e}function $k(t,e,n){if(n!==Sk[e]){if(n==null){t.style.removeProperty(e)}else{t.style.setProperty(e,n+"")}Sk[e]=n}}function Dk(t,e){for(const n in e){Ak(t,n,e[n])}}function Ak(t,e,n){if(n!=null){t.setAttribute(e,n)}else{t.removeAttribute(e)}}function Nk(t,e,n,i){if(n!=null){t.setAttributeNS(i,e,n)}else{t.removeAttributeNS(i,e)}}function zk(){let t;return typeof window==="undefined"?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function Rk(t){ew.call(this,t);this._text=null;this._defs={gradient:{},clipping:{}}}(0,m.XW)(Rk,ew,{svg(){return this._text},_render(t){const e=ak();e.open("svg",(0,m.l7)({},Ox,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;if(n&&n!=="transparent"&&n!=="none"){e.open("rect",{width:this._width,height:this._height,fill:n}).close()}e.open("g",hk,{transform:"translate("+this._origin+")"});this.mark(e,t);e.close();this.defs(e);this._text=e.close()+"";return this},mark(t,e){const n=Ub[e.marktype],i=n.tag,r=[Gw,n.attr];t.open("g",{class:Vb(e),"clip-path":e.clip?i_(this,e,e.group):null},Vw(e),{"pointer-events":i!=="g"&&e.interactive===false?"none":null});const o=o=>{const s=this.href(o);if(s)t.open("a",s);t.open(i,this.attr(e,o,r,i!=="g"?i:null));if(i==="text"){const e=vb(o);if((0,m.kJ)(e)){const n={x:0,dy:gb(o)};for(let i=0;i<e.length;++i){t.open("tspan",i?n:null).text(xb(o,e[i])).close()}}else{t.text(xb(o,e))}}else if(i==="g"){const i=o.strokeForeground,r=o.fill,s=o.stroke;if(i&&s){o.stroke=null}t.open("path",this.attr(e,o,n.background,"bgrect")).close();t.open("g",this.attr(e,o,n.content));K_(o,(e=>this.mark(t,e)));t.close();if(i&&s){if(r)o.fill=null;o.stroke=s;t.open("path",this.attr(e,o,n.foreground,"bgrect")).close();if(r)o.fill=r}else{t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}}t.close();if(s)t.close()};if(n.nested){if(e.items&&e.items.length)o(e.items[0])}else{K_(e,o)}return t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e]){return n}else{this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href;t.href=null;(this._hrefs||(this._hrefs={}))[e]=t}))}}return null},attr(t,e,n,i){const r={},o=(t,e,n,i)=>{r[i||t]=e};if(Array.isArray(n)){n.forEach((t=>t(o,e,this)))}else{n(o,e,this)}if(i){Ck(r,e,t,i,this._defs)}return r},defs(t){const e=this._defs.gradient,n=this._defs.clipping,i=Object.keys(e).length+Object.keys(n).length;if(i===0)return;t.open("defs");for(const r in e){const n=e[r],i=n.stops;if(n.gradient==="radial"){t.open("pattern",{id:Ny+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"});t.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close();t.close();t.open("radialGradient",{id:r,fx:n.x1,fy:n.y1,fr:n.r1,cx:n.x2,cy:n.y2,r:n.r2})}else{t.open("linearGradient",{id:r,x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2})}for(let e=0;e<i.length;++e){t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close()}t.close()}for(const r in n){const e=n[r];t.open("clipPath",{id:r});if(e.path){t.open("path",{d:e.path}).close()}else{t.open("rect",{x:0,y:0,width:e.width,height:e.height}).close()}t.close()}t.close()}});function Ck(t,e,n,i,r){let o;if(e==null)return t;if(i==="bgrect"&&n.interactive===false){t["pointer-events"]="none"}if(i==="bgfore"){if(n.interactive===false){t["pointer-events"]="none"}t.display="none";if(e.fill!==null)return t}if(i==="image"&&e.smooth===false){o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]}if(i==="text"){t["font-family"]=kb(e);t["font-size"]=mb(e)+"px";t["font-style"]=e.fontStyle;t["font-variant"]=e.fontVariant;t["font-weight"]=e.fontWeight}for(const s in ck){let n=e[s];const i=ck[s];if(n==="transparent"&&(i==="fill"||i==="stroke"));else if(n!=null){if(zy(n)){n=Ry(n,r.gradient,"")}t[i]=n}}for(const s in fk){const t=e[s];if(t!=null){o=o||[];o.push(`${fk[s]}: ${t};`)}}if(o){t.style=o.join(" ")}return t}const Ok="canvas";const Uk="png";const Pk="svg";const Ik="none";const qk={Canvas:Ok,PNG:Uk,SVG:Pk,None:Ik};const Lk={};Lk[Ok]=Lk[Uk]={renderer:Rw,headless:Rw,handler:Mw};Lk[Pk]={renderer:gk,headless:Rk,handler:Pw};Lk[Ik]={};function Fk(t,e){t=String(t||"").toLowerCase();if(arguments.length>1){Lk[t]=e;return this}else{return Lk[t]}}function jk(t,e,n){const i=[],r=(new r_).union(e),o=t.marktype;return o?Wk(t,r,n,i):o==="group"?Hk(t,r,n,i):(0,m.vU)("Intersect scene must be mark node or group item.")}function Wk(t,e,n,i){if(Xk(t,e,n)){const r=t.items,o=t.marktype,s=r.length;let a=0;if(o==="group"){for(;a<s;++a){Hk(r[a],e,n,i)}}else{for(const t=Ub[o].isect;a<s;++a){const n=r[a];if(Bk(n,e,t))i.push(n)}}}return i}function Xk(t,e,n){return t.bounds&&e.intersects(t.bounds)&&(t.marktype==="group"||t.interactive!==false&&(!n||n(t)))}function Hk(t,e,n,i){if(n&&n(t.mark)&&Bk(t,e,Ub.group.isect)){i.push(t)}const r=t.items,o=r&&r.length;if(o){const s=t.x||0,a=t.y||0;e.translate(-s,-a);for(let t=0;t<o;++t){Wk(r[t],e,n,i)}e.translate(s,a)}return i}function Bk(t,e,n){const i=t.bounds;return e.encloses(i)||e.intersects(i)&&n(t,e)}const Yk=new r_;function Jk(t){const e=t.clip;if((0,m.mf)(e)){e(D_(Yk.clear()))}else if(e){Yk.set(0,0,t.group.width,t.group.height)}else return;t.bounds.intersect(Yk)}const Gk=1e-9;function Vk(t,e,n){return t===e?true:n==="path"?Kk(t,e):t instanceof Date&&e instanceof Date?+t===+e:(0,m.hj)(t)&&(0,m.hj)(e)?Math.abs(t-e)<=Gk:!t||!e||!(0,m.Kn)(t)&&!(0,m.Kn)(e)?t==e:Zk(t,e)}function Kk(t,e){return Vk(Wy(t),Wy(e))}function Zk(t,e){var n=Object.keys(t),i=Object.keys(e),r,o;if(n.length!==i.length)return false;n.sort();i.sort();for(o=n.length-1;o>=0;o--){if(n[o]!=i[o])return false}for(o=n.length-1;o>=0;o--){r=n[o];if(!Vk(t[r],e[r],r))return false}return typeof t===typeof e}function Qk(){n_();Ay()}const tM="top";const eM="left";const nM="right";const iM="bottom";const rM="top-left";const oM="top-right";const sM="bottom-left";const aM="bottom-right";const lM="start";const uM="middle";const cM="end";const fM="x";const hM="y";const dM="group";const pM="axis";const mM="title";const gM="frame";const yM="scope";const vM="legend";const _M="row-header";const xM="row-footer";const bM="row-title";const wM="column-header";const kM="column-footer";const MM="column-title";const SM="padding";const EM="symbol";const TM="fit";const $M="fit-x";const DM="fit-y";const AM="pad";const NM="none";const zM="all";const RM="each";const CM="flush";const OM="column";const UM="row";function PM(t){Us.call(this,null,t)}(0,m.XW)(PM,Us,{transform(t,e){const n=e.dataflow,i=t.mark,r=i.marktype,o=Ub[r],s=o.bound;let a=i.bounds,l;if(o.nested){if(i.items.length)n.dirty(i.items[0]);a=IM(i,s);i.items.forEach((t=>{t.bounds.clear().union(a)}))}else if(r===dM||t.modified()){e.visit(e.MOD,(t=>n.dirty(t)));a.clear();i.items.forEach((t=>a.union(IM(t,s))));switch(i.role){case pM:case vM:case mM:e.reflow()}}else{l=e.changed(e.REM);e.visit(e.ADD,(t=>{a.union(IM(t,s))}));e.visit(e.MOD,(t=>{l=l||a.alignsWith(t.bounds);n.dirty(t);a.union(IM(t,s))}));if(l){a.clear();i.items.forEach((t=>a.union(t.bounds)))}}Jk(i);return e.modifies("bounds")}});function IM(t,e,n){return e(t.bounds.clear(),t,n)}const qM=":vega_identifier:";function LM(t){Us.call(this,0,t)}LM.Definition={type:"Identifier",metadata:{modifies:true},params:[{name:"as",type:"string",required:true}]};(0,m.XW)(LM,Us,{transform(t,e){const n=FM(e.dataflow),i=t.as;let r=n.value;e.visit(e.ADD,(t=>t[i]=t[i]||++r));n.set(this.value=r);return e}});function FM(t){return t._signals[qM]||(t._signals[qM]=t.add(0))}function jM(t){Us.call(this,null,t)}(0,m.XW)(jM,Us,{transform(t,e){let n=this.value;if(!n){n=e.dataflow.scenegraph().mark(t.markdef,WM(t),t.index);n.group.context=t.context;if(!t.context.group)t.context.group=n.group;n.source=this.source;n.clip=t.clip;n.interactive=t.interactive;this.value=n}const i=n.marktype===dM?s_:o_;e.visit(e.ADD,(t=>i.call(t,n)));if(t.modified("clip")||t.modified("interactive")){n.clip=t.clip;n.interactive=!!t.interactive;n.zdirty=true;e.reflow()}n.items=e.source;return e}});function WM(t){const e=t.groups,n=t.parent;return e&&e.size===1?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}function XM(t){Us.call(this,null,t)}const HM={parity:t=>t.filter(((t,e)=>e%2?t.opacity=0:1)),greedy:(t,e)=>{let n;return t.filter(((t,i)=>!i||!BM(n.bounds,t.bounds,e)?(n=t,1):t.opacity=0))}};const BM=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2);const YM=(t,e)=>{for(var n=1,i=t.length,r=t[0].bounds,o;n<i;r=o,++n){if(BM(r,o=t[n].bounds,e))return true}};const JM=t=>{const e=t.bounds;return e.width()>1&&e.height()>1};const GM=(t,e,n)=>{var i=t.range(),r=new r_;if(e===tM||e===iM){r.set(i[0],-Infinity,i[1],+Infinity)}else{r.set(-Infinity,i[0],+Infinity,i[1])}r.expand(n||1);return t=>r.encloses(t.bounds)};const VM=t=>{t.forEach((t=>t.opacity=1));return t};const KM=(t,e)=>t.reflow(e.modified()).modifies("opacity");(0,m.XW)(XM,Us,{transform(t,e){const n=HM[t.method]||HM.parity,i=t.separation||0;let r=e.materialize(e.SOURCE).source,o,s;if(!r||!r.length)return;if(!t.method){if(t.modified("method")){VM(r);e=KM(e,t)}return e}r=r.filter(JM);if(!r.length)return;if(t.sort){r=r.slice().sort(t.sort)}o=VM(r);e=KM(e,t);if(o.length>=3&&YM(o,i)){do{o=n(o,i)}while(o.length>=3&&YM(o,i));if(o.length<3&&!(0,m.fj)(r).opacity){if(o.length>1)(0,m.fj)(o).opacity=0;(0,m.fj)(r).opacity=1}}if(t.boundScale&&t.boundTolerance>=0){s=GM(t.boundScale,t.boundOrient,+t.boundTolerance);r.forEach((t=>{if(!s(t))t.opacity=0}))}const a=o[0].mark.bounds.clear();r.forEach((t=>{if(t.opacity)a.union(t.bounds)}));return e}});function ZM(t){Us.call(this,null,t)}(0,m.XW)(ZM,Us,{transform(t,e){const n=e.dataflow;e.visit(e.ALL,(t=>n.dirty(t)));if(e.fields&&e.fields["zindex"]){const t=e.source&&e.source[0];if(t)t.mark.zdirty=true}}});const QM=new r_;function tS(t,e,n){return t[e]===n?0:(t[e]=n,1)}function eS(t){var e=t.items[0].orient;return e===eM||e===nM}function nS(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}function iS(t,e,n,i){var r=e.items[0],o=r.datum,s=r.translate!=null?r.translate:.5,a=r.orient,l=nS(o),u=r.range,c=r.offset,f=r.position,h=r.minExtent,d=r.maxExtent,p=o.title&&r.items[l[2]].items[0],m=r.titlePadding,g=r.bounds,y=p&&_b(p),v=0,_=0,x,b;QM.clear().union(g);g.clear();if((x=l[0])>-1)g.union(r.items[x].bounds);if((x=l[1])>-1)g.union(r.items[x].bounds);switch(a){case tM:v=f||0;_=-c;b=Math.max(h,Math.min(d,-g.y1));g.add(0,-b).add(u,0);if(p)rS(t,p,b,m,y,0,-1,g);break;case eM:v=-c;_=f||0;b=Math.max(h,Math.min(d,-g.x1));g.add(-b,0).add(0,u);if(p)rS(t,p,b,m,y,1,-1,g);break;case nM:v=n+c;_=f||0;b=Math.max(h,Math.min(d,g.x2));g.add(0,0).add(b,u);if(p)rS(t,p,b,m,y,1,1,g);break;case iM:v=f||0;_=i+c;b=Math.max(h,Math.min(d,g.y2));g.add(0,0).add(u,b);if(p)rS(t,p,b,m,0,0,1,g);break;default:v=r.x;_=r.y}c_(g.translate(v,_),r);if(tS(r,"x",v+s)|tS(r,"y",_+s)){r.bounds=QM;t.dirty(r);r.bounds=g;t.dirty(r)}return r.mark.bounds.clear().union(g)}function rS(t,e,n,i,r,o,s,a){const l=e.bounds;if(e.auto){const a=s*(n+r+i);let u=0,c=0;t.dirty(e);o?u=(e.x||0)-(e.x=a):c=(e.y||0)-(e.y=a);e.mark.bounds.clear().union(l.translate(-u,-c));t.dirty(e)}a.union(l)}const oS=(t,e)=>Math.floor(Math.min(t,e));const sS=(t,e)=>Math.ceil(Math.max(t,e));function aS(t){var e=t.items,n=e.length,i=0,r,o;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i){r=e[i];o=r.items;if(r.marktype===dM){switch(r.role){case pM:case vM:case mM:break;case _M:s.rowheaders.push(...o);break;case xM:s.rowfooters.push(...o);break;case wM:s.colheaders.push(...o);break;case kM:s.colfooters.push(...o);break;case bM:s.rowtitle=o[0];break;case MM:s.coltitle=o[0];break;default:s.marks.push(...o)}}}return s}function lS(t){return(new r_).set(0,0,t.width||0,t.height||0)}function uS(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function cS(t,e,n){const i=(0,m.Kn)(t)?t[e]:t;return i!=null?i:n!==undefined?n:0}function fS(t){return t<0?Math.ceil(-t):0}function hS(t,e,n){var i=!n.nodirty,r=n.bounds===CM?lS:uS,o=QM.set(0,0,0,0),s=cS(n.align,OM),a=cS(n.align,UM),l=cS(n.padding,OM),u=cS(n.padding,UM),c=n.columns||e.length,f=c<=0?1:Math.ceil(e.length/c),h=e.length,d=Array(h),p=Array(c),m=0,g=Array(h),y=Array(f),v=0,_=Array(h),x=Array(h),b=Array(h),w,k,M,S,E,T,$,D,A,N,z;for(k=0;k<c;++k)p[k]=0;for(k=0;k<f;++k)y[k]=0;for(k=0;k<h;++k){T=e[k];E=b[k]=r(T);T.x=T.x||0;_[k]=0;T.y=T.y||0;x[k]=0;M=k%c;S=~~(k/c);m=Math.max(m,$=Math.ceil(E.x2));v=Math.max(v,D=Math.ceil(E.y2));p[M]=Math.max(p[M],$);y[S]=Math.max(y[S],D);d[k]=l+fS(E.x1);g[k]=u+fS(E.y1);if(i)t.dirty(e[k])}for(k=0;k<h;++k){if(k%c===0)d[k]=0;if(k<c)g[k]=0}if(s===RM){for(M=1;M<c;++M){for(z=0,k=M;k<h;k+=c){if(z<d[k])z=d[k]}for(k=M;k<h;k+=c){d[k]=z+p[M-1]}}}else if(s===zM){for(z=0,k=0;k<h;++k){if(k%c&&z<d[k])z=d[k]}for(k=0;k<h;++k){if(k%c)d[k]=z+m}}else{for(s=false,M=1;M<c;++M){for(k=M;k<h;k+=c){d[k]+=p[M-1]}}}if(a===RM){for(S=1;S<f;++S){for(z=0,k=S*c,w=k+c;k<w;++k){if(z<g[k])z=g[k]}for(k=S*c;k<w;++k){g[k]=z+y[S-1]}}}else if(a===zM){for(z=0,k=c;k<h;++k){if(z<g[k])z=g[k]}for(k=c;k<h;++k){g[k]=z+v}}else{for(a=false,S=1;S<f;++S){for(k=S*c,w=k+c;k<w;++k){g[k]+=y[S-1]}}}for(A=0,k=0;k<h;++k){A=d[k]+(k%c?A:0);_[k]+=A-e[k].x}for(M=0;M<c;++M){for(N=0,k=M;k<h;k+=c){N+=g[k];x[k]+=N-e[k].y}}if(s&&cS(n.center,OM)&&f>1){for(k=0;k<h;++k){E=s===zM?m:p[k%c];A=E-b[k].x2-e[k].x-_[k];if(A>0)_[k]+=A/2}}if(a&&cS(n.center,UM)&&c!==1){for(k=0;k<h;++k){E=a===zM?v:y[~~(k/c)];N=E-b[k].y2-e[k].y-x[k];if(N>0)x[k]+=N/2}}for(k=0;k<h;++k){o.union(b[k].translate(_[k],x[k]))}A=cS(n.anchor,fM);N=cS(n.anchor,hM);switch(cS(n.anchor,OM)){case cM:A-=o.width();break;case uM:A-=o.width()/2}switch(cS(n.anchor,UM)){case cM:N-=o.height();break;case uM:N-=o.height()/2}A=Math.round(A);N=Math.round(N);o.clear();for(k=0;k<h;++k){e[k].mark.bounds.clear()}for(k=0;k<h;++k){T=e[k];T.x+=_[k]+=A;T.y+=x[k]+=N;o.union(T.mark.bounds.union(T.bounds.translate(_[k],x[k])));if(i)t.dirty(T)}return o}function dS(t,e,n){var i=aS(e),r=i.marks,o=n.bounds===CM?pS:mS,s=n.offset,a=n.columns||r.length,l=a<=0?1:Math.ceil(r.length/a),u=l*a,c,f,h,d,p,m,g;const y=hS(t,r,n);if(y.empty())y.set(0,0,0,0);if(i.rowheaders){m=cS(n.headerBand,UM,null);c=gS(t,i.rowheaders,r,a,l,-cS(s,"rowHeader"),oS,0,o,"x1",0,a,1,m)}if(i.colheaders){m=cS(n.headerBand,OM,null);f=gS(t,i.colheaders,r,a,a,-cS(s,"columnHeader"),oS,1,o,"y1",0,1,a,m)}if(i.rowfooters){m=cS(n.footerBand,UM,null);h=gS(t,i.rowfooters,r,a,l,cS(s,"rowFooter"),sS,0,o,"x2",a-1,a,1,m)}if(i.colfooters){m=cS(n.footerBand,OM,null);d=gS(t,i.colfooters,r,a,a,cS(s,"columnFooter"),sS,1,o,"y2",u-a,1,a,m)}if(i.rowtitle){p=cS(n.titleAnchor,UM);g=cS(s,"rowTitle");g=p===cM?h+g:c-g;m=cS(n.titleBand,UM,.5);yS(t,i.rowtitle,g,0,y,m)}if(i.coltitle){p=cS(n.titleAnchor,OM);g=cS(s,"columnTitle");g=p===cM?d+g:f-g;m=cS(n.titleBand,OM,.5);yS(t,i.coltitle,g,1,y,m)}}function pS(t,e){return e==="x1"?t.x||0:e==="y1"?t.y||0:e==="x2"?(t.x||0)+(t.width||0):e==="y2"?(t.y||0)+(t.height||0):undefined}function mS(t,e){return t.bounds[e]}function gS(t,e,n,i,r,o,s,a,l,u,c,f,h,d){var p=n.length,m=0,g=0,y,v,_,x,b,w,k,M,S;if(!p)return m;for(y=c;y<p;y+=f){if(n[y])m=s(m,l(n[y],u))}if(!e.length)return m;if(e.length>r){t.warn("Grid headers exceed limit: "+r);e=e.slice(0,r)}m+=o;for(v=0,x=e.length;v<x;++v){t.dirty(e[v]);e[v].mark.bounds.clear()}for(y=c,v=0,x=e.length;v<x;++v,y+=f){w=e[v];b=w.mark.bounds;for(_=y;_>=0&&(k=n[_])==null;_-=h);if(a){M=d==null?k.x:Math.round(k.bounds.x1+d*k.bounds.width());S=m}else{M=m;S=d==null?k.y:Math.round(k.bounds.y1+d*k.bounds.height())}b.union(w.bounds.translate(M-(w.x||0),S-(w.y||0)));w.x=M;w.y=S;t.dirty(w);g=s(g,b[u])}return g}function yS(t,e,n,i,r,o){if(!e)return;t.dirty(e);var s=n,a=n;i?s=Math.round(r.x1+o*r.width()):a=Math.round(r.y1+o*r.height());e.bounds.translate(s-(e.x||0),a-(e.y||0));e.mark.bounds.clear().union(e.bounds);e.x=s;e.y=a;t.dirty(e)}function vS(t,e){const n=t[e]||{};return(e,i)=>n[e]!=null?n[e]:t[e]!=null?t[e]:i}function _S(t,e){let n=-Infinity;t.forEach((t=>{if(t.offset!=null)n=Math.max(n,t.offset)}));return n>-Infinity?n:e}function xS(t,e,n,i,r,o,s){const a=vS(n,e),l=_S(t,a("offset",0)),u=a("anchor",lM),c=u===cM?1:u===uM?.5:0;const f={align:RM,bounds:a("bounds",CM),columns:a("direction")==="vertical"?1:t.length,padding:a("margin",8),center:a("center"),nodirty:true};switch(e){case eM:f.anchor={x:Math.floor(i.x1)-l,column:cM,y:c*(s||i.height()+2*i.y1),row:u};break;case nM:f.anchor={x:Math.ceil(i.x2)+l,y:c*(s||i.height()+2*i.y1),row:u};break;case tM:f.anchor={y:Math.floor(r.y1)-l,row:cM,x:c*(o||r.width()+2*r.x1),column:u};break;case iM:f.anchor={y:Math.ceil(r.y2)+l,x:c*(o||r.width()+2*r.x1),column:u};break;case rM:f.anchor={x:l,y:l};break;case oM:f.anchor={x:o-l,y:l,column:cM};break;case sM:f.anchor={x:l,y:s-l,row:cM};break;case aM:f.anchor={x:o-l,y:s-l,column:cM,row:cM};break}return f}function bS(t,e){var n=e.items[0],i=n.datum,r=n.orient,o=n.bounds,s=n.x,a=n.y,l,u;n._bounds?n._bounds.clear().union(o):n._bounds=o.clone();o.clear();kS(t,n,n.items[0].items[0]);o=wS(n,o);l=2*n.padding;u=2*n.padding;if(!o.empty()){l=Math.ceil(o.width()+l);u=Math.ceil(o.height()+u)}if(i.type===EM){ES(n.items[0].items[0].items[0].items)}if(r!==NM){n.x=s=0;n.y=a=0}n.width=l;n.height=u;c_(o.set(s,a,s+l,a+u),n);n.mark.bounds.clear().union(o);return n}function wS(t,e){t.items.forEach((t=>e.union(t.bounds)));e.x1=t.padding;e.y1=t.padding;return e}function kS(t,e,n){var i=e.padding,r=i-n.x,o=i-n.y;if(!e.datum.title){if(r||o)SS(t,n,r,o)}else{var s=e.items[1].items[0],a=s.anchor,l=e.titlePadding||0,u=i-s.x,c=i-s.y;switch(s.orient){case eM:r+=Math.ceil(s.bounds.width())+l;break;case nM:case iM:break;default:o+=s.bounds.height()+l}if(r||o)SS(t,n,r,o);switch(s.orient){case eM:c+=MS(e,n,s,a,1,1);break;case nM:u+=MS(e,n,s,cM,0,0)+l;c+=MS(e,n,s,a,1,1);break;case iM:u+=MS(e,n,s,a,0,0);c+=MS(e,n,s,cM,-1,0,1)+l;break;default:u+=MS(e,n,s,a,0,0)}if(u||c)SS(t,s,u,c);if((u=Math.round(s.bounds.x1-i))<0){SS(t,n,-u,0);SS(t,s,-u,0)}}}function MS(t,e,n,i,r,o,s){const a=t.datum.type!=="symbol",l=n.datum.vgrad,u=a&&(o||!l)&&!s?e.items[0]:e,c=u.bounds[r?"y2":"x2"]-t.padding,f=l&&o?c:0,h=l&&o?0:c,d=r<=0?0:_b(n);return Math.round(i===lM?f:i===cM?h-d:.5*(c-d))}function SS(t,e,n,i){e.x+=n;e.y+=i;e.bounds.translate(n,i);e.mark.bounds.translate(n,i);t.dirty(e)}function ES(t){const e=t.reduce(((t,e)=>{t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0);return t}),{});t.forEach((t=>{t.width=e[t.column];t.height=t.bounds.y2-t.y}))}function TS(t,e,n,i,r){var o=e.items[0],s=o.frame,a=o.orient,l=o.anchor,u=o.offset,c=o.padding,f=o.items[0].items[0],h=o.items[1]&&o.items[1].items[0],d=a===eM||a===nM?i:n,p=0,m=0,g=0,y=0,v=0,_;if(s!==dM){a===eM?(p=r.y2,d=r.y1):a===nM?(p=r.y1,d=r.y2):(p=r.x1,d=r.x2)}else if(a===eM){p=i,d=0}_=l===lM?p:l===cM?d:(p+d)/2;if(h&&h.text){switch(a){case tM:case iM:v=f.bounds.height()+c;break;case eM:y=f.bounds.width()+c;break;case nM:y=-f.bounds.width()-c;break}QM.clear().union(h.bounds);QM.translate(y-(h.x||0),v-(h.y||0));if(tS(h,"x",y)|tS(h,"y",v)){t.dirty(h);h.bounds.clear().union(QM);h.mark.bounds.clear().union(QM);t.dirty(h)}QM.clear().union(h.bounds)}else{QM.clear()}QM.union(f.bounds);switch(a){case tM:m=_;g=r.y1-QM.height()-u;break;case eM:m=r.x1-QM.width()-u;g=_;break;case nM:m=r.x2+QM.width()+u;g=_;break;case iM:m=_;g=r.y2+u;break;default:m=o.x;g=o.y}if(tS(o,"x",m)|tS(o,"y",g)){QM.translate(m,g);t.dirty(o);o.bounds.clear().union(QM);e.bounds.clear().union(QM);t.dirty(o)}return o.bounds}function $S(t){Us.call(this,null,t)}(0,m.XW)($S,Us,{transform(t,e){const n=e.dataflow;t.mark.items.forEach((e=>{if(t.layout)dS(n,e,t.layout);AS(n,e,t)}));return DS(t.mark.group)?e.reflow():e}});function DS(t){return t&&t.mark.role!=="legend-entry"}function AS(t,e,n){var i=e.items,r=Math.max(0,e.width||0),o=Math.max(0,e.height||0),s=(new r_).set(0,0,r,o),a=s.clone(),l=s.clone(),u=[],c,f,h,d,p,m;for(p=0,m=i.length;p<m;++p){f=i[p];switch(f.role){case pM:d=eS(f)?a:l;d.union(iS(t,f,r,o));break;case mM:c=f;break;case vM:u.push(bS(t,f));break;case gM:case yM:case _M:case xM:case bM:case wM:case kM:case MM:a.union(f.bounds);l.union(f.bounds);break;default:s.union(f.bounds)}}if(u.length){const e={};u.forEach((t=>{h=t.orient||nM;if(h!==NM)(e[h]||(e[h]=[])).push(t)}));for(const i in e){const s=e[i];hS(t,s,xS(s,i,n.legends,a,l,r,o))}u.forEach((e=>{const i=e.bounds;if(!i.equals(e._bounds)){e.bounds=e._bounds;t.dirty(e);e.bounds=i;t.dirty(e)}if(n.autosize&&(n.autosize.type===TM||n.autosize.type===$M||n.autosize.type===DM)){switch(e.orient){case eM:case nM:s.add(i.x1,0).add(i.x2,0);break;case tM:case iM:s.add(0,i.y1).add(0,i.y2)}}else{s.union(i)}}))}s.union(a).union(l);if(c){s.union(TS(t,c,r,o,s))}if(e.clip){s.set(0,0,e.width||0,e.height||0)}NS(t,e,s,n)}function NS(t,e,n,i){const r=i.autosize||{},o=r.type;if(t._autosize<1||!o)return;let s=t._width,a=t._height,l=Math.max(0,e.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,e.height||0),f=Math.max(0,Math.ceil(-n.y1));const h=Math.max(0,Math.ceil(n.x2-l)),d=Math.max(0,Math.ceil(n.y2-c));if(r.contains===SM){const e=t.padding();s-=e.left+e.right;a-=e.top+e.bottom}if(o===NM){u=0;f=0;l=s;c=a}else if(o===TM){l=Math.max(0,s-u-h);c=Math.max(0,a-f-d)}else if(o===$M){l=Math.max(0,s-u-h);a=c+f+d}else if(o===DM){s=l+u+h;c=Math.max(0,a-f-d)}else if(o===AM){s=l+u+h;a=c+f+d}t._resizeView(s,a,l,c,[u,f],r.resize)}function zS(t,e){let n=0;if(e===undefined){for(let e of t){if(e=+e){n+=e}}}else{let i=-1;for(let r of t){if(r=+e(r,++i,t)){n+=r}}}return n}function RS(t){Us.call(this,null,t)}(0,m.XW)(RS,Us,{transform(t,e){if(this.value&&!t.modified()){return e.StopPropagation}var n=e.dataflow.locale(),i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=this.value,o=t.scale,s=t.count==null?t.values?t.values.length:10:t.count,a=ly(o,s,t.minstep),l=t.format||fy(n,o,a,t.formatSpecifier,t.formatType,!!t.values),u=t.values?uy(o,t.values,a):cy(o,a);if(r)i.rem=r;r=u.map(((t,e)=>ko({index:e/(u.length-1||1),value:t,label:l(t)})));if(t.extra&&r.length){r.push(ko({index:-1,extra:{value:r[0].value},label:""}))}i.source=r;i.add=r;this.value=r;return i}});function CS(t){Us.call(this,null,t)}function OS(){return ko({})}function US(t){const e=(0,m.Xr)().test((t=>t.exit));e.lookup=n=>e.get(t(n));return e}(0,m.XW)(CS,Us,{transform(t,e){var n=e.dataflow,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.item||OS,o=t.key||bo,s=this.value;if((0,m.kJ)(i.encode)){i.encode=null}if(s&&(t.modified("key")||e.modified(o))){(0,m.vU)("DataJoin does not support modified key function or fields.")}if(!s){e=e.addAll();this.value=s=US(o)}e.visit(e.ADD,(t=>{const e=o(t);let n=s.get(e);if(n){if(n.exit){s.empty--;i.add.push(n)}else{i.mod.push(n)}}else{n=r(t);s.set(e,n);i.add.push(n)}n.datum=t;n.exit=false}));e.visit(e.MOD,(t=>{const e=o(t),n=s.get(e);if(n){n.datum=t;i.mod.push(n)}}));e.visit(e.REM,(t=>{const e=o(t),n=s.get(e);if(t===n.datum&&!n.exit){i.rem.push(n);n.exit=true;++s.empty}}));if(e.changed(e.ADD_MOD))i.modifies("datum");if(e.clean()||t.clean&&s.empty>n.cleanThreshold){n.runAfter(s.clean)}return i}});function PS(t){Us.call(this,null,t)}(0,m.XW)(PS,Us,{transform(t,e){var n=e.fork(e.ADD_REM),i=t.mod||false,r=t.encoders,o=e.encode;if((0,m.kJ)(o)){if(n.changed()||o.every((t=>r[t]))){o=o[0];n.encode=null}else{return e.StopPropagation}}var s=o==="enter",a=r.update||m.k,l=r.enter||m.k,u=r.exit||m.k,c=(o&&!s?r[o]:a)||m.k;if(e.changed(e.ADD)){e.visit(e.ADD,(e=>{l(e,t);a(e,t)}));n.modifies(l.output);n.modifies(a.output);if(c!==m.k&&c!==a){e.visit(e.ADD,(e=>{c(e,t)}));n.modifies(c.output)}}if(e.changed(e.REM)&&u!==m.k){e.visit(e.REM,(e=>{u(e,t)}));n.modifies(u.output)}if(s||c!==m.k){const r=e.MOD|(t.modified()?e.REFLOW:0);if(s){e.visit(r,(e=>{const r=l(e,t)||i;if(c(e,t)||r)n.mod.push(e)}));if(n.mod.length)n.modifies(l.output)}else{e.visit(r,(e=>{if(c(e,t)||i)n.mod.push(e)}))}if(n.mod.length)n.modifies(c.output)}return n.changed()?n:e.StopPropagation}});function IS(t){Us.call(this,[],t)}(0,m.XW)(IS,Us,{transform(t,e){if(this.value!=null&&!t.modified()){return e.StopPropagation}var n=e.dataflow.locale(),i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=this.value,o=t.type||ny,s=t.scale,a=+t.limit,l=ly(s,t.count==null?5:t.count,t.minstep),u=!!t.values||o===ny,c=t.format||xy(n,s,l,o,t.formatSpecifier,t.formatType,u),f=t.values||my(s,l),h,d,p,g,y;if(r)i.rem=r;if(o===ny){if(a&&f.length>a){e.dataflow.warn("Symbol legend count exceeds limit, filtering items.");r=f.slice(0,a-1);y=true}else{r=f}if((0,m.mf)(p=t.size)){if(!t.values&&s(r[0])===0){r=r.slice(1)}g=r.reduce(((e,n)=>Math.max(e,p(n,t))),0)}else{p=(0,m.a9)(g=p||8)}r=r.map(((e,n)=>ko({index:n,label:c(e,n,r),value:e,offset:g,size:p(e,t)})));if(y){y=f[r.length];r.push(ko({index:r.length,label:`…${f.length-r.length} entries`,value:y,offset:g,size:p(y,t)}))}}else if(o===ry){h=s.domain(),d=Yg(s,h[0],(0,m.fj)(h));if(f.length<3&&!t.values&&h[0]!==(0,m.fj)(h)){f=[h[0],(0,m.fj)(h)]}r=f.map(((t,e)=>ko({index:e,label:c(t,e,f),value:t,perc:d(t)})))}else{p=f.length-1;d=Ey(s);r=f.map(((t,e)=>ko({index:e,label:c(t,e,f),value:t,perc:e?d(t):0,perc2:e===p?1:d(f[e+1])})))}i.source=r;i.add=r;this.value=r;return i}});const qS=t=>t.source.x;const LS=t=>t.source.y;const FS=t=>t.target.x;const jS=t=>t.target.y;function WS(t){Us.call(this,{},t)}WS.Definition={type:"LinkPath",metadata:{modifies:true},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};(0,m.XW)(WS,Us,{transform(t,e){var n=t.sourceX||qS,i=t.sourceY||LS,r=t.targetX||FS,o=t.targetY||jS,s=t.as||"path",a=t.orient||"vertical",l=t.shape||"line",u=nE.get(l+"-"+a)||nE.get(l);if(!u){(0,m.vU)("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:""))}e.visit(e.SOURCE,(t=>{t[s]=u(n(t),i(t),r(t),o(t))}));return e.reflow(t.modified()).modifies(s)}});const XS=(t,e,n,i)=>"M"+t+","+e+"L"+n+","+i;const HS=(t,e,n,i)=>XS(e*Math.cos(t),e*Math.sin(t),i*Math.cos(n),i*Math.sin(n));const BS=(t,e,n,i)=>{var r=n-t,o=i-e,s=Math.sqrt(r*r+o*o)/2,a=180*Math.atan2(o,r)/Math.PI;return"M"+t+","+e+"A"+s+","+s+" "+a+" 0 1"+" "+n+","+i};const YS=(t,e,n,i)=>BS(e*Math.cos(t),e*Math.sin(t),i*Math.cos(n),i*Math.sin(n));const JS=(t,e,n,i)=>{const r=n-t,o=i-e,s=.2*(r+o),a=.2*(o-r);return"M"+t+","+e+"C"+(t+s)+","+(e+a)+" "+(n+a)+","+(i-s)+" "+n+","+i};const GS=(t,e,n,i)=>JS(e*Math.cos(t),e*Math.sin(t),i*Math.cos(n),i*Math.sin(n));const VS=(t,e,n,i)=>"M"+t+","+e+"V"+i+"H"+n;const KS=(t,e,n,i)=>"M"+t+","+e+"H"+n+"V"+i;const ZS=(t,e,n,i)=>{const r=Math.cos(t),o=Math.sin(t),s=Math.cos(n),a=Math.sin(n),l=Math.abs(n-t)>Math.PI?n<=t:n>t;return"M"+e*r+","+e*o+"A"+e+","+e+" 0 0,"+(l?1:0)+" "+e*s+","+e*a+"L"+i*s+","+i*a};const QS=(t,e,n,i)=>{const r=(t+n)/2;return"M"+t+","+e+"C"+r+","+e+" "+r+","+i+" "+n+","+i};const tE=(t,e,n,i)=>{const r=(e+i)/2;return"M"+t+","+e+"C"+t+","+r+" "+n+","+r+" "+n+","+i};const eE=(t,e,n,i)=>{const r=Math.cos(t),o=Math.sin(t),s=Math.cos(n),a=Math.sin(n),l=(e+i)/2;return"M"+e*r+","+e*o+"C"+l*r+","+l*o+" "+l*s+","+l*a+" "+i*s+","+i*a};const nE=(0,m.Xr)({line:XS,"line-radial":HS,arc:BS,"arc-radial":YS,curve:JS,"curve-radial":GS,"orthogonal-horizontal":VS,"orthogonal-vertical":KS,"orthogonal-radial":ZS,"diagonal-horizontal":QS,"diagonal-vertical":tE,"diagonal-radial":eE});function iE(t){Us.call(this,null,t)}iE.Definition={type:"Pie",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:false},{name:"as",type:"string",array:true,length:2,default:["startAngle","endAngle"]}]};(0,m.XW)(iE,Us,{transform(t,e){var n=t.as||["startAngle","endAngle"],i=n[0],r=n[1],o=t.field||m.kX,s=t.startAngle||0,a=t.endAngle!=null?t.endAngle:2*Math.PI,l=e.source,u=l.map(o),c=u.length,f=s,h=(a-s)/zS(u),d=rl(c),p,g,y;if(t.sort){d.sort(((t,e)=>u[t]-u[e]))}for(p=0;p<c;++p){y=u[d[p]];g=l[d[p]];g[i]=f;g[r]=f+=y*h}this.value=u;return e.reflow(t.modified()).modifies(n)}});const rE=5;function oE(t){const e=t.type;return!t.bins&&(e===Km||e===Qm||e===tg)}function sE(t){return Og(t)&&t!==rg}const aE=(0,m.Rg)(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function lE(t){Us.call(this,null,t);this.modified(true)}(0,m.XW)(lE,Us,{transform(t,e){var n=e.dataflow,i=this.value,r=uE(t);if(!i||r!==i.type){this.value=i=zg(r)()}for(r in t)if(!aE[r]){if(r==="padding"&&sE(i.type))continue;(0,m.mf)(i[r])?i[r](t[r]):n.warn("Unsupported scale property: "+r)}gE(i,t,mE(i,t,fE(i,t,n)));return e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function uE(t){var e=t.type,n="",i;if(e===rg)return rg+"-"+Km;if(cE(t)){i=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(t.domainMid!=null):0;n=i===2?rg+"-":i===3?og+"-":""}return(n+e||Km).toLowerCase()}function cE(t){const e=t.type;return Og(e)&&e!==ng&&e!==ig&&(t.scheme||t.range&&t.range.length&&t.range.every(m.HD))}function fE(t,e,n){const i=hE(t,e.domainRaw,n);if(i>-1)return i;var r=e.domain,o=t.type,s=e.zero||e.zero===undefined&&oE(t),a,l;if(!r)return 0;if(sE(o)&&e.padding&&r[0]!==(0,m.fj)(r)){r=dE(o,r,e.range,e.padding,e.exponent,e.constant)}if(s||e.domainMin!=null||e.domainMax!=null||e.domainMid!=null){a=(r=r.slice()).length-1||1;if(s){if(r[0]>0)r[0]=0;if(r[a]<0)r[a]=0}if(e.domainMin!=null)r[0]=e.domainMin;if(e.domainMax!=null)r[a]=e.domainMax;if(e.domainMid!=null){l=e.domainMid;const t=l>r[a]?a+1:l<r[0]?0:a;if(t!==a)n.warn("Scale domainMid exceeds domain min or max.",l);r.splice(t,0,l)}}t.domain(pE(o,r,n));if(o===ug){t.unknown(e.domainImplicit?Lp:undefined)}if(e.nice&&t.nice){t.nice(e.nice!==true&&ly(t,e.nice)||null)}return r.length}function hE(t,e,n){if(e){t.domain(pE(t.type,e,n));return e.length}else{return-1}}function dE(t,e,n,i,r,o){var s=Math.abs((0,m.fj)(n)-n[0]),a=s/(s-2*i),l=t===Zm?(0,m.dH)(e,null,a):t===tg?(0,m.mK)(e,null,a,.5):t===Qm?(0,m.mK)(e,null,a,r||1):t===eg?(0,m.bV)(e,null,a,o||1):(0,m.ay)(e,null,a);e=e.slice();e[0]=l[0];e[e.length-1]=l[1];return e}function pE(t,e,n){if(Ig(t)){var i=Math.abs(e.reduce(((t,e)=>t+(e<0?-1:e>0?1:0)),0));if(i!==e.length){n.warn("Log scale domain includes zero: "+(0,m.m8)(e))}}return e}function mE(t,e,n){let i=e.bins;if(i&&!(0,m.kJ)(i)){const e=t.domain(),n=e[0],r=(0,m.fj)(e),o=i.step;let s=i.start==null?n:i.start,a=i.stop==null?r:i.stop;if(!o)(0,m.vU)("Scale bins parameter missing step property.");if(s<n)s=o*Math.ceil(n/o);if(a>r)a=o*Math.floor(r/o);i=rl(s,a+o/2,o)}if(i){t.bins=i}else if(t.bins){delete t.bins}if(t.type===hg){if(!i){t.bins=t.domain()}else if(!e.domain&&!e.domainRaw){t.domain(i);n=i.length}}return n}function gE(t,e,n){var i=t.type,r=e.round||false,o=e.range;if(e.rangeStep!=null){o=yE(i,e,n)}else if(e.scheme){o=vE(i,e,n);if((0,m.mf)(o)){if(t.interpolator){return t.interpolator(o)}else{(0,m.vU)(`Scale type ${i} does not support interpolating color schemes.`)}}}if(o&&Lg(i)){return t.interpolator(Xg(xE(o,e.reverse),e.interpolate,e.interpolateGamma))}if(o&&e.interpolate&&t.interpolate){t.interpolate(Jg(e.interpolate,e.interpolateGamma))}else if((0,m.mf)(t.round)){t.round(r)}else if((0,m.mf)(t.rangeRound)){t.interpolate(r?wd:bd)}if(o)t.range(xE(o,e.reverse))}function yE(t,e,n){if(t!==fg&&t!==cg){(0,m.vU)("Only band and point scales support rangeStep.")}var i=(e.paddingOuter!=null?e.paddingOuter:e.padding)||0,r=t===cg?1:(e.paddingInner!=null?e.paddingInner:e.padding)||0;return[0,e.rangeStep*Gm(n,r,i)]}function vE(t,e,n){var i=e.schemeExtent,r,o;if((0,m.kJ)(e.scheme)){o=Xg(e.scheme,e.interpolate,e.interpolateGamma)}else{r=e.scheme.toLowerCase();o=ey(r);if(!o)(0,m.vU)(`Unrecognized scheme name: ${e.scheme}`)}n=t===lg?n+1:t===hg?n-1:t===sg||t===ag?+e.schemeCount||rE:n;return Lg(t)?_E(o,i,e.reverse):(0,m.mf)(o)?Hg(_E(o,i),n):t===ug?o:o.slice(0,n)}function _E(t,e,n){return(0,m.mf)(t)&&(e||n)?Wg(t,xE(e||[0,1],n)):t}function xE(t,e){return e?t.slice().reverse():t}function bE(t){Us.call(this,null,t)}(0,m.XW)(bE,Us,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");if(n)e.source.sort(To(t.sort));this.modified(n);return e}});const wE="zero",kE="center",ME="normalize",SE=["y0","y1"];function EE(t){Us.call(this,null,t)}EE.Definition={type:"Stack",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:true},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:wE,values:[wE,kE,ME]},{name:"as",type:"string",array:true,length:2,default:SE}]};(0,m.XW)(EE,Us,{transform(t,e){var n=t.as||SE,i=n[0],r=n[1],o=To(t.sort),s=t.field||m.kX,a=t.offset===kE?TE:t.offset===ME?$E:DE,l,u,c,f;l=AE(e.source,t.groupby,o,s);for(u=0,c=l.length,f=l.max;u<c;++u){a(l[u],f,s,i,r)}return e.reflow(t.modified()).modifies(n)}});function TE(t,e,n,i,r){var o=(e-t.sum)/2,s=t.length,a=0,l;for(;a<s;++a){l=t[a];l[i]=o;l[r]=o+=Math.abs(n(l))}}function $E(t,e,n,i,r){var o=1/t.sum,s=0,a=t.length,l=0,u=0,c;for(;l<a;++l){c=t[l];c[i]=s;c[r]=s=o*(u+=Math.abs(n(c)))}}function DE(t,e,n,i,r){var o=0,s=0,a=t.length,l=0,u,c;for(;l<a;++l){c=t[l];u=+n(c);if(u<0){c[i]=s;c[r]=s+=u}else{c[i]=o;c[r]=o+=u}}}function AE(t,e,n,i){var r=[],o=t=>t(c),s,a,l,u,c,f,h,d,p;if(e==null){r.push(t.slice())}else{for(s={},a=0,l=t.length;a<l;++a){c=t[a];f=e.map(o);h=s[f];if(!h){s[f]=h=[];r.push(h)}h.push(c)}}for(f=0,p=0,u=r.length;f<u;++f){h=r[f];for(a=0,d=0,l=h.length;a<l;++a){d+=Math.abs(i(h[a]))}h.sum=d;if(d>p)p=d;if(n)h.sort(n)}r.max=p;return r}const NE=t=>t;function zE(t,e){if(t&&CE.hasOwnProperty(t.type)){CE[t.type](t,e)}}var RE={Feature:function(t,e){zE(t.geometry,e)},FeatureCollection:function(t,e){var n=t.features,i=-1,r=n.length;while(++i<r)zE(n[i].geometry,e)}};var CE={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates;e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){OE(t.coordinates,e,0)},MultiLineString:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)OE(n[i],e,0)},Polygon:function(t,e){UE(t.coordinates,e)},MultiPolygon:function(t,e){var n=t.coordinates,i=-1,r=n.length;while(++i<r)UE(n[i],e)},GeometryCollection:function(t,e){var n=t.geometries,i=-1,r=n.length;while(++i<r)zE(n[i],e)}};function OE(t,e,n){var i=-1,r=t.length-n,o;e.lineStart();while(++i<r)o=t[i],e.point(o[0],o[1],o[2]);e.lineEnd()}function UE(t,e){var n=-1,i=t.length;e.polygonStart();while(++n<i)OE(t[n],e,1);e.polygonEnd()}function PE(t,e){if(t&&RE.hasOwnProperty(t.type)){RE[t.type](t,e)}else{zE(t,e)}}class IE{constructor(){this._partials=new Float64Array(32);this._n=0}add(t){const e=this._partials;let n=0;for(let i=0;i<this._n&&i<32;i++){const r=e[i],o=t+r,s=Math.abs(t)<Math.abs(r)?t-(o-r):r-(o-t);if(s)e[n++]=s;t=o}e[n]=t;this._n=n+1;return this}valueOf(){const t=this._partials;let e=this._n,n,i,r,o=0;if(e>0){o=t[--e];while(e>0){n=o;i=t[--e];o=n+i;r=i-(o-n);if(r)break}if(e>0&&(r<0&&t[e-1]<0||r>0&&t[e-1]>0)){i=r*2;n=o+i;if(i==n-o)o=n}}return o}}function qE(t,e){const n=new IE;if(e===undefined){for(let e of t){if(e=+e){n.add(e)}}}else{let i=-1;for(let r of t){if(r=+e(r,++i,t)){n.add(r)}}}return+n}function LE(t,e){const n=new IE;let i=-1;return Float64Array.from(t,e===undefined?t=>n.add(+t||0):r=>n.add(+e(r,++i,t)||0))}var FE=1e-6;var jE=1e-12;var WE=Math.PI;var XE=WE/2;var HE=WE/4;var BE=WE*2;var YE=180/WE;var JE=WE/180;var GE=Math.abs;var VE=Math.atan;var KE=Math.atan2;var ZE=Math.cos;var QE=Math.ceil;var tT=Math.exp;var eT=Math.floor;var nT=Math.hypot;var iT=Math.log;var rT=Math.pow;var oT=Math.sin;var sT=Math.sign||function(t){return t>0?1:t<0?-1:0};var aT=Math.sqrt;var lT=Math.tan;function uT(t){return t>1?0:t<-1?WE:Math.acos(t)}function cT(t){return t>1?XE:t<-1?-XE:Math.asin(t)}function fT(t){return(t=oT(t/2))*t}function hT(){}var dT=new IE,pT=new IE,mT,gT,yT,vT;var _T={point:hT,lineStart:hT,lineEnd:hT,polygonStart:function(){_T.lineStart=xT;_T.lineEnd=kT},polygonEnd:function(){_T.lineStart=_T.lineEnd=_T.point=hT;dT.add(GE(pT));pT=new IE},result:function(){var t=dT/2;dT=new IE;return t}};function xT(){_T.point=bT}function bT(t,e){_T.point=wT;mT=yT=t,gT=vT=e}function wT(t,e){pT.add(vT*t-yT*e);yT=t,vT=e}function kT(){wT(mT,gT)}const MT=_T;var ST=Infinity,ET=ST,TT=-ST,$T=TT;var DT={point:AT,lineStart:hT,lineEnd:hT,polygonStart:hT,polygonEnd:hT,result:function(){var t=[[ST,ET],[TT,$T]];TT=$T=-(ET=ST=Infinity);return t}};function AT(t,e){if(t<ST)ST=t;if(t>TT)TT=t;if(e<ET)ET=e;if(e>$T)$T=e}const NT=DT;var zT=0,RT=0,CT=0,OT=0,UT=0,PT=0,IT=0,qT=0,LT=0,FT,jT,WT,XT;var HT={point:BT,lineStart:YT,lineEnd:VT,polygonStart:function(){HT.lineStart=KT;HT.lineEnd=ZT},polygonEnd:function(){HT.point=BT;HT.lineStart=YT;HT.lineEnd=VT},result:function(){var t=LT?[IT/LT,qT/LT]:PT?[OT/PT,UT/PT]:CT?[zT/CT,RT/CT]:[NaN,NaN];zT=RT=CT=OT=UT=PT=IT=qT=LT=0;return t}};function BT(t,e){zT+=t;RT+=e;++CT}function YT(){HT.point=JT}function JT(t,e){HT.point=GT;BT(WT=t,XT=e)}function GT(t,e){var n=t-WT,i=e-XT,r=aT(n*n+i*i);OT+=r*(WT+t)/2;UT+=r*(XT+e)/2;PT+=r;BT(WT=t,XT=e)}function VT(){HT.point=BT}function KT(){HT.point=QT}function ZT(){t$(FT,jT)}function QT(t,e){HT.point=t$;BT(FT=WT=t,jT=XT=e)}function t$(t,e){var n=t-WT,i=e-XT,r=aT(n*n+i*i);OT+=r*(WT+t)/2;UT+=r*(XT+e)/2;PT+=r;r=XT*t-WT*e;IT+=r*(WT+t);qT+=r*(XT+e);LT+=r*3;BT(WT=t,XT=e)}const e$=HT;function n$(t){this._context=t}n$.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line===0)this._context.closePath();this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e);this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e);this._context.arc(t,e,this._radius,0,BE);break}}},result:hT};var i$=new IE,r$,o$,s$,a$,l$;var u$={point:hT,lineStart:function(){u$.point=c$},lineEnd:function(){if(r$)f$(o$,s$);u$.point=hT},polygonStart:function(){r$=true},polygonEnd:function(){r$=null},result:function(){var t=+i$;i$=new IE;return t}};function c$(t,e){u$.point=f$;o$=a$=t,s$=l$=e}function f$(t,e){a$-=t,l$-=e;i$.add(aT(a$*a$+l$*l$));a$=t,l$=e}const h$=u$;let d$,p$,m$,g$;class y${constructor(t){this._append=t==null?v$:_$(t);this._radius=4.5;this._=""}pointRadius(t){this._radius=+t;return this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){if(this._line===0)this._+="Z";this._point=NaN}point(t,e){switch(this._point){case 0:{this._append`M${t},${e}`;this._point=1;break}case 1:{this._append`L${t},${e}`;break}default:{this._append`M${t},${e}`;if(this._radius!==m$||this._append!==p$){const t=this._radius;const e=this._;this._="";this._append`m0,${t}a${t},${t} 0 1,1 0,${-2*t}a${t},${t} 0 1,1 0,${2*t}z`;m$=t;p$=this._append;g$=this._;this._=e}this._+=g$;break}}}result(){const t=this._;this._="";return t.length?t:null}}function v$(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e){this._+=arguments[e]+t[e]}}function _$(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return v$;if(e!==d$){const t=10**e;d$=e;p$=function e(n){let i=1;this._+=n[0];for(const r=n.length;i<r;++i){this._+=Math.round(arguments[i]*t)/t+n[i]}}}return p$}function x$(t,e){let n=3,i=4.5,r,o;function s(t){if(t){if(typeof i==="function")o.pointRadius(+i.apply(this,arguments));PE(t,r(o))}return o.result()}s.area=function(t){PE(t,r(MT));return MT.result()};s.measure=function(t){PE(t,r(h$));return h$.result()};s.bounds=function(t){PE(t,r(NT));return NT.result()};s.centroid=function(t){PE(t,r(e$));return e$.result()};s.projection=function(e){if(!arguments.length)return t;r=e==null?(t=null,NE):(t=e).stream;return s};s.context=function(t){if(!arguments.length)return e;o=t==null?(e=null,new y$(n)):new n$(e=t);if(typeof i!=="function")o.pointRadius(i);return s};s.pointRadius=function(t){if(!arguments.length)return i;i=typeof t==="function"?t:(o.pointRadius(+t),+t);return s};s.digits=function(t){if(!arguments.length)return n;if(t==null)n=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);n=e}if(e===null)o=new y$(n);return s};return s.projection(t).digits(n).context(e)}function b$(){var t=[],e;return{point:function(t,n,i){e.push([t,n,i])},lineStart:function(){t.push(e=[])},lineEnd:hT,rejoin:function(){if(t.length>1)t.push(t.pop().concat(t.shift()))},result:function(){var n=t;t=[];e=null;return n}}}function w$(t,e){return GE(t[0]-e[0])<FE&&GE(t[1]-e[1])<FE}function k$(t,e,n,i){this.x=t;this.z=e;this.o=n;this.e=i;this.v=false;this.n=this.p=null}function M$(t,e,n,i,r){var o=[],s=[],a,l;t.forEach((function(t){if((e=t.length-1)<=0)return;var e,n=t[0],i=t[e],l;if(w$(n,i)){if(!n[2]&&!i[2]){r.lineStart();for(a=0;a<e;++a)r.point((n=t[a])[0],n[1]);r.lineEnd();return}i[0]+=2*FE}o.push(l=new k$(n,t,null,true));s.push(l.o=new k$(n,null,l,false));o.push(l=new k$(i,t,null,false));s.push(l.o=new k$(i,null,l,true))}));if(!o.length)return;s.sort(e);S$(o);S$(s);for(a=0,l=s.length;a<l;++a){s[a].e=n=!n}var u=o[0],c,f;while(1){var h=u,d=true;while(h.v)if((h=h.n)===u)return;c=h.z;r.lineStart();do{h.v=h.o.v=true;if(h.e){if(d){for(a=0,l=c.length;a<l;++a)r.point((f=c[a])[0],f[1])}else{i(h.x,h.n.x,1,r)}h=h.n}else{if(d){c=h.p.z;for(a=c.length-1;a>=0;--a)r.point((f=c[a])[0],f[1])}else{i(h.x,h.p.x,-1,r)}h=h.p}h=h.o;c=h.z;d=!d}while(!h.v);r.lineEnd()}}function S$(t){if(!(e=t.length))return;var e,n=0,i=t[0],r;while(++n<e){i.n=r=t[n];r.p=i;i=r}i.n=r=t[0];r.p=i}function E$(t){return[KE(t[1],t[0]),cT(t[2])]}function T$(t){var e=t[0],n=t[1],i=ZE(n);return[i*ZE(e),i*oT(e),oT(n)]}function $$(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function D$(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function A$(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function N$(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function z$(t){var e=aT(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function R$(t){return GE(t[0])<=WE?t[0]:sT(t[0])*((GE(t[0])+WE)%BE-WE)}function C$(t,e){var n=R$(e),i=e[1],r=oT(i),o=[oT(n),-ZE(n),0],s=0,a=0;var l=new IE;if(r===1)i=XE+FE;else if(r===-1)i=-XE-FE;for(var u=0,c=t.length;u<c;++u){if(!(h=(f=t[u]).length))continue;var f,h,d=f[h-1],p=R$(d),m=d[1]/2+HE,g=oT(m),y=ZE(m);for(var v=0;v<h;++v,p=x,g=w,y=k,d=_){var _=f[v],x=R$(_),b=_[1]/2+HE,w=oT(b),k=ZE(b),M=x-p,S=M>=0?1:-1,E=S*M,T=E>WE,$=g*w;l.add(KE($*S*oT(E),y*k+$*ZE(E)));s+=T?M+S*BE:M;if(T^p>=n^x>=n){var D=D$(T$(d),T$(_));z$(D);var A=D$(o,D);z$(A);var N=(T^M>=0?-1:1)*cT(A[2]);if(i>N||i===N&&(D[0]||D[1])){a+=T^M>=0?1:-1}}}}return(s<-FE||s<FE&&l<-jE)^a&1}function*O$(t){for(const e of t){yield*e}}function U$(t){return Array.from(O$(t))}function P$(t,e,n,i){return function(r){var o=e(r),s=b$(),a=e(s),l=false,u,c,f;var h={point:d,lineStart:m,lineEnd:g,polygonStart:function(){h.point=y;h.lineStart=v;h.lineEnd=_;c=[];u=[]},polygonEnd:function(){h.point=d;h.lineStart=m;h.lineEnd=g;c=U$(c);var t=C$(u,i);if(c.length){if(!l)r.polygonStart(),l=true;M$(c,q$,t,n,r)}else if(t){if(!l)r.polygonStart(),l=true;r.lineStart();n(null,null,1,r);r.lineEnd()}if(l)r.polygonEnd(),l=false;c=u=null},sphere:function(){r.polygonStart();r.lineStart();n(null,null,1,r);r.lineEnd();r.polygonEnd()}};function d(e,n){if(t(e,n))r.point(e,n)}function p(t,e){o.point(t,e)}function m(){h.point=p;o.lineStart()}function g(){h.point=d;o.lineEnd()}function y(t,e){f.push([t,e]);a.point(t,e)}function v(){a.lineStart();f=[]}function _(){y(f[0][0],f[0][1]);a.lineEnd();var t=a.clean(),e=s.result(),n,i=e.length,o,h,d;f.pop();u.push(f);f=null;if(!i)return;if(t&1){h=e[0];if((o=h.length-1)>0){if(!l)r.polygonStart(),l=true;r.lineStart();for(n=0;n<o;++n)r.point((d=h[n])[0],d[1]);r.lineEnd()}return}if(i>1&&t&2)e.push(e.pop().concat(e.shift()));c.push(e.filter(I$))}return h}}function I$(t){return t.length>1}function q$(t,e){return((t=t.x)[0]<0?t[1]-XE-FE:XE-t[1])-((e=e.x)[0]<0?e[1]-XE-FE:XE-e[1])}const L$=P$((function(){return true}),F$,W$,[-WE,-XE]);function F$(t){var e=NaN,n=NaN,i=NaN,r;return{lineStart:function(){t.lineStart();r=1},point:function(o,s){var a=o>0?WE:-WE,l=GE(o-e);if(GE(l-WE)<FE){t.point(e,n=(n+s)/2>0?XE:-XE);t.point(i,n);t.lineEnd();t.lineStart();t.point(a,n);t.point(o,n);r=0}else if(i!==a&&l>=WE){if(GE(e-i)<FE)e-=i*FE;if(GE(o-a)<FE)o-=a*FE;n=j$(e,n,o,s);t.point(i,n);t.lineEnd();t.lineStart();t.point(a,n);r=0}t.point(e=o,n=s);i=a},lineEnd:function(){t.lineEnd();e=n=NaN},clean:function(){return 2-r}}}function j$(t,e,n,i){var r,o,s=oT(t-n);return GE(s)>FE?VE((oT(e)*(o=ZE(i))*oT(n)-oT(i)*(r=ZE(e))*oT(t))/(r*o*s)):(e+i)/2}function W$(t,e,n,i){var r;if(t==null){r=n*XE;i.point(-WE,r);i.point(0,r);i.point(WE,r);i.point(WE,0);i.point(WE,-r);i.point(0,-r);i.point(-WE,-r);i.point(-WE,0);i.point(-WE,r)}else if(GE(t[0]-e[0])>FE){var o=t[0]<e[0]?WE:-WE;r=n*o/2;i.point(-o,r);i.point(0,r);i.point(o,r)}else{i.point(e[0],e[1])}}function X$(t,e,n,i,r,o){if(!n)return;var s=ZE(e),a=oT(e),l=i*n;if(r==null){r=e+i*BE;o=e-l/2}else{r=H$(s,r);o=H$(s,o);if(i>0?r<o:r>o)r+=i*BE}for(var u,c=r;i>0?c>o:c<o;c-=l){u=E$([s,-a*ZE(c),-a*oT(c)]);t.point(u[0],u[1])}}function H$(t,e){e=T$(e),e[0]-=t;z$(e);var n=uT(-e[1]);return((-e[2]<0?-n:n)+BE-FE)%BE}function B$(){var t=constant([0,0]),e=constant(90),n=constant(6),i,r,o={point:s};function s(t,e){i.push(t=r(t,e));t[0]*=degrees,t[1]*=degrees}function a(){var s=t.apply(this,arguments),a=e.apply(this,arguments)*radians,l=n.apply(this,arguments)*radians;i=[];r=rotateRadians(-s[0]*radians,-s[1]*radians,0).invert;X$(o,a,l,1);s={type:"Polygon",coordinates:[i]};i=r=null;return s}a.center=function(e){return arguments.length?(t=typeof e==="function"?e:constant([+e[0],+e[1]]),a):t};a.radius=function(t){return arguments.length?(e=typeof t==="function"?t:constant(+t),a):e};a.precision=function(t){return arguments.length?(n=typeof t==="function"?t:constant(+t),a):n};return a}function Y$(t){var e=ZE(t),n=6*JE,i=e>0,r=GE(e)>FE;function o(e,i,r,o){X$(o,t,n,r,e,i)}function s(t,n){return ZE(t)*ZE(n)>e}function a(t){var e,n,o,a,c;return{lineStart:function(){a=o=false;c=1},point:function(f,h){var d=[f,h],p,m=s(f,h),g=i?m?0:u(f,h):m?u(f+(f<0?WE:-WE),h):0;if(!e&&(a=o=m))t.lineStart();if(m!==o){p=l(e,d);if(!p||w$(e,p)||w$(d,p))d[2]=1}if(m!==o){c=0;if(m){t.lineStart();p=l(d,e);t.point(p[0],p[1])}else{p=l(e,d);t.point(p[0],p[1],2);t.lineEnd()}e=p}else if(r&&e&&i^m){var y;if(!(g&n)&&(y=l(d,e,true))){c=0;if(i){t.lineStart();t.point(y[0][0],y[0][1]);t.point(y[1][0],y[1][1]);t.lineEnd()}else{t.point(y[1][0],y[1][1]);t.lineEnd();t.lineStart();t.point(y[0][0],y[0][1],3)}}}if(m&&(!e||!w$(e,d))){t.point(d[0],d[1])}e=d,o=m,n=g},lineEnd:function(){if(o)t.lineEnd();e=null},clean:function(){return c|(a&&o)<<1}}}function l(t,n,i){var r=T$(t),o=T$(n);var s=[1,0,0],a=D$(r,o),l=$$(a,a),u=a[0],c=l-u*u;if(!c)return!i&&t;var f=e*l/c,h=-e*u/c,d=D$(s,a),p=N$(s,f),m=N$(a,h);A$(p,m);var g=d,y=$$(p,g),v=$$(g,g),_=y*y-v*($$(p,p)-1);if(_<0)return;var x=aT(_),b=N$(g,(-y-x)/v);A$(b,p);b=E$(b);if(!i)return b;var w=t[0],k=n[0],M=t[1],S=n[1],E;if(k<w)E=w,w=k,k=E;var T=k-w,$=GE(T-WE)<FE,D=$||T<FE;if(!$&&S<M)E=M,M=S,S=E;if(D?$?M+S>0^b[1]<(GE(b[0]-w)<FE?M:S):M<=b[1]&&b[1]<=S:T>WE^(w<=b[0]&&b[0]<=k)){var A=N$(g,(-y+x)/v);A$(A,p);return[b,E$(A)]}}function u(e,n){var r=i?t:WE-t,o=0;if(e<-r)o|=1;else if(e>r)o|=2;if(n<-r)o|=4;else if(n>r)o|=8;return o}return P$(s,a,o,i?[0,-t]:[-WE,t-WE])}function J$(t,e,n,i,r,o){var s=t[0],a=t[1],l=e[0],u=e[1],c=0,f=1,h=l-s,d=u-a,p;p=n-s;if(!h&&p>0)return;p/=h;if(h<0){if(p<c)return;if(p<f)f=p}else if(h>0){if(p>f)return;if(p>c)c=p}p=r-s;if(!h&&p<0)return;p/=h;if(h<0){if(p>f)return;if(p>c)c=p}else if(h>0){if(p<c)return;if(p<f)f=p}p=i-a;if(!d&&p>0)return;p/=d;if(d<0){if(p<c)return;if(p<f)f=p}else if(d>0){if(p>f)return;if(p>c)c=p}p=o-a;if(!d&&p<0)return;p/=d;if(d<0){if(p>f)return;if(p>c)c=p}else if(d>0){if(p<c)return;if(p<f)f=p}if(c>0)t[0]=s+c*h,t[1]=a+c*d;if(f<1)e[0]=s+f*h,e[1]=a+f*d;return true}var G$=1e9,V$=-G$;function K$(t,e,n,i){function r(r,o){return t<=r&&r<=n&&e<=o&&o<=i}function o(r,o,a,u){var c=0,f=0;if(r==null||(c=s(r,a))!==(f=s(o,a))||l(r,o)<0^a>0){do{u.point(c===0||c===3?t:n,c>1?i:e)}while((c=(c+a+4)%4)!==f)}else{u.point(o[0],o[1])}}function s(i,r){return GE(i[0]-t)<FE?r>0?0:3:GE(i[0]-n)<FE?r>0?2:1:GE(i[1]-e)<FE?r>0?1:0:r>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var n=s(t,1),i=s(e,1);return n!==i?n-i:n===0?e[1]-t[1]:n===1?t[0]-e[0]:n===2?t[1]-e[1]:e[0]-t[0]}return function(s){var l=s,u=b$(),c,f,h,d,p,m,g,y,v,_,x;var b={point:w,lineStart:E,lineEnd:T,polygonStart:M,polygonEnd:S};function w(t,e){if(r(t,e))l.point(t,e)}function k(){var e=0;for(var n=0,r=f.length;n<r;++n){for(var o=f[n],s=1,a=o.length,l=o[0],u,c,h=l[0],d=l[1];s<a;++s){u=h,c=d,l=o[s],h=l[0],d=l[1];if(c<=i){if(d>i&&(h-u)*(i-c)>(d-c)*(t-u))++e}else{if(d<=i&&(h-u)*(i-c)<(d-c)*(t-u))--e}}}return e}function M(){l=u,c=[],f=[],x=true}function S(){var t=k(),e=x&&t,n=(c=U$(c)).length;if(e||n){s.polygonStart();if(e){s.lineStart();o(null,null,1,s);s.lineEnd()}if(n){M$(c,a,t,o,s)}s.polygonEnd()}l=s,c=f=h=null}function E(){b.point=$;if(f)f.push(h=[]);_=true;v=false;g=y=NaN}function T(){if(c){$(d,p);if(m&&v)u.rejoin();c.push(u.result())}b.point=w;if(v)l.lineEnd()}function $(o,s){var a=r(o,s);if(f)h.push([o,s]);if(_){d=o,p=s,m=a;_=false;if(a){l.lineStart();l.point(o,s)}}else{if(a&&v)l.point(o,s);else{var u=[g=Math.max(V$,Math.min(G$,g)),y=Math.max(V$,Math.min(G$,y))],c=[o=Math.max(V$,Math.min(G$,o)),s=Math.max(V$,Math.min(G$,s))];if(J$(u,c,t,e,n,i)){if(!v){l.lineStart();l.point(u[0],u[1])}l.point(c[0],c[1]);if(!a)l.lineEnd();x=false}else if(a){l.lineStart();l.point(o,s);x=false}}}g=o,y=s,v=a}return b}}function Z$(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}if(t.invert&&e.invert)n.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])};return n}function Q$(t,e){if(GE(t)>WE)t-=Math.round(t/BE)*BE;return[t,e]}Q$.invert=Q$;function tD(t,e,n){return(t%=BE)?e||n?Z$(nD(t),iD(e,n)):nD(t):e||n?iD(e,n):Q$}function eD(t){return function(e,n){e+=t;if(GE(e)>WE)e-=Math.round(e/BE)*BE;return[e,n]}}function nD(t){var e=eD(t);e.invert=eD(-t);return e}function iD(t,e){var n=ZE(t),i=oT(t),r=ZE(e),o=oT(e);function s(t,e){var s=ZE(e),a=ZE(t)*s,l=oT(t)*s,u=oT(e),c=u*n+a*i;return[KE(l*r-c*o,a*n-u*i),cT(c*r+l*o)]}s.invert=function(t,e){var s=ZE(e),a=ZE(t)*s,l=oT(t)*s,u=oT(e),c=u*r-l*o;return[KE(l*r+u*o,a*n+c*i),cT(c*n-a*i)]};return s}function rD(t){t=tD(t[0]*JE,t[1]*JE,t.length>2?t[2]*JE:0);function e(e){e=t(e[0]*JE,e[1]*JE);return e[0]*=YE,e[1]*=YE,e}e.invert=function(e){e=t.invert(e[0]*JE,e[1]*JE);return e[0]*=YE,e[1]*=YE,e};return e}function oD(t){return{stream:sD(t)}}function sD(t){return function(e){var n=new aD;for(var i in t)n[i]=t[i];n.stream=e;return n}}function aD(){}aD.prototype={constructor:aD,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function lD(t,e,n){var i=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]);if(i!=null)t.clipExtent(null);PE(n,t.stream(NT));e(NT.result());if(i!=null)t.clipExtent(i);return t}function uD(t,e,n){return lD(t,(function(n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=Math.min(i/(n[1][0]-n[0][0]),r/(n[1][1]-n[0][1])),s=+e[0][0]+(i-o*(n[1][0]+n[0][0]))/2,a=+e[0][1]+(r-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([s,a])}),n)}function cD(t,e,n){return uD(t,[[0,0],e],n)}function fD(t,e,n){return lD(t,(function(n){var i=+e,r=i/(n[1][0]-n[0][0]),o=(i-r*(n[1][0]+n[0][0]))/2,s=-r*n[0][1];t.scale(150*r).translate([o,s])}),n)}function hD(t,e,n){return lD(t,(function(n){var i=+e,r=i/(n[1][1]-n[0][1]),o=-r*n[0][0],s=(i-r*(n[1][1]+n[0][1]))/2;t.scale(150*r).translate([o,s])}),n)}var dD=16,pD=ZE(30*JE);function mD(t,e){return+e?yD(t,e):gD(t)}function gD(t){return sD({point:function(e,n){e=t(e,n);this.stream.point(e[0],e[1])}})}function yD(t,e){function n(i,r,o,s,a,l,u,c,f,h,d,p,m,g){var y=u-i,v=c-r,_=y*y+v*v;if(_>4*e&&m--){var x=s+h,b=a+d,w=l+p,k=aT(x*x+b*b+w*w),M=cT(w/=k),S=GE(GE(w)-1)<FE||GE(o-f)<FE?(o+f)/2:KE(b,x),E=t(S,M),T=E[0],$=E[1],D=T-i,A=$-r,N=v*D-y*A;if(N*N/_>e||GE((y*D+v*A)/_-.5)>.3||s*h+a*d+l*p<pD){n(i,r,o,s,a,l,T,$,S,x/=k,b/=k,w,m,g);g.point(T,$);n(T,$,S,x,b,w,u,c,f,h,d,p,m,g)}}}return function(e){var i,r,o,s,a,l,u,c,f,h,d,p;var m={point:g,lineStart:y,lineEnd:_,polygonStart:function(){e.polygonStart();m.lineStart=x},polygonEnd:function(){e.polygonEnd();m.lineStart=y}};function g(n,i){n=t(n,i);e.point(n[0],n[1])}function y(){c=NaN;m.point=v;e.lineStart()}function v(i,r){var o=T$([i,r]),s=t(i,r);n(c,f,u,h,d,p,c=s[0],f=s[1],u=i,h=o[0],d=o[1],p=o[2],dD,e);e.point(c,f)}function _(){m.point=g;e.lineEnd()}function x(){y();m.point=b;m.lineEnd=w}function b(t,e){v(i=t,e),r=c,o=f,s=h,a=d,l=p;m.point=v}function w(){n(c,f,u,h,d,p,r,o,i,s,a,l,dD,e);m.lineEnd=_;_()}return m}}var vD=sD({point:function(t,e){this.stream.point(t*JE,e*JE)}});function _D(t){return sD({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}function xD(t,e,n,i,r){function o(o,s){o*=i;s*=r;return[e+t*o,n-t*s]}o.invert=function(o,s){return[(o-e)/t*i,(n-s)/t*r]};return o}function bD(t,e,n,i,r,o){if(!o)return xD(t,e,n,i,r);var s=ZE(o),a=oT(o),l=s*t,u=a*t,c=s/t,f=a/t,h=(a*n-s*e)/t,d=(a*e+s*n)/t;function p(t,o){t*=i;o*=r;return[l*t-u*o+e,n-u*t-l*o]}p.invert=function(t,e){return[i*(c*t-f*e+h),r*(d-f*t-c*e)]};return p}function wD(t){return kD((function(){return t}))()}function kD(t){var e,n=150,i=480,r=250,o=0,s=0,a=0,l=0,u=0,c,f=0,h=1,d=1,p=null,m=L$,g=null,y,v,_,x=NE,b=.5,w,k,M,S,E;function T(t){return M(t[0]*JE,t[1]*JE)}function $(t){t=M.invert(t[0],t[1]);return t&&[t[0]*YE,t[1]*YE]}T.stream=function(t){return S&&E===t?S:S=vD(_D(c)(m(w(x(E=t)))))};T.preclip=function(t){return arguments.length?(m=t,p=undefined,A()):m};T.postclip=function(t){return arguments.length?(x=t,g=y=v=_=null,A()):x};T.clipAngle=function(t){return arguments.length?(m=+t?Y$(p=t*JE):(p=null,L$),A()):p*YE};T.clipExtent=function(t){return arguments.length?(x=t==null?(g=y=v=_=null,NE):K$(g=+t[0][0],y=+t[0][1],v=+t[1][0],_=+t[1][1]),A()):g==null?null:[[g,y],[v,_]]};T.scale=function(t){return arguments.length?(n=+t,D()):n};T.translate=function(t){return arguments.length?(i=+t[0],r=+t[1],D()):[i,r]};T.center=function(t){return arguments.length?(o=t[0]%360*JE,s=t[1]%360*JE,D()):[o*YE,s*YE]};T.rotate=function(t){return arguments.length?(a=t[0]%360*JE,l=t[1]%360*JE,u=t.length>2?t[2]%360*JE:0,D()):[a*YE,l*YE,u*YE]};T.angle=function(t){return arguments.length?(f=t%360*JE,D()):f*YE};T.reflectX=function(t){return arguments.length?(h=t?-1:1,D()):h<0};T.reflectY=function(t){return arguments.length?(d=t?-1:1,D()):d<0};T.precision=function(t){return arguments.length?(w=mD(k,b=t*t),A()):aT(b)};T.fitExtent=function(t,e){return uD(T,t,e)};T.fitSize=function(t,e){return cD(T,t,e)};T.fitWidth=function(t,e){return fD(T,t,e)};T.fitHeight=function(t,e){return hD(T,t,e)};function D(){var t=bD(n,0,0,h,d,f).apply(null,e(o,s)),p=bD(n,i-t[0],r-t[1],h,d,f);c=tD(a,l,u);k=Z$(e,p);M=Z$(c,k);w=mD(k,b);return A()}function A(){S=E=null;return T}return function(){e=t.apply(this,arguments);T.invert=e.invert&&$;return D()}}function MD(t){var e=0,n=WE/3,i=kD(t),r=i(e,n);r.parallels=function(t){return arguments.length?i(e=t[0]*JE,n=t[1]*JE):[e*YE,n*YE]};return r}function SD(t){var e=ZE(t);function n(t,n){return[t*e,oT(n)/e]}n.invert=function(t,n){return[t/e,cT(n*e)]};return n}function ED(t,e){var n=oT(t),i=(n+oT(e))/2;if(GE(i)<FE)return SD(t);var r=1+n*(2*i-n),o=aT(r)/i;function s(t,e){var n=aT(r-2*i*oT(e))/i;return[n*oT(t*=i),o-n*ZE(t)]}s.invert=function(t,e){var n=o-e,s=KE(t,GE(n))*sT(n);if(n*i<0)s-=WE*sT(t)*sT(n);return[s/i,cT((r-(t*t+n*n)*i*i)/(2*i))]};return s}function TD(){return MD(ED).scale(155.424).center([0,33.6442])}function $D(){return TD().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function DD(t){var e=t.length;return{point:function(n,i){var r=-1;while(++r<e)t[r].point(n,i)},sphere:function(){var n=-1;while(++n<e)t[n].sphere()},lineStart:function(){var n=-1;while(++n<e)t[n].lineStart()},lineEnd:function(){var n=-1;while(++n<e)t[n].lineEnd()},polygonStart:function(){var n=-1;while(++n<e)t[n].polygonStart()},polygonEnd:function(){var n=-1;while(++n<e)t[n].polygonEnd()}}}function AD(){var t,e,n=$D(),i,r=TD().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o,s=TD().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,l,u={point:function(t,e){l=[t,e]}};function c(t){var e=t[0],n=t[1];return l=null,(i.point(e,n),l)||(o.point(e,n),l)||(a.point(e,n),l)}c.invert=function(t){var e=n.scale(),i=n.translate(),o=(t[0]-i[0])/e,a=(t[1]-i[1])/e;return(a>=.12&&a<.234&&o>=-.425&&o<-.214?r:a>=.166&&a<.234&&o>=-.214&&o<-.115?s:n).invert(t)};c.stream=function(i){return t&&e===i?t:t=DD([n.stream(e=i),r.stream(i),s.stream(i)])};c.precision=function(t){if(!arguments.length)return n.precision();n.precision(t),r.precision(t),s.precision(t);return f()};c.scale=function(t){if(!arguments.length)return n.scale();n.scale(t),r.scale(t*.35),s.scale(t);return c.translate(n.translate())};c.translate=function(t){if(!arguments.length)return n.translate();var e=n.scale(),l=+t[0],c=+t[1];i=n.translate(t).clipExtent([[l-.455*e,c-.238*e],[l+.455*e,c+.238*e]]).stream(u);o=r.translate([l-.307*e,c+.201*e]).clipExtent([[l-.425*e+FE,c+.12*e+FE],[l-.214*e-FE,c+.234*e-FE]]).stream(u);a=s.translate([l-.205*e,c+.212*e]).clipExtent([[l-.214*e+FE,c+.166*e+FE],[l-.115*e-FE,c+.234*e-FE]]).stream(u);return f()};c.fitExtent=function(t,e){return uD(c,t,e)};c.fitSize=function(t,e){return cD(c,t,e)};c.fitWidth=function(t,e){return fD(c,t,e)};c.fitHeight=function(t,e){return hD(c,t,e)};function f(){t=e=null;return c}return c.scale(1070)}function ND(t){return function(e,n){var i=ZE(e),r=ZE(n),o=t(i*r);if(o===Infinity)return[2,0];return[o*r*oT(e),o*oT(n)]}}function zD(t){return function(e,n){var i=aT(e*e+n*n),r=t(i),o=oT(r),s=ZE(r);return[KE(e*o,i*s),cT(i&&n*o/i)]}}var RD=ND((function(t){return aT(2/(1+t))}));RD.invert=zD((function(t){return 2*cT(t/2)}));function CD(){return wD(RD).scale(124.75).clipAngle(180-.001)}var OD=ND((function(t){return(t=uT(t))&&t/oT(t)}));OD.invert=zD((function(t){return t}));function UD(){return wD(OD).scale(79.4188).clipAngle(180-.001)}function PD(t,e){return[t,iT(lT((XE+e)/2))]}PD.invert=function(t,e){return[t,2*VE(tT(e))-XE]};function ID(){return qD(PD).scale(961/BE)}function qD(t){var e=wD(t),n=e.center,i=e.scale,r=e.translate,o=e.clipExtent,s=null,a,l,u;e.scale=function(t){return arguments.length?(i(t),c()):i()};e.translate=function(t){return arguments.length?(r(t),c()):r()};e.center=function(t){return arguments.length?(n(t),c()):n()};e.clipExtent=function(t){return arguments.length?(t==null?s=a=l=u=null:(s=+t[0][0],a=+t[0][1],l=+t[1][0],u=+t[1][1]),c()):s==null?null:[[s,a],[l,u]]};function c(){var n=WE*i(),r=e(rD(e.rotate()).invert([0,0]));return o(s==null?[[r[0]-n,r[1]-n],[r[0]+n,r[1]+n]]:t===PD?[[Math.max(r[0]-n,s),a],[Math.min(r[0]+n,l),u]]:[[s,Math.max(r[1]-n,a)],[l,Math.min(r[1]+n,u)]])}return c()}function LD(t){return lT((XE+t)/2)}function FD(t,e){var n=ZE(t),i=t===e?oT(t):iT(n/ZE(e))/iT(LD(e)/LD(t)),r=n*rT(LD(t),i)/i;if(!i)return PD;function o(t,e){if(r>0){if(e<-XE+FE)e=-XE+FE}else{if(e>XE-FE)e=XE-FE}var n=r/rT(LD(e),i);return[n*oT(i*t),r-n*ZE(i*t)]}o.invert=function(t,e){var n=r-e,o=sT(i)*aT(t*t+n*n),s=KE(t,GE(n))*sT(n);if(n*i<0)s-=WE*sT(t)*sT(n);return[s/i,2*VE(rT(r/o,1/i))-XE]};return o}function jD(){return MD(FD).scale(109.5).parallels([30,30])}function WD(t,e){return[t,e]}WD.invert=WD;function XD(){return wD(WD).scale(152.63)}function HD(t,e){var n=ZE(t),i=t===e?oT(t):(n-ZE(e))/(e-t),r=n/i+t;if(GE(i)<FE)return WD;function o(t,e){var n=r-e,o=i*t;return[n*oT(o),r-n*ZE(o)]}o.invert=function(t,e){var n=r-e,o=KE(t,GE(n))*sT(n);if(n*i<0)o-=WE*sT(t)*sT(n);return[o/i,r-sT(i)*aT(t*t+n*n)]};return o}function BD(){return MD(HD).scale(131.154).center([0,13.9389])}var YD=1.340264,JD=-.081106,GD=893e-6,VD=.003796,KD=aT(3)/2,ZD=12;function QD(t,e){var n=cT(KD*oT(e)),i=n*n,r=i*i*i;return[t*ZE(n)/(KD*(YD+3*JD*i+r*(7*GD+9*VD*i))),n*(YD+JD*i+r*(GD+VD*i))]}QD.invert=function(t,e){var n=e,i=n*n,r=i*i*i;for(var o=0,s,a,l;o<ZD;++o){a=n*(YD+JD*i+r*(GD+VD*i))-e;l=YD+3*JD*i+r*(7*GD+9*VD*i);n-=s=a/l,i=n*n,r=i*i*i;if(GE(s)<jE)break}return[KD*t*(YD+3*JD*i+r*(7*GD+9*VD*i))/ZE(n),cT(oT(n)/KD)]};function tA(){return wD(QD).scale(177.158)}function eA(t,e){var n=ZE(e),i=ZE(t)*n;return[n*oT(t)/i,oT(e)/i]}eA.invert=zD(VE);function nA(){return wD(eA).scale(144.049).clipAngle(60)}function iA(){var t=1,e=0,n=0,i=1,r=1,o=0,s,a,l=null,u,c,f,h=1,d=1,p=sD({point:function(t,e){var n=_([t,e]);this.stream.point(n[0],n[1])}}),m=NE,g,y;function v(){h=t*i;d=t*r;g=y=null;return _}function _(t){var i=t[0]*h,r=t[1]*d;if(o){var l=r*s-i*a;i=i*s+r*a;r=l}return[i+e,r+n]}_.invert=function(t){var i=t[0]-e,r=t[1]-n;if(o){var l=r*s+i*a;i=i*s-r*a;r=l}return[i/h,r/d]};_.stream=function(t){return g&&y===t?g:g=p(m(y=t))};_.postclip=function(t){return arguments.length?(m=t,l=u=c=f=null,v()):m};_.clipExtent=function(t){return arguments.length?(m=t==null?(l=u=c=f=null,NE):K$(l=+t[0][0],u=+t[0][1],c=+t[1][0],f=+t[1][1]),v()):l==null?null:[[l,u],[c,f]]};_.scale=function(e){return arguments.length?(t=+e,v()):t};_.translate=function(t){return arguments.length?(e=+t[0],n=+t[1],v()):[e,n]};_.angle=function(t){return arguments.length?(o=t%360*JE,a=oT(o),s=ZE(o),v()):o*YE};_.reflectX=function(t){return arguments.length?(i=t?-1:1,v()):i<0};_.reflectY=function(t){return arguments.length?(r=t?-1:1,v()):r<0};_.fitExtent=function(t,e){return uD(_,t,e)};_.fitSize=function(t,e){return cD(_,t,e)};_.fitWidth=function(t,e){return fD(_,t,e)};_.fitHeight=function(t,e){return hD(_,t,e)};return _}function rA(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),e*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}rA.invert=function(t,e){var n=e,i=25,r;do{var o=n*n,s=o*o;n-=r=(n*(1.007226+o*(.015085+s*(-.044475+.028874*o-.005916*s)))-e)/(1.007226+o*(.015085*3+s*(-.044475*7+.028874*9*o-.005916*11*s)))}while(GE(r)>FE&&--i>0);return[t/(.8707+(o=n*n)*(-.131979+o*(-.013791+o*o*o*(.003971-.001529*o)))),n]};function oA(){return wD(rA).scale(175.295)}function sA(t,e){return[ZE(e)*oT(t),oT(e)]}sA.invert=zD(cT);function aA(){return wD(sA).scale(249.5).clipAngle(90+FE)}function lA(t,e){var n=ZE(e),i=1+ZE(t)*n;return[n*oT(t)/i,oT(e)/i]}lA.invert=zD((function(t){return 2*VE(t)}));function uA(){return wD(lA).scale(250).clipAngle(142)}function cA(t,e){return[iT(lT((XE+e)/2)),-t]}cA.invert=function(t,e){return[-e,2*VE(tT(t))-XE]};function fA(){var t=qD(cA),e=t.center,n=t.rotate;t.center=function(t){return arguments.length?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])};t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])};return n([0,0,90]).scale(159.155)}var hA=Math.abs;var dA=Math.atan;var pA=Math.atan2;var mA=Math.ceil;var gA=Math.cos;var yA=Math.exp;var vA=Math.floor;var _A=Math.log;var xA=Math.max;var bA=Math.min;var wA=Math.pow;var kA=Math.round;var MA=Math.sign||function(t){return t>0?1:t<0?-1:0};var SA=Math.sin;var EA=Math.tan;var TA=1e-6;var $A=1e-12;var DA=Math.PI;var AA=DA/2;var NA=DA/4;var zA=Math.SQRT1_2;var RA=FA(2);var CA=FA(DA);var OA=DA*2;var UA=180/DA;var PA=DA/180;function IA(t){return t?t/Math.sin(t):1}function qA(t){return t>1?AA:t<-1?-AA:Math.asin(t)}function LA(t){return t>1?0:t<-1?DA:Math.acos(t)}function FA(t){return t>0?Math.sqrt(t):0}function jA(t){t=yA(2*t);return(t-1)/(t+1)}function WA(t){return(yA(t)-yA(-t))/2}function XA(t){return(yA(t)+yA(-t))/2}function HA(t){return _A(t+FA(t*t+1))}function BA(t){return _A(t+FA(t*t-1))}function YA(t,e){var n=t*SA(e),i=30,r;do{e-=r=(e+SA(e)-n)/(1+gA(e))}while(hA(r)>TA&&--i>0);return e/2}function JA(t,e,n){function i(i,r){return[t*i*gA(r=YA(n,r)),e*SA(r)]}i.invert=function(i,r){return r=qA(r/e),[i/(t*gA(r)),qA((2*r+SA(2*r))/n)]};return i}var GA=JA(RA/AA,RA,DA);function VA(){return wD(GA).scale(169.529)}const KA=x$();const ZA=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function QA(t,e){return function n(){const i=e();i.type=t;i.path=x$().projection(i);i.copy=i.copy||function(){const t=n();ZA.forEach((e=>{if(i[e])t[e](i[e]())}));t.path.pointRadius(i.path.pointRadius());return t};return Dg(i)}}function tN(t,e){if(!t||typeof t!=="string"){throw new Error("Projection type must be a name string.")}t=t.toLowerCase();if(arguments.length>1){nN[t]=QA(t,e);return this}else{return nN[t]||null}}function eN(t){return t&&t.path||KA}const nN={albers:$D,albersusa:AD,azimuthalequalarea:CD,azimuthalequidistant:UD,conicconformal:jD,conicequalarea:TD,conicequidistant:BD,equalEarth:tA,equirectangular:XD,gnomonic:nA,identity:iA,mercator:ID,mollweide:VA,naturalEarth1:oA,orthographic:aA,stereographic:uA,transversemercator:fA};for(const GV in nN){tN(GV,nN[GV])}function iN(t,e,n){var i=rl(t,e-FE,n).concat(e);return function(t){return i.map((function(e){return[t,e]}))}}function rN(t,e,n){var i=rl(t,e-FE,n).concat(e);return function(t){return i.map((function(e){return[e,t]}))}}function oN(){var t,e,n,i,r,o,s,a,l=10,u=l,c=90,f=360,h,d,p,m,g=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return rl(QE(i/c)*c,n,c).map(p).concat(rl(QE(a/f)*f,s,f).map(m)).concat(rl(QE(e/l)*l,t,l).filter((function(t){return GE(t%c)>FE})).map(h)).concat(rl(QE(o/u)*u,r,u).filter((function(t){return GE(t%f)>FE})).map(d))}y.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))};y.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(m(s).slice(1),p(n).reverse().slice(1),m(a).reverse().slice(1))]}};y.extent=function(t){if(!arguments.length)return y.extentMinor();return y.extentMajor(t).extentMinor(t)};y.extentMajor=function(t){if(!arguments.length)return[[i,a],[n,s]];i=+t[0][0],n=+t[1][0];a=+t[0][1],s=+t[1][1];if(i>n)t=i,i=n,n=t;if(a>s)t=a,a=s,s=t;return y.precision(g)};y.extentMinor=function(n){if(!arguments.length)return[[e,o],[t,r]];e=+n[0][0],t=+n[1][0];o=+n[0][1],r=+n[1][1];if(e>t)n=e,e=t,t=n;if(o>r)n=o,o=r,r=n;return y.precision(g)};y.step=function(t){if(!arguments.length)return y.stepMinor();return y.stepMajor(t).stepMinor(t)};y.stepMajor=function(t){if(!arguments.length)return[c,f];c=+t[0],f=+t[1];return y};y.stepMinor=function(t){if(!arguments.length)return[l,u];l=+t[0],u=+t[1];return y};y.precision=function(l){if(!arguments.length)return g;g=+l;h=iN(o,r,90);d=rN(e,t,g);p=iN(a,s,90);m=rN(i,n,g);return y};return y.extentMajor([[-180,-90+FE],[180,90-FE]]).extentMinor([[-180,-80-FE],[180,80+FE]])}function sN(){return oN()()}function aN(){}const lN=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function uN(){var t=1,e=1,n=a;function i(t,e){return e.map((e=>r(t,e)))}function r(t,e){var i=[],r=[];o(t,e,(o=>{n(o,t,e);if(cN(o)>0)i.push([o]);else r.push(o)}));r.forEach((t=>{for(var e=0,n=i.length,r;e<n;++e){if(fN((r=i[e])[0],t)!==-1){r.push(t);return}}}));return{type:"MultiPolygon",value:e,coordinates:i}}function o(n,i,r){var o=new Array,a=new Array,l,u,c,f,h,d;l=u=-1;f=n[0]>=i;lN[f<<1].forEach(p);while(++l<t-1){c=f,f=n[l+1]>=i;lN[c|f<<1].forEach(p)}lN[f<<0].forEach(p);while(++u<e-1){l=-1;f=n[u*t+t]>=i;h=n[u*t]>=i;lN[f<<1|h<<2].forEach(p);while(++l<t-1){c=f,f=n[u*t+t+l+1]>=i;d=h,h=n[u*t+l+1]>=i;lN[c|f<<1|h<<2|d<<3].forEach(p)}lN[f|h<<3].forEach(p)}l=-1;h=n[u*t]>=i;lN[h<<2].forEach(p);while(++l<t-1){d=h,h=n[u*t+l+1]>=i;lN[h<<2|d<<3].forEach(p)}lN[h<<3].forEach(p);function p(t){var e=[t[0][0]+l,t[0][1]+u],n=[t[1][0]+l,t[1][1]+u],i=s(e),c=s(n),f,h;if(f=a[i]){if(h=o[c]){delete a[f.end];delete o[h.start];if(f===h){f.ring.push(n);r(f.ring)}else{o[f.start]=a[h.end]={start:f.start,end:h.end,ring:f.ring.concat(h.ring)}}}else{delete a[f.end];f.ring.push(n);a[f.end=c]=f}}else if(f=o[c]){if(h=a[i]){delete o[f.start];delete a[h.end];if(f===h){f.ring.push(n);r(f.ring)}else{o[h.start]=a[f.end]={start:h.start,end:f.end,ring:h.ring.concat(f.ring)}}}else{delete o[f.start];f.ring.unshift(e);o[f.start=i]=f}}else{o[i]=a[c]={start:i,end:c,ring:[e,n]}}}}function s(e){return e[0]*2+e[1]*(t+1)*4}function a(n,i,r){n.forEach((n=>{var o=n[0],s=n[1],a=o|0,l=s|0,u,c=i[l*t+a];if(o>0&&o<t&&a===o){u=i[l*t+a-1];n[0]=o+(r-u)/(c-u)-.5}if(s>0&&s<e&&l===s){u=i[(l-1)*t+a];n[1]=s+(r-u)/(c-u)-.5}}))}i.contour=r;i.size=function(n){if(!arguments.length)return[t,e];var r=Math.floor(n[0]),o=Math.floor(n[1]);if(!(r>=0&&o>=0))(0,m.vU)("invalid size");return t=r,e=o,i};i.smooth=function(t){return arguments.length?(n=t?a:aN,i):n===a};return i}function cN(t){var e=0,n=t.length,i=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];while(++e<n)i+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return i}function fN(t,e){var n=-1,i=e.length,r;while(++n<i)if(r=hN(t,e[n]))return r;return 0}function hN(t,e){var n=e[0],i=e[1],r=-1;for(var o=0,s=t.length,a=s-1;o<s;a=o++){var l=t[o],u=l[0],c=l[1],f=t[a],h=f[0],d=f[1];if(dN(l,f,e))return 0;if(c>i!==d>i&&n<(h-u)*(i-c)/(d-c)+u)r=-r}return r}function dN(t,e,n){var i;return pN(t,e,n)&&mN(t[i=+(t[0]===e[0])],n[i],e[i])}function pN(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}function mN(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}function gN(t,e,n){return function(i){var r=(0,m.We)(i),o=n?Math.min(r[0],0):r[0],s=r[1],a=s-o,l=e?X(o,s,t):a/(t+1);return rl(o+l,s,l)}}function yN(t){Us.call(this,null,t)}yN.Definition={type:"Isocontour",metadata:{generates:true},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:true},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:false},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:true},{name:"smooth",type:"boolean",default:true},{name:"scale",type:"number",expr:true},{name:"translate",type:"number",array:true,expr:true},{name:"as",type:"string",null:true,default:"contour"}]};(0,m.XW)(yN,Us,{transform(t,e){if(this.value&&!e.changed()&&!t.modified()){return e.StopPropagation}var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=e.materialize(e.SOURCE).source,r=t.field||m.yR,o=uN().smooth(t.smooth!==false),s=t.thresholds||vN(i,r,t),a=t.as===null?null:t.as||"contour",l=[];i.forEach((e=>{const n=r(e);const i=o.size([n.width,n.height])(n.values,(0,m.kJ)(s)?s:s(n.values));_N(i,n,e,t);i.forEach((t=>{l.push(So(e,ko(a!=null?{[a]:t}:t)))}))}));if(this.value)n.rem=this.value;this.value=n.source=n.add=l;return n}});function vN(t,e,n){const i=gN(n.levels||10,n.nice,n.zero!==false);return n.resolve!=="shared"?i:i(t.map((t=>Ls(e(t).values))))}function _N(t,e,n,i){let r=i.scale||e.scale,o=i.translate||e.translate;if((0,m.mf)(r))r=r(n,i);if((0,m.mf)(o))o=o(n,i);if((r===1||r==null)&&!o)return;const s=((0,m.hj)(r)?r:r[0])||1,a=((0,m.hj)(r)?r:r[1])||1,l=o&&o[0]||0,u=o&&o[1]||0;t.forEach(xN(e,s,a,l,u))}function xN(t,e,n,i,r){const o=t.x1||0,s=t.y1||0,a=e*n<0;function l(t){t.forEach(u)}function u(t){if(a)t.reverse();t.forEach(c)}function c(t){t[0]=(t[0]-o)*e+i;t[1]=(t[1]-s)*n+r}return function(t){t.coordinates.forEach(l);return t}}function bN(t,e,n){const i=t>=0?t:oa(e,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function wN(t){return(0,m.mf)(t)?t:(0,m.a9)(+t)}function kN(){var t=t=>t[0],e=t=>t[1],n=m.kX,i=[-1,-1],r=960,o=500,s=2;function a(a,l){const u=bN(i[0],a,t)>>s,c=bN(i[1],a,e)>>s,f=u?u+2:0,h=c?c+2:0,d=2*f+(r>>s),p=2*h+(o>>s),m=new Float32Array(d*p),g=new Float32Array(d*p);let y=m;a.forEach((i=>{const r=f+(+t(i)>>s),o=h+(+e(i)>>s);if(r>=0&&r<d&&o>=0&&o<p){m[r+o*d]+=+n(i)}}));if(u>0&&c>0){MN(d,p,m,g,u);SN(d,p,g,m,c);MN(d,p,m,g,u);SN(d,p,g,m,c);MN(d,p,m,g,u);SN(d,p,g,m,c)}else if(u>0){MN(d,p,m,g,u);MN(d,p,g,m,u);MN(d,p,m,g,u);y=g}else if(c>0){SN(d,p,m,g,c);SN(d,p,g,m,c);SN(d,p,m,g,c);y=g}const v=l?Math.pow(2,-2*s):1/zS(y);for(let t=0,e=d*p;t<e;++t)y[t]*=v;return{values:y,scale:1<<s,width:d,height:p,x1:f,y1:h,x2:f+(r>>s),y2:h+(o>>s)}}a.x=function(e){return arguments.length?(t=wN(e),a):t};a.y=function(t){return arguments.length?(e=wN(t),a):e};a.weight=function(t){return arguments.length?(n=wN(t),a):n};a.size=function(t){if(!arguments.length)return[r,o];var e=+t[0],n=+t[1];if(!(e>=0&&n>=0))(0,m.vU)("invalid size");return r=e,o=n,a};a.cellSize=function(t){if(!arguments.length)return 1<<s;if(!((t=+t)>=1))(0,m.vU)("invalid cell size");s=Math.floor(Math.log(t)/Math.LN2);return a};a.bandwidth=function(t){if(!arguments.length)return i;t=(0,m.IX)(t);if(t.length===1)t=[+t[0],+t[0]];if(t.length!==2)(0,m.vU)("invalid bandwidth");return i=t,a};return a}function MN(t,e,n,i,r){const o=(r<<1)+1;for(let s=0;s<e;++s){for(let e=0,a=0;e<t+r;++e){if(e<t){a+=n[e+s*t]}if(e>=r){if(e>=o){a-=n[e-o+s*t]}i[e-r+s*t]=a/Math.min(e+1,t-1+o-e,o)}}}}function SN(t,e,n,i,r){const o=(r<<1)+1;for(let s=0;s<t;++s){for(let a=0,l=0;a<e+r;++a){if(a<e){l+=n[s+a*t]}if(a>=r){if(a>=o){l-=n[s+(a-o)*t]}i[s+(a-r)*t]=l/Math.min(a+1,e-1+o-a,o)}}}}function EN(t){Us.call(this,null,t)}EN.Definition={type:"KDE2D",metadata:{generates:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"weight",type:"field"},{name:"groupby",type:"field",array:true},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:true,length:2},{name:"counts",type:"boolean",default:false},{name:"as",type:"string",default:"grid"}]};const TN=["x","y","weight","size","cellSize","bandwidth"];function $N(t,e){TN.forEach((n=>e[n]!=null?t[n](e[n]):0));return t}(0,m.XW)(EN,Us,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=e.materialize(e.SOURCE).source,r=DN(i,t.groupby),o=(t.groupby||[]).map(m.el),s=$N(kN(),t),a=t.as||"grid",l=[];function u(t,e){for(let n=0;n<o.length;++n)t[o[n]]=e[n];return t}l=r.map((e=>ko(u({[a]:s(e,t.counts)},e.dims))));if(this.value)n.rem=this.value;this.value=n.source=n.add=l;return n}});function DN(t,e){var n=[],i=t=>t(a),r,o,s,a,l,u;if(e==null){n.push(t)}else{for(r={},o=0,s=t.length;o<s;++o){a=t[o];l=e.map(i);u=r[l];if(!u){r[l]=u=[];u.dims=l;n.push(u)}u.push(a)}}return n}function AN(t){Us.call(this,null,t)}AN.Definition={type:"Contour",metadata:{generates:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"values",type:"number",array:true},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:false},{name:"thresholds",type:"number",array:true},{name:"smooth",type:"boolean",default:true}]};(0,m.XW)(AN,Us,{transform(t,e){if(this.value&&!e.changed()&&!t.modified()){return e.StopPropagation}var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=uN().smooth(t.smooth!==false),r=t.values,o=t.thresholds||gN(t.count||10,t.nice,!!r),s=t.size,a,l;if(!r){r=e.materialize(e.SOURCE).source;a=$N(kN(),t)(r,true);l=xN(a,a.scale||1,a.scale||1,0,0);s=[a.width,a.height];r=a.values}o=(0,m.kJ)(o)?o:o(r);r=i.size(s)(r,o);if(l)r.forEach(l);if(this.value)n.rem=this.value;this.value=n.source=n.add=(r||[]).map(ko);return n}});const NN="Feature";const zN="FeatureCollection";const RN="MultiPoint";function CN(t){Us.call(this,null,t)}CN.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:true,length:2},{name:"geojson",type:"field"}]};(0,m.XW)(CN,Us,{transform(t,e){var n=this._features,i=this._points,r=t.fields,o=r&&r[0],s=r&&r[1],a=t.geojson||!r&&m.yR,l=e.ADD,u;u=t.modified()||e.changed(e.REM)||e.modified((0,m.Oj)(a))||o&&e.modified((0,m.Oj)(o))||s&&e.modified((0,m.Oj)(s));if(!this.value||u){l=e.SOURCE;this._features=n=[];this._points=i=[]}if(a){e.visit(l,(t=>n.push(a(t))))}if(o&&s){e.visit(l,(t=>{var e=o(t),n=s(t);if(e!=null&&n!=null&&(e=+e)===e&&(n=+n)===n){i.push([e,n])}}));n=n.concat({type:NN,geometry:{type:RN,coordinates:i}})}this.value={type:zN,features:n}}});function ON(t){Us.call(this,null,t)}ON.Definition={type:"GeoPath",metadata:{modifies:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"path"}]};(0,m.XW)(ON,Us,{transform(t,e){var n=e.fork(e.ALL),i=this.value,r=t.field||m.yR,o=t.as||"path",s=n.SOURCE;if(!i||t.modified()){this.value=i=eN(t.projection);n.materialize().reflow()}else{s=r===m.yR||e.modified(r.fields)?n.ADD_MOD:n.ADD}const a=UN(i,t.pointRadius);n.visit(s,(t=>t[o]=i(r(t))));i.pointRadius(a);return n.modifies(o)}});function UN(t,e){const n=t.pointRadius();t.context(null);if(e!=null){t.pointRadius(e)}return n}function PN(t){Us.call(this,null,t)}PN.Definition={type:"GeoPoint",metadata:{modifies:true},params:[{name:"projection",type:"projection",required:true},{name:"fields",type:"field",array:true,required:true,length:2},{name:"as",type:"string",array:true,length:2,default:["x","y"]}]};(0,m.XW)(PN,Us,{transform(t,e){var n=t.projection,i=t.fields[0],r=t.fields[1],o=t.as||["x","y"],s=o[0],a=o[1],l;function u(t){const e=n([i(t),r(t)]);if(e){t[s]=e[0];t[a]=e[1]}else{t[s]=undefined;t[a]=undefined}}if(t.modified()){e=e.materialize().reflow(true).visit(e.SOURCE,u)}else{l=e.modified(i.fields)||e.modified(r.fields);e.visit(l?e.ADD_MOD:e.ADD,u)}return e.modifies(o)}});function IN(t){Us.call(this,null,t)}IN.Definition={type:"GeoShape",metadata:{modifies:true,nomod:true},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:true},{name:"as",type:"string",default:"shape"}]};(0,m.XW)(IN,Us,{transform(t,e){var n=e.fork(e.ALL),i=this.value,r=t.as||"shape",o=n.ADD;if(!i||t.modified()){this.value=i=qN(eN(t.projection),t.field||(0,m.EP)("datum"),t.pointRadius);n.materialize().reflow();o=n.SOURCE}n.visit(o,(t=>t[r]=i));return n.modifies(r)}});function qN(t,e,n){const i=n==null?n=>t(e(n)):i=>{var r=t.pointRadius(),o=t.pointRadius(n)(e(i));t.pointRadius(r);return o};i.context=e=>{t.context(e);return i};return i}function LN(t){Us.call(this,[],t);this.generator=oN()}LN.Definition={type:"Graticule",metadata:{changes:true,generates:true},params:[{name:"extent",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMajor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"extentMinor",type:"array",array:true,length:2,content:{type:"number",array:true,length:2}},{name:"step",type:"number",array:true,length:2},{name:"stepMajor",type:"number",array:true,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:true,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};(0,m.XW)(LN,Us,{transform(t,e){var n=this.value,i=this.generator,r;if(!n.length||t.modified()){for(const e in t){if((0,m.mf)(i[e])){i[e](t[e])}}}r=i();if(n.length){e.mod.push(Eo(n[0],r))}else{e.add.push(ko(r))}n[0]=r;return e}});function FN(t){Us.call(this,null,t)}FN.Definition={type:"heatmap",metadata:{modifies:true},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:true},{name:"opacity",type:"number",expr:true},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};(0,m.XW)(FN,Us,{transform(t,e){if(!e.changed()&&!t.modified()){return e.StopPropagation}var n=e.materialize(e.SOURCE).source,i=t.resolve==="shared",r=t.field||m.yR,o=WN(t.opacity,t),s=jN(t.color,t),a=t.as||"image",l={$x:0,$y:0,$value:0,$max:i?Ls(n.map((t=>Ls(r(t).values)))):0};n.forEach((t=>{const e=r(t);const n=(0,m.l7)({},t,l);if(!i)n.$max=Ls(e.values||[]);t[a]=HN(e,n,s.dep?s:(0,m.a9)(s(n)),o.dep?o:(0,m.a9)(o(n)))}));return e.reflow(true).modifies(a)}});function jN(t,e){let n;if((0,m.mf)(t)){n=n=>Oh(t(n,e));n.dep=XN(t)}else{n=(0,m.a9)(Oh(t||"#888"))}return n}function WN(t,e){let n;if((0,m.mf)(t)){n=n=>t(n,e);n.dep=XN(t)}else if(t){n=(0,m.a9)(t)}else{n=t=>t.$value/t.$max||0;n.dep=true}return n}function XN(t){if(!(0,m.mf)(t))return false;const e=(0,m.Rg)((0,m.Oj)(t));return e.$x||e.$y||e.$value||e.$max}function HN(t,e,n,i){const r=t.width,o=t.height,s=t.x1||0,a=t.y1||0,l=t.x2||r,u=t.y2||o,c=t.values,f=c?t=>c[t]:m.bM,h=rh(l-s,u-a),d=h.getContext("2d"),p=d.getImageData(0,0,l-s,u-a),g=p.data;for(let m=a,y=0;m<u;++m){e.$y=m-a;for(let t=s,o=m*r;t<l;++t,y+=4){e.$x=t-s;e.$value=f(t+o);const r=n(e);g[y+0]=r.r;g[y+1]=r.g;g[y+2]=r.b;g[y+3]=~~(255*i(e))}}d.putImageData(p,0,0);return h}function BN(t){Us.call(this,null,t);this.modified(true)}(0,m.XW)(BN,Us,{transform(t,e){let n=this.value;if(!n||t.modified("type")){this.value=n=JN(t.type);ZA.forEach((e=>{if(t[e]!=null)GN(n,e,t[e])}))}else{ZA.forEach((e=>{if(t.modified(e))GN(n,e,t[e])}))}if(t.pointRadius!=null)n.path.pointRadius(t.pointRadius);if(t.fit)YN(n,t);return e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function YN(t,e){const n=VN(e.fit);e.extent?t.fitExtent(e.extent,n):e.size?t.fitSize(e.size,n):0}function JN(t){const e=tN((t||"mercator").toLowerCase());if(!e)(0,m.vU)("Unrecognized projection type: "+t);return e()}function GN(t,e,n){if((0,m.mf)(t[e]))t[e](n)}function VN(t){t=(0,m.IX)(t);return t.length===1?t[0]:{type:zN,features:t.reduce(((t,e)=>t.concat(KN(e))),[])}}function KN(t){return t.type===zN?t.features:(0,m.IX)(t).filter((t=>t!=null)).map((t=>t.type===NN?t:{type:NN,geometry:t}))}function ZN(t,e){var n,i=1;if(t==null)t=0;if(e==null)e=0;function r(){var r,o=n.length,s,a=0,l=0;for(r=0;r<o;++r){s=n[r],a+=s.x,l+=s.y}for(a=(a/o-t)*i,l=(l/o-e)*i,r=0;r<o;++r){s=n[r],s.x-=a,s.y-=l}}r.initialize=function(t){n=t};r.x=function(e){return arguments.length?(t=+e,r):t};r.y=function(t){return arguments.length?(e=+t,r):e};r.strength=function(t){return arguments.length?(i=+t,r):i};return r}function QN(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return tz(this.cover(e,n),e,n,t)}function tz(t,e,n,i){if(isNaN(e)||isNaN(n))return t;var r,o=t._root,s={data:i},a=t._x0,l=t._y0,u=t._x1,c=t._y1,f,h,d,p,m,g,y,v;if(!o)return t._root=s,t;while(o.length){if(m=e>=(f=(a+u)/2))a=f;else u=f;if(g=n>=(h=(l+c)/2))l=h;else c=h;if(r=o,!(o=o[y=g<<1|m]))return r[y]=s,t}d=+t._x.call(null,o.data);p=+t._y.call(null,o.data);if(e===d&&n===p)return s.next=o,r?r[y]=s:t._root=s,t;do{r=r?r[y]=new Array(4):t._root=new Array(4);if(m=e>=(f=(a+u)/2))a=f;else u=f;if(g=n>=(h=(l+c)/2))l=h;else c=h}while((y=g<<1|m)===(v=(p>=h)<<1|d>=f));return r[v]=o,r[y]=s,t}function ez(t){var e,n,i=t.length,r,o,s=new Array(i),a=new Array(i),l=Infinity,u=Infinity,c=-Infinity,f=-Infinity;for(n=0;n<i;++n){if(isNaN(r=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e)))continue;s[n]=r;a[n]=o;if(r<l)l=r;if(r>c)c=r;if(o<u)u=o;if(o>f)f=o}if(l>c||u>f)return this;this.cover(l,u).cover(c,f);for(n=0;n<i;++n){tz(this,s[n],a[n],t[n])}return this}function nz(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,i=this._y0,r=this._x1,o=this._y1;if(isNaN(n)){r=(n=Math.floor(t))+1;o=(i=Math.floor(e))+1}else{var s=r-n||1,a=this._root,l,u;while(n>t||t>=r||i>e||e>=o){u=(e<i)<<1|t<n;l=new Array(4),l[u]=a,a=l,s*=2;switch(u){case 0:r=n+s,o=i+s;break;case 1:n=r-s,o=i+s;break;case 2:r=n+s,i=o-s;break;case 3:n=r-s,i=o-s;break}}if(this._root&&this._root.length)this._root=a}this._x0=n;this._y0=i;this._x1=r;this._y1=o;return this}function iz(){var t=[];this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}));return t}function rz(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?undefined:[[this._x0,this._y0],[this._x1,this._y1]]}function oz(t,e,n,i,r){this.node=t;this.x0=e;this.y0=n;this.x1=i;this.y1=r}function sz(t,e,n){var i,r=this._x0,o=this._y0,s,a,l,u,c=this._x1,f=this._y1,h=[],d=this._root,p,m;if(d)h.push(new oz(d,r,o,c,f));if(n==null)n=Infinity;else{r=t-n,o=e-n;c=t+n,f=e+n;n*=n}while(p=h.pop()){if(!(d=p.node)||(s=p.x0)>c||(a=p.y0)>f||(l=p.x1)<r||(u=p.y1)<o)continue;if(d.length){var g=(s+l)/2,y=(a+u)/2;h.push(new oz(d[3],g,y,l,u),new oz(d[2],s,y,g,u),new oz(d[1],g,a,l,y),new oz(d[0],s,a,g,y));if(m=(e>=y)<<1|t>=g){p=h[h.length-1];h[h.length-1]=h[h.length-1-m];h[h.length-1-m]=p}}else{var v=t-+this._x.call(null,d.data),_=e-+this._y.call(null,d.data),x=v*v+_*_;if(x<n){var b=Math.sqrt(n=x);r=t-b,o=e-b;c=t+b,f=e+b;i=d.data}}}return i}function az(t){if(isNaN(c=+this._x.call(null,t))||isNaN(f=+this._y.call(null,t)))return this;var e,n=this._root,i,r,o,s=this._x0,a=this._y0,l=this._x1,u=this._y1,c,f,h,d,p,m,g,y;if(!n)return this;if(n.length)while(true){if(p=c>=(h=(s+l)/2))s=h;else l=h;if(m=f>=(d=(a+u)/2))a=d;else u=d;if(!(e=n,n=n[g=m<<1|p]))return this;if(!n.length)break;if(e[g+1&3]||e[g+2&3]||e[g+3&3])i=e,y=g}while(n.data!==t)if(!(r=n,n=n.next))return this;if(o=n.next)delete n.next;if(r)return o?r.next=o:delete r.next,this;if(!e)return this._root=o,this;o?e[g]=o:delete e[g];if((n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length){if(i)i[y]=n;else this._root=n}return this}function lz(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function uz(){return this._root}function cz(){var t=0;this.visit((function(e){if(!e.length)do{++t}while(e=e.next)}));return t}function fz(t){var e=[],n,i=this._root,r,o,s,a,l;if(i)e.push(new oz(i,this._x0,this._y0,this._x1,this._y1));while(n=e.pop()){if(!t(i=n.node,o=n.x0,s=n.y0,a=n.x1,l=n.y1)&&i.length){var u=(o+a)/2,c=(s+l)/2;if(r=i[3])e.push(new oz(r,u,c,a,l));if(r=i[2])e.push(new oz(r,o,c,u,l));if(r=i[1])e.push(new oz(r,u,s,a,c));if(r=i[0])e.push(new oz(r,o,s,u,c))}}return this}function hz(t){var e=[],n=[],i;if(this._root)e.push(new oz(this._root,this._x0,this._y0,this._x1,this._y1));while(i=e.pop()){var r=i.node;if(r.length){var o,s=i.x0,a=i.y0,l=i.x1,u=i.y1,c=(s+l)/2,f=(a+u)/2;if(o=r[0])e.push(new oz(o,s,a,c,f));if(o=r[1])e.push(new oz(o,c,a,l,f));if(o=r[2])e.push(new oz(o,s,f,c,u));if(o=r[3])e.push(new oz(o,c,f,l,u))}n.push(i)}while(i=n.pop()){t(i.node,i.x0,i.y0,i.x1,i.y1)}return this}function dz(t){return t[0]}function pz(t){return arguments.length?(this._x=t,this):this._x}function mz(t){return t[1]}function gz(t){return arguments.length?(this._y=t,this):this._y}function yz(t,e,n){var i=new vz(e==null?dz:e,n==null?mz:n,NaN,NaN,NaN,NaN);return t==null?i:i.addAll(t)}function vz(t,e,n,i,r,o){this._x=t;this._y=e;this._x0=n;this._y0=i;this._x1=r;this._y1=o;this._root=undefined}function _z(t){var e={data:t.data},n=e;while(t=t.next)n=n.next={data:t.data};return e}var xz=yz.prototype=vz.prototype;xz.copy=function(){var t=new vz(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,i;if(!e)return t;if(!e.length)return t._root=_z(e),t;n=[{source:e,target:t._root=new Array(4)}];while(e=n.pop()){for(var r=0;r<4;++r){if(i=e.source[r]){if(i.length)n.push({source:i,target:e.target[r]=new Array(4)});else e.target[r]=_z(i)}}}return t};xz.add=QN;xz.addAll=ez;xz.cover=nz;xz.data=iz;xz.extent=rz;xz.find=sz;xz.remove=az;xz.removeAll=lz;xz.root=uz;xz.size=cz;xz.visit=fz;xz.visitAfter=hz;xz.x=pz;xz.y=gz;function bz(t){return function(){return t}}function wz(t){return(t()-.5)*1e-6}function kz(t){return t.x+t.vx}function Mz(t){return t.y+t.vy}function Sz(t){var e,n,i,r=1,o=1;if(typeof t!=="function")t=bz(t==null?1:+t);function s(){var t,s=e.length,l,u,c,f,h,d;for(var p=0;p<o;++p){l=yz(e,kz,Mz).visitAfter(a);for(t=0;t<s;++t){u=e[t];h=n[u.index],d=h*h;c=u.x+u.vx;f=u.y+u.vy;l.visit(m)}}function m(t,e,n,o,s){var a=t.data,l=t.r,p=h+l;if(a){if(a.index>u.index){var m=c-a.x-a.vx,g=f-a.y-a.vy,y=m*m+g*g;if(y<p*p){if(m===0)m=wz(i),y+=m*m;if(g===0)g=wz(i),y+=g*g;y=(p-(y=Math.sqrt(y)))/y*r;u.vx+=(m*=y)*(p=(l*=l)/(d+l));u.vy+=(g*=y)*p;a.vx-=m*(p=1-p);a.vy-=g*p}}return}return e>c+p||o<c-p||n>f+p||s<f-p}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e){if(t[e]&&t[e].r>t.r){t.r=t[e].r}}}function l(){if(!e)return;var i,r=e.length,o;n=new Array(r);for(i=0;i<r;++i)o=e[i],n[o.index]=+t(o,i,e)}s.initialize=function(t,n){e=t;i=n;l()};s.iterations=function(t){return arguments.length?(o=+t,s):o};s.strength=function(t){return arguments.length?(r=+t,s):r};s.radius=function(e){return arguments.length?(t=typeof e==="function"?e:bz(+e),l(),s):t};return s}var Ez={value:()=>{}};function Tz(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new $z(n)}function $z(t){this._=t}function Dz(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0)n=t.slice(i+1),t=t.slice(0,i);if(t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}$z.prototype=Tz.prototype={constructor:$z,on:function(t,e){var n=this._,i=Dz(t+"",n),r,o=-1,s=i.length;if(arguments.length<2){while(++o<s)if((r=(t=i[o]).type)&&(r=Az(n[r],t.name)))return r;return}if(e!=null&&typeof e!=="function")throw new Error("invalid callback: "+e);while(++o<s){if(r=(t=i[o]).type)n[r]=Nz(n[r],t.name,e);else if(e==null)for(r in n)n[r]=Nz(n[r],t.name,null)}return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new $z(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,o;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],i=0,r=o.length;i<r;++i)o[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};function Az(t,e){for(var n=0,i=t.length,r;n<i;++n){if((r=t[n]).name===e){return r.value}}}function Nz(t,e,n){for(var i=0,r=t.length;i<r;++i){if(t[i].name===e){t[i]=Ez,t=t.slice(0,i).concat(t.slice(i+1));break}}if(n!=null)t.push({name:e,value:n});return t}const zz=Tz;var Rz=0,Cz=0,Oz=0,Uz=1e3,Pz,Iz,qz=0,Lz=0,Fz=0,jz=typeof performance==="object"&&performance.now?performance:Date,Wz=typeof window==="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Xz(){return Lz||(Wz(Hz),Lz=jz.now()+Fz)}function Hz(){Lz=0}function Bz(){this._call=this._time=this._next=null}Bz.prototype=Yz.prototype={constructor:Bz,restart:function(t,e,n){if(typeof t!=="function")throw new TypeError("callback is not a function");n=(n==null?Xz():+n)+(e==null?0:+e);if(!this._next&&Iz!==this){if(Iz)Iz._next=this;else Pz=this;Iz=this}this._call=t;this._time=n;Zz()},stop:function(){if(this._call){this._call=null;this._time=Infinity;Zz()}}};function Yz(t,e,n){var i=new Bz;i.restart(t,e,n);return i}function Jz(){Xz();++Rz;var t=Pz,e;while(t){if((e=Lz-t._time)>=0)t._call.call(undefined,e);t=t._next}--Rz}function Gz(){Lz=(qz=jz.now())+Fz;Rz=Cz=0;try{Jz()}finally{Rz=0;Kz();Lz=0}}function Vz(){var t=jz.now(),e=t-qz;if(e>Uz)Fz-=e,qz=t}function Kz(){var t,e=Pz,n,i=Infinity;while(e){if(e._call){if(i>e._time)i=e._time;t=e,e=e._next}else{n=e._next,e._next=null;e=t?t._next=n:Pz=n}}Iz=t;Zz(i)}function Zz(t){if(Rz)return;if(Cz)Cz=clearTimeout(Cz);var e=t-Lz;if(e>24){if(t<Infinity)Cz=setTimeout(Gz,t-jz.now()-Fz);if(Oz)Oz=clearInterval(Oz)}else{if(!Oz)qz=jz.now(),Oz=setInterval(Vz,Uz);Rz=1,Wz(Gz)}}const Qz=1664525;const tR=1013904223;const eR=4294967296;function nR(){let t=1;return()=>(t=(Qz*t+tR)%eR)/eR}function iR(t){return t.x}function rR(t){return t.y}var oR=10,sR=Math.PI*(3-Math.sqrt(5));function aR(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),o=0,s=.6,a=new Map,l=Yz(f),u=zz("tick","end"),c=nR();if(t==null)t=[];function f(){h();u.call("tick",e);if(n<i){l.stop();u.call("end",e)}}function h(i){var l,u=t.length,c;if(i===undefined)i=1;for(var f=0;f<i;++f){n+=(o-n)*r;a.forEach((function(t){t(n)}));for(l=0;l<u;++l){c=t[l];if(c.fx==null)c.x+=c.vx*=s;else c.x=c.fx,c.vx=0;if(c.fy==null)c.y+=c.vy*=s;else c.y=c.fy,c.vy=0}}return e}function d(){for(var e=0,n=t.length,i;e<n;++e){i=t[e],i.index=e;if(i.fx!=null)i.x=i.fx;if(i.fy!=null)i.y=i.fy;if(isNaN(i.x)||isNaN(i.y)){var r=oR*Math.sqrt(.5+e),o=e*sR;i.x=r*Math.cos(o);i.y=r*Math.sin(o)}if(isNaN(i.vx)||isNaN(i.vy)){i.vx=i.vy=0}}}function p(e){if(e.initialize)e.initialize(t,c);return e}d();return e={tick:h,restart:function(){return l.restart(f),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),a.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(i=+t,e):i},alphaDecay:function(t){return arguments.length?(r=+t,e):+r},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},randomSource:function(t){return arguments.length?(c=t,a.forEach(p),e):c},force:function(t,n){return arguments.length>1?(n==null?a.delete(t):a.set(t,p(n)),e):a.get(t)},find:function(e,n,i){var r=0,o=t.length,s,a,l,u,c;if(i==null)i=Infinity;else i*=i;for(r=0;r<o;++r){u=t[r];s=e-u.x;a=n-u.y;l=s*s+a*a;if(l<i)c=u,i=l}return c},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}}function lR(){var t,e,n,i,r=bz(-30),o,s=1,a=Infinity,l=.81;function u(n){var r,o=t.length,s=yz(t,iR,rR).visitAfter(f);for(i=n,r=0;r<o;++r)e=t[r],s.visit(h)}function c(){if(!t)return;var e,n=t.length,i;o=new Array(n);for(e=0;e<n;++e)i=t[e],o[i.index]=+r(i,e,t)}function f(t){var e=0,n,i,r=0,s,a,l;if(t.length){for(s=a=l=0;l<4;++l){if((n=t[l])&&(i=Math.abs(n.value))){e+=n.value,r+=i,s+=i*n.x,a+=i*n.y}}t.x=s/r;t.y=a/r}else{n=t;n.x=n.data.x;n.y=n.data.y;do{e+=o[n.data.index]}while(n=n.next)}t.value=e}function h(t,r,u,c){if(!t.value)return true;var f=t.x-e.x,h=t.y-e.y,d=c-r,p=f*f+h*h;if(d*d/l<p){if(p<a){if(f===0)f=wz(n),p+=f*f;if(h===0)h=wz(n),p+=h*h;if(p<s)p=Math.sqrt(s*p);e.vx+=f*t.value*i/p;e.vy+=h*t.value*i/p}return true}else if(t.length||p>=a)return;if(t.data!==e||t.next){if(f===0)f=wz(n),p+=f*f;if(h===0)h=wz(n),p+=h*h;if(p<s)p=Math.sqrt(s*p)}do{if(t.data!==e){d=o[t.data.index]*i/p;e.vx+=f*d;e.vy+=h*d}}while(t=t.next)}u.initialize=function(e,i){t=e;n=i;c()};u.strength=function(t){return arguments.length?(r=typeof t==="function"?t:bz(+t),c(),u):r};u.distanceMin=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)};u.distanceMax=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)};u.theta=function(t){return arguments.length?(l=t*t,u):Math.sqrt(l)};return u}function uR(t){return t.index}function cR(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function fR(t){var e=uR,n=f,i,r=bz(30),o,s,a,l,u,c=1;if(t==null)t=[];function f(t){return 1/Math.min(a[t.source.index],a[t.target.index])}function h(e){for(var n=0,r=t.length;n<c;++n){for(var s=0,a,f,h,d,p,m,g;s<r;++s){a=t[s],f=a.source,h=a.target;d=h.x+h.vx-f.x-f.vx||wz(u);p=h.y+h.vy-f.y-f.vy||wz(u);m=Math.sqrt(d*d+p*p);m=(m-o[s])/m*e*i[s];d*=m,p*=m;h.vx-=d*(g=l[s]);h.vy-=p*g;f.vx+=d*(g=1-g);f.vy+=p*g}}}function d(){if(!s)return;var n,r=s.length,u=t.length,c=new Map(s.map(((t,n)=>[e(t,n,s),t]))),f;for(n=0,a=new Array(r);n<u;++n){f=t[n],f.index=n;if(typeof f.source!=="object")f.source=cR(c,f.source);if(typeof f.target!=="object")f.target=cR(c,f.target);a[f.source.index]=(a[f.source.index]||0)+1;a[f.target.index]=(a[f.target.index]||0)+1}for(n=0,l=new Array(u);n<u;++n){f=t[n],l[n]=a[f.source.index]/(a[f.source.index]+a[f.target.index])}i=new Array(u),p();o=new Array(u),m()}function p(){if(!s)return;for(var e=0,r=t.length;e<r;++e){i[e]=+n(t[e],e,t)}}function m(){if(!s)return;for(var e=0,n=t.length;e<n;++e){o[e]=+r(t[e],e,t)}}h.initialize=function(t,e){s=t;u=e;d()};h.links=function(e){return arguments.length?(t=e,d(),h):t};h.id=function(t){return arguments.length?(e=t,h):e};h.iterations=function(t){return arguments.length?(c=+t,h):c};h.strength=function(t){return arguments.length?(n=typeof t==="function"?t:bz(+t),p(),h):n};h.distance=function(t){return arguments.length?(r=typeof t==="function"?t:bz(+t),m(),h):r};return h}function hR(t){var e=bz(.1),n,i,r;if(typeof t!=="function")t=bz(t==null?0:+t);function o(t){for(var e=0,o=n.length,s;e<o;++e){s=n[e],s.vx+=(r[e]-s.x)*i[e]*t}}function s(){if(!n)return;var o,s=n.length;i=new Array(s);r=new Array(s);for(o=0;o<s;++o){i[o]=isNaN(r[o]=+t(n[o],o,n))?0:+e(n[o],o,n)}}o.initialize=function(t){n=t;s()};o.strength=function(t){return arguments.length?(e=typeof t==="function"?t:bz(+t),s(),o):e};o.x=function(e){return arguments.length?(t=typeof e==="function"?e:bz(+e),s(),o):t};return o}function dR(t){var e=bz(.1),n,i,r;if(typeof t!=="function")t=bz(t==null?0:+t);function o(t){for(var e=0,o=n.length,s;e<o;++e){s=n[e],s.vy+=(r[e]-s.y)*i[e]*t}}function s(){if(!n)return;var o,s=n.length;i=new Array(s);r=new Array(s);for(o=0;o<s;++o){i[o]=isNaN(r[o]=+t(n[o],o,n))?0:+e(n[o],o,n)}}o.initialize=function(t){n=t;s()};o.strength=function(t){return arguments.length?(e=typeof t==="function"?t:bz(+t),s(),o):e};o.y=function(e){return arguments.length?(t=typeof e==="function"?e:bz(+e),s(),o):t};return o}const pR={center:ZN,collide:Sz,nbody:lR,link:fR,x:hR,y:dR};const mR="forces",gR=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],yR=["static","iterations"],vR=["x","y","vx","vy"];function _R(t){Us.call(this,null,t)}_R.Definition={type:"Force",metadata:{modifies:true},params:[{name:"static",type:"boolean",default:false},{name:"restart",type:"boolean",default:false},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:true,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:true},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:true},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:true},{name:"strength",type:"number",expr:true},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:true,modify:false,default:vR}]};(0,m.XW)(_R,Us,{transform(t,e){var n=this.value,i=e.changed(e.ADD_REM),r=t.modified(gR),o=t.iterations||300;if(!n){this.value=n=bR(e.source,t);n.on("tick",xR(e.dataflow,this));if(!t.static){i=true;n.tick()}e.modifies("index")}else{if(i){e.modifies("index");n.nodes(e.source)}if(r||e.changed(e.MOD)){wR(n,t,0,e)}}if(r||i||t.modified(yR)||e.changed()&&t.restart){n.alpha(Math.max(n.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/o));if(t.static){for(n.stop();--o>=0;)n.tick()}else{if(n.stopped())n.restart();if(!i)return e.StopPropagation}}return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let a=this._argops,l=0,u=a.length,c;l<u;++l){c=a[l];if(c.name!==mR||c.op._argval.force!=="link"){continue}for(var i=c.op._argops,r=0,o=i.length,s;r<o;++r){if(i[r].name==="links"&&(s=i[r].op.source)){n.pulse(s,n.changeset().reflow());break}}}return e.reflow(t.modified()).modifies(vR)}});function xR(t,e){return()=>t.touch(e).run()}function bR(t,e){const n=aR(t),i=n.stop,r=n.restart;let o=false;n.stopped=()=>o;n.restart=()=>(o=false,r());n.stop=()=>(o=true,i());return wR(n,e,true).on("end",(()=>o=true))}function wR(t,e,n,i){var r=(0,m.IX)(e.forces),o,s,a,l;for(o=0,s=gR.length;o<s;++o){a=gR[o];if(a!==mR&&e.modified(a))t[a](e[a])}for(o=0,s=r.length;o<s;++o){l=mR+o;a=n||e.modified(mR,o)?MR(r[o]):i&&kR(r[o],i)?t.force(l):null;if(a)t.force(l,a)}for(s=t.numForces||0;o<s;++o){t.force(mR+o,null)}t.numForces=r.length;return t}function kR(t,e){var n,i;for(n in t){if((0,m.mf)(i=t[n])&&e.modified((0,m.Oj)(i)))return 1}return 0}function MR(t){var e,n;if(!(0,m.nr)(pR,t.force)){(0,m.vU)("Unrecognized force: "+t.force)}e=pR[t.force]();for(n in t){if((0,m.mf)(e[n]))SR(e[n],t[n],t)}return e}function SR(t,e,n){t((0,m.mf)(e)?t=>e(t,n):e)}function ER(t){var e=0,n=t.children,i=n&&n.length;if(!i)e=1;else while(--i>=0)e+=n[i].value;t.value=e}function TR(){return this.eachAfter(ER)}function $R(t,e){let n=-1;for(const i of this){t.call(e,i,++n,this)}return this}function DR(t,e){var n=this,i=[n],r,o,s=-1;while(n=i.pop()){t.call(e,n,++s,this);if(r=n.children){for(o=r.length-1;o>=0;--o){i.push(r[o])}}}return this}function AR(t,e){var n=this,i=[n],r=[],o,s,a,l=-1;while(n=i.pop()){r.push(n);if(o=n.children){for(s=0,a=o.length;s<a;++s){i.push(o[s])}}}while(n=r.pop()){t.call(e,n,++l,this)}return this}function NR(t,e){let n=-1;for(const i of this){if(t.call(e,i,++n,this)){return i}}}function zR(t){return this.eachAfter((function(e){var n=+t(e.data)||0,i=e.children,r=i&&i.length;while(--r>=0)n+=i[r].value;e.value=n}))}function RR(t){return this.eachBefore((function(e){if(e.children){e.children.sort(t)}}))}function CR(t){var e=this,n=OR(e,t),i=[e];while(e!==n){e=e.parent;i.push(e)}var r=i.length;while(t!==n){i.splice(r,0,t);t=t.parent}return i}function OR(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;t=n.pop();e=i.pop();while(t===e){r=t;t=n.pop();e=i.pop()}return r}function UR(){var t=this,e=[t];while(t=t.parent){e.push(t)}return e}function PR(){return Array.from(this)}function IR(){var t=[];this.eachBefore((function(e){if(!e.children){t.push(e)}}));return t}function qR(){var t=this,e=[];t.each((function(n){if(n!==t){e.push({source:n.parent,target:n})}}));return e}function*LR(){var t=this,e,n=[t],i,r,o;do{e=n.reverse(),n=[];while(t=e.pop()){yield t;if(i=t.children){for(r=0,o=i.length;r<o;++r){n.push(i[r])}}}}while(n.length)}function FR(t,e){if(t instanceof Map){t=[undefined,t];if(e===undefined)e=XR}else if(e===undefined){e=WR}var n=new YR(t),i,r=[n],o,s,a,l;while(i=r.pop()){if((s=e(i.data))&&(l=(s=Array.from(s)).length)){i.children=s;for(a=l-1;a>=0;--a){r.push(o=s[a]=new YR(s[a]));o.parent=i;o.depth=i.depth+1}}}return n.eachBefore(BR)}function jR(){return FR(this).eachBefore(HR)}function WR(t){return t.children}function XR(t){return Array.isArray(t)?t[1]:null}function HR(t){if(t.data.value!==undefined)t.value=t.data.value;t.data=t.data.data}function BR(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function YR(t){this.data=t;this.depth=this.height=0;this.parent=null}YR.prototype=FR.prototype={constructor:YR,count:TR,each:$R,eachAfter:AR,eachBefore:DR,find:NR,sum:zR,sort:RR,path:CR,ancestors:UR,descendants:PR,leaves:IR,links:qR,copy:jR,[Symbol.iterator]:LR};function JR(t){return t==null?null:GR(t)}function GR(t){if(typeof t!=="function")throw new Error;return t}function VR(){return 0}function KR(t){return function(){return t}}const ZR=1664525;const QR=1013904223;const tC=4294967296;function eC(){let t=1;return()=>(t=(ZR*t+QR)%tC)/tC}function nC(t){return typeof t==="object"&&"length"in t?t:Array.from(t)}function iC(t,e){let n=t.length,i,r;while(n){r=e()*n--|0;i=t[n];t[n]=t[r];t[r]=i}return t}function rC(t){return oC(t,lcg())}function oC(t,e){var n=0,i=(t=iC(Array.from(t),e)).length,r=[],o,s;while(n<i){o=t[n];if(s&&lC(s,o))++n;else s=cC(r=sC(r,o)),n=0}return s}function sC(t,e){var n,i;if(uC(e,t))return[e];for(n=0;n<t.length;++n){if(aC(e,t[n])&&uC(hC(t[n],e),t)){return[t[n],e]}}for(n=0;n<t.length-1;++n){for(i=n+1;i<t.length;++i){if(aC(hC(t[n],t[i]),e)&&aC(hC(t[n],e),t[i])&&aC(hC(t[i],e),t[n])&&uC(dC(t[n],t[i],e),t)){return[t[n],t[i],e]}}}throw new Error}function aC(t,e){var n=t.r-e.r,i=e.x-t.x,r=e.y-t.y;return n<0||n*n<i*i+r*r}function lC(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function uC(t,e){for(var n=0;n<e.length;++n){if(!lC(t,e[n])){return false}}return true}function cC(t){switch(t.length){case 1:return fC(t[0]);case 2:return hC(t[0],t[1]);case 3:return dC(t[0],t[1],t[2])}}function fC(t){return{x:t.x,y:t.y,r:t.r}}function hC(t,e){var n=t.x,i=t.y,r=t.r,o=e.x,s=e.y,a=e.r,l=o-n,u=s-i,c=a-r,f=Math.sqrt(l*l+u*u);return{x:(n+o+l/f*c)/2,y:(i+s+u/f*c)/2,r:(f+r+a)/2}}function dC(t,e,n){var i=t.x,r=t.y,o=t.r,s=e.x,a=e.y,l=e.r,u=n.x,c=n.y,f=n.r,h=i-s,d=i-u,p=r-a,m=r-c,g=l-o,y=f-o,v=i*i+r*r-o*o,_=v-s*s-a*a+l*l,x=v-u*u-c*c+f*f,b=d*p-h*m,w=(p*x-m*_)/(b*2)-i,k=(m*g-p*y)/b,M=(d*_-h*x)/(b*2)-r,S=(h*y-d*g)/b,E=k*k+S*S-1,T=2*(o+w*k+M*S),$=w*w+M*M-o*o,D=-(Math.abs(E)>1e-6?(T+Math.sqrt(T*T-4*E*$))/(2*E):$/T);return{x:i+w+k*D,y:r+M+S*D,r:D}}function pC(t,e,n){var i=t.x-e.x,r,o,s=t.y-e.y,a,l,u=i*i+s*s;if(u){o=e.r+n.r,o*=o;l=t.r+n.r,l*=l;if(o>l){r=(u+l-o)/(2*u);a=Math.sqrt(Math.max(0,l/u-r*r));n.x=t.x-r*i-a*s;n.y=t.y-r*s+a*i}else{r=(u+o-l)/(2*u);a=Math.sqrt(Math.max(0,o/u-r*r));n.x=e.x+r*i-a*s;n.y=e.y+r*s+a*i}}else{n.x=e.x+n.r;n.y=e.y}}function mC(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function gC(t){var e=t._,n=t.next._,i=e.r+n.r,r=(e.x*n.r+n.x*e.r)/i,o=(e.y*n.r+n.y*e.r)/i;return r*r+o*o}function yC(t){this._=t;this.next=null;this.previous=null}function vC(t,e){if(!(o=(t=nC(t)).length))return 0;var n,i,r,o,s,a,l,u,c,f,h;n=t[0],n.x=0,n.y=0;if(!(o>1))return n.r;i=t[1],n.x=-i.r,i.x=n.r,i.y=0;if(!(o>2))return n.r+i.r;pC(i,n,r=t[2]);n=new yC(n),i=new yC(i),r=new yC(r);n.next=r.previous=i;i.next=n.previous=r;r.next=i.previous=n;t:for(l=3;l<o;++l){pC(n._,i._,r=t[l]),r=new yC(r);u=i.next,c=n.previous,f=i._.r,h=n._.r;do{if(f<=h){if(mC(u._,r._)){i=u,n.next=i,i.previous=n,--l;continue t}f+=u._.r,u=u.next}else{if(mC(c._,r._)){n=c,n.next=i,i.previous=n,--l;continue t}h+=c._.r,c=c.previous}}while(u!==c.next);r.previous=n,r.next=i,n.next=i.previous=i=r;s=gC(n);while((r=r.next)!==i){if((a=gC(r))<s){n=r,s=a}}i=n.next}n=[i._],r=i;while((r=r.next)!==i)n.push(r._);r=oC(n,e);for(l=0;l<o;++l)n=t[l],n.x-=r.x,n.y-=r.y;return r.r}function _C(t){vC(t,lcg());return t}function xC(t){return Math.sqrt(t.value)}function bC(){var t=null,e=1,n=1,i=VR;function r(r){const o=eC();r.x=e/2,r.y=n/2;if(t){r.eachBefore(wC(t)).eachAfter(kC(i,.5,o)).eachBefore(MC(1))}else{r.eachBefore(wC(xC)).eachAfter(kC(VR,1,o)).eachAfter(kC(i,r.r/Math.min(e,n),o)).eachBefore(MC(Math.min(e,n)/(2*r.r)))}return r}r.radius=function(e){return arguments.length?(t=JR(e),r):t};r.size=function(t){return arguments.length?(e=+t[0],n=+t[1],r):[e,n]};r.padding=function(t){return arguments.length?(i=typeof t==="function"?t:KR(+t),r):i};return r}function wC(t){return function(e){if(!e.children){e.r=Math.max(0,+t(e)||0)}}}function kC(t,e,n){return function(i){if(r=i.children){var r,o,s=r.length,a=t(i)*e||0,l;if(a)for(o=0;o<s;++o)r[o].r+=a;l=vC(r,n);if(a)for(o=0;o<s;++o)r[o].r-=a;i.r=l+a}}}function MC(t){return function(e){var n=e.parent;e.r*=t;if(n){e.x=n.x+t*e.x;e.y=n.y+t*e.y}}}function SC(t){t.x0=Math.round(t.x0);t.y0=Math.round(t.y0);t.x1=Math.round(t.x1);t.y1=Math.round(t.y1)}function EC(t,e,n,i,r){var o=t.children,s,a=-1,l=o.length,u=t.value&&(i-e)/t.value;while(++a<l){s=o[a],s.y0=n,s.y1=r;s.x0=e,s.x1=e+=s.value*u}}function TC(){var t=1,e=1,n=0,i=false;function r(r){var s=r.height+1;r.x0=r.y0=n;r.x1=t;r.y1=e/s;r.eachBefore(o(e,s));if(i)r.eachBefore(SC);return r}function o(t,e){return function(i){if(i.children){EC(i,i.x0,t*(i.depth+1)/e,i.x1,t*(i.depth+2)/e)}var r=i.x0,o=i.y0,s=i.x1-n,a=i.y1-n;if(s<r)r=s=(r+s)/2;if(a<o)o=a=(o+a)/2;i.x0=r;i.y0=o;i.x1=s;i.y1=a}}r.round=function(t){return arguments.length?(i=!!t,r):i};r.size=function(n){return arguments.length?(t=+n[0],e=+n[1],r):[t,e]};r.padding=function(t){return arguments.length?(n=+t,r):n};return r}var $C={depth:-1},DC={},AC={};function NC(t){return t.id}function zC(t){return t.parentId}function RC(){var t=NC,e=zC,n;function i(i){var r=Array.from(i),o=t,s=e,a,l,u,c,f,h,d,p,m=new Map;if(n!=null){const t=r.map(((t,e)=>CC(n(t,e,i))));const e=t.map(OC);const a=new Set(t).add("");for(const n of e){if(!a.has(n)){a.add(n);t.push(n);e.push(OC(n));r.push(AC)}}o=(e,n)=>t[n];s=(t,n)=>e[n]}for(u=0,a=r.length;u<a;++u){l=r[u],h=r[u]=new YR(l);if((d=o(l,u,i))!=null&&(d+="")){p=h.id=d;m.set(p,m.has(p)?DC:h)}if((d=s(l,u,i))!=null&&(d+="")){h.parent=d}}for(u=0;u<a;++u){h=r[u];if(d=h.parent){f=m.get(d);if(!f)throw new Error("missing: "+d);if(f===DC)throw new Error("ambiguous: "+d);if(f.children)f.children.push(h);else f.children=[h];h.parent=f}else{if(c)throw new Error("multiple roots");c=h}}if(!c)throw new Error("no root");if(n!=null){while(c.data===AC&&c.children.length===1){c=c.children[0],--a}for(let t=r.length-1;t>=0;--t){h=r[t];if(h.data!==AC)break;h.data=null}}c.parent=$C;c.eachBefore((function(t){t.depth=t.parent.depth+1;--a})).eachBefore(BR);c.parent=null;if(a>0)throw new Error("cycle");return c}i.id=function(e){return arguments.length?(t=JR(e),i):t};i.parentId=function(t){return arguments.length?(e=JR(t),i):e};i.path=function(t){return arguments.length?(n=JR(t),i):n};return i}function CC(t){t=`${t}`;let e=t.length;if(UC(t,e-1)&&!UC(t,e-2))t=t.slice(0,-1);return t[0]==="/"?t:`/${t}`}function OC(t){let e=t.length;if(e<2)return"";while(--e>1)if(UC(t,e))break;return t.slice(0,e)}function UC(t,e){if(t[e]==="/"){let n=0;while(e>0&&t[--e]==="\\")++n;if((n&1)===0)return true}return false}function PC(t,e){return t.parent===e.parent?1:2}function IC(t){var e=t.children;return e?e[0]:t.t}function qC(t){var e=t.children;return e?e[e.length-1]:t.t}function LC(t,e,n){var i=n/(e.i-t.i);e.c-=i;e.s+=n;t.c+=i;e.z+=n;e.m+=n}function FC(t){var e=0,n=0,i=t.children,r=i.length,o;while(--r>=0){o=i[r];o.z+=e;o.m+=e;e+=o.s+(n+=o.c)}}function jC(t,e,n){return t.a.parent===e.parent?t.a:n}function WC(t,e){this._=t;this.parent=null;this.children=null;this.A=null;this.a=this;this.z=0;this.m=0;this.c=0;this.s=0;this.t=null;this.i=e}WC.prototype=Object.create(YR.prototype);function XC(t){var e=new WC(t,0),n,i=[e],r,o,s,a;while(n=i.pop()){if(o=n._.children){n.children=new Array(a=o.length);for(s=a-1;s>=0;--s){i.push(r=n.children[s]=new WC(o[s],s));r.parent=n}}}(e.parent=new WC(null,0)).children=[e];return e}function HC(){var t=PC,e=1,n=1,i=null;function r(r){var a=XC(r);a.eachAfter(o),a.parent.m=-a.z;a.eachBefore(s);if(i)r.eachBefore(l);else{var u=r,c=r,f=r;r.eachBefore((function(t){if(t.x<u.x)u=t;if(t.x>c.x)c=t;if(t.depth>f.depth)f=t}));var h=u===c?1:t(u,c)/2,d=h-u.x,p=e/(c.x+h+d),m=n/(f.depth||1);r.eachBefore((function(t){t.x=(t.x+d)*p;t.y=t.depth*m}))}return r}function o(e){var n=e.children,i=e.parent.children,r=e.i?i[e.i-1]:null;if(n){FC(e);var o=(n[0].z+n[n.length-1].z)/2;if(r){e.z=r.z+t(e._,r._);e.m=e.z-o}else{e.z=o}}else if(r){e.z=r.z+t(e._,r._)}e.parent.A=a(e,r,e.parent.A||i[0])}function s(t){t._.x=t.z+t.parent.m;t.m+=t.parent.m}function a(e,n,i){if(n){var r=e,o=e,s=n,a=r.parent.children[0],l=r.m,u=o.m,c=s.m,f=a.m,h;while(s=qC(s),r=IC(r),s&&r){a=IC(a);o=qC(o);o.a=e;h=s.z+c-r.z-l+t(s._,r._);if(h>0){LC(jC(s,e,i),e,h);l+=h;u+=h}c+=s.m;l+=r.m;f+=a.m;u+=o.m}if(s&&!qC(o)){o.t=s;o.m+=c-u}if(r&&!IC(a)){a.t=r;a.m+=l-f;i=e}}return i}function l(t){t.x*=e;t.y=t.depth*n}r.separation=function(e){return arguments.length?(t=e,r):t};r.size=function(t){return arguments.length?(i=false,e=+t[0],n=+t[1],r):i?null:[e,n]};r.nodeSize=function(t){return arguments.length?(i=true,e=+t[0],n=+t[1],r):i?[e,n]:null};return r}function BC(t,e){return t.parent===e.parent?1:2}function YC(t){return t.reduce(JC,0)/t.length}function JC(t,e){return t+e.x}function GC(t){return 1+t.reduce(VC,0)}function VC(t,e){return Math.max(t,e.y)}function KC(t){var e;while(e=t.children)t=e[0];return t}function ZC(t){var e;while(e=t.children)t=e[e.length-1];return t}function QC(){var t=BC,e=1,n=1,i=false;function r(r){var o,s=0;r.eachAfter((function(e){var n=e.children;if(n){e.x=YC(n);e.y=GC(n)}else{e.x=o?s+=t(e,o):0;e.y=0;o=e}}));var a=KC(r),l=ZC(r),u=a.x-t(a,l)/2,c=l.x+t(l,a)/2;return r.eachAfter(i?function(t){t.x=(t.x-r.x)*e;t.y=(r.y-t.y)*n}:function(t){t.x=(t.x-u)/(c-u)*e;t.y=(1-(r.y?t.y/r.y:1))*n})}r.separation=function(e){return arguments.length?(t=e,r):t};r.size=function(t){return arguments.length?(i=false,e=+t[0],n=+t[1],r):i?null:[e,n]};r.nodeSize=function(t){return arguments.length?(i=true,e=+t[0],n=+t[1],r):i?[e,n]:null};return r}function tO(t,e,n,i,r){var o=t.children,s,a=o.length,l,u=new Array(a+1);for(u[0]=l=s=0;s<a;++s){u[s+1]=l+=o[s].value}c(0,a,t.value,e,n,i,r);function c(t,e,n,i,r,s,a){if(t>=e-1){var l=o[t];l.x0=i,l.y0=r;l.x1=s,l.y1=a;return}var f=u[t],h=n/2+f,d=t+1,p=e-1;while(d<p){var m=d+p>>>1;if(u[m]<h)d=m+1;else p=m}if(h-u[d-1]<u[d]-h&&t+1<d)--d;var g=u[d]-f,y=n-g;if(s-i>a-r){var v=n?(i*y+s*g)/n:s;c(t,d,g,i,r,v,a);c(d,e,y,v,r,s,a)}else{var _=n?(r*y+a*g)/n:a;c(t,d,g,i,r,s,_);c(d,e,y,i,_,s,a)}}}function eO(t,e,n,i,r){var o=t.children,s,a=-1,l=o.length,u=t.value&&(r-n)/t.value;while(++a<l){s=o[a],s.x0=e,s.x1=i;s.y0=n,s.y1=n+=s.value*u}}function nO(t,e,n,i,r){(t.depth&1?eO:EC)(t,e,n,i,r)}var iO=(1+Math.sqrt(5))/2;function rO(t,e,n,i,r,o){var s=[],a=e.children,l,u,c=0,f=0,h=a.length,d,p,m=e.value,g,y,v,_,x,b,w;while(c<h){d=r-n,p=o-i;do{g=a[f++].value}while(!g&&f<h);y=v=g;b=Math.max(p/d,d/p)/(m*t);w=g*g*b;x=Math.max(v/w,w/y);for(;f<h;++f){g+=u=a[f].value;if(u<y)y=u;if(u>v)v=u;w=g*g*b;_=Math.max(v/w,w/y);if(_>x){g-=u;break}x=_}s.push(l={value:g,dice:d<p,children:a.slice(c,f)});if(l.dice)EC(l,n,i,r,m?i+=p*g/m:o);else eO(l,n,i,m?n+=d*g/m:r,o);m-=g,c=f}return s}const oO=function t(e){function n(t,n,i,r,o){rO(e,t,n,i,r,o)}n.ratio=function(e){return t((e=+e)>1?e:1)};return n}(iO);const sO=function t(e){function n(t,n,i,r,o){if((s=t._squarify)&&s.ratio===e){var s,a,l,u,c=-1,f,h=s.length,d=t.value;while(++c<h){a=s[c],l=a.children;for(u=a.value=0,f=l.length;u<f;++u)a.value+=l[u].value;if(a.dice)EC(a,n,i,r,d?i+=(o-i)*a.value/d:o);else eO(a,n,i,d?n+=(r-n)*a.value/d:r,o);d-=a.value}}else{t._squarify=s=rO(e,t,n,i,r,o);s.ratio=e}}n.ratio=function(e){return t((e=+e)>1?e:1)};return n}(iO);function aO(){var t=oO,e=false,n=1,i=1,r=[0],o=VR,s=VR,a=VR,l=VR,u=VR;function c(t){t.x0=t.y0=0;t.x1=n;t.y1=i;t.eachBefore(f);r=[0];if(e)t.eachBefore(SC);return t}function f(e){var n=r[e.depth],i=e.x0+n,c=e.y0+n,f=e.x1-n,h=e.y1-n;if(f<i)i=f=(i+f)/2;if(h<c)c=h=(c+h)/2;e.x0=i;e.y0=c;e.x1=f;e.y1=h;if(e.children){n=r[e.depth+1]=o(e)/2;i+=u(e)-n;c+=s(e)-n;f-=a(e)-n;h-=l(e)-n;if(f<i)i=f=(i+f)/2;if(h<c)c=h=(c+h)/2;t(e,i,c,f,h)}}c.round=function(t){return arguments.length?(e=!!t,c):e};c.size=function(t){return arguments.length?(n=+t[0],i=+t[1],c):[n,i]};c.tile=function(e){return arguments.length?(t=GR(e),c):t};c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()};c.paddingInner=function(t){return arguments.length?(o=typeof t==="function"?t:KR(+t),c):o};c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()};c.paddingTop=function(t){return arguments.length?(s=typeof t==="function"?t:KR(+t),c):s};c.paddingRight=function(t){return arguments.length?(a=typeof t==="function"?t:KR(+t),c):a};c.paddingBottom=function(t){return arguments.length?(l=typeof t==="function"?t:KR(+t),c):l};c.paddingLeft=function(t){return arguments.length?(u=typeof t==="function"?t:KR(+t),c):u};return c}function lO(t,e,n){const i={};t.each((t=>{const r=t.data;if(n(r))i[e(r)]=t}));t.lookup=i;return t}function uO(t){Us.call(this,null,t)}uO.Definition={type:"Nest",metadata:{treesource:true,changes:true},params:[{name:"keys",type:"field",array:true},{name:"generate",type:"boolean"}]};const cO=t=>t.values;(0,m.XW)(uO,Us,{transform(t,e){if(!e.source){(0,m.vU)("Nest transform requires an upstream data source.")}var n=t.generate,i=t.modified(),r=e.clone(),o=this.value;if(!o||i||e.changed()){if(o){o.each((t=>{if(t.children&&xo(t.data)){r.rem.push(t.data)}}))}this.value=o=FR({values:(0,m.IX)(t.keys).reduce(((t,e)=>{t.key(e);return t}),fO()).entries(r.source)},cO);if(n){o.each((t=>{if(t.children){t=ko(t.data);r.add.push(t);r.source.push(t)}}))}lO(o,bo,bo)}r.source.root=o;return r}});function fO(){const t=[],e={entries:t=>i(n(t,0),0),key:n=>(t.push(n),e)};function n(e,i){if(i>=t.length){return e}const r=e.length,o=t[i++],s={},a={};let l=-1,u,c,f;while(++l<r){u=o(c=e[l])+"";if(f=s[u]){f.push(c)}else{s[u]=[c]}}for(u in s){a[u]=n(s[u],i)}return a}function i(e,n){if(++n>t.length)return e;const r=[];for(const t in e){r.push({key:t,values:i(e[t],n)})}return r}return e}function hO(t){Us.call(this,null,t)}const dO=(t,e)=>t.parent===e.parent?1:2;(0,m.XW)(hO,Us,{transform(t,e){if(!e.source||!e.source.root){(0,m.vU)(this.constructor.name+" transform requires a backing tree data source.")}const n=this.layout(t.method),i=this.fields,r=e.source.root,o=t.as||i;if(t.field)r.sum(t.field);else r.count();if(t.sort)r.sort(To(t.sort,(t=>t.data)));pO(n,this.params,t);if(n.separation){n.separation(t.separation!==false?dO:m.kX)}try{this.value=n(r)}catch(s){(0,m.vU)(s)}r.each((t=>mO(t,i,o)));return e.reflow(t.modified()).modifies(o).modifies("leaf")}});function pO(t,e,n){for(let i,r=0,o=e.length;r<o;++r){i=e[r];if(i in n)t[i](n[i])}}function mO(t,e,n){const i=t.data,r=e.length-1;for(let o=0;o<r;++o){i[n[o]]=t[e[o]]}i[n[r]]=t.children?t.children.length:0}const gO=["x","y","r","depth","children"];function yO(t){hO.call(this,t)}yO.Definition={type:"Pack",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:gO.length,default:gO}]};(0,m.XW)(yO,hO,{layout:bC,params:["radius","size","padding"],fields:gO});const vO=["x0","y0","x1","y1","depth","children"];function _O(t){hO.call(this,t)}_O.Definition={type:"Partition",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:vO.length,default:vO}]};(0,m.XW)(_O,hO,{layout:TC,params:["size","round","padding"],fields:vO});function xO(t){Us.call(this,null,t)}xO.Definition={type:"Stratify",metadata:{treesource:true},params:[{name:"key",type:"field",required:true},{name:"parentKey",type:"field",required:true}]};(0,m.XW)(xO,Us,{transform(t,e){if(!e.source){(0,m.vU)("Stratify transform requires an upstream data source.")}let n=this.value;const i=t.modified(),r=e.fork(e.ALL).materialize(e.SOURCE),o=!n||i||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);r.source=r.source.slice();if(o){n=r.source.length?lO(RC().id(t.key).parentId(t.parentKey)(r.source),t.key,m.yb):lO(RC()([{}]),t.key,t.key)}r.source.root=this.value=n;return r}});const bO={tidy:HC,cluster:QC};const wO=["x","y","depth","children"];function kO(t){hO.call(this,t)}kO.Definition={type:"Tree",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:true,length:2},{name:"nodeSize",type:"number",array:true,length:2},{name:"separation",type:"boolean",default:true},{name:"as",type:"string",array:true,length:wO.length,default:wO}]};(0,m.XW)(kO,hO,{layout(t){const e=t||"tidy";if((0,m.nr)(bO,e))return bO[e]();else(0,m.vU)("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:wO});function MO(t){Us.call(this,[],t)}MO.Definition={type:"TreeLinks",metadata:{tree:true,generates:true,changes:true},params:[]};(0,m.XW)(MO,Us,{transform(t,e){const n=this.value,i=e.source&&e.source.root,r=e.fork(e.NO_SOURCE),o={};if(!i)(0,m.vU)("TreeLinks transform requires a tree data source.");if(e.changed(e.ADD_REM)){r.rem=n;e.visit(e.SOURCE,(t=>o[bo(t)]=1));i.each((t=>{const e=t.data,n=t.parent&&t.parent.data;if(n&&o[bo(e)]&&o[bo(n)]){r.add.push(ko({source:n,target:e}))}}));this.value=r.add}else if(e.changed(e.MOD)){e.visit(e.MOD,(t=>o[bo(t)]=1));n.forEach((t=>{if(o[bo(t.source)]||o[bo(t.target)]){r.mod.push(t)}}))}return r}});const SO={binary:tO,dice:EC,slice:eO,slicedice:nO,squarify:oO,resquarify:sO};const EO=["x0","y0","x1","y1","depth","children"];function TO(t){hO.call(this,t)}TO.Definition={type:"Treemap",metadata:{tree:true,modifies:true},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:false},{name:"size",type:"number",array:true,length:2},{name:"as",type:"string",array:true,length:EO.length,default:EO}]};(0,m.XW)(TO,hO,{layout(){const t=aO();t.ratio=e=>{const n=t.tile();if(n.ratio)t.tile(n.ratio(e))};t.method=e=>{if((0,m.nr)(SO,e))t.tile(SO[e]);else(0,m.vU)("Unrecognized Treemap layout method: "+e)};return t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:EO});const $O=4278190080;function DO(t,e){const n=t.bitmap();(e||[]).forEach((e=>n.set(t(e.boundary[0]),t(e.boundary[3]))));return[n,undefined]}function AO(t,e,n,i,r){const o=t.width,s=t.height,a=i||r,l=rh(o,s).getContext("2d"),u=rh(o,s).getContext("2d"),c=a&&rh(o,s).getContext("2d");n.forEach((t=>zO(l,t,false)));zO(u,e,false);if(a){zO(c,e,true)}const f=NO(l,o,s),h=NO(u,o,s),d=a&&NO(c,o,s),p=t.bitmap(),m=a&&t.bitmap();let g,y,v,_,x,b,w,k;for(y=0;y<s;++y){for(g=0;g<o;++g){x=y*o+g;b=f[x]&$O;k=h[x]&$O;w=a&&d[x]&$O;if(b||w||k){v=t(g);_=t(y);if(!r&&(b||k))p.set(v,_);if(a&&(b||w))m.set(v,_)}}}return[p,m]}function NO(t,e,n){return new Uint32Array(t.getImageData(0,0,e,n).data.buffer)}function zO(t,e,n){if(!e.length)return;const i=e[0].mark.marktype;if(i==="group"){e.forEach((e=>{e.items.forEach((e=>zO(t,e.items,n)))}))}else{Ub[i].draw(t,{items:n?e.map(RO):e})}}function RO(t){const e=So(t,{});if(e.stroke&&e.strokeOpacity!==0||e.fill&&e.fillOpacity!==0){return{...e,strokeOpacity:1,stroke:"#000",fillOpacity:0}}return e}const CO=5,OO=31,UO=32,PO=new Uint32Array(UO+1),IO=new Uint32Array(UO+1);IO[0]=0;PO[0]=~IO[0];for(let GV=1;GV<=UO;++GV){IO[GV]=IO[GV-1]<<1|1;PO[GV]=~IO[GV]}function qO(t,e){const n=new Uint32Array(~~((t*e+UO)/UO));function i(t,e){n[t]|=e}function r(t,e){n[t]&=e}return{array:n,get:(e,i)=>{const r=i*t+e;return n[r>>>CO]&1<<(r&OO)},set:(e,n)=>{const r=n*t+e;i(r>>>CO,1<<(r&OO))},clear:(e,n)=>{const i=n*t+e;r(i>>>CO,~(1<<(i&OO)))},getRange:(e,i,r,o)=>{let s=o,a,l,u,c;for(;s>=i;--s){a=s*t+e;l=s*t+r;u=a>>>CO;c=l>>>CO;if(u===c){if(n[u]&PO[a&OO]&IO[(l&OO)+1]){return true}}else{if(n[u]&PO[a&OO])return true;if(n[c]&IO[(l&OO)+1])return true;for(let t=u+1;t<c;++t){if(n[t])return true}}}return false},setRange:(e,n,r,o)=>{let s,a,l,u,c;for(;n<=o;++n){s=n*t+e;a=n*t+r;l=s>>>CO;u=a>>>CO;if(l===u){i(l,PO[s&OO]&IO[(a&OO)+1])}else{i(l,PO[s&OO]);i(u,IO[(a&OO)+1]);for(c=l+1;c<u;++c)i(c,4294967295)}}},clearRange:(e,n,i,o)=>{let s,a,l,u,c;for(;n<=o;++n){s=n*t+e;a=n*t+i;l=s>>>CO;u=a>>>CO;if(l===u){r(l,IO[s&OO]|PO[(a&OO)+1])}else{r(l,IO[s&OO]);r(u,PO[(a&OO)+1]);for(c=l+1;c<u;++c)r(c,0)}}},outOfBounds:(n,i,r,o)=>n<0||i<0||o>=e||r>=t}}function LO(t,e,n){const i=Math.max(1,Math.sqrt(t*e/1e6)),r=~~((t+2*n+i)/i),o=~~((e+2*n+i)/i),s=t=>~~((t+n)/i);s.invert=t=>t*i-n;s.bitmap=()=>qO(r,o);s.ratio=i;s.padding=n;s.width=t;s.height=e;return s}function FO(t,e,n,i){const r=t.width,o=t.height;return function(t){const e=t.datum.datum.items[i].items,n=e.length,s=t.datum.fontSize,a=ub.width(t.datum,t.datum.text);let l=0,u,c,f,h,d,p,m;for(let i=0;i<n;++i){u=e[i].x;f=e[i].y;c=e[i].x2===undefined?u:e[i].x2;h=e[i].y2===undefined?f:e[i].y2;d=(u+c)/2;p=(f+h)/2;m=Math.abs(c-u+h-f);if(m>=l){l=m;t.x=d;t.y=p}}d=a/2;p=s/2;u=t.x-d;c=t.x+d;f=t.y-p;h=t.y+p;t.align="center";if(u<0&&c<=r){t.align="left"}else if(0<=u&&r<c){t.align="right"}t.baseline="middle";if(f<0&&h<=o){t.baseline="top"}else if(0<=f&&o<h){t.baseline="bottom"}return true}}function jO(t,e,n,i,r,o){let s=n/2;return t-s<0||t+s>r||e-(s=i/2)<0||e+s>o}function WO(t,e,n,i,r,o,s,a){const l=r*o/(i*2),u=t(e-l),c=t(e+l),f=t(n-(o=o/2)),h=t(n+o);return s.outOfBounds(u,f,c,h)||s.getRange(u,f,c,h)||a&&a.getRange(u,f,c,h)}function XO(t,e,n,i){const r=t.width,o=t.height,s=e[0],a=e[1];function l(e,n,i,l,u){const c=t.invert(e),f=t.invert(n);let h=i,d=o,p;if(!jO(c,f,l,u,r,o)&&!WO(t,c,f,u,l,h,s,a)&&!WO(t,c,f,u,l,u,s,null)){while(d-h>=1){p=(h+d)/2;if(WO(t,c,f,u,l,p,s,a)){d=p}else{h=p}}if(h>i){return[c,f,h,true]}}}return function(e){const a=e.datum.datum.items[i].items,u=a.length,c=e.datum.fontSize,f=ub.width(e.datum,e.datum.text);let h=n?c:0,d=false,p=false,m=0,g,y,v,_,x,b,w,k,M,S,E,T,$,D,A,N,z;for(let i=0;i<u;++i){g=a[i].x;v=a[i].y;y=a[i].x2===undefined?g:a[i].x2;_=a[i].y2===undefined?v:a[i].y2;if(g>y){z=g;g=y;y=z}if(v>_){z=v;v=_;_=z}M=t(g);E=t(y);S=~~((M+E)/2);T=t(v);D=t(_);$=~~((T+D)/2);for(w=S;w>=M;--w){for(k=$;k>=T;--k){N=l(w,k,h,f,c);if(N){[e.x,e.y,h,d]=N}}}for(w=S;w<=E;++w){for(k=$;k<=D;++k){N=l(w,k,h,f,c);if(N){[e.x,e.y,h,d]=N}}}if(!d&&!n){A=Math.abs(y-g+_-v);x=(g+y)/2;b=(v+_)/2;if(A>=m&&!jO(x,b,f,c,r,o)&&!WO(t,x,b,c,f,c,s,null)){m=A;e.x=x;e.y=b;p=true}}}if(d||p){x=f/2;b=c/2;s.setRange(t(e.x-x),t(e.y-b),t(e.x+x),t(e.y+b));e.align="center";e.baseline="middle";return true}else{return false}}}const HO=[-1,-1,1,1];const BO=[-1,1,-1,1];function YO(t,e,n,i){const r=t.width,o=t.height,s=e[0],a=e[1],l=t.bitmap();return function(e){const u=e.datum.datum.items[i].items,c=u.length,f=e.datum.fontSize,h=ub.width(e.datum,e.datum.text),d=[];let p=n?f:0,m=false,g=false,y=0,v,_,x,b,w,k,M,S,E,T,$,D;for(let i=0;i<c;++i){v=u[i].x;x=u[i].y;_=u[i].x2===undefined?v:u[i].x2;b=u[i].y2===undefined?x:u[i].y2;d.push([t((v+_)/2),t((x+b)/2)]);while(d.length){[M,S]=d.pop();if(s.get(M,S)||a.get(M,S)||l.get(M,S))continue;l.set(M,S);for(let t=0;t<4;++t){w=M+HO[t];k=S+BO[t];if(!l.outOfBounds(w,k,w,k))d.push([w,k])}w=t.invert(M);k=t.invert(S);E=p;T=o;if(!jO(w,k,h,f,r,o)&&!WO(t,w,k,f,h,E,s,a)&&!WO(t,w,k,f,h,f,s,null)){while(T-E>=1){$=(E+T)/2;if(WO(t,w,k,f,h,$,s,a)){T=$}else{E=$}}if(E>p){e.x=w;e.y=k;p=E;m=true}}}if(!m&&!n){D=Math.abs(_-v+b-x);w=(v+_)/2;k=(x+b)/2;if(D>=y&&!jO(w,k,h,f,r,o)&&!WO(t,w,k,f,h,f,s,null)){y=D;e.x=w;e.y=k;g=true}}}if(m||g){w=h/2;k=f/2;s.setRange(t(e.x-w),t(e.y-k),t(e.x+w),t(e.y+k));e.align="center";e.baseline="middle";return true}else{return false}}}const JO=["right","center","left"],GO=["bottom","middle","top"];function VO(t,e,n,i){const r=t.width,o=t.height,s=e[0],a=e[1],l=i.length;return function(e){const u=e.boundary,c=e.datum.fontSize;if(u[2]<0||u[5]<0||u[0]>r||u[3]>o){return false}let f=e.textWidth??0,h,d,p,m,g,y,v,_,x,b,w,k,M,S,E;for(let r=0;r<l;++r){h=(n[r]&3)-1;d=(n[r]>>>2&3)-1;p=h===0&&d===0||i[r]<0;m=h&&d?Math.SQRT1_2:1;g=i[r]<0?-1:1;y=u[1+h]+i[r]*h*m;w=u[4+d]+g*c*d/2+i[r]*d*m;_=w-c/2;x=w+c/2;k=t(y);S=t(_);E=t(x);if(!f){if(!KO(k,k,S,E,s,a,y,y,_,x,u,p)){continue}else{f=ub.width(e.datum,e.datum.text)}}b=y+g*f*h/2;y=b-f/2;v=b+f/2;k=t(y);M=t(v);if(KO(k,M,S,E,s,a,y,v,_,x,u,p)){e.x=!h?b:h*g<0?v:y;e.y=!d?w:d*g<0?x:_;e.align=JO[h*g+1];e.baseline=GO[d*g+1];s.setRange(k,S,M,E);return true}}return false}}function KO(t,e,n,i,r,o,s,a,l,u,c,f){return!(r.outOfBounds(t,n,e,i)||(f&&o||r).getRange(t,n,e,i))}const ZO=0,QO=4,tU=8,eU=0,nU=1,iU=2;const rU={"top-left":ZO+eU,top:ZO+nU,"top-right":ZO+iU,left:QO+eU,middle:QO+nU,right:QO+iU,"bottom-left":tU+eU,bottom:tU+nU,"bottom-right":tU+iU};const oU={naive:FO,"reduced-search":XO,floodfill:YO};function sU(t,e,n,i,r,o,s,a,l,u,c){if(!t.length)return t;const f=Math.max(i.length,r.length),h=aU(i,f),d=lU(r,f),p=uU(t[0].datum),m=p==="group"&&t[0].datum.items[l].marktype,g=m==="area",y=cU(p,m,a,l),v=u===null||u===Infinity,_=g&&c==="naive";let x=-1,b=-1;const w=t.map((t=>{const e=v?ub.width(t,t.text):undefined;x=Math.max(x,e);b=Math.max(b,t.fontSize);return{datum:t,opacity:0,x:undefined,y:undefined,align:undefined,baseline:undefined,boundary:y(t),textWidth:e}}));u=u===null||u===Infinity?Math.max(x,b)+Math.max(...i):u;const k=LO(e[0],e[1],u);let M;if(!_){if(n){w.sort(((t,e)=>n(t.datum,e.datum)))}let e=false;for(let t=0;t<d.length&&!e;++t){e=d[t]===5||h[t]<0}const i=(p&&s||g)&&t.map((t=>t.datum));M=o.length||i?AO(k,i||[],o,e,g):DO(k,s&&w)}const S=g?oU[c](k,M,s,l):VO(k,M,d,h);w.forEach((t=>t.opacity=+S(t)));return w}function aU(t,e){const n=new Float64Array(e),i=t.length;for(let r=0;r<i;++r)n[r]=t[r]||0;for(let r=i;r<e;++r)n[r]=n[i-1];return n}function lU(t,e){const n=new Int8Array(e),i=t.length;for(let r=0;r<i;++r)n[r]|=rU[t[r]];for(let r=i;r<e;++r)n[r]=n[i-1];return n}function uU(t){return t&&t.mark&&t.mark.marktype}function cU(t,e,n,i){const r=t=>[t.x,t.x,t.x,t.y,t.y,t.y];if(!t){return r}else if(t==="line"||t==="area"){return t=>r(t.datum)}else if(e==="line"){return t=>{const e=t.datum.items[i].items;return r(e.length?e[n==="start"?0:e.length-1]:{x:NaN,y:NaN})}}else{return t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}}}const fU=["x","y","opacity","align","baseline"];const hU=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function dU(t){Us.call(this,null,t)}dU.Definition={type:"Label",metadata:{modifies:true},params:[{name:"size",type:"number",array:true,length:2,required:true},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:true,default:hU},{name:"offset",type:"number",array:true,default:[1]},{name:"padding",type:"number",default:0,null:true},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:true},{name:"avoidMarks",type:"data",array:true},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:true,length:fU.length,default:fU}]};(0,m.XW)(dU,Us,{transform(t,e){function n(n){const i=t[n];return(0,m.mf)(i)&&e.modified(i.fields)}const i=t.modified();if(!(i||e.changed(e.ADD_REM)||n("sort")))return;if(!t.size||t.size.length!==2){(0,m.vU)("Size parameter should be specified as a [width, height] array.")}const r=t.as||fU;sU(e.materialize(e.SOURCE).source||[],t.size,t.sort,(0,m.IX)(t.offset==null?1:t.offset),(0,m.IX)(t.anchor||hU),t.avoidMarks||[],t.avoidBaseMark!==false,t.lineAnchor||"end",t.markIndex||0,t.padding===undefined?0:t.padding,t.method||"naive").forEach((t=>{const e=t.datum;e[r[0]]=t.x;e[r[1]]=t.y;e[r[2]]=t.opacity;e[r[3]]=t.align;e[r[4]]=t.baseline}));return e.reflow(i).modifies(r)}});function pU(t,e){var n=[],i=function(t){return t(a)},r,o,s,a,l,u;if(e==null){n.push(t)}else{for(r={},o=0,s=t.length;o<s;++o){a=t[o];l=e.map(i);u=r[l];if(!u){r[l]=u=[];u.dims=l;n.push(u)}u.push(a)}}return n}function mU(t){Us.call(this,null,t)}mU.Definition={type:"Loess",metadata:{generates:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:true}]};(0,m.XW)(mU,Us,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=e.materialize(e.SOURCE).source,r=pU(i,t.groupby),o=(t.groupby||[]).map(m.el),s=o.length,a=t.as||[(0,m.el)(t.x),(0,m.el)(t.y)],l=[];r.forEach((e=>{Ga(e,t.x,t.y,t.bandwidth||.3).forEach((t=>{const n={};for(let i=0;i<s;++i){n[o[i]]=e.dims[i]}n[a[0]]=t[0];n[a[1]]=t[1];l.push(ko(n))}))}));if(this.value)n.rem=this.value;this.value=n.add=n.source=l}return n}});const gU={linear:qa,log:La,exp:Fa,pow:ja,quad:Wa,poly:Xa};const yU=(t,e)=>t==="poly"?e:t==="quad"?2:1;function vU(t){Us.call(this,null,t)}vU.Definition={type:"Regression",metadata:{generates:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"groupby",type:"field",array:true},{name:"method",type:"string",default:"linear",values:Object.keys(gU)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:true,length:2},{name:"params",type:"boolean",default:false},{name:"as",type:"string",array:true}]};(0,m.XW)(vU,Us,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=e.materialize(e.SOURCE).source,r=pU(i,t.groupby),o=(t.groupby||[]).map(m.el),s=t.method||"linear",a=t.order||3,l=yU(s,a),u=t.as||[(0,m.el)(t.x),(0,m.el)(t.y)],c=gU[s],f=[];let h=t.extent;if(!(0,m.nr)(gU,s)){(0,m.vU)("Invalid regression method: "+s)}if(h!=null){if(s==="log"&&h[0]<=0){e.dataflow.warn("Ignoring extent with values <= 0 for log regression.");h=null}}r.forEach((n=>{const i=n.length;if(i<=l){e.dataflow.warn("Skipping regression with more parameters than data points.");return}const r=c(n,t.x,t.y,a);if(t.params){f.push(ko({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));return}const d=h||(0,m.We)(n,t.x),p=t=>{const e={};for(let i=0;i<o.length;++i){e[o[i]]=n.dims[i]}e[u[0]]=t[0];e[u[1]]=t[1];f.push(ko(e))};if(s==="linear"){d.forEach((t=>p([t,r.predict(t)])))}else{tl(r.predict,d,25,200).forEach(p)}}));if(this.value)n.rem=this.value;this.value=n.add=n.source=f}return n}});const _U=11102230246251565e-32;const xU=134217729;const bU=(3+8*_U)*_U;function wU(t,e,n,i,r){let o,s,a,l;let u=e[0];let c=i[0];let f=0;let h=0;if(c>u===c>-u){o=u;u=e[++f]}else{o=c;c=i[++h]}let d=0;if(f<t&&h<n){if(c>u===c>-u){s=u+o;a=o-(s-u);u=e[++f]}else{s=c+o;a=o-(s-c);c=i[++h]}o=s;if(a!==0){r[d++]=a}while(f<t&&h<n){if(c>u===c>-u){s=o+u;l=s-o;a=o-(s-l)+(u-l);u=e[++f]}else{s=o+c;l=s-o;a=o-(s-l)+(c-l);c=i[++h]}o=s;if(a!==0){r[d++]=a}}}while(f<t){s=o+u;l=s-o;a=o-(s-l)+(u-l);u=e[++f];o=s;if(a!==0){r[d++]=a}}while(h<n){s=o+c;l=s-o;a=o-(s-l)+(c-l);c=i[++h];o=s;if(a!==0){r[d++]=a}}if(o!==0||d===0){r[d++]=o}return d}function kU(t,e,n,i,r,o,s,a){return wU(wU(t,e,n,i,s),s,r,o,a)}function MU(t,e,n,i){let r,o,s,a,l;let u,c,f,h,d,p;c=xU*n;d=c-(c-n);p=n-d;let m=e[0];r=m*n;c=xU*m;f=c-(c-m);h=m-f;s=h*p-(r-f*d-h*d-f*p);let g=0;if(s!==0){i[g++]=s}for(let y=1;y<t;y++){m=e[y];a=m*n;c=xU*m;f=c-(c-m);h=m-f;l=h*p-(a-f*d-h*d-f*p);o=r+l;u=o-r;s=r-(o-u)+(l-u);if(s!==0){i[g++]=s}r=a+o;s=o-(r-a);if(s!==0){i[g++]=s}}if(r!==0||g===0){i[g++]=r}return g}function SU(t,e){for(let n=0;n<t;n++)e[n]=-e[n];return t}function EU(t,e){let n=e[0];for(let i=1;i<t;i++)n+=e[i];return n}function TU(t){return new Float64Array(t)}const $U=(3+16*_U)*_U;const DU=(2+12*_U)*_U;const AU=(9+64*_U)*_U*_U;const NU=TU(4);const zU=TU(8);const RU=TU(12);const CU=TU(16);const OU=TU(4);function UU(t,e,n,i,r,o,s){let a,l,u,c;let f,h,d,p,m,g,y,v,_,x,b,w,k,M;const S=t-r;const E=n-r;const T=e-o;const $=i-o;x=S*$;h=xU*S;d=h-(h-S);p=S-d;h=xU*$;m=h-(h-$);g=$-m;b=p*g-(x-d*m-p*m-d*g);w=T*E;h=xU*T;d=h-(h-T);p=T-d;h=xU*E;m=h-(h-E);g=E-m;k=p*g-(w-d*m-p*m-d*g);y=b-k;f=b-y;NU[0]=b-(y+f)+(f-k);v=x+y;f=v-x;_=x-(v-f)+(y-f);y=_-w;f=_-y;NU[1]=_-(y+f)+(f-w);M=v+y;f=M-v;NU[2]=v-(M-f)+(y-f);NU[3]=M;let D=EU(4,NU);let A=DU*s;if(D>=A||-D>=A){return D}f=t-S;a=t-(S+f)+(f-r);f=n-E;u=n-(E+f)+(f-r);f=e-T;l=e-(T+f)+(f-o);f=i-$;c=i-($+f)+(f-o);if(a===0&&l===0&&u===0&&c===0){return D}A=AU*s+bU*Math.abs(D);D+=S*c+$*a-(T*u+E*l);if(D>=A||-D>=A)return D;x=a*$;h=xU*a;d=h-(h-a);p=a-d;h=xU*$;m=h-(h-$);g=$-m;b=p*g-(x-d*m-p*m-d*g);w=l*E;h=xU*l;d=h-(h-l);p=l-d;h=xU*E;m=h-(h-E);g=E-m;k=p*g-(w-d*m-p*m-d*g);y=b-k;f=b-y;OU[0]=b-(y+f)+(f-k);v=x+y;f=v-x;_=x-(v-f)+(y-f);y=_-w;f=_-y;OU[1]=_-(y+f)+(f-w);M=v+y;f=M-v;OU[2]=v-(M-f)+(y-f);OU[3]=M;const N=wU(4,NU,4,OU,zU);x=S*c;h=xU*S;d=h-(h-S);p=S-d;h=xU*c;m=h-(h-c);g=c-m;b=p*g-(x-d*m-p*m-d*g);w=T*u;h=xU*T;d=h-(h-T);p=T-d;h=xU*u;m=h-(h-u);g=u-m;k=p*g-(w-d*m-p*m-d*g);y=b-k;f=b-y;OU[0]=b-(y+f)+(f-k);v=x+y;f=v-x;_=x-(v-f)+(y-f);y=_-w;f=_-y;OU[1]=_-(y+f)+(f-w);M=v+y;f=M-v;OU[2]=v-(M-f)+(y-f);OU[3]=M;const z=wU(N,zU,4,OU,RU);x=a*c;h=xU*a;d=h-(h-a);p=a-d;h=xU*c;m=h-(h-c);g=c-m;b=p*g-(x-d*m-p*m-d*g);w=l*u;h=xU*l;d=h-(h-l);p=l-d;h=xU*u;m=h-(h-u);g=u-m;k=p*g-(w-d*m-p*m-d*g);y=b-k;f=b-y;OU[0]=b-(y+f)+(f-k);v=x+y;f=v-x;_=x-(v-f)+(y-f);y=_-w;f=_-y;OU[1]=_-(y+f)+(f-w);M=v+y;f=M-v;OU[2]=v-(M-f)+(y-f);OU[3]=M;const R=wU(z,RU,4,OU,CU);return CU[R-1]}function PU(t,e,n,i,r,o){const s=(e-o)*(n-r);const a=(t-r)*(i-o);const l=s-a;if(s===0||a===0||s>0!==a>0)return l;const u=Math.abs(s+a);if(Math.abs(l)>=$U*u)return l;return-UU(t,e,n,i,r,o,u)}function IU(t,e,n,i,r,o){return(e-o)*(n-r)-(t-r)*(i-o)}const qU=(7+56*_U)*_U;const LU=(3+28*_U)*_U;const FU=(26+288*_U)*_U*_U;const jU=TU(4);const WU=TU(4);const XU=TU(4);const HU=TU(4);const BU=TU(4);const YU=TU(4);const JU=TU(4);const GU=TU(4);const VU=TU(4);const KU=TU(8);const ZU=TU(8);const QU=TU(8);const tP=TU(4);const eP=TU(8);const nP=TU(8);const iP=TU(8);const rP=TU(12);let oP=TU(192);let sP=TU(192);function aP(t,e,n){t=sum(t,oP,e,n,sP);const i=oP;oP=sP;sP=i;return t}function lP(t,e,n,i,r,o,s,a){let l,u,c,f,h,d,p,m,g,y,v,_,x,b,w,k;if(t===0){if(e===0){s[0]=0;a[0]=0;return 1}else{k=-e;v=k*n;u=splitter*k;c=u-(u-k);f=k-c;u=splitter*n;h=u-(u-n);d=n-h;s[0]=f*d-(v-c*h-f*h-c*d);s[1]=v;v=e*r;u=splitter*e;c=u-(u-e);f=e-c;u=splitter*r;h=u-(u-r);d=r-h;a[0]=f*d-(v-c*h-f*h-c*d);a[1]=v;return 2}}else{if(e===0){v=t*i;u=splitter*t;c=u-(u-t);f=t-c;u=splitter*i;h=u-(u-i);d=i-h;s[0]=f*d-(v-c*h-f*h-c*d);s[1]=v;k=-t;v=k*o;u=splitter*k;c=u-(u-k);f=k-c;u=splitter*o;h=u-(u-o);d=o-h;a[0]=f*d-(v-c*h-f*h-c*d);a[1]=v;return 2}else{v=t*i;u=splitter*t;c=u-(u-t);f=t-c;u=splitter*i;h=u-(u-i);d=i-h;_=f*d-(v-c*h-f*h-c*d);x=e*n;u=splitter*e;c=u-(u-e);f=e-c;u=splitter*n;h=u-(u-n);d=n-h;b=f*d-(x-c*h-f*h-c*d);p=_-b;l=_-p;s[0]=_-(p+l)+(l-b);m=v+p;l=m-v;y=v-(m-l)+(p-l);p=y-x;l=y-p;s[1]=y-(p+l)+(l-x);w=m+p;l=w-m;s[2]=m-(w-l)+(p-l);s[3]=w;v=e*r;u=splitter*e;c=u-(u-e);f=e-c;u=splitter*r;h=u-(u-r);d=r-h;_=f*d-(v-c*h-f*h-c*d);x=t*o;u=splitter*t;c=u-(u-t);f=t-c;u=splitter*o;h=u-(u-o);d=o-h;b=f*d-(x-c*h-f*h-c*d);p=_-b;l=_-p;a[0]=_-(p+l)+(l-b);m=v+p;l=m-v;y=v-(m-l)+(p-l);p=y-x;l=y-p;a[1]=y-(p+l)+(l-x);w=m+p;l=w-m;a[2]=m-(w-l)+(p-l);a[3]=w;return 4}}}function uP(t,e,n,i,r){let o,s,a,l,u,c,f,h,d,p,m,g,y;m=e*n;s=splitter*e;a=s-(s-e);l=e-a;s=splitter*n;u=s-(s-n);c=n-u;g=l*c-(m-a*u-l*u-a*c);s=splitter*i;u=s-(s-i);c=i-u;f=g*i;s=splitter*g;a=s-(s-g);l=g-a;tP[0]=l*c-(f-a*u-l*u-a*c);h=m*i;s=splitter*m;a=s-(s-m);l=m-a;p=l*c-(h-a*u-l*u-a*c);d=f+p;o=d-f;tP[1]=f-(d-o)+(p-o);y=h+d;tP[2]=d-(y-h);tP[3]=y;t=aP(t,4,tP);if(r!==0){s=splitter*r;u=s-(s-r);c=r-u;f=g*r;s=splitter*g;a=s-(s-g);l=g-a;tP[0]=l*c-(f-a*u-l*u-a*c);h=m*r;s=splitter*m;a=s-(s-m);l=m-a;p=l*c-(h-a*u-l*u-a*c);d=f+p;o=d-f;tP[1]=f-(d-o)+(p-o);y=h+d;tP[2]=d-(y-h);tP[3]=y;t=aP(t,4,tP)}return t}function cP(t,e,n,i,r,o,s,a,l,u,c,f,h){let d;let p,m,g;let y,v,_;let x,b,w;let k,M,S,E,T,$,D,A,N,z,R,C,O,U,P;const I=t-u;const q=i-u;const L=s-u;const F=e-c;const j=r-c;const W=a-c;const X=n-f;const H=o-f;const B=l-f;R=q*W;M=splitter*q;S=M-(M-q);E=q-S;M=splitter*W;T=M-(M-W);$=W-T;C=E*$-(R-S*T-E*T-S*$);O=L*j;M=splitter*L;S=M-(M-L);E=L-S;M=splitter*j;T=M-(M-j);$=j-T;U=E*$-(O-S*T-E*T-S*$);D=C-U;k=C-D;jU[0]=C-(D+k)+(k-U);A=R+D;k=A-R;z=R-(A-k)+(D-k);D=z-O;k=z-D;jU[1]=z-(D+k)+(k-O);P=A+D;k=P-A;jU[2]=A-(P-k)+(D-k);jU[3]=P;R=L*F;M=splitter*L;S=M-(M-L);E=L-S;M=splitter*F;T=M-(M-F);$=F-T;C=E*$-(R-S*T-E*T-S*$);O=I*W;M=splitter*I;S=M-(M-I);E=I-S;M=splitter*W;T=M-(M-W);$=W-T;U=E*$-(O-S*T-E*T-S*$);D=C-U;k=C-D;WU[0]=C-(D+k)+(k-U);A=R+D;k=A-R;z=R-(A-k)+(D-k);D=z-O;k=z-D;WU[1]=z-(D+k)+(k-O);P=A+D;k=P-A;WU[2]=A-(P-k)+(D-k);WU[3]=P;R=I*j;M=splitter*I;S=M-(M-I);E=I-S;M=splitter*j;T=M-(M-j);$=j-T;C=E*$-(R-S*T-E*T-S*$);O=q*F;M=splitter*q;S=M-(M-q);E=q-S;M=splitter*F;T=M-(M-F);$=F-T;U=E*$-(O-S*T-E*T-S*$);D=C-U;k=C-D;XU[0]=C-(D+k)+(k-U);A=R+D;k=A-R;z=R-(A-k)+(D-k);D=z-O;k=z-D;XU[1]=z-(D+k)+(k-O);P=A+D;k=P-A;XU[2]=A-(P-k)+(D-k);XU[3]=P;d=sum(sum(scale(4,jU,X,eP),eP,scale(4,WU,H,nP),nP,iP),iP,scale(4,XU,B,eP),eP,oP);let Y=estimate(d,oP);let J=LU*h;if(Y>=J||-Y>=J){return Y}k=t-I;p=t-(I+k)+(k-u);k=i-q;m=i-(q+k)+(k-u);k=s-L;g=s-(L+k)+(k-u);k=e-F;y=e-(F+k)+(k-c);k=r-j;v=r-(j+k)+(k-c);k=a-W;_=a-(W+k)+(k-c);k=n-X;x=n-(X+k)+(k-f);k=o-H;b=o-(H+k)+(k-f);k=l-B;w=l-(B+k)+(k-f);if(p===0&&m===0&&g===0&&y===0&&v===0&&_===0&&x===0&&b===0&&w===0){return Y}J=FU*h+resulterrbound*Math.abs(Y);Y+=X*(q*_+W*m-(j*g+L*v))+x*(q*W-j*L)+H*(L*y+F*g-(W*p+I*_))+b*(L*F-W*I)+B*(I*v+j*p-(F*m+q*y))+w*(I*j-F*q);if(Y>=J||-Y>=J){return Y}const G=lP(p,y,q,j,L,W,HU,BU);const V=lP(m,v,L,W,I,F,YU,JU);const K=lP(g,_,I,F,q,j,GU,VU);const Z=sum(V,YU,K,VU,KU);d=aP(d,scale(Z,KU,X,iP),iP);const Q=sum(K,GU,G,BU,ZU);d=aP(d,scale(Q,ZU,H,iP),iP);const tt=sum(G,HU,V,JU,QU);d=aP(d,scale(tt,QU,B,iP),iP);if(x!==0){d=aP(d,scale(4,jU,x,rP),rP);d=aP(d,scale(Z,KU,x,iP),iP)}if(b!==0){d=aP(d,scale(4,WU,b,rP),rP);d=aP(d,scale(Q,ZU,b,iP),iP)}if(w!==0){d=aP(d,scale(4,XU,w,rP),rP);d=aP(d,scale(tt,QU,w,iP),iP)}if(p!==0){if(v!==0){d=uP(d,p,v,B,w)}if(_!==0){d=uP(d,-p,_,H,b)}}if(m!==0){if(_!==0){d=uP(d,m,_,X,x)}if(y!==0){d=uP(d,-m,y,B,w)}}if(g!==0){if(y!==0){d=uP(d,g,y,H,b)}if(v!==0){d=uP(d,-g,v,X,x)}}return oP[d-1]}function fP(t,e,n,i,r,o,s,a,l,u,c,f){const h=t-u;const d=i-u;const p=s-u;const m=e-c;const g=r-c;const y=a-c;const v=n-f;const _=o-f;const x=l-f;const b=d*y;const w=p*g;const k=p*m;const M=h*y;const S=h*g;const E=d*m;const T=v*(b-w)+_*(k-M)+x*(S-E);const $=(Math.abs(b)+Math.abs(w))*Math.abs(v)+(Math.abs(k)+Math.abs(M))*Math.abs(_)+(Math.abs(S)+Math.abs(E))*Math.abs(x);const D=qU*$;if(T>D||-T>D){return T}return cP(t,e,n,i,r,o,s,a,l,u,c,f,$)}function hP(t,e,n,i,r,o,s,a,l,u,c,f){const h=t-u;const d=i-u;const p=s-u;const m=e-c;const g=r-c;const y=a-c;const v=n-f;const _=o-f;const x=l-f;return h*(g*x-_*y)+d*(y*v-x*m)+p*(m*_-v*g)}const dP=(10+96*_U)*_U;const pP=(4+48*_U)*_U;const mP=(44+576*_U)*_U*_U;const gP=TU(4);const yP=TU(4);const vP=TU(4);const _P=TU(4);const xP=TU(4);const bP=TU(4);const wP=TU(4);const kP=TU(4);const MP=TU(8);const SP=TU(8);const EP=TU(8);const TP=TU(8);const $P=TU(8);const DP=TU(8);const AP=TU(8);const NP=TU(8);const zP=TU(8);const RP=TU(4);const CP=TU(4);const OP=TU(4);const UP=TU(8);const PP=TU(16);const IP=TU(16);const qP=TU(16);const LP=TU(32);const FP=TU(32);const jP=TU(48);const WP=TU(64);let XP=TU(1152);let HP=TU(1152);function BP(t,e,n){t=sum(t,XP,e,n,HP);const i=XP;XP=HP;HP=i;return t}function YP(t,e,n,i,r,o,s,a,l){let u;let c,f,h,d,p,m;let g,y,v,_,x,b;let w,k,M;let S,E,T;let $,D;let A,N,z,R,C,O,U,P,I,q,L,F,j,W;const X=t-s;const H=n-s;const B=r-s;const Y=e-a;const J=i-a;const G=o-a;q=H*G;N=splitter*H;z=N-(N-H);R=H-z;N=splitter*G;C=N-(N-G);O=G-C;L=R*O-(q-z*C-R*C-z*O);F=B*J;N=splitter*B;z=N-(N-B);R=B-z;N=splitter*J;C=N-(N-J);O=J-C;j=R*O-(F-z*C-R*C-z*O);U=L-j;A=L-U;gP[0]=L-(U+A)+(A-j);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I-F;A=I-U;gP[1]=I-(U+A)+(A-F);W=P+U;A=W-P;gP[2]=P-(W-A)+(U-A);gP[3]=W;q=B*Y;N=splitter*B;z=N-(N-B);R=B-z;N=splitter*Y;C=N-(N-Y);O=Y-C;L=R*O-(q-z*C-R*C-z*O);F=X*G;N=splitter*X;z=N-(N-X);R=X-z;N=splitter*G;C=N-(N-G);O=G-C;j=R*O-(F-z*C-R*C-z*O);U=L-j;A=L-U;yP[0]=L-(U+A)+(A-j);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I-F;A=I-U;yP[1]=I-(U+A)+(A-F);W=P+U;A=W-P;yP[2]=P-(W-A)+(U-A);yP[3]=W;q=X*J;N=splitter*X;z=N-(N-X);R=X-z;N=splitter*J;C=N-(N-J);O=J-C;L=R*O-(q-z*C-R*C-z*O);F=H*Y;N=splitter*H;z=N-(N-H);R=H-z;N=splitter*Y;C=N-(N-Y);O=Y-C;j=R*O-(F-z*C-R*C-z*O);U=L-j;A=L-U;vP[0]=L-(U+A)+(A-j);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I-F;A=I-U;vP[1]=I-(U+A)+(A-F);W=P+U;A=W-P;vP[2]=P-(W-A)+(U-A);vP[3]=W;u=sum(sum(sum(scale(scale(4,gP,X,UP),UP,X,PP),PP,scale(scale(4,gP,Y,UP),UP,Y,IP),IP,LP),LP,sum(scale(scale(4,yP,H,UP),UP,H,PP),PP,scale(scale(4,yP,J,UP),UP,J,IP),IP,FP),FP,WP),WP,sum(scale(scale(4,vP,B,UP),UP,B,PP),PP,scale(scale(4,vP,G,UP),UP,G,IP),IP,LP),LP,XP);let V=estimate(u,XP);let K=pP*l;if(V>=K||-V>=K){return V}A=t-X;c=t-(X+A)+(A-s);A=e-Y;d=e-(Y+A)+(A-a);A=n-H;f=n-(H+A)+(A-s);A=i-J;p=i-(J+A)+(A-a);A=r-B;h=r-(B+A)+(A-s);A=o-G;m=o-(G+A)+(A-a);if(c===0&&f===0&&h===0&&d===0&&p===0&&m===0){return V}K=mP*l+resulterrbound*Math.abs(V);V+=(X*X+Y*Y)*(H*m+G*f-(J*h+B*p))+2*(X*c+Y*d)*(H*G-J*B)+((H*H+J*J)*(B*d+Y*h-(G*c+X*m))+2*(H*f+J*p)*(B*Y-G*X))+((B*B+G*G)*(X*p+J*c-(Y*f+H*d))+2*(B*h+G*m)*(X*J-Y*H));if(V>=K||-V>=K){return V}if(f!==0||p!==0||h!==0||m!==0){q=X*X;N=splitter*X;z=N-(N-X);R=X-z;L=R*R-(q-z*z-(z+z)*R);F=Y*Y;N=splitter*Y;z=N-(N-Y);R=Y-z;j=R*R-(F-z*z-(z+z)*R);U=L+j;A=U-L;_P[0]=L-(U-A)+(j-A);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I+F;A=U-I;_P[1]=I-(U-A)+(F-A);W=P+U;A=W-P;_P[2]=P-(W-A)+(U-A);_P[3]=W}if(h!==0||m!==0||c!==0||d!==0){q=H*H;N=splitter*H;z=N-(N-H);R=H-z;L=R*R-(q-z*z-(z+z)*R);F=J*J;N=splitter*J;z=N-(N-J);R=J-z;j=R*R-(F-z*z-(z+z)*R);U=L+j;A=U-L;xP[0]=L-(U-A)+(j-A);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I+F;A=U-I;xP[1]=I-(U-A)+(F-A);W=P+U;A=W-P;xP[2]=P-(W-A)+(U-A);xP[3]=W}if(c!==0||d!==0||f!==0||p!==0){q=B*B;N=splitter*B;z=N-(N-B);R=B-z;L=R*R-(q-z*z-(z+z)*R);F=G*G;N=splitter*G;z=N-(N-G);R=G-z;j=R*R-(F-z*z-(z+z)*R);U=L+j;A=U-L;bP[0]=L-(U-A)+(j-A);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I+F;A=U-I;bP[1]=I-(U-A)+(F-A);W=P+U;A=W-P;bP[2]=P-(W-A)+(U-A);bP[3]=W}if(c!==0){g=scale(4,gP,c,MP);u=BP(u,sum_three(scale(g,MP,2*X,PP),PP,scale(scale(4,bP,c,UP),UP,J,IP),IP,scale(scale(4,xP,c,UP),UP,-G,qP),qP,LP,jP),jP)}if(d!==0){y=scale(4,gP,d,SP);u=BP(u,sum_three(scale(y,SP,2*Y,PP),PP,scale(scale(4,xP,d,UP),UP,B,IP),IP,scale(scale(4,bP,d,UP),UP,-H,qP),qP,LP,jP),jP)}if(f!==0){v=scale(4,yP,f,EP);u=BP(u,sum_three(scale(v,EP,2*H,PP),PP,scale(scale(4,_P,f,UP),UP,G,IP),IP,scale(scale(4,bP,f,UP),UP,-Y,qP),qP,LP,jP),jP)}if(p!==0){_=scale(4,yP,p,TP);u=BP(u,sum_three(scale(_,TP,2*J,PP),PP,scale(scale(4,bP,p,UP),UP,X,IP),IP,scale(scale(4,_P,p,UP),UP,-B,qP),qP,LP,jP),jP)}if(h!==0){x=scale(4,vP,h,$P);u=BP(u,sum_three(scale(x,$P,2*B,PP),PP,scale(scale(4,xP,h,UP),UP,Y,IP),IP,scale(scale(4,_P,h,UP),UP,-J,qP),qP,LP,jP),jP)}if(m!==0){b=scale(4,vP,m,DP);u=BP(u,sum_three(scale(b,DP,2*G,PP),PP,scale(scale(4,_P,m,UP),UP,H,IP),IP,scale(scale(4,xP,m,UP),UP,-X,qP),qP,LP,jP),jP)}if(c!==0||d!==0){if(f!==0||p!==0||h!==0||m!==0){q=f*G;N=splitter*f;z=N-(N-f);R=f-z;N=splitter*G;C=N-(N-G);O=G-C;L=R*O-(q-z*C-R*C-z*O);F=H*m;N=splitter*H;z=N-(N-H);R=H-z;N=splitter*m;C=N-(N-m);O=m-C;j=R*O-(F-z*C-R*C-z*O);U=L+j;A=U-L;wP[0]=L-(U-A)+(j-A);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I+F;A=U-I;wP[1]=I-(U-A)+(F-A);W=P+U;A=W-P;wP[2]=P-(W-A)+(U-A);wP[3]=W;q=h*-J;N=splitter*h;z=N-(N-h);R=h-z;N=splitter*-J;C=N-(N- -J);O=-J-C;L=R*O-(q-z*C-R*C-z*O);F=B*-p;N=splitter*B;z=N-(N-B);R=B-z;N=splitter*-p;C=N-(N- -p);O=-p-C;j=R*O-(F-z*C-R*C-z*O);U=L+j;A=U-L;kP[0]=L-(U-A)+(j-A);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I+F;A=U-I;kP[1]=I-(U-A)+(F-A);W=P+U;A=W-P;kP[2]=P-(W-A)+(U-A);kP[3]=W;k=sum(4,wP,4,kP,NP);q=f*m;N=splitter*f;z=N-(N-f);R=f-z;N=splitter*m;C=N-(N-m);O=m-C;L=R*O-(q-z*C-R*C-z*O);F=h*p;N=splitter*h;z=N-(N-h);R=h-z;N=splitter*p;C=N-(N-p);O=p-C;j=R*O-(F-z*C-R*C-z*O);U=L-j;A=L-U;CP[0]=L-(U+A)+(A-j);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I-F;A=I-U;CP[1]=I-(U+A)+(A-F);W=P+U;A=W-P;CP[2]=P-(W-A)+(U-A);CP[3]=W;E=4}else{NP[0]=0;k=1;CP[0]=0;E=1}if(c!==0){const t=scale(k,NP,c,qP);u=BP(u,sum(scale(g,MP,c,PP),PP,scale(t,qP,2*X,LP),LP,jP),jP);const e=scale(E,CP,c,UP);u=BP(u,sum_three(scale(e,UP,2*X,PP),PP,scale(e,UP,c,IP),IP,scale(t,qP,c,LP),LP,FP,WP),WP);if(p!==0){u=BP(u,scale(scale(4,bP,c,UP),UP,p,PP),PP)}if(m!==0){u=BP(u,scale(scale(4,xP,-c,UP),UP,m,PP),PP)}}if(d!==0){const t=scale(k,NP,d,qP);u=BP(u,sum(scale(y,SP,d,PP),PP,scale(t,qP,2*Y,LP),LP,jP),jP);const e=scale(E,CP,d,UP);u=BP(u,sum_three(scale(e,UP,2*Y,PP),PP,scale(e,UP,d,IP),IP,scale(t,qP,d,LP),LP,FP,WP),WP)}}if(f!==0||p!==0){if(h!==0||m!==0||c!==0||d!==0){q=h*Y;N=splitter*h;z=N-(N-h);R=h-z;N=splitter*Y;C=N-(N-Y);O=Y-C;L=R*O-(q-z*C-R*C-z*O);F=B*d;N=splitter*B;z=N-(N-B);R=B-z;N=splitter*d;C=N-(N-d);O=d-C;j=R*O-(F-z*C-R*C-z*O);U=L+j;A=U-L;wP[0]=L-(U-A)+(j-A);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I+F;A=U-I;wP[1]=I-(U-A)+(F-A);W=P+U;A=W-P;wP[2]=P-(W-A)+(U-A);wP[3]=W;$=-G;D=-m;q=c*$;N=splitter*c;z=N-(N-c);R=c-z;N=splitter*$;C=N-(N-$);O=$-C;L=R*O-(q-z*C-R*C-z*O);F=X*D;N=splitter*X;z=N-(N-X);R=X-z;N=splitter*D;C=N-(N-D);O=D-C;j=R*O-(F-z*C-R*C-z*O);U=L+j;A=U-L;kP[0]=L-(U-A)+(j-A);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I+F;A=U-I;kP[1]=I-(U-A)+(F-A);W=P+U;A=W-P;kP[2]=P-(W-A)+(U-A);kP[3]=W;M=sum(4,wP,4,kP,zP);q=h*d;N=splitter*h;z=N-(N-h);R=h-z;N=splitter*d;C=N-(N-d);O=d-C;L=R*O-(q-z*C-R*C-z*O);F=c*m;N=splitter*c;z=N-(N-c);R=c-z;N=splitter*m;C=N-(N-m);O=m-C;j=R*O-(F-z*C-R*C-z*O);U=L-j;A=L-U;OP[0]=L-(U+A)+(A-j);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I-F;A=I-U;OP[1]=I-(U+A)+(A-F);W=P+U;A=W-P;OP[2]=P-(W-A)+(U-A);OP[3]=W;T=4}else{zP[0]=0;M=1;OP[0]=0;T=1}if(f!==0){const t=scale(M,zP,f,qP);u=BP(u,sum(scale(v,EP,f,PP),PP,scale(t,qP,2*H,LP),LP,jP),jP);const e=scale(T,OP,f,UP);u=BP(u,sum_three(scale(e,UP,2*H,PP),PP,scale(e,UP,f,IP),IP,scale(t,qP,f,LP),LP,FP,WP),WP);if(m!==0){u=BP(u,scale(scale(4,_P,f,UP),UP,m,PP),PP)}if(d!==0){u=BP(u,scale(scale(4,bP,-f,UP),UP,d,PP),PP)}}if(p!==0){const t=scale(M,zP,p,qP);u=BP(u,sum(scale(_,TP,p,PP),PP,scale(t,qP,2*J,LP),LP,jP),jP);const e=scale(T,OP,p,UP);u=BP(u,sum_three(scale(e,UP,2*J,PP),PP,scale(e,UP,p,IP),IP,scale(t,qP,p,LP),LP,FP,WP),WP)}}if(h!==0||m!==0){if(c!==0||d!==0||f!==0||p!==0){q=c*J;N=splitter*c;z=N-(N-c);R=c-z;N=splitter*J;C=N-(N-J);O=J-C;L=R*O-(q-z*C-R*C-z*O);F=X*p;N=splitter*X;z=N-(N-X);R=X-z;N=splitter*p;C=N-(N-p);O=p-C;j=R*O-(F-z*C-R*C-z*O);U=L+j;A=U-L;wP[0]=L-(U-A)+(j-A);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I+F;A=U-I;wP[1]=I-(U-A)+(F-A);W=P+U;A=W-P;wP[2]=P-(W-A)+(U-A);wP[3]=W;$=-Y;D=-d;q=f*$;N=splitter*f;z=N-(N-f);R=f-z;N=splitter*$;C=N-(N-$);O=$-C;L=R*O-(q-z*C-R*C-z*O);F=H*D;N=splitter*H;z=N-(N-H);R=H-z;N=splitter*D;C=N-(N-D);O=D-C;j=R*O-(F-z*C-R*C-z*O);U=L+j;A=U-L;kP[0]=L-(U-A)+(j-A);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I+F;A=U-I;kP[1]=I-(U-A)+(F-A);W=P+U;A=W-P;kP[2]=P-(W-A)+(U-A);kP[3]=W;w=sum(4,wP,4,kP,AP);q=c*p;N=splitter*c;z=N-(N-c);R=c-z;N=splitter*p;C=N-(N-p);O=p-C;L=R*O-(q-z*C-R*C-z*O);F=f*d;N=splitter*f;z=N-(N-f);R=f-z;N=splitter*d;C=N-(N-d);O=d-C;j=R*O-(F-z*C-R*C-z*O);U=L-j;A=L-U;RP[0]=L-(U+A)+(A-j);P=q+U;A=P-q;I=q-(P-A)+(U-A);U=I-F;A=I-U;RP[1]=I-(U+A)+(A-F);W=P+U;A=W-P;RP[2]=P-(W-A)+(U-A);RP[3]=W;S=4}else{AP[0]=0;w=1;RP[0]=0;S=1}if(h!==0){const t=scale(w,AP,h,qP);u=BP(u,sum(scale(x,$P,h,PP),PP,scale(t,qP,2*B,LP),LP,jP),jP);const e=scale(S,RP,h,UP);u=BP(u,sum_three(scale(e,UP,2*B,PP),PP,scale(e,UP,h,IP),IP,scale(t,qP,h,LP),LP,FP,WP),WP);if(d!==0){u=BP(u,scale(scale(4,xP,h,UP),UP,d,PP),PP)}if(p!==0){u=BP(u,scale(scale(4,_P,-h,UP),UP,p,PP),PP)}}if(m!==0){const t=scale(w,AP,m,qP);u=BP(u,sum(scale(b,DP,m,PP),PP,scale(t,qP,2*G,LP),LP,jP),jP);const e=scale(S,RP,m,UP);u=BP(u,sum_three(scale(e,UP,2*G,PP),PP,scale(e,UP,m,IP),IP,scale(t,qP,m,LP),LP,FP,WP),WP)}}return XP[u-1]}function JP(t,e,n,i,r,o,s,a){const l=t-s;const u=n-s;const c=r-s;const f=e-a;const h=i-a;const d=o-a;const p=u*d;const m=c*h;const g=l*l+f*f;const y=c*f;const v=l*d;const _=u*u+h*h;const x=l*h;const b=u*f;const w=c*c+d*d;const k=g*(p-m)+_*(y-v)+w*(x-b);const M=(Math.abs(p)+Math.abs(m))*g+(Math.abs(y)+Math.abs(v))*_+(Math.abs(x)+Math.abs(b))*w;const S=dP*M;if(k>S||-k>S){return k}return YP(t,e,n,i,r,o,s,a,M)}function GP(t,e,n,i,r,o,s,a){const l=t-s;const u=e-a;const c=n-s;const f=i-a;const h=r-s;const d=o-a;const p=l*f-c*u;const m=c*d-h*f;const g=h*u-l*d;const y=l*l+u*u;const v=c*c+f*f;const _=h*h+d*d;return y*m+v*g+_*p}const VP=(16+224*_U)*_U;const KP=(5+72*_U)*_U;const ZP=(71+1408*_U)*_U*_U;const QP=TU(4);const tI=TU(4);const eI=TU(4);const nI=TU(4);const iI=TU(4);const rI=TU(4);const oI=TU(4);const sI=TU(4);const aI=TU(4);const lI=TU(4);const uI=TU(24);const cI=TU(24);const fI=TU(24);const hI=TU(24);const dI=TU(24);const pI=TU(24);const mI=TU(24);const gI=TU(24);const yI=TU(24);const vI=TU(24);const _I=TU(1152);const xI=TU(1152);const bI=TU(1152);const wI=TU(1152);const kI=TU(1152);const MI=TU(2304);const SI=TU(2304);const EI=TU(3456);const TI=TU(5760);const $I=TU(8);const DI=TU(8);const AI=TU(8);const NI=TU(16);const zI=TU(24);const RI=TU(48);const CI=TU(48);const OI=TU(96);const UI=TU(192);const PI=TU(384);const II=TU(384);const qI=TU(384);const LI=TU(768);function FI(t,e,n,i,r,o,s){return sum_three(scale(4,t,i,$I),$I,scale(4,e,r,DI),DI,scale(4,n,o,AI),AI,NI,s)}function jI(t,e,n,i,r,o,s,a,l,u,c,f){const h=sum(sum(t,e,n,i,RI),RI,negate(sum(r,o,s,a,CI),CI),CI,OI);return sum_three(scale(scale(h,OI,l,UI),UI,l,PI),PI,scale(scale(h,OI,u,UI),UI,u,II),II,scale(scale(h,OI,c,UI),UI,c,qI),qI,LI,f)}function WI(t,e,n,i,r,o,s,a,l,u,c,f,h,d,p){let m,g,y,v,_,x,b,w,k,M,S,E,T,$;M=t*r;g=splitter*t;y=g-(g-t);v=t-y;g=splitter*r;_=g-(g-r);x=r-_;S=v*x-(M-y*_-v*_-y*x);E=i*e;g=splitter*i;y=g-(g-i);v=i-y;g=splitter*e;_=g-(g-e);x=e-_;T=v*x-(E-y*_-v*_-y*x);b=S-T;m=S-b;QP[0]=S-(b+m)+(m-T);w=M+b;m=w-M;k=M-(w-m)+(b-m);b=k-E;m=k-b;QP[1]=k-(b+m)+(m-E);$=w+b;m=$-w;QP[2]=w-($-m)+(b-m);QP[3]=$;M=i*a;g=splitter*i;y=g-(g-i);v=i-y;g=splitter*a;_=g-(g-a);x=a-_;S=v*x-(M-y*_-v*_-y*x);E=s*r;g=splitter*s;y=g-(g-s);v=s-y;g=splitter*r;_=g-(g-r);x=r-_;T=v*x-(E-y*_-v*_-y*x);b=S-T;m=S-b;tI[0]=S-(b+m)+(m-T);w=M+b;m=w-M;k=M-(w-m)+(b-m);b=k-E;m=k-b;tI[1]=k-(b+m)+(m-E);$=w+b;m=$-w;tI[2]=w-($-m)+(b-m);tI[3]=$;M=s*c;g=splitter*s;y=g-(g-s);v=s-y;g=splitter*c;_=g-(g-c);x=c-_;S=v*x-(M-y*_-v*_-y*x);E=u*a;g=splitter*u;y=g-(g-u);v=u-y;g=splitter*a;_=g-(g-a);x=a-_;T=v*x-(E-y*_-v*_-y*x);b=S-T;m=S-b;eI[0]=S-(b+m)+(m-T);w=M+b;m=w-M;k=M-(w-m)+(b-m);b=k-E;m=k-b;eI[1]=k-(b+m)+(m-E);$=w+b;m=$-w;eI[2]=w-($-m)+(b-m);eI[3]=$;M=u*d;g=splitter*u;y=g-(g-u);v=u-y;g=splitter*d;_=g-(g-d);x=d-_;S=v*x-(M-y*_-v*_-y*x);E=h*c;g=splitter*h;y=g-(g-h);v=h-y;g=splitter*c;_=g-(g-c);x=c-_;T=v*x-(E-y*_-v*_-y*x);b=S-T;m=S-b;nI[0]=S-(b+m)+(m-T);w=M+b;m=w-M;k=M-(w-m)+(b-m);b=k-E;m=k-b;nI[1]=k-(b+m)+(m-E);$=w+b;m=$-w;nI[2]=w-($-m)+(b-m);nI[3]=$;M=h*e;g=splitter*h;y=g-(g-h);v=h-y;g=splitter*e;_=g-(g-e);x=e-_;S=v*x-(M-y*_-v*_-y*x);E=t*d;g=splitter*t;y=g-(g-t);v=t-y;g=splitter*d;_=g-(g-d);x=d-_;T=v*x-(E-y*_-v*_-y*x);b=S-T;m=S-b;iI[0]=S-(b+m)+(m-T);w=M+b;m=w-M;k=M-(w-m)+(b-m);b=k-E;m=k-b;iI[1]=k-(b+m)+(m-E);$=w+b;m=$-w;iI[2]=w-($-m)+(b-m);iI[3]=$;M=t*a;g=splitter*t;y=g-(g-t);v=t-y;g=splitter*a;_=g-(g-a);x=a-_;S=v*x-(M-y*_-v*_-y*x);E=s*e;g=splitter*s;y=g-(g-s);v=s-y;g=splitter*e;_=g-(g-e);x=e-_;T=v*x-(E-y*_-v*_-y*x);b=S-T;m=S-b;rI[0]=S-(b+m)+(m-T);w=M+b;m=w-M;k=M-(w-m)+(b-m);b=k-E;m=k-b;rI[1]=k-(b+m)+(m-E);$=w+b;m=$-w;rI[2]=w-($-m)+(b-m);rI[3]=$;M=i*c;g=splitter*i;y=g-(g-i);v=i-y;g=splitter*c;_=g-(g-c);x=c-_;S=v*x-(M-y*_-v*_-y*x);E=u*r;g=splitter*u;y=g-(g-u);v=u-y;g=splitter*r;_=g-(g-r);x=r-_;T=v*x-(E-y*_-v*_-y*x);b=S-T;m=S-b;oI[0]=S-(b+m)+(m-T);w=M+b;m=w-M;k=M-(w-m)+(b-m);b=k-E;m=k-b;oI[1]=k-(b+m)+(m-E);$=w+b;m=$-w;oI[2]=w-($-m)+(b-m);oI[3]=$;M=s*d;g=splitter*s;y=g-(g-s);v=s-y;g=splitter*d;_=g-(g-d);x=d-_;S=v*x-(M-y*_-v*_-y*x);E=h*a;g=splitter*h;y=g-(g-h);v=h-y;g=splitter*a;_=g-(g-a);x=a-_;T=v*x-(E-y*_-v*_-y*x);b=S-T;m=S-b;sI[0]=S-(b+m)+(m-T);w=M+b;m=w-M;k=M-(w-m)+(b-m);b=k-E;m=k-b;sI[1]=k-(b+m)+(m-E);$=w+b;m=$-w;sI[2]=w-($-m)+(b-m);sI[3]=$;M=u*e;g=splitter*u;y=g-(g-u);v=u-y;g=splitter*e;_=g-(g-e);x=e-_;S=v*x-(M-y*_-v*_-y*x);E=t*c;g=splitter*t;y=g-(g-t);v=t-y;g=splitter*c;_=g-(g-c);x=c-_;T=v*x-(E-y*_-v*_-y*x);b=S-T;m=S-b;aI[0]=S-(b+m)+(m-T);w=M+b;m=w-M;k=M-(w-m)+(b-m);b=k-E;m=k-b;aI[1]=k-(b+m)+(m-E);$=w+b;m=$-w;aI[2]=w-($-m)+(b-m);aI[3]=$;M=h*r;g=splitter*h;y=g-(g-h);v=h-y;g=splitter*r;_=g-(g-r);x=r-_;S=v*x-(M-y*_-v*_-y*x);E=i*d;g=splitter*i;y=g-(g-i);v=i-y;g=splitter*d;_=g-(g-d);x=d-_;T=v*x-(E-y*_-v*_-y*x);b=S-T;m=S-b;lI[0]=S-(b+m)+(m-T);w=M+b;m=w-M;k=M-(w-m)+(b-m);b=k-E;m=k-b;lI[1]=k-(b+m)+(m-E);$=w+b;m=$-w;lI[2]=w-($-m)+(b-m);lI[3]=$;const D=FI(QP,tI,rI,l,n,-o,uI);const A=FI(tI,eI,oI,f,o,-l,cI);const N=FI(eI,nI,sI,p,l,-f,fI);const z=FI(nI,iI,aI,n,f,-p,hI);const R=FI(iI,QP,lI,o,p,-n,dI);const C=FI(QP,oI,aI,f,n,o,pI);const O=FI(tI,sI,lI,p,o,l,mI);const U=FI(eI,aI,rI,n,l,f,gI);const P=FI(nI,lI,oI,o,f,p,yI);const I=FI(iI,rI,sI,l,p,n,vI);const q=sum_three(jI(N,fI,O,mI,P,yI,A,cI,t,e,n,_I),_I,jI(z,hI,U,gI,I,vI,N,fI,i,r,o,xI),xI,sum_three(jI(R,dI,P,yI,C,pI,z,hI,s,a,l,bI),bI,jI(D,uI,I,vI,O,mI,R,dI,u,c,f,wI),wI,jI(A,cI,C,pI,U,gI,D,uI,h,d,p,kI),kI,SI,EI),EI,MI,TI);return TI[q-1]}const XI=TU(96);const HI=TU(96);const BI=TU(96);const YI=TU(1152);function JI(t,e,n,i,r,o,s,a,l,u){const c=FI(t,e,n,i,r,o,zI);return sum_three(scale(scale(c,zI,s,RI),RI,s,XI),XI,scale(scale(c,zI,a,RI),RI,a,HI),HI,scale(scale(c,zI,l,RI),RI,l,BI),BI,UI,u)}function GI(t,e,n,i,r,o,s,a,l,u,c,f,h,d,p,m){let g,y,v,_,x,b;let w,k,M,S;let E,T,$,D;let A,N,z,R;let C,O,U,P,I,q,L,F,j,W,X,H,B;const Y=t-h;const J=i-h;const G=s-h;const V=u-h;const K=e-d;const Z=r-d;const Q=a-d;const tt=c-d;const et=n-p;const nt=o-p;const it=l-p;const rt=f-p;W=Y*Z;O=splitter*Y;U=O-(O-Y);P=Y-U;O=splitter*Z;I=O-(O-Z);q=Z-I;X=P*q-(W-U*I-P*I-U*q);H=J*K;O=splitter*J;U=O-(O-J);P=J-U;O=splitter*K;I=O-(O-K);q=K-I;B=P*q-(H-U*I-P*I-U*q);L=X-B;C=X-L;QP[0]=X-(L+C)+(C-B);F=W+L;C=F-W;j=W-(F-C)+(L-C);L=j-H;C=j-L;QP[1]=j-(L+C)+(C-H);g=F+L;C=g-F;QP[2]=F-(g-C)+(L-C);QP[3]=g;W=J*Q;O=splitter*J;U=O-(O-J);P=J-U;O=splitter*Q;I=O-(O-Q);q=Q-I;X=P*q-(W-U*I-P*I-U*q);H=G*Z;O=splitter*G;U=O-(O-G);P=G-U;O=splitter*Z;I=O-(O-Z);q=Z-I;B=P*q-(H-U*I-P*I-U*q);L=X-B;C=X-L;tI[0]=X-(L+C)+(C-B);F=W+L;C=F-W;j=W-(F-C)+(L-C);L=j-H;C=j-L;tI[1]=j-(L+C)+(C-H);y=F+L;C=y-F;tI[2]=F-(y-C)+(L-C);tI[3]=y;W=G*tt;O=splitter*G;U=O-(O-G);P=G-U;O=splitter*tt;I=O-(O-tt);q=tt-I;X=P*q-(W-U*I-P*I-U*q);H=V*Q;O=splitter*V;U=O-(O-V);P=V-U;O=splitter*Q;I=O-(O-Q);q=Q-I;B=P*q-(H-U*I-P*I-U*q);L=X-B;C=X-L;eI[0]=X-(L+C)+(C-B);F=W+L;C=F-W;j=W-(F-C)+(L-C);L=j-H;C=j-L;eI[1]=j-(L+C)+(C-H);v=F+L;C=v-F;eI[2]=F-(v-C)+(L-C);eI[3]=v;W=V*K;O=splitter*V;U=O-(O-V);P=V-U;O=splitter*K;I=O-(O-K);q=K-I;X=P*q-(W-U*I-P*I-U*q);H=Y*tt;O=splitter*Y;U=O-(O-Y);P=Y-U;O=splitter*tt;I=O-(O-tt);q=tt-I;B=P*q-(H-U*I-P*I-U*q);L=X-B;C=X-L;aI[0]=X-(L+C)+(C-B);F=W+L;C=F-W;j=W-(F-C)+(L-C);L=j-H;C=j-L;aI[1]=j-(L+C)+(C-H);_=F+L;C=_-F;aI[2]=F-(_-C)+(L-C);aI[3]=_;W=Y*Q;O=splitter*Y;U=O-(O-Y);P=Y-U;O=splitter*Q;I=O-(O-Q);q=Q-I;X=P*q-(W-U*I-P*I-U*q);H=G*K;O=splitter*G;U=O-(O-G);P=G-U;O=splitter*K;I=O-(O-K);q=K-I;B=P*q-(H-U*I-P*I-U*q);L=X-B;C=X-L;rI[0]=X-(L+C)+(C-B);F=W+L;C=F-W;j=W-(F-C)+(L-C);L=j-H;C=j-L;rI[1]=j-(L+C)+(C-H);x=F+L;C=x-F;rI[2]=F-(x-C)+(L-C);rI[3]=x;W=J*tt;O=splitter*J;U=O-(O-J);P=J-U;O=splitter*tt;I=O-(O-tt);q=tt-I;X=P*q-(W-U*I-P*I-U*q);H=V*Z;O=splitter*V;U=O-(O-V);P=V-U;O=splitter*Z;I=O-(O-Z);q=Z-I;B=P*q-(H-U*I-P*I-U*q);L=X-B;C=X-L;oI[0]=X-(L+C)+(C-B);F=W+L;C=F-W;j=W-(F-C)+(L-C);L=j-H;C=j-L;oI[1]=j-(L+C)+(C-H);b=F+L;C=b-F;oI[2]=F-(b-C)+(L-C);oI[3]=b;const ot=sum(sum(negate(JI(tI,eI,oI,rt,nt,-it,Y,K,et,_I),_I),_I,JI(eI,aI,rI,et,it,rt,J,Z,nt,xI),xI,MI),MI,sum(negate(JI(aI,QP,oI,nt,rt,et,G,Q,it,bI),bI),bI,JI(QP,tI,rI,it,et,-nt,V,tt,rt,wI),wI,SI),SI,YI);let st=estimate(ot,YI);let at=KP*m;if(st>=at||-st>=at){return st}C=t-Y;w=t-(Y+C)+(C-h);C=e-K;E=e-(K+C)+(C-d);C=n-et;A=n-(et+C)+(C-p);C=i-J;k=i-(J+C)+(C-h);C=r-Z;T=r-(Z+C)+(C-d);C=o-nt;N=o-(nt+C)+(C-p);C=s-G;M=s-(G+C)+(C-h);C=a-Q;$=a-(Q+C)+(C-d);C=l-it;z=l-(it+C)+(C-p);C=u-V;S=u-(V+C)+(C-h);C=c-tt;D=c-(tt+C)+(C-d);C=f-rt;R=f-(rt+C)+(C-p);if(w===0&&E===0&&A===0&&k===0&&T===0&&N===0&&M===0&&$===0&&z===0&&S===0&&D===0&&R===0){return st}at=ZP*m+resulterrbound*Math.abs(st);const lt=Y*T+Z*w-(K*k+J*E);const ut=J*$+Q*k-(Z*M+G*T);const ct=G*D+tt*M-(Q*S+V*$);const ft=V*E+K*S-(tt*w+Y*D);const ht=Y*$+Q*w-(K*M+G*E);const dt=J*D+tt*k-(Z*S+V*T);st+=(J*J+Z*Z+nt*nt)*(it*ft+rt*ht+et*ct+(z*_+R*x+A*v))+(V*V+tt*tt+rt*rt)*(et*ut-nt*ht+it*lt+(A*y-N*x+z*g))-((Y*Y+K*K+et*et)*(nt*ct-it*dt+rt*ut+(N*v-z*b+R*y))+(G*G+Q*Q+it*it)*(rt*lt+et*dt+nt*ft+(R*g+A*b+N*_)))+2*((J*k+Z*T+nt*N)*(it*_+rt*x+et*v)+(V*S+tt*D+rt*R)*(et*y-nt*x+it*g)-((Y*w+K*E+et*A)*(nt*v-it*b+rt*y)+(G*M+Q*$+it*z)*(rt*g+et*b+nt*_)));if(st>=at||-st>=at){return st}return WI(t,e,n,i,r,o,s,a,l,u,c,f,h,d,p)}function VI(t,e,n,i,r,o,s,a,l,u,c,f,h,d,p){const m=t-h;const g=i-h;const y=s-h;const v=u-h;const _=e-d;const x=r-d;const b=a-d;const w=c-d;const k=n-p;const M=o-p;const S=l-p;const E=f-p;const T=m*x;const $=g*_;const D=T-$;const A=g*b;const N=y*x;const z=A-N;const R=y*w;const C=v*b;const O=R-C;const U=v*_;const P=m*w;const I=U-P;const q=m*b;const L=y*_;const F=q-L;const j=g*w;const W=v*x;const X=j-W;const H=k*z-M*F+S*D;const B=M*O-S*X+E*z;const Y=S*I+E*F+k*O;const J=E*D+k*X+M*I;const G=m*m+_*_+k*k;const V=g*g+x*x+M*M;const K=y*y+b*b+S*S;const Z=v*v+w*w+E*E;const Q=K*J-Z*H+(G*B-V*Y);const tt=Math.abs(k);const et=Math.abs(M);const nt=Math.abs(S);const it=Math.abs(E);const rt=Math.abs(T);const ot=Math.abs($);const st=Math.abs(A);const at=Math.abs(N);const lt=Math.abs(R);const ut=Math.abs(C);const ct=Math.abs(U);const ft=Math.abs(P);const ht=Math.abs(q);const dt=Math.abs(L);const pt=Math.abs(j);const mt=Math.abs(W);const gt=((lt+ut)*et+(mt+pt)*nt+(st+at)*it)*G+((ct+ft)*nt+(ht+dt)*it+(lt+ut)*tt)*V+((rt+ot)*it+(pt+mt)*tt+(ct+ft)*et)*K+((st+at)*tt+(dt+ht)*et+(rt+ot)*nt)*Z;const yt=VP*gt;if(Q>yt||-Q>yt){return Q}return-GI(t,e,n,i,r,o,s,a,l,u,c,f,h,d,p,gt)}function KI(t,e,n,i,r,o,s,a,l,u,c,f,h,d,p){const m=t-h;const g=i-h;const y=s-h;const v=u-h;const _=e-d;const x=r-d;const b=a-d;const w=c-d;const k=n-p;const M=o-p;const S=l-p;const E=f-p;const T=m*x-g*_;const $=g*b-y*x;const D=y*w-v*b;const A=v*_-m*w;const N=m*b-y*_;const z=g*w-v*x;const R=k*$-M*N+S*T;const C=M*D-S*z+E*$;const O=S*A+E*N+k*D;const U=E*T+k*z+M*A;const P=m*m+_*_+k*k;const I=g*g+x*x+M*M;const q=y*y+b*b+S*S;const L=v*v+w*w+E*E;return q*U-L*R+(P*C-I*O)}const ZI=Math.pow(2,-52);const QI=new Uint32Array(512);class tq{static from(t,e=lq,n=uq){const i=t.length;const r=new Float64Array(i*2);for(let o=0;o<i;o++){const i=t[o];r[2*o]=e(i);r[2*o+1]=n(i)}return new tq(r)}constructor(t){const e=t.length>>1;if(e>0&&typeof t[0]!=="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(n*3);this._halfedges=new Int32Array(n*3);this._hashSize=Math.ceil(Math.sqrt(e));this._hullPrev=new Uint32Array(e);this._hullNext=new Uint32Array(e);this._hullTri=new Uint32Array(e);this._hullHash=new Int32Array(this._hashSize).fill(-1);this._ids=new Uint32Array(e);this._dists=new Float64Array(e);this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:i,_hullHash:r}=this;const o=t.length>>1;let s=Infinity;let a=Infinity;let l=-Infinity;let u=-Infinity;for(let S=0;S<o;S++){const e=t[2*S];const n=t[2*S+1];if(e<s)s=e;if(n<a)a=n;if(e>l)l=e;if(n>u)u=n;this._ids[S]=S}const c=(s+l)/2;const f=(a+u)/2;let h=Infinity;let d,p,m;for(let S=0;S<o;S++){const e=nq(c,f,t[2*S],t[2*S+1]);if(e<h){d=S;h=e}}const g=t[2*d];const y=t[2*d+1];h=Infinity;for(let S=0;S<o;S++){if(S===d)continue;const e=nq(g,y,t[2*S],t[2*S+1]);if(e<h&&e>0){p=S;h=e}}let v=t[2*p];let _=t[2*p+1];let x=Infinity;for(let S=0;S<o;S++){if(S===d||S===p)continue;const e=rq(g,y,v,_,t[2*S],t[2*S+1]);if(e<x){m=S;x=e}}let b=t[2*m];let w=t[2*m+1];if(x===Infinity){for(let i=0;i<o;i++){this._dists[i]=t[2*i]-t[0]||t[2*i+1]-t[1]}sq(this._ids,this._dists,0,o-1);const e=new Uint32Array(o);let n=0;for(let t=0,i=-Infinity;t<o;t++){const r=this._ids[t];if(this._dists[r]>i){e[n++]=r;i=this._dists[r]}}this.hull=e.subarray(0,n);this.triangles=new Uint32Array(0);this.halfedges=new Uint32Array(0);return}if(PU(g,y,v,_,b,w)<0){const t=p;const e=v;const n=_;p=m;v=b;_=w;m=t;b=e;w=n}const k=oq(g,y,v,_,b,w);this._cx=k.x;this._cy=k.y;for(let S=0;S<o;S++){this._dists[S]=nq(t[2*S],t[2*S+1],k.x,k.y)}sq(this._ids,this._dists,0,o-1);this._hullStart=d;let M=3;n[d]=e[m]=p;n[p]=e[d]=m;n[m]=e[p]=d;i[d]=0;i[p]=1;i[m]=2;r.fill(-1);r[this._hashKey(g,y)]=d;r[this._hashKey(v,_)]=p;r[this._hashKey(b,w)]=m;this.trianglesLen=0;this._addTriangle(d,p,m,-1,-1,-1);for(let S=0,E,T;S<this._ids.length;S++){const o=this._ids[S];const s=t[2*o];const a=t[2*o+1];if(S>0&&Math.abs(s-E)<=ZI&&Math.abs(a-T)<=ZI)continue;E=s;T=a;if(o===d||o===p||o===m)continue;let l=0;for(let t=0,e=this._hashKey(s,a);t<this._hashSize;t++){l=r[(e+t)%this._hashSize];if(l!==-1&&l!==n[l])break}l=e[l];let u=l,c;while(c=n[u],PU(s,a,t[2*u],t[2*u+1],t[2*c],t[2*c+1])>=0){u=c;if(u===l){u=-1;break}}if(u===-1)continue;let f=this._addTriangle(u,o,n[u],-1,-1,i[u]);i[o]=this._legalize(f+2);i[u]=f;M++;let h=n[u];while(c=n[h],PU(s,a,t[2*h],t[2*h+1],t[2*c],t[2*c+1])<0){f=this._addTriangle(h,o,c,i[o],-1,i[h]);i[o]=this._legalize(f+2);n[h]=h;M--;h=c}if(u===l){while(c=e[u],PU(s,a,t[2*c],t[2*c+1],t[2*u],t[2*u+1])<0){f=this._addTriangle(c,o,u,-1,i[u],i[c]);this._legalize(f+2);i[c]=f;n[u]=u;M--;u=c}}this._hullStart=e[o]=u;n[u]=e[h]=o;n[o]=h;r[this._hashKey(s,a)]=o;r[this._hashKey(t[2*u],t[2*u+1])]=u}this.hull=new Uint32Array(M);for(let S=0,E=this._hullStart;S<M;S++){this.hull[S]=E;E=n[E]}this.triangles=this._triangles.subarray(0,this.trianglesLen);this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(eq(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:i}=this;let r=0;let o=0;while(true){const s=n[t];const a=t-t%3;o=a+(t+2)%3;if(s===-1){if(r===0)break;t=QI[--r];continue}const l=s-s%3;const u=a+(t+1)%3;const c=l+(s+2)%3;const f=e[o];const h=e[t];const d=e[u];const p=e[c];const m=iq(i[2*f],i[2*f+1],i[2*h],i[2*h+1],i[2*d],i[2*d+1],i[2*p],i[2*p+1]);if(m){e[t]=p;e[s]=f;const i=n[c];if(i===-1){let e=this._hullStart;do{if(this._hullTri[e]===c){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,i);this._link(s,n[o]);this._link(o,c);const a=l+(s+1)%3;if(r<QI.length){QI[r++]=a}}else{if(r===0)break;t=QI[--r]}}return o}_link(t,e){this._halfedges[t]=e;if(e!==-1)this._halfedges[e]=t}_addTriangle(t,e,n,i,r,o){const s=this.trianglesLen;this._triangles[s]=t;this._triangles[s+1]=e;this._triangles[s+2]=n;this._link(s,i);this._link(s+1,r);this._link(s+2,o);this.trianglesLen+=3;return s}}function eq(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}function nq(t,e,n,i){const r=t-n;const o=e-i;return r*r+o*o}function iq(t,e,n,i,r,o,s,a){const l=t-s;const u=e-a;const c=n-s;const f=i-a;const h=r-s;const d=o-a;const p=l*l+u*u;const m=c*c+f*f;const g=h*h+d*d;return l*(f*g-m*d)-u*(c*g-m*h)+p*(c*d-f*h)<0}function rq(t,e,n,i,r,o){const s=n-t;const a=i-e;const l=r-t;const u=o-e;const c=s*s+a*a;const f=l*l+u*u;const h=.5/(s*u-a*l);const d=(u*c-a*f)*h;const p=(s*f-l*c)*h;return d*d+p*p}function oq(t,e,n,i,r,o){const s=n-t;const a=i-e;const l=r-t;const u=o-e;const c=s*s+a*a;const f=l*l+u*u;const h=.5/(s*u-a*l);const d=t+(u*c-a*f)*h;const p=e+(s*f-l*c)*h;return{x:d,y:p}}function sq(t,e,n,i){if(i-n<=20){for(let r=n+1;r<=i;r++){const i=t[r];const o=e[i];let s=r-1;while(s>=n&&e[t[s]]>o)t[s+1]=t[s--];t[s+1]=i}}else{const r=n+i>>1;let o=n+1;let s=i;aq(t,r,o);if(e[t[n]]>e[t[i]])aq(t,n,i);if(e[t[o]]>e[t[i]])aq(t,o,i);if(e[t[n]]>e[t[o]])aq(t,n,o);const a=t[o];const l=e[a];while(true){do{o++}while(e[t[o]]<l);do{s--}while(e[t[s]]>l);if(s<o)break;aq(t,o,s)}t[n+1]=t[s];t[s]=a;if(i-o+1>=s-n){sq(t,e,o,i);sq(t,e,n,s-1)}else{sq(t,e,n,s-1);sq(t,e,o,i)}}}function aq(t,e,n){const i=t[e];t[e]=t[n];t[n]=i}function lq(t){return t[0]}function uq(t){return t[1]}const cq=1e-6;class fq{constructor(){this._x0=this._y0=this._x1=this._y1=null;this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,n){t=+t,e=+e,n=+n;const i=t+n;const r=e;if(n<0)throw new Error("negative radius");if(this._x1===null)this._+=`M${i},${r}`;else if(Math.abs(this._x1-i)>cq||Math.abs(this._y1-r)>cq)this._+="L"+i+","+r;if(!n)return;this._+=`A${n},${n},0,1,1,${t-n},${e}A${n},${n},0,1,1,${this._x1=i},${this._y1=r}`}rect(t,e,n,i){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+n}v${+i}h${-n}Z`}value(){return this._||null}}class hq{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class dq{constructor(t,[e,n,i,r]=[0,0,960,500]){if(!((i=+i)>=(e=+e))||!((r=+r)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t;this._circumcenters=new Float64Array(t.points.length*2);this.vectors=new Float64Array(t.points.length*2);this.xmax=i,this.xmin=e;this.ymax=r,this.ymin=n;this._init()}update(){this.delaunay.update();this._init();return this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:i}=this;const r=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let h=0,d=0,p=n.length,m,g;h<p;h+=3,d+=2){const e=n[h]*2;const i=n[h+1]*2;const o=n[h+2]*2;const s=t[e];const a=t[e+1];const l=t[i];const u=t[i+1];const c=t[o];const f=t[o+1];const p=l-s;const y=u-a;const v=c-s;const _=f-a;const x=(p*_-y*v)*2;if(Math.abs(x)<1e-9){let e=1e9;const i=n[0]*2;e*=Math.sign((t[i]-s)*_-(t[i+1]-a)*v);m=(s+c)/2-e*_;g=(a+f)/2+e*v}else{const t=1/x;const e=p*p+y*y;const n=v*v+_*_;m=s+(_*e-y*n)*t;g=a+(p*n-v*e)*t}r[d]=m;r[d+1]=g}let o=e[e.length-1];let s,a=o*4;let l,u=t[2*o];let c,f=t[2*o+1];i.fill(0);for(let h=0;h<e.length;++h){o=e[h];s=a,l=u,c=f;a=o*4,u=t[2*o],f=t[2*o+1];i[s+2]=i[a]=c-f;i[s+3]=i[a+1]=u-l}}render(t){const e=t==null?t=new fq:undefined;const{delaunay:{halfedges:n,inedges:i,hull:r},circumcenters:o,vectors:s}=this;if(r.length<=1)return null;for(let u=0,c=n.length;u<c;++u){const e=n[u];if(e<u)continue;const i=Math.floor(u/3)*2;const r=Math.floor(e/3)*2;const s=o[i];const a=o[i+1];const l=o[r];const c=o[r+1];this._renderSegment(s,a,l,c,t)}let a,l=r[r.length-1];for(let u=0;u<r.length;++u){a=l,l=r[u];const e=Math.floor(i[l]/3)*2;const n=o[e];const c=o[e+1];const f=a*4;const h=this._project(n,c,s[f+2],s[f+3]);if(h)this._renderSegment(n,c,h[0],h[1],t)}return e&&e.value()}renderBounds(t){const e=t==null?t=new fq:undefined;t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin);return e&&e.value()}renderCell(t,e){const n=e==null?e=new fq:undefined;const i=this._clip(t);if(i===null||!i.length)return;e.moveTo(i[0],i[1]);let r=i.length;while(i[0]===i[r-2]&&i[1]===i[r-1]&&r>1)r-=2;for(let o=2;o<r;o+=2){if(i[o]!==i[o-2]||i[o+1]!==i[o-1])e.lineTo(i[o],i[o+1])}e.closePath();return n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);if(t)t.index=e,yield t}}cellPolygon(t){const e=new hq;this.renderCell(t,e);return e.value()}_renderSegment(t,e,n,i,r){let o;const s=this._regioncode(t,e);const a=this._regioncode(n,i);if(s===0&&a===0){r.moveTo(t,e);r.lineTo(n,i)}else if(o=this._clipSegment(t,e,n,i,s,a)){r.moveTo(o[0],o[1]);r.lineTo(o[2],o[3])}}contains(t,e,n){if((e=+e,e!==e)||(n=+n,n!==n))return false;return this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let i=0,r=e.length;i<r;i+=2){for(let o=0,s=t.length;o<s;o+=2){if(e[i]==t[o]&&e[i+1]==t[o+1]&&e[(i+2)%r]==t[(o+s-2)%s]&&e[(i+3)%r]==t[(o+s-1)%s]){yield n;break t}}}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:i,triangles:r}}=this;const o=n[t];if(o===-1)return null;const s=[];let a=o;do{const n=Math.floor(a/3);s.push(e[n*2],e[n*2+1]);a=a%3===2?a-2:a+1;if(r[a]!==t)break;a=i[a]}while(a!==o&&a!==-1);return s}_clip(t){if(t===0&&this.delaunay.hull.length===1){return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]}const e=this._cell(t);if(e===null)return null;const{vectors:n}=this;const i=t*4;return n[i]||n[i+1]?this._clipInfinite(t,e,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(t,e)}_clipFinite(t,e){const n=e.length;let i=null;let r,o,s=e[n-2],a=e[n-1];let l,u=this._regioncode(s,a);let c,f=0;for(let h=0;h<n;h+=2){r=s,o=a,s=e[h],a=e[h+1];l=u,u=this._regioncode(s,a);if(l===0&&u===0){c=f,f=0;if(i)i.push(s,a);else i=[s,a]}else{let e,n,h,d,p;if(l===0){if((e=this._clipSegment(r,o,s,a,l,u))===null)continue;[n,h,d,p]=e}else{if((e=this._clipSegment(s,a,r,o,u,l))===null)continue;[d,p,n,h]=e;c=f,f=this._edgecode(n,h);if(c&&f)this._edge(t,c,f,i,i.length);if(i)i.push(n,h);else i=[n,h]}c=f,f=this._edgecode(d,p);if(c&&f)this._edge(t,c,f,i,i.length);if(i)i.push(d,p);else i=[d,p]}}if(i){c=f,f=this._edgecode(i[0],i[1]);if(c&&f)this._edge(t,c,f,i,i.length)}else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)){return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin]}return i}_clipSegment(t,e,n,i,r,o){while(true){if(r===0&&o===0)return[t,e,n,i];if(r&o)return null;let s,a,l=r||o;if(l&8)s=t+(n-t)*(this.ymax-e)/(i-e),a=this.ymax;else if(l&4)s=t+(n-t)*(this.ymin-e)/(i-e),a=this.ymin;else if(l&2)a=e+(i-e)*(this.xmax-t)/(n-t),s=this.xmax;else a=e+(i-e)*(this.xmin-t)/(n-t),s=this.xmin;if(r)t=s,e=a,r=this._regioncode(t,e);else n=s,i=a,o=this._regioncode(n,i)}}_clipInfinite(t,e,n,i,r,o){let s=Array.from(e),a;if(a=this._project(s[0],s[1],n,i))s.unshift(a[0],a[1]);if(a=this._project(s[s.length-2],s[s.length-1],r,o))s.push(a[0],a[1]);if(s=this._clipFinite(t,s)){for(let e=0,n=s.length,i,r=this._edgecode(s[n-2],s[n-1]);e<n;e+=2){i=r,r=this._edgecode(s[e],s[e+1]);if(i&&r)e=this._edge(t,i,r,s,e),n=s.length}}else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)){s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]}return s}_edge(t,e,n,i,r){while(e!==n){let n,o;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,o=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,o=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,o=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,o=this.ymin;break}if((i[r]!==n||i[r+1]!==o)&&this.contains(t,n,o)){i.splice(r,0,n,o),r+=2}}if(i.length>4){for(let t=0;t<i.length;t+=2){const e=(t+2)%i.length,n=(t+4)%i.length;if(i[t]===i[e]&&i[e]===i[n]||i[t+1]===i[e+1]&&i[e+1]===i[n+1])i.splice(e,2),t-=2}}return r}_project(t,e,n,i){let r=Infinity,o,s,a;if(i<0){if(e<=this.ymin)return null;if((o=(this.ymin-e)/i)<r)a=this.ymin,s=t+(r=o)*n}else if(i>0){if(e>=this.ymax)return null;if((o=(this.ymax-e)/i)<r)a=this.ymax,s=t+(r=o)*n}if(n>0){if(t>=this.xmax)return null;if((o=(this.xmax-t)/n)<r)s=this.xmax,a=e+(r=o)*i}else if(n<0){if(t<=this.xmin)return null;if((o=(this.xmin-t)/n)<r)s=this.xmin,a=e+(r=o)*i}return[s,a]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}const pq=2*Math.PI,mq=Math.pow;function gq(t){return t[0]}function yq(t){return t[1]}function vq(t){const{triangles:e,coords:n}=t;for(let i=0;i<e.length;i+=3){const t=2*e[i],r=2*e[i+1],o=2*e[i+2],s=(n[o]-n[t])*(n[r+1]-n[t+1])-(n[r]-n[t])*(n[o+1]-n[t+1]);if(s>1e-10)return false}return true}function _q(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class xq{static from(t,e=gq,n=yq,i){return new xq("length"in t?bq(t,e,n,i):Float64Array.from(wq(t,e,n,i)))}constructor(t){this._delaunator=new tq(t);this.inedges=new Int32Array(t.length/2);this._hullIndex=new Int32Array(t.length/2);this.points=this._delaunator.coords;this._init()}update(){this._delaunator.update();this._init();return this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&vq(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],i=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],r=1e-8*Math.hypot(i[3]-i[1],i[2]-i[0]);for(let o=0,s=e.length/2;o<s;++o){const t=_q(e[2*o],e[2*o+1],r);e[2*o]=t[0];e[2*o+1]=t[1]}this._delaunator=new tq(e)}else{delete this.collinear}const n=this.halfedges=this._delaunator.halfedges;const i=this.hull=this._delaunator.hull;const r=this.triangles=this._delaunator.triangles;const o=this.inedges.fill(-1);const s=this._hullIndex.fill(-1);for(let a=0,l=n.length;a<l;++a){const t=r[a%3===2?a-2:a+1];if(n[a]===-1||o[t]===-1)o[t]=a}for(let a=0,l=i.length;a<l;++a){s[i[a]]=a}if(i.length<=2&&i.length>0){this.triangles=new Int32Array(3).fill(-1);this.halfedges=new Int32Array(3).fill(-1);this.triangles[0]=i[0];o[i[0]]=1;if(i.length===2){o[i[1]]=0;this.triangles[1]=i[1];this.triangles[2]=i[1]}}}voronoi(t){return new dq(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:i,halfedges:r,triangles:o,collinear:s}=this;if(s){const e=s.indexOf(t);if(e>0)yield s[e-1];if(e<s.length-1)yield s[e+1];return}const a=e[t];if(a===-1)return;let l=a,u=-1;do{yield u=o[l];l=l%3===2?l-2:l+1;if(o[l]!==t)return;l=r[l];if(l===-1){const e=n[(i[t]+1)%n.length];if(e!==u)yield e;return}}while(l!==a)}find(t,e,n=0){if((t=+t,t!==t)||(e=+e,e!==e))return-1;const i=n;let r;while((r=this._step(n,t,e))>=0&&r!==n&&r!==i)n=r;return r}_step(t,e,n){const{inedges:i,hull:r,_hullIndex:o,halfedges:s,triangles:a,points:l}=this;if(i[t]===-1||!l.length)return(t+1)%(l.length>>1);let u=t;let c=mq(e-l[t*2],2)+mq(n-l[t*2+1],2);const f=i[t];let h=f;do{let i=a[h];const f=mq(e-l[i*2],2)+mq(n-l[i*2+1],2);if(f<c)c=f,u=i;h=h%3===2?h-2:h+1;if(a[h]!==t)break;h=s[h];if(h===-1){h=r[(o[t]+1)%r.length];if(h!==i){if(mq(e-l[h*2],2)+mq(n-l[h*2+1],2)<c)return h}break}}while(h!==f);return u}render(t){const e=t==null?t=new fq:undefined;const{points:n,halfedges:i,triangles:r}=this;for(let o=0,s=i.length;o<s;++o){const e=i[o];if(e<o)continue;const s=r[o]*2;const a=r[e]*2;t.moveTo(n[s],n[s+1]);t.lineTo(n[a],n[a+1])}this.renderHull(t);return e&&e.value()}renderPoints(t,e){if(e===undefined&&(!t||typeof t.moveTo!=="function"))e=t,t=null;e=e==undefined?2:+e;const n=t==null?t=new fq:undefined;const{points:i}=this;for(let r=0,o=i.length;r<o;r+=2){const n=i[r],o=i[r+1];t.moveTo(n+e,o);t.arc(n,o,e,0,pq)}return n&&n.value()}renderHull(t){const e=t==null?t=new fq:undefined;const{hull:n,points:i}=this;const r=n[0]*2,o=n.length;t.moveTo(i[r],i[r+1]);for(let s=1;s<o;++s){const e=2*n[s];t.lineTo(i[e],i[e+1])}t.closePath();return e&&e.value()}hullPolygon(){const t=new hq;this.renderHull(t);return t.value()}renderTriangle(t,e){const n=e==null?e=new fq:undefined;const{points:i,triangles:r}=this;const o=r[t*=3]*2;const s=r[t+1]*2;const a=r[t+2]*2;e.moveTo(i[o],i[o+1]);e.lineTo(i[s],i[s+1]);e.lineTo(i[a],i[a+1]);e.closePath();return n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e){yield this.trianglePolygon(e)}}trianglePolygon(t){const e=new hq;this.renderTriangle(t,e);return e.value()}}function bq(t,e,n,i){const r=t.length;const o=new Float64Array(r*2);for(let s=0;s<r;++s){const r=t[s];o[s*2]=e.call(i,r,s,t);o[s*2+1]=n.call(i,r,s,t)}return o}function*wq(t,e,n,i){let r=0;for(const o of t){yield e.call(i,o,r,t);yield n.call(i,o,r,t);++r}}function kq(t){Us.call(this,null,t)}kq.Definition={type:"Voronoi",metadata:{modifies:true},params:[{name:"x",type:"field",required:true},{name:"y",type:"field",required:true},{name:"size",type:"number",array:true,length:2},{name:"extent",type:"array",array:true,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:true,length:2}},{name:"as",type:"string",default:"path"}]};const Mq=[-1e5,-1e5,1e5,1e5];(0,m.XW)(kq,Us,{transform(t,e){const n=t.as||"path",i=e.source;if(!i||!i.length)return e;let r=t.size;r=r?[0,0,r[0],r[1]]:(r=t.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:Mq;const o=this.value=xq.from(i,t.x,t.y).voronoi(r);for(let s=0,a=i.length;s<a;++s){const t=o.cellPolygon(s);i[s][n]=t?Sq(t):null}return e.reflow(t.modified()).modifies(n)}});function Sq(t){const e=t[0][0],n=t[0][1];let i=t.length-1;for(;t[i][0]===e&&t[i][1]===n;--i);return"M"+t.slice(0,i+1).join("L")+"Z"}var Eq=Math.PI/180,Tq=1<<11>>5,$q=1<<11;function Dq(){var t=[256,256],e,n,i,r,o,s,a,l=Cq,u=[],c=Math.random,f={};f.layout=function(){var l=h(rh()),f=Uq((t[0]>>5)*t[1]),p=null,m=u.length,g=-1,y=[],v=u.map((t=>({text:e(t),font:n(t),style:r(t),weight:o(t),rotate:s(t),size:~~(i(t)+1e-14),padding:a(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:false,sprite:null,datum:t}))).sort(((t,e)=>e.size-t.size));while(++g<m){var _=v[g];_.x=t[0]*(c()+.5)>>1;_.y=t[1]*(c()+.5)>>1;Aq(l,_,v,g);if(_.hasText&&d(f,_,p)){y.push(_);if(p)zq(p,_);else p=[{x:_.x+_.x0,y:_.y+_.y0},{x:_.x+_.x1,y:_.y+_.y1}];_.x-=t[0]>>1;_.y-=t[1]>>1}}return y};function h(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(Tq<<5)/e;t.height=$q/e;var n=t.getContext("2d");n.fillStyle=n.strokeStyle="red";n.textAlign="center";return{context:n,ratio:e}}function d(e,n,i){var r=n.x,o=n.y,s=Math.sqrt(t[0]*t[0]+t[1]*t[1]),a=l(t),u=c()<.5?1:-1,f=-u,h,d,p;while(h=a(f+=u)){d=~~h[0];p=~~h[1];if(Math.min(Math.abs(d),Math.abs(p))>=s)break;n.x=r+d;n.y=o+p;if(n.x+n.x0<0||n.y+n.y0<0||n.x+n.x1>t[0]||n.y+n.y1>t[1])continue;if(!i||!Nq(n,e,t[0])){if(!i||Rq(n,i)){var m=n.sprite,g=n.width>>5,y=t[0]>>5,v=n.x-(g<<4),_=v&127,x=32-_,b=n.y1-n.y0,w=(n.y+n.y0)*y+(v>>5),k;for(var M=0;M<b;M++){k=0;for(var S=0;S<=g;S++){e[w+S]|=k<<x|(S<g?(k=m[M*g+S])>>>_:0)}w+=y}n.sprite=null;return true}}}return false}f.words=function(t){if(arguments.length){u=t;return f}else{return u}};f.size=function(e){if(arguments.length){t=[+e[0],+e[1]];return f}else{return t}};f.font=function(t){if(arguments.length){n=Pq(t);return f}else{return n}};f.fontStyle=function(t){if(arguments.length){r=Pq(t);return f}else{return r}};f.fontWeight=function(t){if(arguments.length){o=Pq(t);return f}else{return o}};f.rotate=function(t){if(arguments.length){s=Pq(t);return f}else{return s}};f.text=function(t){if(arguments.length){e=Pq(t);return f}else{return e}};f.spiral=function(t){if(arguments.length){l=Iq[t]||t;return f}else{return l}};f.fontSize=function(t){if(arguments.length){i=Pq(t);return f}else{return i}};f.padding=function(t){if(arguments.length){a=Pq(t);return f}else{return a}};f.random=function(t){if(arguments.length){c=t;return f}else{return c}};return f}function Aq(t,e,n,i){if(e.sprite)return;var r=t.context,o=t.ratio;r.clearRect(0,0,(Tq<<5)/o,$q/o);var s=0,a=0,l=0,u=n.length,c,f,h,d,p;--i;while(++i<u){e=n[i];r.save();r.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font;c=r.measureText(e.text+"m").width*o;h=e.size<<1;if(e.rotate){var m=Math.sin(e.rotate*Eq),g=Math.cos(e.rotate*Eq),y=c*g,v=c*m,_=h*g,x=h*m;c=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5;h=~~Math.max(Math.abs(v+_),Math.abs(v-_))}else{c=c+31>>5<<5}if(h>l)l=h;if(s+c>=Tq<<5){s=0;a+=l;l=0}if(a+h>=$q)break;r.translate((s+(c>>1))/o,(a+(h>>1))/o);if(e.rotate)r.rotate(e.rotate*Eq);r.fillText(e.text,0,0);if(e.padding){r.lineWidth=2*e.padding;r.strokeText(e.text,0,0)}r.restore();e.width=c;e.height=h;e.xoff=s;e.yoff=a;e.x1=c>>1;e.y1=h>>1;e.x0=-e.x1;e.y0=-e.y1;e.hasText=true;s+=c}var b=r.getImageData(0,0,(Tq<<5)/o,$q/o).data,w=[];while(--i>=0){e=n[i];if(!e.hasText)continue;c=e.width;f=c>>5;h=e.y1-e.y0;for(d=0;d<h*f;d++)w[d]=0;s=e.xoff;if(s==null)return;a=e.yoff;var k=0,M=-1;for(p=0;p<h;p++){for(d=0;d<c;d++){var S=f*p+(d>>5),E=b[(a+p)*(Tq<<5)+(s+d)<<2]?1<<31-d%32:0;w[S]|=E;k|=E}if(k)M=p;else{e.y0++;h--;p--;a++}}e.y1=e.y0+M;e.sprite=w.slice(0,(e.y1-e.y0)*f)}}function Nq(t,e,n){n>>=5;var i=t.sprite,r=t.width>>5,o=t.x-(r<<4),s=o&127,a=32-s,l=t.y1-t.y0,u=(t.y+t.y0)*n+(o>>5),c;for(var f=0;f<l;f++){c=0;for(var h=0;h<=r;h++){if((c<<a|(h<r?(c=i[f*r+h])>>>s:0))&e[u+h])return true}u+=n}return false}function zq(t,e){var n=t[0],i=t[1];if(e.x+e.x0<n.x)n.x=e.x+e.x0;if(e.y+e.y0<n.y)n.y=e.y+e.y0;if(e.x+e.x1>i.x)i.x=e.x+e.x1;if(e.y+e.y1>i.y)i.y=e.y+e.y1}function Rq(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function Cq(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function Oq(t){var e=4,n=e*t[0]/t[1],i=0,r=0;return function(t){var o=t<0?-1:1;switch(Math.sqrt(1+4*o*t)-o&3){case 0:i+=n;break;case 1:r+=e;break;case 2:i-=n;break;default:r-=e;break}return[i,r]}}function Uq(t){var e=[],n=-1;while(++n<t)e[n]=0;return e}function Pq(t){return typeof t==="function"?t:function(){return t}}var Iq={archimedean:Cq,rectangular:Oq};const qq=["x","y","font","fontSize","fontStyle","fontWeight","angle"];const Lq=["text","font","rotate","fontSize","fontStyle","fontWeight"];function Fq(t){Us.call(this,Dq(),t)}Fq.Definition={type:"Wordcloud",metadata:{modifies:true},params:[{name:"size",type:"number",array:true,length:2},{name:"font",type:"string",expr:true,default:"sans-serif"},{name:"fontStyle",type:"string",expr:true,default:"normal"},{name:"fontWeight",type:"string",expr:true,default:"normal"},{name:"fontSize",type:"number",expr:true,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:true,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:true},{name:"as",type:"string",array:true,length:7,default:qq}]};(0,m.XW)(Fq,Us,{transform(t,e){if(t.size&&!(t.size[0]&&t.size[1])){(0,m.vU)("Wordcloud size dimensions must be non-zero.")}function n(n){const i=t[n];return(0,m.mf)(i)&&e.modified(i.fields)}const i=t.modified();if(!(i||e.changed(e.ADD_REM)||Lq.some(n)))return;const r=e.materialize(e.SOURCE).source,o=this.value,s=t.as||qq;let a=t.fontSize||14,l;(0,m.mf)(a)?l=t.fontSizeRange:a=(0,m.a9)(a);if(l){const t=a,e=zg("sqrt")().domain((0,m.We)(r,t)).range(l);a=n=>e(t(n))}r.forEach((t=>{t[s[0]]=NaN;t[s[1]]=NaN;t[s[3]]=0}));const u=o.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(a).random(aa).layout();const c=o.size(),f=c[0]>>1,h=c[1]>>1,d=u.length;for(let p=0,m,g;p<d;++p){m=u[p];g=m.datum;g[s[0]]=m.x+f;g[s[1]]=m.y+h;g[s[2]]=m.font;g[s[3]]=m.size;g[s[4]]=m.style;g[s[5]]=m.weight;g[s[6]]=m.rotate}return e.reflow(i).modifies(s)}});function jq(t,e){return Array.from(e,(e=>t[e]))}const Wq=t=>new Uint8Array(t);const Xq=t=>new Uint16Array(t);const Hq=t=>new Uint32Array(t);function Bq(){let t=8,e=[],n=Hq(0),i=Jq(0,t),r=Jq(0,t);return{data:()=>e,seen:()=>n=Yq(n,e.length),add(t){for(let n=0,i=e.length,r=t.length,o;n<r;++n){o=t[n];o._index=i++;e.push(o)}},remove(t,n){const o=e.length,s=Array(o-t),a=e;let l,u,c;for(u=0;!n[u]&&u<o;++u){s[u]=e[u];a[u]=u}for(c=u;u<o;++u){l=e[u];if(!n[u]){a[u]=c;i[c]=i[u];r[c]=r[u];s[c]=l;l._index=c++}else{a[u]=-1}i[u]=0}e=s;return a},size:()=>e.length,curr:()=>i,prev:()=>r,reset:t=>r[t]=i[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){i[t]|=e},clear(t,e){i[t]&=~e},resize(e,n){const o=i.length;if(e>o||n>t){t=Math.max(n,t);i=Jq(e,t,i);r=Jq(e,t)}}}}function Yq(t,e,n){if(t.length>=e)return t;n=n||new t.constructor(e);n.set(t);return n}function Jq(t,e,n){const i=(e<257?Wq:e<65537?Xq:Hq)(t);if(n)i.set(n);return i}function Gq(t,e,n){const i=1<<e;return{one:i,zero:~i,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this,r=n.bisect(n.range,t.value),o=t.index,s=r[0],a=r[1],l=o.length;let u;for(u=0;u<s;++u)e[o[u]]|=i;for(u=a;u<l;++u)e[o[u]]|=i;return n}}}function Vq(){let t=Hq(0),e=[],n=0;function i(i,r,o){if(!r.length)return[];const s=n,a=r.length,l=Hq(a);let u=Array(a),c,f,h;for(h=0;h<a;++h){u[h]=i(r[h]);l[h]=h}u=Kq(u,l);if(s){c=e;f=t;e=Array(s+a);t=Hq(s+a);Zq(o,c,f,s,u,l,a,e,t)}else{if(o>0)for(h=0;h<a;++h){l[h]+=o}e=u;t=l}n=s+a;return{index:l,value:u}}function r(i,r){const o=n;let s,a,l;for(a=0;!r[t[a]]&&a<o;++a);for(l=a;a<o;++a){if(!r[s=t[a]]){t[l]=s;e[l]=e[a];++l}}n=o-i}function o(e){for(let i=0,r=n;i<r;++i){t[i]=e[t[i]]}}function s(t,i){let r;if(i){r=i.length}else{i=e;r=n}return[lh(i,t[0],0,r),ah(i,t[1],0,r)]}return{insert:i,remove:r,bisect:s,reindex:o,index:()=>t,size:()=>n}}function Kq(t,e){t.sort.call(e,((e,n)=>{const i=t[e],r=t[n];return i<r?-1:i>r?1:0}));return jq(t,e)}function Zq(t,e,n,i,r,o,s,a,l){let u=0,c=0,f;for(f=0;u<i&&c<s;++f){if(e[u]<r[c]){a[f]=e[u];l[f]=n[u++]}else{a[f]=r[c];l[f]=o[c++]+t}}for(;u<i;++u,++f){a[f]=e[u];l[f]=n[u]}for(;c<s;++c,++f){a[f]=r[c];l[f]=o[c]+t}}function Qq(t){Us.call(this,Bq(),t);this._indices=null;this._dims=null}Qq.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:true,required:true},{name:"query",type:"array",array:true,required:true,content:{type:"number",array:true,length:2}}]};(0,m.XW)(Qq,Us,{transform(t,e){if(!this._dims){return this.init(t,e)}else{var n=t.modified("fields")||t.fields.some((t=>e.modified(t.fields)));return n?this.reinit(t,e):this.eval(t,e)}},init(t,e){const n=t.fields,i=t.query,r=this._indices={},o=this._dims=[],s=i.length;let a=0,l,u;for(;a<s;++a){l=n[a].fname;u=r[l]||(r[l]=Vq());o.push(Gq(u,a,i[a]))}return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),i=t.fields,r=t.query,o=this._indices,s=this._dims,a=this.value,l=a.curr(),u=a.prev(),c=a.all(),f=n.rem=n.add,h=n.mod,d=r.length,p={};let m,g,y,v,_,x,b,w,k;u.set(l);if(e.rem.length){_=this.remove(t,e,n)}if(e.add.length){a.add(e.add)}if(e.mod.length){x={};for(v=e.mod,b=0,w=v.length;b<w;++b){x[v[b]._index]=1}}for(b=0;b<d;++b){k=i[b];if(!s[b]||t.modified("fields",b)||e.modified(k.fields)){y=k.fname;if(!(m=p[y])){o[y]=g=Vq();p[y]=m=g.insert(k,e.source,0)}s[b]=Gq(g,b,r[b]).onAdd(m,l)}}for(b=0,w=a.data().length;b<w;++b){if(_[b]){continue}else if(u[b]!==l[b]){f.push(b)}else if(x[b]&&l[b]!==c){h.push(b)}}a.mask=(1<<d)-1;return n},eval(t,e){const n=e.materialize().fork(),i=this._dims.length;let r=0;if(e.rem.length){this.remove(t,e,n);r|=(1<<i)-1}if(t.modified("query")&&!t.modified("fields")){r|=this.update(t,e,n)}if(e.add.length){this.insert(t,e,n);r|=(1<<i)-1}if(e.mod.length){this.modify(e,n);r|=(1<<i)-1}this.value.mask=r;return n},insert(t,e,n){const i=e.add,r=this.value,o=this._dims,s=this._indices,a=t.fields,l={},u=n.add,c=r.size()+i.length,f=o.length;let h=r.size(),d,p,m;r.resize(c,f);r.add(i);const g=r.curr(),y=r.prev(),v=r.all();for(d=0;d<f;++d){p=a[d].fname;m=l[p]||(l[p]=s[p].insert(a[d],i,h));o[d].onAdd(m,g)}for(;h<c;++h){y[h]=v;if(g[h]!==v)u.push(h)}},modify(t,e){const n=e.mod,i=this.value,r=i.curr(),o=i.all(),s=t.mod;let a,l,u;for(a=0,l=s.length;a<l;++a){u=s[a]._index;if(r[u]!==o)n.push(u)}},remove(t,e,n){const i=this._indices,r=this.value,o=r.curr(),s=r.prev(),a=r.all(),l={},u=n.rem,c=e.rem;let f,h,d,p;for(f=0,h=c.length;f<h;++f){d=c[f]._index;l[d]=1;s[d]=p=o[d];o[d]=a;if(p!==a)u.push(d)}for(d in i){i[d].remove(h,l)}this.reindex(e,h,l);return l},reindex(t,e,n){const i=this._indices,r=this.value;t.runAfter((()=>{const t=r.remove(e,n);for(const e in i)i[e].reindex(t)}))},update(t,e,n){const i=this._dims,r=t.query,o=e.stamp,s=i.length;let a=0,l,u;n.filters=0;for(u=0;u<s;++u){if(t.modified("query",u)){l=u;++a}}if(a===1){a=i[l].one;this.incrementOne(i[l],r[l],n.add,n.rem)}else{for(u=0,a=0;u<s;++u){if(!t.modified("query",u))continue;a|=i[u].one;this.incrementAll(i[u],r[u],o,n.add);n.rem=n.add}}return a},incrementAll(t,e,n,i){const r=this.value,o=r.seen(),s=r.curr(),a=r.prev(),l=t.index(),u=t.bisect(t.range),c=t.bisect(e),f=c[0],h=c[1],d=u[0],p=u[1],m=t.one;let g,y,v;if(f<d){for(g=f,y=Math.min(d,h);g<y;++g){v=l[g];if(o[v]!==n){a[v]=s[v];o[v]=n;i.push(v)}s[v]^=m}}else if(f>d){for(g=d,y=Math.min(f,p);g<y;++g){v=l[g];if(o[v]!==n){a[v]=s[v];o[v]=n;i.push(v)}s[v]^=m}}if(h>p){for(g=Math.max(f,p),y=h;g<y;++g){v=l[g];if(o[v]!==n){a[v]=s[v];o[v]=n;i.push(v)}s[v]^=m}}else if(h<p){for(g=Math.max(d,h),y=p;g<y;++g){v=l[g];if(o[v]!==n){a[v]=s[v];o[v]=n;i.push(v)}s[v]^=m}}t.range=e.slice()},incrementOne(t,e,n,i){const r=this.value,o=r.curr(),s=t.index(),a=t.bisect(t.range),l=t.bisect(e),u=l[0],c=l[1],f=a[0],h=a[1],d=t.one;let p,m,g;if(u<f){for(p=u,m=Math.min(f,c);p<m;++p){g=s[p];o[g]^=d;n.push(g)}}else if(u>f){for(p=f,m=Math.min(u,h);p<m;++p){g=s[p];o[g]^=d;i.push(g)}}if(c>h){for(p=Math.max(u,h),m=c;p<m;++p){g=s[p];o[g]^=d;n.push(g)}}else if(c<h){for(p=Math.max(f,c),m=h;p<m;++p){g=s[p];o[g]^=d;i.push(g)}}t.range=e.slice()}});function tL(t){Us.call(this,null,t)}tL.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:true,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:true,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};(0,m.XW)(tL,Us,{transform(t,e){const n=~(t.ignore||0),i=t.filter,r=i.mask;if((r&n)===0)return e.StopPropagation;const o=e.fork(e.ALL),s=i.data(),a=i.curr(),l=i.prev(),u=t=>!(a[t]&n)?s[t]:null;o.filter(o.MOD,u);if(!(r&r-1)){o.filter(o.ADD,u);o.filter(o.REM,(t=>(a[t]&n)===r?s[t]:null))}else{o.filter(o.ADD,(t=>{const e=a[t]&n,i=!e&&e^l[t]&n;return i?s[t]:null}));o.filter(o.REM,(t=>{const e=a[t]&n,i=e&&!(e^(e^l[t]&n));return i?s[t]:null}))}return o.filter(o.SOURCE,(t=>u(t._index)))}});var eL=n(25693);var nL=new IE;var iL=new IE,rL,oL,sL,aL,lL;var uL={point:hT,lineStart:hT,lineEnd:hT,polygonStart:function(){nL=new IE;uL.lineStart=cL;uL.lineEnd=fL},polygonEnd:function(){var t=+nL;iL.add(t<0?BE+t:t);this.lineStart=this.lineEnd=this.point=hT},sphere:function(){iL.add(BE)}};function cL(){uL.point=hL}function fL(){dL(rL,oL)}function hL(t,e){uL.point=dL;rL=t,oL=e;t*=JE,e*=JE;sL=t,aL=ZE(e=e/2+HE),lL=oT(e)}function dL(t,e){t*=JE,e*=JE;e=e/2+HE;var n=t-sL,i=n>=0?1:-1,r=i*n,o=ZE(e),s=oT(e),a=lL*s,l=aL*o+a*ZE(r),u=a*i*oT(r);nL.add(KE(u,l));sL=t,aL=o,lL=s}function pL(t){iL=new IE;PE(t,uL);return iL*2}var mL,gL,yL,vL,_L,xL,bL,wL,kL,ML,SL;var EL={point:TL,lineStart:DL,lineEnd:AL,polygonStart:function(){EL.point=NL;EL.lineStart=zL;EL.lineEnd=RL;kL=new IE;uL.polygonStart()},polygonEnd:function(){uL.polygonEnd();EL.point=TL;EL.lineStart=DL;EL.lineEnd=AL;if(nL<0)mL=-(yL=180),gL=-(vL=90);else if(kL>FE)vL=90;else if(kL<-FE)gL=-90;SL[0]=mL,SL[1]=yL},sphere:function(){mL=-(yL=180),gL=-(vL=90)}};function TL(t,e){ML.push(SL=[mL=t,yL=t]);if(e<gL)gL=e;if(e>vL)vL=e}function $L(t,e){var n=T$([t*JE,e*JE]);if(wL){var i=D$(wL,n),r=[i[1],-i[0],0],o=D$(r,i);z$(o);o=E$(o);var s=t-_L,a=s>0?1:-1,l=o[0]*YE*a,u,c=GE(s)>180;if(c^(a*_L<l&&l<a*t)){u=o[1]*YE;if(u>vL)vL=u}else if(l=(l+360)%360-180,c^(a*_L<l&&l<a*t)){u=-o[1]*YE;if(u<gL)gL=u}else{if(e<gL)gL=e;if(e>vL)vL=e}if(c){if(t<_L){if(CL(mL,t)>CL(mL,yL))yL=t}else{if(CL(t,yL)>CL(mL,yL))mL=t}}else{if(yL>=mL){if(t<mL)mL=t;if(t>yL)yL=t}else{if(t>_L){if(CL(mL,t)>CL(mL,yL))yL=t}else{if(CL(t,yL)>CL(mL,yL))mL=t}}}}else{ML.push(SL=[mL=t,yL=t])}if(e<gL)gL=e;if(e>vL)vL=e;wL=n,_L=t}function DL(){EL.point=$L}function AL(){SL[0]=mL,SL[1]=yL;EL.point=TL;wL=null}function NL(t,e){if(wL){var n=t-_L;kL.add(GE(n)>180?n+(n>0?360:-360):n)}else{xL=t,bL=e}uL.point(t,e);$L(t,e)}function zL(){uL.lineStart()}function RL(){NL(xL,bL);uL.lineEnd();if(GE(kL)>FE)mL=-(yL=180);SL[0]=mL,SL[1]=yL;wL=null}function CL(t,e){return(e-=t)<0?e+360:e}function OL(t,e){return t[0]-e[0]}function UL(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function PL(t){var e,n,i,r,o,s,a;vL=yL=-(mL=gL=Infinity);ML=[];PE(t,EL);if(n=ML.length){ML.sort(OL);for(e=1,i=ML[0],o=[i];e<n;++e){r=ML[e];if(UL(i,r[0])||UL(i,r[1])){if(CL(i[0],r[1])>CL(i[0],i[1]))i[1]=r[1];if(CL(r[0],i[1])>CL(i[0],i[1]))i[0]=r[0]}else{o.push(i=r)}}for(s=-Infinity,n=o.length-1,e=0,i=o[n];e<=n;i=r,++e){r=o[e];if((a=CL(i[1],r[0]))>s)s=a,mL=r[0],yL=i[1]}}ML=SL=null;return mL===Infinity||gL===Infinity?[[NaN,NaN],[NaN,NaN]]:[[mL,gL],[yL,vL]]}var IL,qL,LL,FL,jL,WL,XL,HL,BL,YL,JL,GL,VL,KL,ZL,QL;var tF={sphere:hT,point:eF,lineStart:iF,lineEnd:sF,polygonStart:function(){tF.lineStart=aF;tF.lineEnd=lF},polygonEnd:function(){tF.lineStart=iF;tF.lineEnd=sF}};function eF(t,e){t*=JE,e*=JE;var n=ZE(e);nF(n*ZE(t),n*oT(t),oT(e))}function nF(t,e,n){++IL;LL+=(t-LL)/IL;FL+=(e-FL)/IL;jL+=(n-jL)/IL}function iF(){tF.point=rF}function rF(t,e){t*=JE,e*=JE;var n=ZE(e);KL=n*ZE(t);ZL=n*oT(t);QL=oT(e);tF.point=oF;nF(KL,ZL,QL)}function oF(t,e){t*=JE,e*=JE;var n=ZE(e),i=n*ZE(t),r=n*oT(t),o=oT(e),s=KE(aT((s=ZL*o-QL*r)*s+(s=QL*i-KL*o)*s+(s=KL*r-ZL*i)*s),KL*i+ZL*r+QL*o);qL+=s;WL+=s*(KL+(KL=i));XL+=s*(ZL+(ZL=r));HL+=s*(QL+(QL=o));nF(KL,ZL,QL)}function sF(){tF.point=eF}function aF(){tF.point=uF}function lF(){cF(GL,VL);tF.point=eF}function uF(t,e){GL=t,VL=e;t*=JE,e*=JE;tF.point=cF;var n=ZE(e);KL=n*ZE(t);ZL=n*oT(t);QL=oT(e);nF(KL,ZL,QL)}function cF(t,e){t*=JE,e*=JE;var n=ZE(e),i=n*ZE(t),r=n*oT(t),o=oT(e),s=ZL*o-QL*r,a=QL*i-KL*o,l=KL*r-ZL*i,u=nT(s,a,l),c=cT(u),f=u&&-c/u;BL.add(f*s);YL.add(f*a);JL.add(f*l);qL+=c;WL+=c*(KL+(KL=i));XL+=c*(ZL+(ZL=r));HL+=c*(QL+(QL=o));nF(KL,ZL,QL)}function fF(t){IL=qL=LL=FL=jL=WL=XL=HL=0;BL=new IE;YL=new IE;JL=new IE;PE(t,tF);var e=+BL,n=+YL,i=+JL,r=nT(e,n,i);if(r<jE){e=WL,n=XL,i=HL;if(qL<FE)e=LL,n=FL,i=jL;r=nT(e,n,i);if(r<jE)return[NaN,NaN]}return[KE(n,e)*YE,cT(i/r)*YE]}function hF(...t){const e=new Op;for(const n of t){for(const t of n){e.add(t)}}return e}function dF(t,...e){t=new Op(t);e=e.map(pF);t:for(const n of t){for(const i of e){if(!i.has(n)){t.delete(n);continue t}}}return t}function pF(t){return t instanceof Op?t:new Op(t)}const mF="intersect";const gF="union";const yF="vlMulti";const vF="vlPoint";const _F="or";const xF="and";const bF="_vgsid_";const wF=(0,m.EP)(bF);const kF="E",MF="R",SF="R-E",EF="R-LE",TF="R-RE",$F="index:unit";function DF(t,e){var n=e.fields,i=e.values,r=n.length,o=0,s,a;for(;o<r;++o){a=n[o];a.getter=m.EP.getter||(0,m.EP)(a.field);s=a.getter(t);if((0,m.J_)(s))s=(0,m.He)(s);if((0,m.J_)(i[o]))i[o]=(0,m.He)(i[o]);if((0,m.J_)(i[o][0]))i[o]=i[o].map(m.He);if(a.type===kF){if((0,m.kJ)(i[o])?i[o].indexOf(s)<0:s!==i[o]){return false}}else{if(a.type===MF){if(!(0,m.u5)(s,i[o]))return false}else if(a.type===TF){if(!(0,m.u5)(s,i[o],true,false))return false}else if(a.type===SF){if(!(0,m.u5)(s,i[o],false,false))return false}else if(a.type===EF){if(!(0,m.u5)(s,i[o],false,true))return false}}}return true}function AF(t,e,n){var i=this.context.data[t],r=i?i.values.value:[],o=i?i[$F]&&i[$F].value:undefined,s=n===mF,a=r.length,l=0,u,c,f,h,d;for(;l<a;++l){u=r[l];if(o&&s){c=c||{};f=c[h=u.unit]||0;if(f===-1)continue;d=DF(e,u);c[h]=d?-1:++f;if(d&&o.size===1)return true;if(!d&&f===o.get(h).count)return false}else{d=DF(e,u);if(s^d)return d}}return a&&s}const NF=De(wF),zF=NF.left,RF=NF.right;function CF(t,e,n){const i=this.context.data[t],r=i?i.values.value:[],o=i?i[$F]&&i[$F].value:undefined,s=n===mF,a=wF(e),l=zF(r,a);if(l===r.length)return false;if(wF(r[l])!==a)return false;if(o&&s){if(o.size===1)return true;if(RF(r,a)-l<o.size)return false}return true}function OF(t,e){return t.map((t=>(0,m.l7)(e.fields?{values:e.fields.map((e=>(e.getter||(e.getter=(0,m.EP)(e.field)))(t.datum)))}:{[bF]:wF(t.datum)},e)))}function UF(t,e,n,i){var r=this.context.data[t],o=r?r.values.value:[],s={},a={},l={},u,c,f,h,d,p,g,y,v,_,x=o.length,b=0,w,k;for(;b<x;++b){u=o[b];h=u.unit;c=u.fields;f=u.values;if(c&&f){for(w=0,k=c.length;w<k;++w){d=c[w];g=s[d.field]||(s[d.field]={});y=g[h]||(g[h]=[]);l[d.field]=v=d.type.charAt(0);_=PF[`${v}_union`];g[h]=_(y,(0,m.IX)(f[w]))}if(n){y=a[h]||(a[h]=[]);y.push((0,m.IX)(f).reduce(((t,e,n)=>(t[c[n].field]=e,t)),{}))}}else{d=bF;p=wF(u);g=s[d]||(s[d]={});y=g[h]||(g[h]=[]);y.push(p);if(n){y=a[h]||(a[h]=[]);y.push({[bF]:p})}}}e=e||gF;if(s[bF]){s[bF]=PF[`${bF}_${e}`](...Object.values(s[bF]))}else{Object.keys(s).forEach((t=>{s[t]=Object.keys(s[t]).map((e=>s[t][e])).reduce(((n,i)=>n===undefined?i:PF[`${l[t]}_${e}`](n,i)))}))}o=Object.keys(a);if(n&&o.length){const t=i?vF:yF;s[t]=e===gF?{[_F]:o.reduce(((t,e)=>(t.push(...a[e]),t)),[])}:{[xF]:o.map((t=>({[_F]:a[t]})))}}return s}var PF={[`${bF}_union`]:hF,[`${bF}_intersect`]:dF,E_union:function(t,e){if(!t.length)return e;var n=0,i=e.length;for(;n<i;++n)if(t.indexOf(e[n])<0)t.push(e[n]);return t},E_intersect:function(t,e){return!t.length?e:t.filter((t=>e.indexOf(t)>=0))},R_union:function(t,e){var n=(0,m.He)(e[0]),i=(0,m.He)(e[1]);if(n>i){n=e[1];i=e[0]}if(!t.length)return[n,i];if(t[0]>n)t[0]=n;if(t[1]<i)t[1]=i;return t},R_intersect:function(t,e){var n=(0,m.He)(e[0]),i=(0,m.He)(e[1]);if(n>i){n=e[1];i=e[0]}if(!t.length)return[n,i];if(i<t[0]||t[1]<n){return[]}else{if(t[0]<n)t[0]=n;if(t[1]>i)t[1]=i}return t}};const IF=":",qF="@";function LF(t,e,n,i){if(e[0].type!==eL.t$)(0,m.vU)("First argument to selection functions must be a string literal.");const r=e[0].value,o=e.length>=2&&(0,m.fj)(e).value,s="unit",a=qF+s,l=IF+r;if(o===mF&&!(0,m.nr)(i,a)){i[a]=n.getData(r).indataRef(n,s)}if(!(0,m.nr)(i,l)){i[l]=n.getData(r).tuplesRef()}}function FF(t){const e=this.context.data[t];return e?e.values.value:[]}function jF(t,e,n){const i=this.context.data[t]["index:"+e],r=i?i.value.get(n):undefined;return r?r.count:r}function WF(t,e){const n=this.context.dataflow,i=this.context.data[t],r=i.input;n.pulse(r,n.changeset().remove(m.yb).insert(e));return 1}function XF(t,e,n){if(t){const n=this.context.dataflow,i=t.mark.source;n.pulse(i,n.changeset().encode(t,e))}return n!==undefined?n:t}const HF=t=>function(e,n){const i=this.context.dataflow.locale();return i[t](n)(e)};const BF=HF("format");const YF=HF("timeFormat");const JF=HF("utcFormat");const GF=HF("timeParse");const VF=HF("utcParse");const KF=new Date(2e3,0,1);function ZF(t,e,n){if(!Number.isInteger(t)||!Number.isInteger(e))return"";KF.setYear(2e3);KF.setMonth(t);KF.setDate(e);return YF.call(this,KF,n)}function QF(t){return ZF.call(this,t,1,"%B")}function tj(t){return ZF.call(this,t,1,"%b")}function ej(t){return ZF.call(this,0,2+t,"%A")}function nj(t){return ZF.call(this,0,2+t,"%a")}const ij=":";const rj="@";const oj="%";const sj="$";function aj(t,e,n,i){if(e[0].type!==eL.t$){(0,m.vU)("First argument to data functions must be a string literal.")}const r=e[0].value,o=ij+r;if(!(0,m.nr)(o,i)){try{i[o]=n.getData(r).tuplesRef()}catch(s){}}}function lj(t,e,n,i){if(e[0].type!==eL.t$)(0,m.vU)("First argument to indata must be a string literal.");if(e[1].type!==eL.t$)(0,m.vU)("Second argument to indata must be a string literal.");const r=e[0].value,o=e[1].value,s=rj+o;if(!(0,m.nr)(s,i)){i[s]=n.getData(r).indataRef(n,o)}}function uj(t,e,n,i){if(e[0].type===eL.t$){cj(n,i,e[0].value)}else{for(t in n.scales){cj(n,i,t)}}}function cj(t,e,n){const i=oj+n;if(!(0,m.nr)(e,i)){try{e[i]=t.scaleRef(n)}catch(r){}}}function fj(t,e){if((0,m.mf)(t)){return t}if((0,m.HD)(t)){const n=e.scales[t];return n&&Ag(n.value)?n.value:undefined}return undefined}function hj(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0;n._bandwidth=uj;n._range=uj;n._scale=uj;const i=e=>"_["+(e.type===eL.t$?(0,m.m8)(oj+e.value):(0,m.m8)(oj)+"+"+t(e))+"]";return{_bandwidth:t=>`this.__bandwidth(${i(t[0])})`,_range:t=>`${i(t[0])}.range()`,_scale:e=>`${i(e[0])}(${t(e[1])})`}}function dj(t,e){return function(n,i,r){if(n){const e=fj(n,(r||this).context);return e&&e.path[t](i)}else{return e(i)}}}const pj=dj("area",pL);const mj=dj("bounds",PL);const gj=dj("centroid",fF);function yj(t){const e=this.context.group;let n=false;if(e)while(t){if(t===e){n=true;break}t=t.mark.group}return n}function vj(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(i){t.warn(i)}return n[n.length-1]}function _j(){return vj(this.context.dataflow,"warn",arguments)}function xj(){return vj(this.context.dataflow,"info",arguments)}function bj(){return vj(this.context.dataflow,"debug",arguments)}function wj(t){const e=t/255;if(e<=.03928){return e/12.92}return Math.pow((e+.055)/1.055,2.4)}function kj(t){const e=Oh(t),n=wj(e.r),i=wj(e.g),r=wj(e.b);return.2126*n+.7152*i+.0722*r}function Mj(t,e){const n=kj(t),i=kj(e),r=Math.max(n,i),o=Math.min(n,i);return(r+.05)/(o+.05)}function Sj(){const t=[].slice.call(arguments);t.unshift({});return(0,m.l7)(...t)}function Ej(t,e){return t===e||t!==t&&e!==e?true:(0,m.kJ)(t)?(0,m.kJ)(e)&&t.length===e.length?Tj(t,e):false:(0,m.Kn)(t)&&(0,m.Kn)(e)?$j(t,e):false}function Tj(t,e){for(let n=0,i=t.length;n<i;++n){if(!Ej(t[n],e[n]))return false}return true}function $j(t,e){for(const n in t){if(!Ej(t[n],e[n]))return false}return true}function Dj(t){return e=>$j(t,e)}function Aj(t,e,n,i,r,o){const s=this.context.dataflow,a=this.context.data[t],l=a.input,u=s.stamp();let c=a.changes,f,h;if(s._trigger===false||!(l.value.length||e||i)){return 0}if(!c||c.stamp<u){a.changes=c=s.changeset();c.stamp=u;s.runAfter((()=>{a.modified=true;s.pulse(l,c).run()}),true,1)}if(n){f=n===true?m.yb:(0,m.kJ)(n)||xo(n)?n:Dj(n);c.remove(f)}if(e){c.insert(e)}if(i){f=Dj(i);if(l.value.some(f)){c.remove(f)}else{c.insert(i)}}if(r){for(h in o){c.modify(r,h,o[h])}}return 1}function Nj(t){const e=t.touches,n=e[0].clientX-e[1].clientX,i=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+i*i)}function zj(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)}const Rj={};function Cj(t,e){const n=Rj[e]||(Rj[e]=(0,m.EP)(e));return(0,m.kJ)(t)?t.map(n):n(t)}function Oj(t){return(0,m.kJ)(t)||ArrayBuffer.isView(t)?t:null}function Uj(t){return Oj(t)||((0,m.HD)(t)?t:null)}function Pj(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++){n[i-1]=arguments[i]}return Oj(t).join(...n)}function Ij(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++){n[i-1]=arguments[i]}return Uj(t).indexOf(...n)}function qj(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++){n[i-1]=arguments[i]}return Uj(t).lastIndexOf(...n)}function Lj(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++){n[i-1]=arguments[i]}return Uj(t).slice(...n)}function Fj(t,e,n){if((0,m.mf)(n))(0,m.vU)("Function argument passed to replace.");return String(t).replace(e,n)}function jj(t){return Oj(t).slice().reverse()}function Wj(t,e,n){return Gm(t||0,e||0,n||0)}function Xj(t,e){const n=fj(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}function Hj(t,e){const n=fj(t,(e||this).context);return n?n.copy():undefined}function Bj(t,e){const n=fj(t,(e||this).context);return n?n.domain():[]}function Yj(t,e,n){const i=fj(t,(n||this).context);return!i?undefined:(0,m.kJ)(e)?(i.invertRange||i.invert)(e):(i.invert||i.invertExtent)(e)}function Jj(t,e){const n=fj(t,(e||this).context);return n&&n.range?n.range():[]}function Gj(t,e,n){const i=fj(t,(n||this).context);return i?i(e):undefined}function Vj(t,e,n,i,r){t=fj(t,(r||this).context);const o=Oy(e,n);let s=t.domain(),a=s[0],l=(0,m.fj)(s),u=m.yR;if(!(l-a)){t=(t.interpolator?zg("sequential")().interpolator(t.interpolator()):zg("linear")().interpolate(t.interpolate()).range(t.range())).domain([a=0,l=1])}else{u=Yg(t,a,l)}if(t.ticks){s=t.ticks(+i||15);if(a!==s[0])s.unshift(a);if(l!==(0,m.fj)(s))s.push(l)}s.forEach((e=>o.stop(u(e),t(e))));return o}function Kj(t,e,n){const i=fj(t,(n||this).context);return function(t){return i?i.path.context(t)(e):""}}function Zj(t){let e=null;return function(n){return n?iv(n,e=e||Wy(t)):t}}const Qj=t=>t.data;function tW(t,e){const n=FF.call(e,t);return n.root&&n.root.lookup||{}}function eW(t,e,n){const i=tW(t,this),r=i[e],o=i[n];return r&&o?r.path(o).map(Qj):undefined}function nW(t,e){const n=tW(t,this)[e];return n?n.ancestors().map(Qj):undefined}const iW=()=>typeof window!=="undefined"&&window||null;function rW(){const t=iW();return t?t.screen:{}}function oW(){const t=iW();return t?[t.innerWidth,t.innerHeight]:[undefined,undefined]}function sW(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[undefined,undefined]}function aW(t,e,n){if(!t)return[];const[i,r]=t,o=(new r_).set(i[0],i[1],r[0],r[1]),s=n||this.context.dataflow.scenegraph().root;return jk(s,o,lW(e))}function lW(t){let e=null;if(t){const n=(0,m.IX)(t.marktype),i=(0,m.IX)(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!i.length||i.some((e=>t.name===e)))}return e}function uW(t,e,n){let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:5;t=(0,m.IX)(t);const r=t[t.length-1];return r===undefined||Math.sqrt((r[0]-e)**2+(r[1]-n)**2)>i?[...t,[e,n]]:t}function cW(t){return(0,m.IX)(t).reduce(((e,n,i)=>{let[r,o]=n;return e+=i==0?`M ${r},${o} `:i===t.length-1?" Z":`L ${r},${o} `}),"")}function fW(t,e,n){const{x:i,y:r,mark:o}=n;const s=(new r_).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[l,u]of e){if(l<s.x1)s.x1=l;if(l>s.x2)s.x2=l;if(u<s.y1)s.y1=u;if(u>s.y2)s.y2=u}s.translate(i,r);const a=aW([[s.x1,s.y1],[s.x2,s.y2]],t,o);return a.filter((t=>hW(t.x,t.y,e)))}function hW(t,e,n){let i=0;for(let r=0,o=n.length-1;r<n.length;o=r++){const[s,a]=n[o];const[l,u]=n[r];if(u>e!=a>e&&t<(s-l)*(e-u)/(a-u)+l){i++}}return i&1}const dW={random(){return aa()},cumulativeNormal:_a,cumulativeLogNormal:Ea,cumulativeUniform:za,densityNormal:va,densityLogNormal:Sa,densityUniform:Na,quantileNormal:xa,quantileLogNormal:Ta,quantileUniform:Ra,sampleNormal:ya,sampleLogNormal:Ma,sampleUniform:Aa,isArray:m.kJ,isBoolean:m.jn,isDate:m.J_,isDefined(t){return t!==undefined},isNumber:m.hj,isObject:m.Kn,isRegExp:m.Kj,isString:m.HD,isTuple:xo,isValid(t){return t!=null&&t===t},toBoolean:m.sw,toDate(t){return(0,m.ZU)(t)},toNumber:m.He,toString:m.BB,indexof:Ij,join:Pj,lastindexof:qj,replace:Fj,reverse:jj,slice:Lj,flush:m.yl,lerp:m.t7,merge:Sj,pad:m.vk,peek:m.fj,pluck:Cj,span:m.yP,inrange:m.u5,truncate:m.$G,rgb:Oh,lab:_m,hcl:Tm,hsl:Hh,luminance:kj,contrast:Mj,sequence:rl,format:BF,utcFormat:JF,utcParse:VF,utcOffset:kn,utcSequence:En,timeFormat:YF,timeParse:GF,timeOffset:wn,timeSequence:Sn,timeUnitSpecifier:Be,monthFormat:QF,monthAbbrevFormat:tj,dayFormat:ej,dayAbbrevFormat:nj,quarter:m.mS,utcquarter:m.N3,week:Ve,utcweek:nn,dayofyear:Ge,utcdayofyear:en,warn:_j,info:xj,debug:bj,extent(t){return(0,m.We)(t)},inScope:yj,intersect:aW,clampRange:m.l$,pinchDistance:Nj,pinchAngle:zj,screen:rW,containerSize:sW,windowSize:oW,bandspace:Wj,setdata:WF,pathShape:Zj,panLinear:m.Dw,panLog:m.mJ,panPow:m.QA,panSymlog:m.Zw,zoomLinear:m.ay,zoomLog:m.dH,zoomPow:m.mK,zoomSymlog:m.bV,encode:XF,modify:Aj,lassoAppend:uW,lassoPath:cW,intersectLasso:fW};const pW=["view","item","group","xy","x","y"],mW="event.vega.",gW="this.",yW={};const vW={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${(0,m.m8)(sj+t)}]`,functions:xW,constants:eL._G,visitors:yW};const _W=(0,eL.YP)(vW);function xW(t){const e=(0,eL.wk)(t);pW.forEach((t=>e[t]=mW+t));for(const n in dW){e[n]=gW+n}(0,m.l7)(e,hj(t,dW,yW));return e}function bW(t,e,n){if(arguments.length===1){return dW[t]}dW[t]=e;if(n)yW[t]=n;if(_W)_W.functions[t]=gW+t;return this}bW("bandwidth",Xj,uj);bW("copy",Hj,uj);bW("domain",Bj,uj);bW("range",Jj,uj);bW("invert",Yj,uj);bW("scale",Gj,uj);bW("gradient",Vj,uj);bW("geoArea",pj,uj);bW("geoBounds",mj,uj);bW("geoCentroid",gj,uj);bW("geoShape",Kj,uj);bW("indata",jF,lj);bW("data",FF,aj);bW("treePath",eW,aj);bW("treeAncestors",nW,aj);bW("vlSelectionTest",AF,LF);bW("vlSelectionIdTest",CF,LF);bW("vlSelectionResolve",UF,LF);bW("vlSelectionTuples",OF);function wW(t,e){const n={};let i;try{t=(0,m.HD)(t)?t:(0,m.m8)(t)+"";i=(0,eL.BJ)(t)}catch(o){(0,m.vU)("Expression parse error: "+t)}i.visit((t=>{if(t.type!==eL.Lt)return;const i=t.callee.name,r=vW.visitors[i];if(r)r(i,t.arguments,e,n)}));const r=_W(i);r.globals.forEach((t=>{const i=sj+t;if(!(0,m.nr)(n,i)&&e.getSignal(t)){n[i]=e.signalRef(t)}}));return{$expr:(0,m.l7)({code:r.code},e.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function kW(t){const e=this,n=t.operators||[];if(t.background){e.background=t.background}if(t.eventConfig){e.eventConfig=t.eventConfig}if(t.locale){e.locale=t.locale}n.forEach((t=>e.parseOperator(t)));n.forEach((t=>e.parseOperatorParameters(t)));(t.streams||[]).forEach((t=>e.parseStream(t)));(t.updates||[]).forEach((t=>e.parseUpdate(t)));return e.resolve()}const MW=(0,m.Rg)(["rule"]),SW=(0,m.Rg)(["group","image","rect"]);function EW(t,e){let n="";if(MW[e])return n;if(t.x2){if(t.x){if(SW[e]){n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"}n+="o.width=o.x2-o.x;"}else{n+="o.x=o.x2-(o.width||0);"}}if(t.xc){n+="o.x=o.xc-(o.width||0)/2;"}if(t.y2){if(t.y){if(SW[e]){n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"}n+="o.height=o.y2-o.y;"}else{n+="o.y=o.y2-(o.height||0);"}}if(t.yc){n+="o.y=o.yc-(o.height||0)/2;"}return n}function TW(t){return(t+"").toLowerCase()}function $W(t){return TW(t)==="operator"}function DW(t){return TW(t)==="collect"}function AW(t,e,n){if(!n.endsWith(";")){n="return("+n+");"}const i=Function(...e.concat(n));return t&&t.functions?i.bind(t.functions):i}function NW(t,e,n,i){return`((u = ${t}) < (v = ${e}) || u == null) && v != null ? ${n}\n  : (u > v || v == null) && u != null ? ${i}\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}\n  : v !== v && u === u ? ${i} : `}var zW={operator:(t,e)=>AW(t,["_"],e.code),parameter:(t,e)=>AW(t,["datum","_"],e.code),event:(t,e)=>AW(t,["event"],e.code),handler:(t,e)=>{const n=`var datum=event.item&&event.item.datum;return ${e.code};`;return AW(t,["_","event"],n)},encode:(t,e)=>{const{marktype:n,channels:i}=e;let r="var o=item,datum=o.datum,m=0,$;";for(const o in i){const t="o["+(0,m.m8)(o)+"]";r+=`$=${i[o].code};if(${t}!==$)${t}=$,m=1;`}r+=EW(i,n);r+="return m;";return AW(t,["item","_"],r)},codegen:{get(t){const e=`[${t.map(m.m8).join("][")}]`;const n=Function("_",`return _${e};`);n.path=e;return n},comparator(t,e){let n;const i=(t,i)=>{const r=e[i];let o,s;if(t.path){o=`a${t.path}`;s=`b${t.path}`}else{(n=n||{})["f"+i]=t;o=`this.f${i}(a)`;s=`this.f${i}(b)`}return NW(o,s,-r,r)};const r=Function("a","b","var u, v; return "+t.map(i).join("")+"0;");return n?r.bind(n):r}}};function RW(t){const e=this;if($W(t.type)||!t.type){e.operator(t,t.update?e.operatorExpression(t.update):null)}else{e.transform(t,t.type)}}function CW(t){const e=this;if(t.params){const n=e.get(t.id);if(!n)(0,m.vU)("Invalid operator id: "+t.id);e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}}function OW(t,e){e=e||{};const n=this;for(const i in t){const r=t[i];e[i]=(0,m.kJ)(r)?r.map((t=>UW(t,n,e))):UW(r,n,e)}return e}function UW(t,e,n){if(!t||!(0,m.Kn)(t))return t;for(let i=0,r=PW.length,o;i<r;++i){o=PW[i];if((0,m.nr)(t,o.key)){return o.parse(t,e,n)}}return t}var PW=[{key:"$ref",parse:IW},{key:"$key",parse:LW},{key:"$expr",parse:qW},{key:"$field",parse:FW},{key:"$encode",parse:WW},{key:"$compare",parse:jW},{key:"$context",parse:XW},{key:"$subflow",parse:HW},{key:"$tupleid",parse:BW}];function IW(t,e){return e.get(t.$ref)||(0,m.vU)("Operator not defined: "+t.$ref)}function qW(t,e,n){if(t.$params){e.parseParameters(t.$params,n)}const i="e:"+t.$expr.code;return e.fn[i]||(e.fn[i]=(0,m.ZE)(e.parameterExpression(t.$expr),t.$fields))}function LW(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=(0,m.Jy)(t.$key,t.$flat,e.expr.codegen))}function FW(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=(0,m.EP)(t.$field,t.$name,e.expr.codegen))}function jW(t,e){const n="c:"+t.$compare+"_"+t.$order,i=(0,m.IX)(t.$compare).map((t=>t&&t.$tupleid?bo:t));return e.fn[n]||(e.fn[n]=(0,m.qu)(i,t.$order,e.expr.codegen))}function WW(t,e){const n=t.$encode,i={};for(const r in n){const t=n[r];i[r]=(0,m.ZE)(e.encodeExpression(t.$expr),t.$fields);i[r].output=t.$output}return i}function XW(t,e){return e}function HW(t,e){const n=t.$subflow;return function(t,i,r){const o=e.fork().parse(n),s=o.get(n.operators[0].id),a=o.signals.parent;if(a)a.set(r);s.detachSubflow=()=>e.detach(o);return s}}function BW(){return bo}function YW(t){var e=this,n=t.filter!=null?e.eventExpression(t.filter):undefined,i=t.stream!=null?e.get(t.stream):undefined,r;if(t.source){i=e.events(t.source,t.type,n)}else if(t.merge){r=t.merge.map((t=>e.get(t)));i=r[0].merge.apply(r[0],r.slice(1))}if(t.between){r=t.between.map((t=>e.get(t)));i=i.between(r[0],r[1])}if(t.filter){i=i.filter(n)}if(t.throttle!=null){i=i.throttle(+t.throttle)}if(t.debounce!=null){i=i.debounce(+t.debounce)}if(i==null){(0,m.vU)("Invalid stream definition: "+JSON.stringify(t))}if(t.consume)i.consume(true);e.stream(t,i)}function JW(t){var e=this,n=(0,m.Kn)(n=t.source)?n.$ref:n,i=e.get(n),r=null,o=t.update,s=undefined;if(!i)(0,m.vU)("Source not defined: "+t.source);r=t.target&&t.target.$expr?e.eventExpression(t.target.$expr):e.get(t.target);if(o&&o.$expr){if(o.$params){s=e.parseParameters(o.$params)}o=e.handlerExpression(o.$expr)}e.update(t,i,r,o,s)}const GW={skip:true};function VW(t){var e=this,n={};if(t.signals){var i=n.signals={};Object.keys(e.signals).forEach((n=>{const r=e.signals[n];if(t.signals(n,r)){i[n]=r.value}}))}if(t.data){var r=n.data={};Object.keys(e.data).forEach((n=>{const i=e.data[n];if(t.data(n,i)){r[n]=i.input.value}}))}if(e.subcontext&&t.recurse!==false){n.subcontext=e.subcontext.map((e=>e.getState(t)))}return n}function KW(t){var e=this,n=e.dataflow,i=t.data,r=t.signals;Object.keys(r||{}).forEach((t=>{n.update(e.signals[t],r[t],GW)}));Object.keys(i||{}).forEach((t=>{n.pulse(e.data[t].input,n.changeset().remove(m.yb).insert(i[t]))}));(t.subcontext||[]).forEach(((t,n)=>{const i=e.subcontext[n];if(i)i.setState(t)}))}function ZW(t,e,n,i){return new QW(t,e,n,i)}function QW(t,e,n,i){this.dataflow=t;this.transforms=e;this.events=t.events.bind(t);this.expr=i||zW,this.signals={};this.scales={};this.nodes={};this.data={};this.fn={};if(n){this.functions=Object.create(n);this.functions.context=this}}function tX(t){this.dataflow=t.dataflow;this.transforms=t.transforms;this.events=t.events;this.expr=t.expr;this.signals=Object.create(t.signals);this.scales=Object.create(t.scales);this.nodes=Object.create(t.nodes);this.data=Object.create(t.data);this.fn=Object.create(t.fn);if(t.functions){this.functions=Object.create(t.functions);this.functions.context=this}}QW.prototype=tX.prototype={fork(){const t=new tX(this);(this.subcontext||(this.subcontext=[])).push(t);return t},detach(t){this.subcontext=this.subcontext.filter((e=>e!==t));const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,i=n.dataflow,r=t.value;n.set(t.id,e);if(DW(t.type)&&r){if(r.$ingest){i.ingest(e,r.$ingest,r.$format)}else if(r.$request){i.preload(e,r.$request,r.$format)}else{i.pulse(e,i.changeset().insert(r))}}if(t.root){n.root=e}if(t.parent){let r=n.get(t.parent.$ref);if(r){i.connect(r,[e]);e.targets().add(r)}else{(n.unresolved=n.unresolved||[]).push((()=>{r=n.get(t.parent.$ref);i.connect(r,[e]);e.targets().add(r)}))}}if(t.signal){n.signals[t.signal]=e}if(t.scale){n.scales[t.scale]=e}if(t.data){for(const i in t.data){const r=n.data[i]||(n.data[i]={});t.data[i].forEach((t=>r[t]=e))}}},resolve(){(this.unresolved||[]).forEach((t=>t()));delete this.unresolved;return this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[TW(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,i,r){this.dataflow.on(e,n,i,r,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:kW,parseOperator:RW,parseOperatorParameters:CW,parseParameters:OW,parseStream:YW,parseUpdate:JW,getState:VW,setState:KW};function eX(t,e,n){var i=new Bz,r=e;if(e==null)return i.restart(t,e,n),i;i._restart=i.restart;i.restart=function(t,e,n){e=+e,n=n==null?Xz():+n;i._restart((function o(s){s+=r;i._restart(o,r+=e,n);t(s)}),e,n)};i.restart(t,e,n);return i}function nX(t){const e=t.container();if(e){e.setAttribute("role","graphics-document");e.setAttribute("aria-roleDescription","visualization");iX(e,t.description())}}function iX(t,e){if(t)e==null?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e)}function rX(t){t.add(null,(e=>{t._background=e.bg;t._resize=1;return e.bg}),{bg:t._signals.background})}const oX="default";function sX(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:oX,item:null}));t.on(t.events("view","mousemove"),e,((t,n)=>{const i=e.value,r=i?(0,m.HD)(i)?i:i.user:oX,o=n.item&&n.item.cursor||null;return i&&r===i.user&&o==i.item?i:{user:r,item:o}}));t.add(null,(function(e){let n=e.cursor,i=this.value;if(!(0,m.HD)(n)){i=n.item;n=n.user}aX(t,n&&n!==oX?n:i||n);return i}),{cursor:e})}function aX(t,e){const n=t.globalCursor()?typeof document!=="undefined"&&document.body:t.container();if(n){return e==null?n.style.removeProperty("cursor"):n.style.cursor=e}}function lX(t,e){var n=t._runtime.data;if(!(0,m.nr)(n,e)){(0,m.vU)("Unrecognized data set: "+e)}return n[e]}function uX(t,e){return arguments.length<2?lX(this,t).values.value:cX.call(this,t,Do().remove(m.yb).insert(e))}function cX(t,e){if(!$o(e)){(0,m.vU)("Second argument to changes must be a changeset.")}const n=lX(this,t);n.modified=true;return this.pulse(n.input,e)}function fX(t,e){return cX.call(this,t,Do().insert(e))}function hX(t,e){return cX.call(this,t,Do().remove(e))}function dX(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function pX(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function mX(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function gX(t){var e=mX(t),n=dX(t),i=pX(t);t._renderer.background(t.background());t._renderer.resize(n,i,e);t._handler.origin(e);t._resizeListeners.forEach((e=>{try{e(n,i)}catch(r){t.error(r)}}))}function yX(t,e,n){var i=t._renderer,r=i&&i.canvas(),o,s,a;if(r){a=mX(t);s=e.changedTouches?e.changedTouches[0]:e;o=Kb(s,r);o[0]-=a[0];o[1]-=a[1]}e.dataflow=t;e.item=n;e.vega=vX(t,n,o);return e}function vX(t,e,n){const i=e?e.mark.marktype==="group"?e:e.mark.group:null;function r(t){var n=i,r;if(t)for(r=e;r;r=r.mark.group){if(r.mark.name===t){n=r;break}}return n&&n.mark&&n.mark.interactive?n:{}}function o(t){if(!t)return n;if((0,m.HD)(t))t=r(t);const e=n.slice();while(t){e[0]-=t.x||0;e[1]-=t.y||0;t=t.mark&&t.mark.group}return e}return{view:(0,m.a9)(t),item:(0,m.a9)(e||{}),group:r,xy:o,x:t=>o(t)[0],y:t=>o(t)[1]}}const _X="view",xX="timer",bX="window",wX={trap:false};function kX(t){const e=(0,m.l7)({defaults:{}},t);const n=(t,e)=>{e.forEach((e=>{if((0,m.kJ)(t[e]))t[e]=(0,m.Rg)(t[e])}))};n(e.defaults,["prevent","allow"]);n(e,["view","window","selector"]);return e}function MX(t,e,n,i){t._eventListeners.push({type:n,sources:(0,m.IX)(e),handler:i})}function SX(t,e){var n=t._eventConfig.defaults,i=n.prevent,r=n.allow;return i===false||r===true?false:i===true||r===false?true:i?i[e]:r?!r[e]:t.preventDefault()}function EX(t,e,n){const i=t._eventConfig&&t._eventConfig[e];if(i===false||(0,m.Kn)(i)&&!i[n]){t.warn(`Blocked ${e} ${n} event listener.`);return false}return true}function TX(t,e,n){var i=this,r=new jo(n),o=function(n,o){i.runAsync(null,(()=>{if(t===_X&&SX(i,e)){n.preventDefault()}r.receive(yX(i,n,o))}))},s;if(t===xX){if(EX(i,"timer",e)){i.timer(o,e)}}else if(t===_X){if(EX(i,"view",e)){i.addEventListener(e,o,wX)}}else{if(t===bX){if(EX(i,"window",e)&&typeof window!=="undefined"){s=[window]}}else if(typeof document!=="undefined"){if(EX(i,"selector",e)){s=Array.from(document.querySelectorAll(t))}}if(!s){i.warn("Can not resolve event source: "+t)}else{for(var a=0,l=s.length;a<l;++a){s[a].addEventListener(e,o)}MX(i,s,e,o)}}return r}function $X(t){return t.item}function DX(t){return t.item.mark.source}function AX(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function NX(t,e){t=[t||"hover"];e=[e||"update",t[0]];this.on(this.events("view","mouseover",$X),DX,AX(t));this.on(this.events("view","mouseout",$X),DX,AX(e));return this}function zX(){var t=this._tooltip,e=this._timers,n=this._eventListeners,i,r,o;i=e.length;while(--i>=0){e[i].stop()}i=n.length;while(--i>=0){o=n[i];r=o.sources.length;while(--r>=0){o.sources[r].removeEventListener(o.type,o.handler)}}if(t){t.call(this,this._handler,null,null,null)}return this}function RX(t,e,n){const i=document.createElement(t);for(const r in e)i.setAttribute(r,e[r]);if(n!=null)i.textContent=n;return i}const CX="vega-bind",OX="vega-bind-name",UX="vega-bind-radio";function PX(t,e,n){if(!e)return;const i=n.param;let r=n.state;if(!r){r=n.state={elements:null,active:false,set:null,update:e=>{if(e!=t.signal(i.signal)){t.runAsync(null,(()=>{r.source=true;t.signal(i.signal,e)}))}}};if(i.debounce){r.update=(0,m.Ds)(i.debounce,r.update)}}const o=i.input==null&&i.element?IX:LX;o(r,e,i,t);if(!r.active){t.on(t._signals[i.signal],null,(()=>{r.source?r.source=false:r.set(t.signal(i.signal))}));r.active=true}return r}function IX(t,e,n,i){const r=n.event||"input";const o=()=>t.update(e.value);i.signal(n.signal,e.value);e.addEventListener(r,o);MX(i,e,r,o);t.set=t=>{e.value=t;e.dispatchEvent(qX(r))}}function qX(t){return typeof Event!=="undefined"?new Event(t):{type:t}}function LX(t,e,n,i){const r=i.signal(n.signal);const o=RX("div",{class:CX});const s=n.input==="radio"?o:o.appendChild(RX("label"));s.appendChild(RX("span",{class:OX},n.name||n.signal));e.appendChild(o);let a=FX;switch(n.input){case"checkbox":a=jX;break;case"select":a=WX;break;case"radio":a=XX;break;case"range":a=HX;break}a(t,s,n,r)}function FX(t,e,n,i){const r=RX("input");for(const o in n){if(o!=="signal"&&o!=="element"){r.setAttribute(o==="input"?"type":o,n[o])}}r.setAttribute("name",n.signal);r.value=i;e.appendChild(r);r.addEventListener("input",(()=>t.update(r.value)));t.elements=[r];t.set=t=>r.value=t}function jX(t,e,n,i){const r={type:"checkbox",name:n.signal};if(i)r.checked=true;const o=RX("input",r);e.appendChild(o);o.addEventListener("change",(()=>t.update(o.checked)));t.elements=[o];t.set=t=>o.checked=!!t||null}function WX(t,e,n,i){const r=RX("select",{name:n.signal}),o=n.labels||[];n.options.forEach(((t,e)=>{const n={value:t};if(BX(t,i))n.selected=true;r.appendChild(RX("option",n,(o[e]||t)+""))}));e.appendChild(r);r.addEventListener("change",(()=>{t.update(n.options[r.selectedIndex])}));t.elements=[r];t.set=t=>{for(let e=0,i=n.options.length;e<i;++e){if(BX(n.options[e],t)){r.selectedIndex=e;return}}}}function XX(t,e,n,i){const r=RX("span",{class:UX}),o=n.labels||[];e.appendChild(r);t.elements=n.options.map(((e,s)=>{const a={type:"radio",name:n.signal,value:e};if(BX(e,i))a.checked=true;const l=RX("input",a);l.addEventListener("change",(()=>t.update(e)));const u=RX("label",{},(o[s]||e)+"");u.prepend(l);r.appendChild(u);return l}));t.set=e=>{const n=t.elements,i=n.length;for(let t=0;t<i;++t){if(BX(n[t].value,e))n[t].checked=true}}}function HX(t,e,n,i){i=i!==undefined?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,o=n.min||Math.min(0,r,+i)||0,s=n.step||X(o,r,100);const a=RX("input",{type:"range",name:n.signal,min:o,max:r,step:s});a.value=i;const l=RX("span",{},+i);e.appendChild(a);e.appendChild(l);const u=()=>{l.textContent=a.value;t.update(+a.value)};a.addEventListener("input",u);a.addEventListener("change",u);t.elements=[a];t.set=t=>{a.value=t;l.textContent=t}}function BX(t,e){return t===e||t+""===e+""}function YX(t,e,n,i,r,o){e=e||new i(t.loader());return e.initialize(n,dX(t),pX(t),mX(t),r,o).background(t.background())}function JX(t,e){return!e?null:function(){try{e.apply(this,arguments)}catch(n){t.error(n)}}}function GX(t,e,n,i){const r=new i(t.loader(),JX(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,mX(t),t);if(e){e.handlers().forEach((t=>{r.on(t.type,t.handler)}))}return r}function VX(t,e){const n=this,i=n._renderType,r=n._eventConfig.bind,o=Fk(i);t=n._el=t?KX(n,t,true):null;nX(n);if(!o)n.error("Unrecognized renderer type: "+i);const s=o.handler||Mw,a=t?o.renderer:o.headless;n._renderer=!a?null:YX(n,n._renderer,t,a);n._handler=GX(n,n._handler,t,s);n._redraw=true;if(t&&r!=="none"){e=e?n._elBind=KX(n,e,true):t.appendChild(RX("form",{class:"vega-bindings"}));n._bind.forEach((t=>{if(t.param.element&&r!=="container"){t.element=KX(n,t.param.element,!!t.param.input)}}));n._bind.forEach((t=>{PX(n,t.element||e,t)}))}return n}function KX(t,e,n){if(typeof e==="string"){if(typeof document!=="undefined"){e=document.querySelector(e);if(!e){t.error("Signal bind element not found: "+e);return null}}else{t.error("DOM document instance not found.");return null}}if(e&&n){try{e.textContent=""}catch(i){e=null;t.error(i)}}return e}const ZX=t=>+t||0;const QX=t=>({top:t,bottom:t,left:t,right:t});function tH(t){return(0,m.Kn)(t)?{top:ZX(t.top),bottom:ZX(t.bottom),left:ZX(t.left),right:ZX(t.right)}:QX(ZX(t))}async function eH(t,e,n,i){const r=Fk(e),o=r&&r.headless;if(!o)(0,m.vU)("Unrecognized renderer type: "+e);await t.runAsync();return YX(t,null,null,o,n,i).renderAsync(t._scenegraph.root)}async function nH(t,e){if(t!==qk.Canvas&&t!==qk.SVG&&t!==qk.PNG){(0,m.vU)("Unrecognized image type: "+t)}const n=await eH(this,t,e);return t===qk.SVG?iH(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function iH(t,e){const n=new Blob([t],{type:e});return window.URL.createObjectURL(n)}async function rH(t,e){const n=await eH(this,qk.Canvas,t,e);return n.canvas()}async function oH(t){const e=await eH(this,qk.SVG,t);return e.svg()}function sH(t,e,n){return ZW(t,Ps,dW,n).parse(e)}function aH(t){var e=this._runtime.scales;if(!(0,m.nr)(e,t)){(0,m.vU)("Unrecognized scale or projection: "+t)}return e[t].value}var lH="width",uH="height",cH="padding",fH={skip:true};function hH(t,e){var n=t.autosize(),i=t.padding();return e-(n&&n.contains===cH?i.left+i.right:0)}function dH(t,e){var n=t.autosize(),i=t.padding();return e-(n&&n.contains===cH?i.top+i.bottom:0)}function pH(t){var e=t._signals,n=e[lH],i=e[uH],r=e[cH];function o(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,(e=>{t._width=e.size;t._viewWidth=hH(t,e.size);o()}),{size:n});t._resizeHeight=t.add(null,(e=>{t._height=e.size;t._viewHeight=dH(t,e.size);o()}),{size:i});const s=t.add(null,o,{pad:r});t._resizeWidth.rank=n.rank+1;t._resizeHeight.rank=i.rank+1;s.rank=r.rank+1}function mH(t,e,n,i,r,o){this.runAfter((s=>{let a=0;s._autosize=0;if(s.width()!==n){a=1;s.signal(lH,n,fH);s._resizeWidth.skip(true)}if(s.height()!==i){a=1;s.signal(uH,i,fH);s._resizeHeight.skip(true)}if(s._viewWidth!==t){s._resize=1;s._viewWidth=t}if(s._viewHeight!==e){s._resize=1;s._viewHeight=e}if(s._origin[0]!==r[0]||s._origin[1]!==r[1]){s._resize=1;s._origin=r}if(a)s.run("enter");if(o)s.runAfter((t=>t.resize()))}),false,1)}function gH(t){return this._runtime.getState(t||{data:yH,signals:vH,recurse:true})}function yH(t,e){return e.modified&&(0,m.kJ)(e.input.value)&&t.indexOf("_:vega:_")}function vH(t,e){return!(t==="parent"||e instanceof Ps.proxy)}function _H(t){this.runAsync(null,(e=>{e._trigger=false;e._runtime.setState(t)}),(t=>{t._trigger=true}));return this}function xH(t,e){function n(e){t({timestamp:Date.now(),elapsed:e})}this._timers.push(eX(n,e))}function bH(t,e,n,i){const r=t.element();if(r)r.setAttribute("title",wH(i))}function wH(t){return t==null?"":(0,m.kJ)(t)?MH(t):(0,m.Kn)(t)&&!(0,m.J_)(t)?kH(t):t+""}function kH(t){return Object.keys(t).map((e=>{const n=t[e];return e+": "+((0,m.kJ)(n)?MH(n):SH(n))})).join("\n")}function MH(t){return"["+t.map(SH).join(", ")+"]"}function SH(t){return(0,m.kJ)(t)?"[…]":(0,m.Kn)(t)&&!(0,m.J_)(t)?"{…}":t}function EH(t,e){const n=this;e=e||{};Cs.call(n);if(e.loader)n.loader(e.loader);if(e.logger)n.logger(e.logger);if(e.logLevel!=null)n.logLevel(e.logLevel);if(e.locale||t.locale){const i=(0,m.l7)({},t.locale,e.locale);n.locale(zr(i.number,i.time))}n._el=null;n._elBind=null;n._renderType=e.renderer||qk.Canvas;n._scenegraph=new Xb;const i=n._scenegraph.root;n._renderer=null;n._tooltip=e.tooltip||bH,n._redraw=true;n._handler=(new Mw).scene(i);n._globalCursor=false;n._preventDefault=false;n._timers=[];n._eventListeners=[];n._resizeListeners=[];n._eventConfig=kX(t.eventConfig);n.globalCursor(n._eventConfig.globalCursor);const r=sH(n,t,e.expr);n._runtime=r;n._signals=r.signals;n._bind=(t.bindings||[]).map((t=>({state:null,param:(0,m.l7)({},t)})));if(r.root)r.root.set(i);i.source=r.data.root.input;n.pulse(r.data.root.input,n.changeset().insert(i.items));n._width=n.width();n._height=n.height();n._viewWidth=hH(n,n._width);n._viewHeight=dH(n,n._height);n._origin=[0,0];n._resize=0;n._autosize=1;pH(n);rX(n);sX(n);n.description(t.description);if(e.hover)n.hover();if(e.container)n.initialize(e.container,e.bind)}function TH(t,e){return(0,m.nr)(t._signals,e)?t._signals[e]:(0,m.vU)("Unrecognized signal name: "+(0,m.m8)(e))}function $H(t,e){const n=(t._targets||[]).filter((t=>t._update&&t._update.handler===e));return n.length?n[0]:null}function DH(t,e,n,i){let r=$H(n,i);if(!r){r=JX(t,(()=>i(e,n.value)));r.handler=i;t.on(n,null,r)}return t}function AH(t,e,n){const i=$H(e,n);if(i)e._targets.remove(i);return t}(0,m.XW)(EH,Cs,{async evaluate(t,e,n){await Cs.prototype.evaluate.call(this,t,e);if(this._redraw||this._resize){try{if(this._renderer){if(this._resize){this._resize=0;gX(this)}await this._renderer.renderAsync(this._scenegraph.root)}this._redraw=false}catch(i){this.error(i)}}if(n)yo(this,n);return this},dirty(t){this._redraw=true;this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=t!=null?t+"":null;if(e!==this._desc)iX(this._el,this._desc=e);return this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const i=TH(this,t);return arguments.length===1?i.value:this.update(i,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",tH(t)):tH(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){if(!arguments.length)return this._renderType;if(!Fk(t))(0,m.vU)("Unrecognized renderer type: "+t);if(t!==this._renderType){this._renderType=t;this._resetRenderer()}return this},tooltip(t){if(!arguments.length)return this._tooltip;if(t!==this._tooltip){this._tooltip=t;this._resetRenderer()}return this},loader(t){if(!arguments.length)return this._loader;if(t!==this._loader){Cs.prototype.loader.call(this,t);this._resetRenderer()}return this},resize(){this._autosize=1;return this.touch(TH(this,"autosize"))},_resetRenderer(){if(this._renderer){this._renderer=null;this.initialize(this._el,this._elBind)}},_resizeView:mH,addEventListener(t,e,n){let i=e;if(!(n&&n.trap===false)){i=JX(this,e);i.raw=e}this._handler.on(t,i);return this},removeEventListener(t,e){var n=this._handler.handlers(t),i=n.length,r,o;while(--i>=0){o=n[i].type;r=n[i].handler;if(t===o&&(e===r||e===r.raw)){this._handler.off(o,r);break}}return this},addResizeListener(t){const e=this._resizeListeners;if(e.indexOf(t)<0){e.push(t)}return this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);if(n>=0){e.splice(n,1)}return this},addSignalListener(t,e){return DH(this,t,TH(this,t),e)},removeSignalListener(t,e){return AH(this,TH(this,t),e)},addDataListener(t,e){return DH(this,t,lX(this,t).values,e)},removeDataListener(t,e){return AH(this,lX(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=aX(this,null);this._globalCursor=!!t;if(e)aX(this,e)}return this}else{return this._globalCursor}},preventDefault(t){if(arguments.length){this._preventDefault=t;return this}else{return this._preventDefault}},timer:xH,events:TX,finalize:zX,hover:NX,data:uX,change:cX,insert:fX,remove:hX,scale:aH,initialize:VX,toImageURL:nH,toCanvas:rH,toSVG:oH,getState:gH,setState:_H});var NH=n(83082);function zH(t){return(0,m.Kn)(t)?t:{type:t||"pad"}}const RH=t=>+t||0;const CH=t=>({top:t,bottom:t,left:t,right:t});function OH(t){return!(0,m.Kn)(t)?CH(RH(t)):t.signal?t:{top:RH(t.top),bottom:RH(t.bottom),left:RH(t.left),right:RH(t.right)}}const UH=t=>(0,m.Kn)(t)&&!(0,m.kJ)(t)?(0,m.l7)({},t):{value:t};function PH(t,e,n,i){if(n!=null){const r=(0,m.Kn)(n)&&!(0,m.kJ)(n)||(0,m.kJ)(n)&&n.length&&(0,m.Kn)(n[0]);if(r){t.update[e]=n}else{t[i||"enter"][e]={value:n}}return 1}else{return 0}}function IH(t,e,n){for(const i in e){PH(t,i,e[i])}for(const i in n){PH(t,i,n[i],"update")}}function qH(t,e,n){for(const i in e){if(n&&(0,m.nr)(n,i))continue;t[i]=(0,m.l7)(t[i]||{},e[i])}return t}function LH(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const FH="mark";const jH="frame";const WH="scope";const XH="axis";const HH="axis-domain";const BH="axis-grid";const YH="axis-label";const JH="axis-tick";const GH="axis-title";const VH="legend";const KH="legend-band";const ZH="legend-entry";const QH="legend-gradient";const tB="legend-label";const eB="legend-symbol";const nB="legend-title";const iB="title";const rB="title-text";const oB="title-subtitle";function sB(t,e,n,i,r){const o={},s={};let a,l,u,c;l="lineBreak";if(e==="text"&&r[l]!=null&&!LH(l,t)){aB(o,l,r[l])}if(n=="legend"||String(n).startsWith("axis")){n=null}c=n===jH?r.group:n===FH?(0,m.l7)({},r.mark,r[e]):null;for(l in c){u=LH(l,t)||(l==="fill"||l==="stroke")&&(LH("fill",t)||LH("stroke",t));if(!u)aB(o,l,c[l])}(0,m.IX)(i).forEach((e=>{const n=r.style&&r.style[e];for(const i in n){if(!LH(i,t)){aB(o,i,n[i])}}}));t=(0,m.l7)({},t);for(l in o){c=o[l];if(c.signal){(a=a||{})[l]=c}else{s[l]=c}}t.enter=(0,m.l7)(s,t.enter);if(a)t.update=(0,m.l7)(a,t.update);return t}function aB(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const lB=t=>(0,m.HD)(t)?(0,m.m8)(t):t.signal?`(${t.signal})`:pB(t);function uB(t){if(t.gradient!=null){return hB(t)}let e=t.signal?`(${t.signal})`:t.color?fB(t.color):t.field!=null?pB(t.field):t.value!==undefined?(0,m.m8)(t.value):undefined;if(t.scale!=null){e=gB(t,e)}if(e===undefined){e=null}if(t.exponent!=null){e=`pow(${e},${dB(t.exponent)})`}if(t.mult!=null){e+=`*${dB(t.mult)}`}if(t.offset!=null){e+=`+${dB(t.offset)}`}if(t.round){e=`round(${e})`}return e}const cB=(t,e,n,i)=>`(${t}(${[e,n,i].map(uB).join(",")})+'')`;function fB(t){return t.c?cB("hcl",t.h,t.c,t.l):t.h||t.s?cB("hsl",t.h,t.s,t.l):t.l||t.a?cB("lab",t.l,t.a,t.b):t.r||t.g||t.b?cB("rgb",t.r,t.g,t.b):null}function hB(t){const e=[t.start,t.stop,t.count].map((t=>t==null?null:(0,m.m8)(t)));while(e.length&&(0,m.fj)(e)==null)e.pop();e.unshift(lB(t.gradient));return`gradient(${e.join(",")})`}function dB(t){return(0,m.Kn)(t)?"("+uB(t)+")":t}function pB(t){return mB((0,m.Kn)(t)?t:{datum:t})}function mB(t){let e,n,i;if(t.signal){e="datum";i=t.signal}else if(t.group||t.parent){n=Math.max(1,t.level||1);e="item";while(n-- >0){e+=".mark.group"}if(t.parent){i=t.parent;e+=".datum"}else{i=t.group}}else if(t.datum){e="datum";i=t.datum}else{(0,m.vU)("Invalid field reference: "+(0,m.m8)(t))}if(!t.signal){i=(0,m.HD)(i)?(0,m._k)(i).map(m.m8).join("]["):mB(i)}return e+"["+i+"]"}function gB(t,e){const n=lB(t.scale);if(t.range!=null){e=`lerp(_range(${n}), ${+t.range})`}else{if(e!==undefined)e=`_scale(${n}, ${e})`;if(t.band){e=(e?e+"+":"")+`_bandwidth(${n})`+(+t.band===1?"":"*"+dB(t.band));if(t.extra){e=`(datum.extra ? _scale(${n}, datum.extra.value) : ${e})`}}if(e==null)e="0"}return e}function yB(t){let e="";t.forEach((t=>{const n=uB(t);e+=t.test?`(${t.test})?${n}:`:n}));if((0,m.fj)(e)===":"){e+="null"}return e}function vB(t,e,n,i,r,o){const s={};o=o||{};o.encoders={$encode:s};t=sB(t,e,n,i,r.config);for(const a in t){s[a]=_B(t[a],e,o,r)}return o}function _B(t,e,n,i){const r={},o={};for(const s in t){if(t[s]!=null){r[s]=bB(xB(t[s]),i,n,o)}}return{$expr:{marktype:e,channels:r},$fields:Object.keys(o),$output:Object.keys(t)}}function xB(t){return(0,m.kJ)(t)?yB(t):uB(t)}function bB(t,e,n,i){const r=wW(t,e);r.$fields.forEach((t=>i[t]=1));(0,m.l7)(n,r.$params);return r.$expr}const wB="outer",kB=["value","update","init","react","bind"];function MB(t,e){(0,m.vU)(t+' for "outer" push: '+(0,m.m8)(e))}function SB(t,e){const n=t.name;if(t.push===wB){if(!e.signals[n])MB("No prior signal definition",n);kB.forEach((e=>{if(t[e]!==undefined)MB("Invalid property ",e)}))}else{const i=e.addSignal(n,t.value);if(t.react===false)i.react=false;if(t.bind)e.addBinding(n,t.bind)}}function EB(t,e,n,i){this.id=-1;this.type=t;this.value=e;this.params=n;if(i)this.parent=i}function TB(t,e,n,i){return new EB(t,e,n,i)}function $B(t,e){return TB("operator",t,e)}function DB(t){const e={$ref:t.id};if(t.id<0)(t.refs=t.refs||[]).push(e);return e}function AB(t,e){return e?{$field:t,$name:e}:{$field:t}}const NB=AB("key");function zB(t,e){return{$compare:t,$order:e}}function RB(t,e){const n={$key:t};if(e)n.$flat=true;return n}const CB="ascending";const OB="descending";function UB(t){return!(0,m.Kn)(t)?"":(t.order===OB?"-":"+")+PB(t.op,t.field)}function PB(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const IB="scope";const qB="view";function LB(t){return t&&t.signal}function FB(t){return t&&t.expr}function jB(t){if(LB(t))return true;if((0,m.Kn)(t))for(const e in t){if(jB(t[e]))return true}return false}function WB(t,e){return t!=null?t:e}function XB(t){return t&&t.signal||t}const HB="timer";function BB(t,e){const n=t.merge?JB:t.stream?GB:t.type?VB:(0,m.vU)("Invalid stream specification: "+(0,m.m8)(t));return n(t,e)}function YB(t){return t===IB?qB:t||qB}function JB(t,e){const n=t.merge.map((t=>BB(t,e))),i=KB({merge:n},t,e);return e.addStream(i).id}function GB(t,e){const n=BB(t.stream,e),i=KB({stream:n},t,e);return e.addStream(i).id}function VB(t,e){let n;if(t.type===HB){n=e.event(HB,t.throttle);t={between:t.between,filter:t.filter}}else{n=e.event(YB(t.source),t.type)}const i=KB({stream:n},t,e);return Object.keys(i).length===1?n:e.addStream(i).id}function KB(t,e,n){let i=e.between;if(i){if(i.length!==2){(0,m.vU)('Stream "between" parameter must have 2 entries: '+(0,m.m8)(e))}t.between=[BB(i[0],n),BB(i[1],n)]}i=e.filter?[].concat(e.filter):[];if(e.marktype||e.markname||e.markrole){i.push(ZB(e.marktype,e.markname,e.markrole))}if(e.source===IB){i.push("inScope(event.item)")}if(i.length){t.filter=wW("("+i.join(")&&(")+")",n).$expr}if((i=e.throttle)!=null){t.throttle=+i}if((i=e.debounce)!=null){t.debounce=+i}if(e.consume){t.consume=true}return t}function ZB(t,e,n){const i="event.item";return i+(t&&t!=="*"?"&&"+i+".mark.marktype==='"+t+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(e?"&&"+i+".mark.name==='"+e+"'":"")}const QB={code:"_.$value",ast:{type:"Identifier",value:"value"}};function tY(t,e,n){const i=t.encode,r={target:n};let o=t.events,s=t.update,a=[];if(!o){(0,m.vU)("Signal update missing events specification.")}if((0,m.HD)(o)){o=(0,NH.r)(o,e.isSubscope()?IB:qB)}o=(0,m.IX)(o).filter((t=>t.signal||t.scale?(a.push(t),0):1));if(a.length>1){a=[nY(a)]}if(o.length){a.push(o.length>1?{merge:o}:o[0])}if(i!=null){if(s)(0,m.vU)("Signal encode and update are mutually exclusive.");s="encode(item(),"+(0,m.m8)(i)+")"}r.update=(0,m.HD)(s)?wW(s,e):s.expr!=null?wW(s.expr,e):s.value!=null?s.value:s.signal!=null?{$expr:QB,$params:{$value:e.signalRef(s.signal)}}:(0,m.vU)("Invalid signal update specification.");if(t.force){r.options={force:true}}a.forEach((t=>e.addUpdate((0,m.l7)(eY(t,e),r))))}function eY(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):BB(t,e)}}function nY(t){return{signal:"["+t.map((t=>t.scale?'scale("'+t.scale+'")':t.signal))+"]"}}function iY(t,e){const n=e.getSignal(t.name);let i=t.update;if(t.init){if(i){(0,m.vU)("Signals can not include both init and update expressions.")}else{i=t.init;n.initonly=true}}if(i){i=wW(i,e);n.update=i.$expr;n.params=i.$params}if(t.on){t.on.forEach((t=>tY(t,e,n.id)))}}const rY=t=>(e,n,i)=>TB(t,n,e||undefined,i);const oY=rY("aggregate");const sY=rY("axisticks");const aY=rY("bound");const lY=rY("collect");const uY=rY("compare");const cY=rY("datajoin");const fY=rY("encode");const hY=rY("expression");const dY=rY("facet");const pY=rY("field");const mY=rY("key");const gY=rY("legendentries");const yY=rY("load");const vY=rY("mark");const _Y=rY("multiextent");const xY=rY("multivalues");const bY=rY("overlap");const wY=rY("params");const kY=rY("prefacet");const MY=rY("projection");const SY=rY("proxy");const EY=rY("relay");const TY=rY("render");const $Y=rY("scale");const DY=rY("sieve");const AY=rY("sortitems");const NY=rY("viewlayout");const zY=rY("values");let RY=0;const CY={min:"min",max:"max",count:"sum"};function OY(t,e){const n=t.type||"linear";if(!Rg(n)){(0,m.vU)("Unrecognized scale type: "+(0,m.m8)(n))}e.addScale(t.name,{type:n,domain:undefined})}function UY(t,e){const n=e.getScale(t.name).params;let i;n.domain=LY(t.domain,t,e);if(t.range!=null){n.range=ZY(t,e,n)}if(t.interpolate!=null){KY(t.interpolate,n)}if(t.nice!=null){n.nice=VY(t.nice)}if(t.bins!=null){n.bins=GY(t.bins,e)}for(i in t){if((0,m.nr)(n,i)||i==="name")continue;n[i]=PY(t[i],e)}}function PY(t,e){return!(0,m.Kn)(t)?t:t.signal?e.signalRef(t.signal):(0,m.vU)("Unsupported object: "+(0,m.m8)(t))}function IY(t,e){return t.signal?e.signalRef(t.signal):t.map((t=>PY(t,e)))}function qY(t){(0,m.vU)("Can not find data set: "+(0,m.m8)(t))}function LY(t,e,n){if(!t){if(e.domainMin!=null||e.domainMax!=null){(0,m.vU)("No scale domain defined for domainMin/domainMax to override.")}return}return t.signal?n.signalRef(t.signal):((0,m.kJ)(t)?FY:t.fields?WY:jY)(t,e,n)}function FY(t,e,n){return t.map((t=>PY(t,n)))}function jY(t,e,n){const i=n.getData(t.data);if(!i)qY(t.data);return Ug(e.type)?i.valuesRef(n,t.field,BY(t.sort,false)):Fg(e.type)?i.domainRef(n,t.field):i.extentRef(n,t.field)}function WY(t,e,n){const i=t.data,r=t.fields.reduce(((t,e)=>{e=(0,m.HD)(e)?{data:i,field:e}:(0,m.kJ)(e)||e.signal?XY(e,n):e;t.push(e);return t}),[]);return(Ug(e.type)?HY:Fg(e.type)?YY:JY)(t,n,r)}function XY(t,e){const n="_:vega:_"+RY++,i=lY({});if((0,m.kJ)(t)){i.value={$ingest:t}}else if(t.signal){const r="setdata("+(0,m.m8)(n)+","+t.signal+")";i.params.input=e.signalRef(r)}e.addDataPipeline(n,[i,DY({})]);return{data:n,field:"data"}}function HY(t,e,n){const i=BY(t.sort,true);let r,o;const s=n.map((t=>{const n=e.getData(t.data);if(!n)qY(t.data);return n.countsRef(e,t.field,i)}));const a={groupby:NB,pulse:s};if(i){r=i.op||"count";o=i.field?PB(r,i.field):"count";a.ops=[CY[r]];a.fields=[e.fieldRef(o)];a.as=[o]}r=e.add(oY(a));const l=e.add(lY({pulse:DB(r)}));o=e.add(zY({field:NB,sort:e.sortRef(i),pulse:DB(l)}));return DB(o)}function BY(t,e){if(t){if(!t.field&&!t.op){if((0,m.Kn)(t))t.field="key";else t={field:"key"}}else if(!t.field&&t.op!=="count"){(0,m.vU)("No field provided for sort aggregate op: "+t.op)}else if(e&&t.field){if(t.op&&!CY[t.op]){(0,m.vU)("Multiple domain scales can not be sorted using "+t.op)}}}return t}function YY(t,e,n){const i=n.map((t=>{const n=e.getData(t.data);if(!n)qY(t.data);return n.domainRef(e,t.field)}));return DB(e.add(xY({values:i})))}function JY(t,e,n){const i=n.map((t=>{const n=e.getData(t.data);if(!n)qY(t.data);return n.extentRef(e,t.field)}));return DB(e.add(_Y({extents:i})))}function GY(t,e){return t.signal||(0,m.kJ)(t)?IY(t,e):e.objectProperty(t)}function VY(t){return(0,m.Kn)(t)?{interval:PY(t.interval),step:PY(t.step)}:PY(t)}function KY(t,e){e.interpolate=PY(t.type||t);if(t.gamma!=null){e.interpolateGamma=PY(t.gamma)}}function ZY(t,e,n){const i=e.config.range;let r=t.range;if(r.signal){return e.signalRef(r.signal)}else if((0,m.HD)(r)){if(i&&(0,m.nr)(i,r)){t=(0,m.l7)({},t,{range:i[r]});return ZY(t,e,n)}else if(r==="width"){r=[0,{signal:"width"}]}else if(r==="height"){r=Ug(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]}else{(0,m.vU)("Unrecognized scale range value: "+(0,m.m8)(r))}}else if(r.scheme){n.scheme=(0,m.kJ)(r.scheme)?IY(r.scheme,e):PY(r.scheme,e);if(r.extent)n.schemeExtent=IY(r.extent,e);if(r.count)n.schemeCount=PY(r.count,e);return}else if(r.step){n.rangeStep=PY(r.step,e);return}else if(Ug(t.type)&&!(0,m.kJ)(r)){return LY(r,t,e)}else if(!(0,m.kJ)(r)){(0,m.vU)("Unsupported range type: "+(0,m.m8)(r))}return r.map((t=>((0,m.kJ)(t)?IY:PY)(t,e)))}function QY(t,e){const n=e.config.projection||{},i={};for(const r in t){if(r==="name")continue;i[r]=tJ(t[r],r,e)}for(const r in n){if(i[r]==null){i[r]=tJ(n[r],r,e)}}e.addProjection(t.name,i)}function tJ(t,e,n){return(0,m.kJ)(t)?t.map((t=>tJ(t,e,n))):!(0,m.Kn)(t)?t:t.signal?n.signalRef(t.signal):e==="fit"?t:(0,m.vU)("Unsupported parameter object: "+(0,m.m8)(t))}const eJ="top";const nJ="left";const iJ="right";const rJ="bottom";const oJ="center";const sJ="vertical";const aJ="start";const lJ="middle";const uJ="end";const cJ="index";const fJ="label";const hJ="offset";const dJ="perc";const pJ="perc2";const mJ="value";const gJ="guide-label";const yJ="guide-title";const vJ="group-title";const _J="group-subtitle";const xJ="symbol";const bJ="gradient";const wJ="discrete";const kJ="size";const MJ="shape";const SJ="fill";const EJ="stroke";const TJ="strokeWidth";const $J="strokeDash";const DJ="opacity";const AJ=[kJ,MJ,SJ,EJ,TJ,$J,DJ];const NJ={name:1,style:1,interactive:1};const zJ={value:0};const RJ={value:1};const CJ="group";const OJ="rect";const UJ="rule";const PJ="symbol";const IJ="text";function qJ(t){t.type=CJ;t.interactive=t.interactive||false;return t}function LJ(t,e){const n=(n,i)=>WB(t[n],WB(e[n],i));n.isVertical=n=>sJ===WB(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection));n.gradientLength=()=>WB(t.gradientLength,e.gradientLength||e.gradientWidth);n.gradientThickness=()=>WB(t.gradientThickness,e.gradientThickness||e.gradientHeight);n.entryColumns=()=>WB(t.columns,WB(e.columns,+n.isVertical(true)));return n}function FJ(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function jJ(t,e,n){const i=e.config.style[n];return i&&i[t]}function WJ(t,e,n){return`item.anchor === '${aJ}' ? ${t} : item.anchor === '${uJ}' ? ${e} : ${n}`}const XJ=WJ((0,m.m8)(nJ),(0,m.m8)(iJ),(0,m.m8)(oJ));function HJ(t){const e=t("tickBand");let n=t("tickOffset"),i,r;if(!e){i=t("bandPosition");r=t("tickExtra")}else if(e.signal){i={signal:`(${e.signal}) === 'extent' ? 1 : 0.5`};r={signal:`(${e.signal}) === 'extent'`};if(!(0,m.Kn)(n)){n={signal:`(${e.signal}) === 'extent' ? 0 : ${n}`}}}else if(e==="extent"){i=1;r=true;n=0}else{i=.5;r=false}return{extra:r,band:i,offset:n}}function BJ(t,e){return!e?t:!t?e:!(0,m.Kn)(t)?{value:t,offset:e}:Object.assign({},t,{offset:BJ(t.offset,e)})}function YJ(t,e){if(e){t.name=e.name;t.style=e.style||t.style;t.interactive=!!e.interactive;t.encode=qH(t.encode,e,NJ)}else{t.interactive=false}return t}function JJ(t,e,n,i){const r=LJ(t,n),o=r.isVertical(),s=r.gradientThickness(),a=r.gradientLength();let l,u,c,f,h;if(o){u=[0,1];c=[0,0];f=s;h=a}else{u=[0,0];c=[1,0];f=a;h=s}const d={enter:l={opacity:zJ,x:zJ,y:zJ,width:UH(f),height:UH(h)},update:(0,m.l7)({},l,{opacity:RJ,fill:{gradient:e,start:u,stop:c}}),exit:{opacity:zJ}};IH(d,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")});return YJ({type:OJ,role:QH,encode:d},i)}function GJ(t,e,n,i,r){const o=LJ(t,n),s=o.isVertical(),a=o.gradientThickness(),l=o.gradientLength();let u,c,f,h,d="";s?(u="y",f="y2",c="x",h="width",d="1-"):(u="x",f="x2",c="y",h="height");const p={opacity:zJ,fill:{scale:e,field:mJ}};p[u]={signal:d+"datum."+dJ,mult:l};p[c]=zJ;p[f]={signal:d+"datum."+pJ,mult:l};p[h]=UH(a);const g={enter:p,update:(0,m.l7)({},p,{opacity:RJ}),exit:{opacity:zJ}};IH(g,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")});return YJ({type:OJ,role:KH,key:mJ,from:r,encode:g},i)}const VJ=`datum.${dJ}<=0?"${nJ}":datum.${dJ}>=1?"${iJ}":"${oJ}"`,KJ=`datum.${dJ}<=0?"${rJ}":datum.${dJ}>=1?"${eJ}":"${lJ}"`;function ZJ(t,e,n,i){const r=LJ(t,e),o=r.isVertical(),s=UH(r.gradientThickness()),a=r.gradientLength();let l=r("labelOverlap"),u,c,f,h,d="";const p={enter:u={opacity:zJ},update:c={opacity:RJ,text:{field:fJ}},exit:{opacity:zJ}};IH(p,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:WB(t.labelLimit,e.gradientLabelLimit)});if(o){u.align={value:"left"};u.baseline=c.baseline={signal:KJ};f="y";h="x";d="1-"}else{u.align=c.align={signal:VJ};u.baseline={value:"top"};f="x";h="y"}u[f]=c[f]={signal:d+"datum."+dJ,mult:a};u[h]=c[h]=s;s.offset=WB(t.labelOffset,e.gradientLabelOffset)||0;l=l?{separation:r("labelSeparation"),method:l,order:"datum."+cJ}:undefined;return YJ({type:IJ,role:tB,style:gJ,key:mJ,from:i,encode:p,overlap:l},n)}function QJ(t,e,n,i,r){const o=LJ(t,e),s=n.entries,a=!!(s&&s.interactive),l=s?s.name:undefined,u=o("clipHeight"),c=o("symbolOffset"),f={data:"value"},h=`(${r}) ? datum.${hJ} : datum.${kJ}`,d=u?UH(u):{field:kJ},p=`datum.${cJ}`,m=`max(1, ${r})`;let g,y,v,_,x;d.mult=.5;g={enter:y={opacity:zJ,x:{signal:h,mult:.5,offset:c},y:d},update:v={opacity:RJ,x:y.x,y:y.y},exit:{opacity:zJ}};let b=null,w=null;if(!t.fill){b=e.symbolBaseFillColor;w=e.symbolBaseStrokeColor}IH(g,{fill:o("symbolFillColor",b),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",w),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")});AJ.forEach((e=>{if(t[e]){v[e]=y[e]={scale:t[e],field:mJ}}}));const k=YJ({type:PJ,role:eB,key:mJ,from:f,clip:u?true:undefined,encode:g},n.symbols);const M=UH(c);M.offset=o("labelOffset");g={enter:y={opacity:zJ,x:{signal:h,offset:M},y:d},update:v={opacity:RJ,text:{field:fJ},x:y.x,y:y.y},exit:{opacity:zJ}};IH(g,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const S=YJ({type:IJ,role:tB,style:gJ,key:mJ,from:f,encode:g},n.labels);g={enter:{noBound:{value:!u},width:zJ,height:u?UH(u):zJ,opacity:zJ},exit:{opacity:zJ},update:v={opacity:RJ,row:{signal:null},column:{signal:null}}};if(o.isVertical(true)){_=`ceil(item.mark.items.length / ${m})`;v.row.signal=`${p}%${_}`;v.column.signal=`floor(${p} / ${_})`;x={field:["row",p]}}else{v.row.signal=`floor(${p} / ${m})`;v.column.signal=`${p} % ${m}`;x={field:p}}v.column.signal=`(${r})?${v.column.signal}:${p}`;i={facet:{data:i,name:"value",groupby:cJ}};return qJ({role:WH,from:i,encode:qH(g,s,NJ),marks:[k,S],name:l,interactive:a,sort:x})}function tG(t,e){const n=LJ(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:true,column:false},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const eG='item.orient === "left"',nG='item.orient === "right"',iG=`(${eG} || ${nG})`,rG=`datum.vgrad && ${iG}`,oG=WJ('"top"','"bottom"','"middle"'),sG=WJ('"right"','"left"','"center"'),aG=`datum.vgrad && ${nG} ? (${sG}) : (${iG} && !(datum.vgrad && ${eG})) ? "left" : ${XJ}`,lG=`item._anchor || (${iG} ? "middle" : "start")`,uG=`${rG} ? (${eG} ? -90 : 90) : 0`,cG=`${iG} ? (datum.vgrad ? (${nG} ? "bottom" : "top") : ${oG}) : "top"`;function fG(t,e,n,i){const r=LJ(t,e);const o={enter:{opacity:zJ},update:{opacity:RJ,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:zJ}};IH(o,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:lG},angle:{signal:uG},align:{signal:aG},baseline:{signal:cG},text:t.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")});return YJ({type:IJ,role:nB,style:yJ,from:i,encode:o},n)}function hG(t,e){let n;if((0,m.Kn)(t)){if(t.signal){n=t.signal}else if(t.path){n="pathShape("+dG(t.path)+")"}else if(t.sphere){n="geoShape("+dG(t.sphere)+', {type: "Sphere"})'}}return n?e.signalRef(n):!!t}function dG(t){return(0,m.Kn)(t)&&t.signal?t.signal:(0,m.m8)(t)}function pG(t){const e=t.role||"";return!e.indexOf("axis")||!e.indexOf("legend")||!e.indexOf("title")?e:t.type===CJ?WH:e||FH}function mG(t){return{marktype:t.type,name:t.name||undefined,role:t.role||pG(t),zindex:+t.zindex||undefined,aria:t.aria,description:t.description}}function gG(t,e){return t&&t.signal?e.signalRef(t.signal):t===false?false:true}function yG(t,e){const n=Is(t.type);if(!n)(0,m.vU)("Unrecognized transform type: "+(0,m.m8)(t.type));const i=TB(n.type.toLowerCase(),null,vG(n,t,e));if(t.signal)e.addSignal(t.signal,e.proxy(i));i.metadata=n.metadata||{};return i}function vG(t,e,n){const i={},r=t.params.length;for(let o=0;o<r;++o){const r=t.params[o];i[r.name]=_G(r,e,n)}return i}function _G(t,e,n){const i=t.type,r=e[t.name];if(i==="index"){return bG(t,e,n)}else if(r===undefined){if(t.required){(0,m.vU)("Missing required "+(0,m.m8)(e.type)+" parameter: "+(0,m.m8)(t.name))}return}else if(i==="param"){return wG(t,e,n)}else if(i==="projection"){return n.projectionRef(e[t.name])}return t.array&&!LB(r)?r.map((e=>xG(t,e,n))):xG(t,r,n)}function xG(t,e,n){const i=t.type;if(LB(e)){return TG(i)?(0,m.vU)("Expression references can not be signals."):$G(i)?n.fieldRef(e):DG(i)?n.compareRef(e):n.signalRef(e.signal)}else{const r=t.expr||$G(i);return r&&MG(e)?n.exprRef(e.expr,e.as):r&&SG(e)?AB(e.field,e.as):TG(i)?wW(e,n):EG(i)?DB(n.getData(e).values):$G(i)?AB(e):DG(i)?n.compareRef(e):e}}function bG(t,e,n){if(!(0,m.HD)(e.from)){(0,m.vU)('Lookup "from" parameter must be a string literal.')}return n.getData(e.from).lookupRef(n,e.key)}function wG(t,e,n){const i=e[t.name];if(t.array){if(!(0,m.kJ)(i)){(0,m.vU)("Expected an array of sub-parameters. Instead: "+(0,m.m8)(i))}return i.map((e=>kG(t,e,n)))}else{return kG(t,i,n)}}function kG(t,e,n){const i=t.params.length;let r;for(let s=0;s<i;++s){r=t.params[s];for(const t in r.key){if(r.key[t]!==e[t]){r=null;break}}if(r)break}if(!r)(0,m.vU)("Unsupported parameter: "+(0,m.m8)(e));const o=(0,m.l7)(vG(r,e,n),r.key);return DB(n.add(wY(o)))}const MG=t=>t&&t.expr;const SG=t=>t&&t.field;const EG=t=>t==="data";const TG=t=>t==="expr";const $G=t=>t==="field";const DG=t=>t==="compare";function AG(t,e,n){let i,r,o,s,a;if(!t){s=DB(n.add(lY(null,[{}])))}else if(i=t.facet){if(!e)(0,m.vU)("Only group marks can be faceted.");if(i.field!=null){s=a=NG(i,n)}else{if(!t.data){o=yG((0,m.l7)({type:"aggregate",groupby:(0,m.IX)(i.groupby)},i.aggregate),n);o.params.key=n.keyRef(i.groupby);o.params.pulse=NG(i,n);s=a=DB(n.add(o))}else{a=DB(n.getData(t.data).aggregate)}r=n.keyRef(i.groupby,true)}}if(!s){s=NG(t,n)}return{key:r,pulse:s,parent:a}}function NG(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:DB(e.getData(t.data).output)}function zG(t,e,n,i,r){this.scope=t;this.input=e;this.output=n;this.values=i;this.aggregate=r;this.index={}}zG.fromEntries=function(t,e){const n=e.length,i=e[n-1],r=e[n-2];let o=e[0],s=null,a=1;if(o&&o.type==="load"){o=e[1]}t.add(e[0]);for(;a<n;++a){e[a].params.pulse=DB(e[a-1]);t.add(e[a]);if(e[a].type==="aggregate")s=e[a]}return new zG(t,o,r,i,s)};function RG(t){return(0,m.HD)(t)?t:null}function CG(t,e,n){const i=PB(n.op,n.field);let r;if(e.ops){for(let t=0,n=e.as.length;t<n;++t){if(e.as[t]===i)return}}else{e.ops=["count"];e.fields=[null];e.as=["count"]}if(n.op){e.ops.push((r=n.op.signal)?t.signalRef(r):n.op);e.fields.push(t.fieldRef(n.field));e.as.push(i)}}function OG(t,e,n,i,r,o,s){const a=e[n]||(e[n]={}),l=UB(o);let u=RG(r),c,f;if(u!=null){t=e.scope;u=u+(l?"|"+l:"");c=a[u]}if(!c){const n=o?{field:NB,pulse:e.countsRef(t,r,o)}:{field:t.fieldRef(r),pulse:DB(e.output)};if(l)n.sort=t.sortRef(o);f=t.add(TB(i,undefined,n));if(s)e.index[r]=f;c=DB(f);if(u!=null)a[u]=c}return c}zG.prototype={countsRef(t,e,n){const i=this,r=i.counts||(i.counts={}),o=RG(e);let s,a,l;if(o!=null){t=i.scope;s=r[o]}if(!s){l={groupby:t.fieldRef(e,"key"),pulse:DB(i.output)};if(n&&n.field)CG(t,l,n);a=t.add(oY(l));s=t.add(lY({pulse:DB(a)}));s={agg:a,ref:DB(s)};if(o!=null)r[o]=s}else if(n&&n.field){CG(t,s.agg.params,n)}return s.ref},tuplesRef(){return DB(this.values)},extentRef(t,e){return OG(t,this,"extent","extent",e,false)},domainRef(t,e){return OG(t,this,"domain","values",e,false)},valuesRef(t,e,n){return OG(t,this,"vals","values",e,n||true)},lookupRef(t,e){return OG(t,this,"lookup","tupleindex",e,false)},indataRef(t,e){return OG(t,this,"indata","tupleindex",e,true,true)}};function UG(t,e,n){const i=t.from.facet,r=i.name,o=NG(i,e);let s;if(!i.name){(0,m.vU)("Facet must have a name: "+(0,m.m8)(i))}if(!i.data){(0,m.vU)("Facet must reference a data set: "+(0,m.m8)(i))}if(i.field){s=e.add(kY({field:e.fieldRef(i.field),pulse:o}))}else if(i.groupby){s=e.add(dY({key:e.keyRef(i.groupby),group:DB(e.proxy(n.parent)),pulse:o}))}else{(0,m.vU)("Facet must specify groupby or field: "+(0,m.m8)(i))}const a=e.fork(),l=a.add(lY()),u=a.add(DY({pulse:DB(l)}));a.addData(r,new zG(a,l,l,u));a.addSignal("parent",null);s.params.subflow={$subflow:a.parse(t).toRuntime()}}function PG(t,e,n){const i=e.add(kY({pulse:n.pulse})),r=e.fork();r.add(DY());r.addSignal("parent",null);i.params.subflow={$subflow:r.parse(t).toRuntime()}}function IG(t,e,n){const i=t.remove,r=t.insert,o=t.toggle,s=t.modify,a=t.values,l=e.add($B());const u="if("+t.trigger+',modify("'+n+'",'+[r,i,o,s,a].map((t=>t==null?"null":t)).join(",")+"),0)";const c=wW(u,e);l.update=c.$expr;l.params=c.$params}function qG(t,e){const n=pG(t),i=t.type===CJ,r=t.from&&t.from.facet,o=t.overlap;let s=t.layout||n===WH||n===jH,a,l,u,c,f,h,d;const p=n===FH||s||r;const g=AG(t.from,i,e);l=e.add(cY({key:g.key||(t.key?AB(t.key):undefined),pulse:g.pulse,clean:!i}));const y=DB(l);l=u=e.add(lY({pulse:y}));l=e.add(vY({markdef:mG(t),interactive:gG(t.interactive,e),clip:hG(t.clip,e),context:{$context:true},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:DB(l)}));const v=DB(l);l=c=e.add(fY(vB(t.encode,t.type,n,t.style,e,{mod:false,pulse:v})));l.params.parent=e.encode();if(t.transform){t.transform.forEach((t=>{const n=yG(t,e),i=n.metadata;if(i.generates||i.changes){(0,m.vU)("Mark transforms should not generate new data.")}if(!i.nomod)c.params.mod=true;n.params.pulse=DB(l);e.add(l=n)}))}if(t.sort){l=e.add(AY({sort:e.compareRef(t.sort),pulse:DB(l)}))}const _=DB(l);if(r||s){s=e.add(NY({layout:e.objectProperty(t.layout),legends:e.legends,mark:v,pulse:_}));h=DB(s)}const x=e.add(aY({mark:v,pulse:h||_}));d=DB(x);if(i){if(p){a=e.operators;a.pop();if(s)a.pop()}e.pushState(_,h||d,y);r?UG(t,e,g):p?PG(t,e,g):e.parse(t);e.popState();if(p){if(s)a.push(s);a.push(x)}}if(o){d=LG(o,d,e)}const b=e.add(TY({pulse:d})),w=e.add(DY({pulse:DB(b)},undefined,e.parent()));if(t.name!=null){f=t.name;e.addData(f,new zG(e,u,b,w));if(t.on)t.on.forEach((t=>{if(t.insert||t.remove||t.toggle){(0,m.vU)("Marks only support modify triggers.")}IG(t,e,f)}))}}function LG(t,e,n){const i=t.method,r=t.bound,o=t.separation;const s={separation:LB(o)?n.signalRef(o.signal):o,method:LB(i)?n.signalRef(i.signal):i,pulse:e};if(t.order){s.sort=n.compareRef({field:t.order})}if(r){const t=r.tolerance;s.boundTolerance=LB(t)?n.signalRef(t.signal):+t;s.boundScale=n.scaleRef(r.scale);s.boundOrient=r.orient}return DB(n.add(bY(s)))}function FG(t,e){const n=e.config.legend,i=t.encode||{},r=LJ(t,n),o=i.legend||{},s=o.name||undefined,a=o.interactive,l=o.style,u={};let c=0,f,h,d;AJ.forEach((e=>t[e]?(u[e]=t[e],c=c||t[e]):0));if(!c)(0,m.vU)("Missing valid scale for legend.");const p=jG(t,e.scaleType(c));const g={title:t.title!=null,scales:u,type:p,vgrad:p!=="symbol"&&r.isVertical()};const y=DB(e.add(lY(null,[g])));const v={enter:{x:{value:0},y:{value:0}}};const _=DB(e.add(gY(h={type:p,scale:e.scaleRef(c),count:e.objectProperty(r("tickCount")),limit:e.property(r("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));if(p===bJ){d=[JJ(t,c,n,i.gradient),ZJ(t,n,i.labels,_)];h.count=h.count||e.signalRef(`max(2,2*floor((${XB(r.gradientLength())})/100))`)}else if(p===wJ){d=[GJ(t,c,n,i.gradient,_),ZJ(t,n,i.labels,_)]}else{f=tG(t,n);d=[QJ(t,n,i,_,XB(f.columns))];h.size=HG(t,e,d[0].marks)}d=[qJ({role:ZH,from:y,encode:v,marks:d,layout:f,interactive:a})];if(g.title){d.push(fG(t,n,i.title,y))}return qG(qJ({role:VH,from:y,encode:qH(XG(r,t,n),o,NJ),marks:d,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:s,interactive:a,style:l}),e)}function jG(t,e){let n=t.type||xJ;if(!t.type&&WG(t)===1&&(t.fill||t.stroke)){n=Og(e)?bJ:Pg(e)?wJ:xJ}return n!==bJ?n:Pg(e)?wJ:bJ}function WG(t){return AJ.reduce(((e,n)=>e+(t[n]?1:0)),0)}function XG(t,e,n){const i={enter:{},update:{}};IH(i,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType});return i}function HG(t,e,n){const i=XB(BG("size",t,n)),r=XB(BG("strokeWidth",t,n)),o=XB(YG(n[1].encode,e,gJ));return wW(`max(ceil(sqrt(${i})+${r}),${o})`,e)}function BG(t,e,n){return e[t]?`scale("${e[t]}",datum)`:FJ(t,n[0].encode)}function YG(t,e,n){return FJ("fontSize",t)||jJ("fontSize",e,n)}const JG=`item.orient==="${nJ}"?-90:item.orient==="${iJ}"?90:0`;function GG(t,e){t=(0,m.HD)(t)?{text:t}:t;const n=LJ(t,e.config.title),i=t.encode||{},r=i.group||{},o=r.name||undefined,s=r.interactive,a=r.style,l=[];const u={},c=DB(e.add(lY(null,[u])));l.push(ZG(t,n,VG(t),c));if(t.subtitle){l.push(QG(t,n,i.subtitle,c))}return qG(qJ({role:iB,from:c,encode:KG(n,r),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),e)}function VG(t){const e=t.encode;return e&&e.title||(0,m.l7)({name:t.name,interactive:t.interactive,style:t.style},e)}function KG(t,e){const n={enter:{},update:{}};IH(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:XJ},angle:{signal:JG},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")});return qH(n,e,NJ)}function ZG(t,e,n,i){const r={value:0},o=t.text,s={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};IH(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")});return YJ({type:IJ,role:rB,style:vJ,from:i,encode:s},n)}function QG(t,e,n,i){const r={value:0},o=t.subtitle,s={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};IH(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")});return YJ({type:IJ,role:oB,style:_J,from:i,encode:s},n)}function tV(t,e){const n=[];if(t.transform){t.transform.forEach((t=>{n.push(yG(t,e))}))}if(t.on){t.on.forEach((n=>{IG(n,e,t.name)}))}e.addDataPipeline(t.name,eV(t,e,n))}function eV(t,e,n){const i=[];let r=null,o=false,s=false,a,l,u,c,f;if(t.values){if(LB(t.values)||jB(t.format)){i.push(iV(e,t));i.push(r=nV())}else{i.push(r=nV({$ingest:t.values,$format:t.format}))}}else if(t.url){if(jB(t.url)||jB(t.format)){i.push(iV(e,t));i.push(r=nV())}else{i.push(r=nV({$request:t.url,$format:t.format}))}}else if(t.source){r=a=(0,m.IX)(t.source).map((t=>DB(e.getData(t).output)));i.push(null)}for(l=0,u=n.length;l<u;++l){c=n[l];f=c.metadata;if(!r&&!f.source){i.push(r=nV())}i.push(c);if(f.generates)s=true;if(f.modifies&&!s)o=true;if(f.source)r=c;else if(f.changes)r=null}if(a){u=a.length-1;i[0]=EY({derive:o,pulse:u?a:a[0]});if(o||u){i.splice(1,0,nV())}}if(!r)i.push(nV());i.push(DY({}));return i}function nV(t){const e=lY({},t);e.metadata={source:true};return e}function iV(t,e){return yY({url:e.url?t.property(e.url):undefined,async:e.async?t.property(e.async):undefined,values:e.values?t.property(e.values):undefined,format:t.objectProperty(e.format)})}const rV=t=>t===rJ||t===eJ;const oV=(t,e,n)=>LB(t)?hV(t.signal,e,n):t===nJ||t===eJ?e:n;const sV=(t,e,n)=>LB(t)?cV(t.signal,e,n):rV(t)?e:n;const aV=(t,e,n)=>LB(t)?fV(t.signal,e,n):rV(t)?n:e;const lV=(t,e,n)=>LB(t)?dV(t.signal,e,n):t===eJ?{value:e}:{value:n};const uV=(t,e,n)=>LB(t)?pV(t.signal,e,n):t===iJ?{value:e}:{value:n};const cV=(t,e,n)=>mV(`${t} === '${eJ}' || ${t} === '${rJ}'`,e,n);const fV=(t,e,n)=>mV(`${t} !== '${eJ}' && ${t} !== '${rJ}'`,e,n);const hV=(t,e,n)=>yV(`${t} === '${nJ}' || ${t} === '${eJ}'`,e,n);const dV=(t,e,n)=>yV(`${t} === '${eJ}'`,e,n);const pV=(t,e,n)=>yV(`${t} === '${iJ}'`,e,n);const mV=(t,e,n)=>{e=e!=null?UH(e):e;n=n!=null?UH(n):n;if(gV(e)&&gV(n)){e=e?e.signal||(0,m.m8)(e.value):null;n=n?n.signal||(0,m.m8)(n.value):null;return{signal:`${t} ? (${e}) : (${n})`}}else{return[(0,m.l7)({test:t},e)].concat(n||[])}};const gV=t=>t==null||Object.keys(t).length===1;const yV=(t,e,n)=>({signal:`${t} ? (${_V(e)}) : (${_V(n)})`});const vV=(t,e,n,i,r)=>({signal:(i!=null?`${t} === '${nJ}' ? (${_V(i)}) : `:"")+(n!=null?`${t} === '${rJ}' ? (${_V(n)}) : `:"")+(r!=null?`${t} === '${iJ}' ? (${_V(r)}) : `:"")+(e!=null?`${t} === '${eJ}' ? (${_V(e)}) : `:"")+"(null)"});const _V=t=>LB(t)?t.signal:t==null?null:(0,m.m8)(t);const xV=(t,e)=>e===0?0:LB(t)?{signal:`(${t.signal}) * ${e}`}:{value:t*e};const bV=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function wV(t,e,n,i){let r;if(e&&(0,m.nr)(e,t)){return e[t]}else if((0,m.nr)(n,t)){return n[t]}else if(t.startsWith("title")){switch(t){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=t[5].toLowerCase()+t.slice(6)}return i[yJ][r]}else if(t.startsWith("label")){switch(t){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=t[5].toLowerCase()+t.slice(6)}return i[gJ][r]}return null}function kV(t){const e={};for(const n of t){if(!n)continue;for(const t in n)e[t]=1}return Object.keys(e)}function MV(t,e){var n=e.config,i=n.style,r=n.axis,o=e.scaleType(t.scale)==="band"&&n.axisBand,s=t.orient,a,l,u;if(LB(s)){const t=kV([n.axisX,n.axisY]),e=kV([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);a={};for(u of t){a[u]=sV(s,wV(u,n.axisX,r,i),wV(u,n.axisY,r,i))}l={};for(u of e){l[u]=vV(s.signal,wV(u,n.axisTop,r,i),wV(u,n.axisBottom,r,i),wV(u,n.axisLeft,r,i),wV(u,n.axisRight,r,i))}}else{a=s===eJ||s===rJ?n.axisX:n.axisY;l=n["axis"+s[0].toUpperCase()+s.slice(1)]}const c=a||l||o?(0,m.l7)({},r,a,l,o):r;return c}function SV(t,e,n,i){const r=LJ(t,e),o=t.orient;let s,a;const l={enter:s={opacity:zJ},update:a={opacity:RJ},exit:{opacity:zJ}};IH(l,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const u=EV(t,0);const c=EV(t,1);s.x=a.x=sV(o,u,zJ);s.x2=a.x2=sV(o,c);s.y=a.y=aV(o,u,zJ);s.y2=a.y2=aV(o,c);return YJ({type:UJ,role:HH,from:i,encode:l},n)}function EV(t,e){return{scale:t.scale,range:e}}function TV(t,e,n,i,r){const o=LJ(t,e),s=t.orient,a=t.gridScale,l=oV(s,1,-1),u=$V(t.offset,l);let c,f,h;const d={enter:c={opacity:zJ},update:h={opacity:RJ},exit:f={opacity:zJ}};IH(d,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:t.scale,field:mJ,band:r.band,extra:r.extra,offset:r.offset,round:o("tickRound")};const g=sV(s,{signal:"height"},{signal:"width"});const y=a?{scale:a,range:0,mult:l,offset:u}:{value:0,offset:u};const v=a?{scale:a,range:1,mult:l,offset:u}:(0,m.l7)(g,{mult:l,offset:u});c.x=h.x=sV(s,p,y);c.y=h.y=aV(s,p,y);c.x2=h.x2=aV(s,v);c.y2=h.y2=sV(s,v);f.x=sV(s,p);f.y=aV(s,p);return YJ({type:UJ,role:BH,key:mJ,from:i,encode:d},n)}function $V(t,e){if(e===1);else if(!(0,m.Kn)(t)){t=LB(e)?{signal:`(${e.signal}) * (${t||0})`}:e*(t||0)}else{let n=t=(0,m.l7)({},t);while(n.mult!=null){if(!(0,m.Kn)(n.mult)){n.mult=LB(e)?{signal:`(${n.mult}) * (${e.signal})`}:n.mult*e;return t}else{n=n.mult=(0,m.l7)({},n.mult)}}n.mult=e}return t}function DV(t,e,n,i,r,o){const s=LJ(t,e),a=t.orient,l=oV(a,-1,1);let u,c,f;const h={enter:u={opacity:zJ},update:f={opacity:RJ},exit:c={opacity:zJ}};IH(h,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const d=UH(r);d.mult=l;const p={scale:t.scale,field:mJ,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};f.y=u.y=sV(a,zJ,p);f.y2=u.y2=sV(a,d);c.x=sV(a,p);f.x=u.x=aV(a,zJ,p);f.x2=u.x2=aV(a,d);c.y=aV(a,p);return YJ({type:UJ,role:JH,key:mJ,from:i,encode:h},n)}function AV(t,e,n,i,r){return{signal:'flush(range("'+t+'"), '+'scale("'+t+'", datum.value), '+e+","+n+","+i+","+r+")"}}function NV(t,e,n,i,r,o){const s=LJ(t,e),a=t.orient,l=t.scale,u=oV(a,-1,1),c=XB(s("labelFlush")),f=XB(s("labelFlushOffset")),h=s("labelAlign"),d=s("labelBaseline");let p=c===0||!!c,m;const g=UH(r);g.mult=u;g.offset=UH(s("labelPadding")||0);g.offset.mult=u;const y={scale:l,field:mJ,band:.5,offset:BJ(o.offset,s("labelOffset"))};const v=sV(a,p?AV(l,c,'"left"','"right"','"center"'):{value:"center"},uV(a,"left","right"));const _=sV(a,lV(a,"bottom","top"),p?AV(l,c,'"top"','"bottom"','"middle"'):{value:"middle"});const x=AV(l,c,`-(${f})`,f,0);p=p&&f;const b={opacity:zJ,x:sV(a,y,g),y:aV(a,y,g)};const w={enter:b,update:m={opacity:RJ,text:{field:fJ},x:b.x,y:b.y,align:v,baseline:_},exit:{opacity:zJ,x:b.x,y:b.y}};IH(w,{dx:!h&&p?sV(a,x):null,dy:!d&&p?aV(a,x):null});IH(w,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:h,baseline:d});const k=s("labelBound");let M=s("labelOverlap");M=M||k?{separation:s("labelSeparation"),method:M,order:"datum.index",bound:k?{scale:l,orient:a,tolerance:k}:null}:undefined;if(m.align!==v){m.align=bV(m.align,v)}if(m.baseline!==_){m.baseline=bV(m.baseline,_)}return YJ({type:IJ,role:YH,style:gJ,key:mJ,from:i,encode:w,overlap:M},n)}function zV(t,e,n,i){const r=LJ(t,e),o=t.orient,s=oV(o,-1,1);let a,l;const u={enter:a={opacity:zJ,anchor:UH(r("titleAnchor",null)),align:{signal:XJ}},update:l=(0,m.l7)({},a,{opacity:RJ,text:UH(t.title)}),exit:{opacity:zJ}};const c={signal:`lerp(range("${t.scale}"), ${WJ(0,1,.5)})`};l.x=sV(o,c);l.y=aV(o,c);a.angle=sV(o,zJ,xV(s,90));a.baseline=sV(o,lV(o,rJ,eJ),{value:rJ});l.angle=a.angle;l.baseline=a.baseline;IH(u,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")});RV(r,o,u,n);u.update.align=bV(u.update.align,a.align);u.update.angle=bV(u.update.angle,a.angle);u.update.baseline=bV(u.update.baseline,a.baseline);return YJ({type:IJ,role:GH,style:yJ,from:i,encode:u},n)}function RV(t,e,n,i){const r=(t,e)=>t!=null?(n.update[e]=bV(UH(t),n.update[e]),false):!LH(e,i)?true:false;const o=r(t("titleX"),"x"),s=r(t("titleY"),"y");n.enter.auto=s===o?UH(s):sV(e,UH(s),UH(o))}function CV(t,e){const n=MV(t,e),i=t.encode||{},r=i.axis||{},o=r.name||undefined,s=r.interactive,a=r.style,l=LJ(t,n),u=HJ(l);const c={scale:t.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:t.title!=null};const f=DB(e.add(lY({},[c])));const h=DB(e.add(sY({scale:e.scaleRef(t.scale),extra:e.property(u.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));const d=[];let p;if(c.grid){d.push(TV(t,n,i.grid,h,u))}if(c.ticks){p=l("tickSize");d.push(DV(t,n,i.ticks,h,p,u))}if(c.labels){p=c.ticks?p:0;d.push(NV(t,n,i.labels,h,p,u))}if(c.domain){d.push(SV(t,n,i.domain,f))}if(c.title){d.push(zV(t,n,i.title,f))}return qG(qJ({role:XH,from:f,encode:qH(OV(l,t),r,NJ),marks:d,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:o,interactive:s,style:a}),e)}function OV(t,e){const n={enter:{},update:{}};IH(n,{orient:t("orient"),offset:t("offset")||0,position:WB(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:`abs(span(range("${e.scale}")))`},translate:t("translate"),format:e.format,formatType:e.formatType});return n}function UV(t,e,n){const i=(0,m.IX)(t.signals),r=(0,m.IX)(t.scales);if(!n)i.forEach((t=>SB(t,e)));(0,m.IX)(t.projections).forEach((t=>QY(t,e)));r.forEach((t=>OY(t,e)));(0,m.IX)(t.data).forEach((t=>tV(t,e)));r.forEach((t=>UY(t,e)));(n||i).forEach((t=>iY(t,e)));(0,m.IX)(t.axes).forEach((t=>CV(t,e)));(0,m.IX)(t.marks).forEach((t=>qG(t,e)));(0,m.IX)(t.legends).forEach((t=>FG(t,e)));if(t.title)GG(t.title,e);e.parseLambdas();return e}const PV=t=>qH({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t);function IV(t,e){const n=e.config;const i=DB(e.root=e.add($B()));const r=LV(t,n);r.forEach((t=>SB(t,e)));e.description=t.description||n.description;e.eventConfig=n.events;e.legends=e.objectProperty(n.legend&&n.legend.layout);e.locale=n.locale;const o=e.add(lY());const s=e.add(fY(vB(PV(t.encode),CJ,jH,t.style,e,{pulse:DB(o)})));const a=e.add(NY({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:i,pulse:DB(s)}));e.operators.pop();e.pushState(DB(s),DB(a),null);UV(t,e,r);e.operators.push(a);let l=e.add(aY({mark:i,pulse:DB(a)}));l=e.add(TY({pulse:DB(l)}));l=e.add(DY({pulse:DB(l)}));e.addData("root",new zG(e,o,o,l));return e}function qV(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function LV(t,e){const n=n=>WB(t[n],e[n]),i=[qV("background",n("background")),qV("autosize",zH(n("autosize"))),qV("padding",OH(n("padding"))),qV("width",n("width")||0),qV("height",n("height")||0)],r=i.reduce(((t,e)=>(t[e.name]=e,t)),{}),o={};(0,m.IX)(t.signals).forEach((t=>{if((0,m.nr)(r,t.name)){t=(0,m.l7)(r[t.name],t)}else{i.push(t)}o[t.name]=t}));(0,m.IX)(e.signals).forEach((t=>{if(!(0,m.nr)(o,t.name)&&!(0,m.nr)(r,t.name)){i.push(t)}}));return i}function FV(t,e){this.config=t||{};this.options=e||{};this.bindings=[];this.field={};this.signals={};this.lambdas={};this.scales={};this.events={};this.data={};this.streams=[];this.updates=[];this.operators=[];this.eventConfig=null;this.locale=null;this._id=0;this._subid=0;this._nextsub=[0];this._parent=[];this._encode=[];this._lookup=[];this._markpath=[]}function jV(t){this.config=t.config;this.options=t.options;this.legends=t.legends;this.field=Object.create(t.field);this.signals=Object.create(t.signals);this.lambdas=Object.create(t.lambdas);this.scales=Object.create(t.scales);this.events=Object.create(t.events);this.data=Object.create(t.data);this.streams=[];this.updates=[];this.operators=[];this._id=0;this._subid=++t._nextsub[0];this._nextsub=t._nextsub;this._parent=t._parent.slice();this._encode=t._encode.slice();this._lookup=t._lookup.slice();this._markpath=t._markpath}FV.prototype=jV.prototype={parse(t){return UV(t,this)},fork(){return new jV(this)},isSubscope(){return this._subid>0},toRuntime(){this.finish();return{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){this.operators.push(t);t.id=this.id();if(t.refs){t.refs.forEach((e=>{e.$ref=t.id}));t.refs=null}return t},proxy(t){const e=t instanceof EB?DB(t):t;return this.add(SY({value:e}))},addStream(t){this.streams.push(t);t.id=this.id();return t},addUpdate(t){this.updates.push(t);return t},finish(){let t,e;if(this.root)this.root.root=true;for(t in this.signals){this.signals[t].signal=t}for(t in this.scales){this.scales[t].scale=t}function n(t,e,n){let i,r;if(t){i=t.data||(t.data={});r=i[e]||(i[e]=[]);r.push(n)}}for(t in this.data){e=this.data[t];n(e.input,t,"input");n(e.output,t,"output");n(e.values,t,"values");for(const i in e.index){n(e.index[i],t,"index:"+i)}}return this},pushState(t,e,n){this._encode.push(DB(this.add(DY({pulse:t}))));this._parent.push(e);this._lookup.push(n?DB(this.proxy(n)):null);this._markpath.push(-1)},popState(){this._encode.pop();this._parent.pop();this._lookup.pop();this._markpath.pop()},parent(){return(0,m.fj)(this._parent)},encode(){return(0,m.fj)(this._encode)},lookup(){return(0,m.fj)(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if((0,m.HD)(t))return AB(t,e);if(!t.signal){(0,m.vU)("Unsupported field reference: "+(0,m.m8)(t))}const n=t.signal;let i=this.field[n];if(!i){const t={name:this.signalRef(n)};if(e)t.as=e;this.field[n]=i=DB(this.add(pY(t)))}return i},compareRef(t){let e=false;const n=t=>LB(t)?(e=true,this.signalRef(t.signal)):FB(t)?(e=true,this.exprRef(t.expr)):t;const i=(0,m.IX)(t.field).map(n),r=(0,m.IX)(t.order).map(n);return e?DB(this.add(uY({fields:i,orders:r}))):zB(i,r)},keyRef(t,e){let n=false;const i=t=>LB(t)?(n=true,DB(r[t.signal])):t;const r=this.signals;t=(0,m.IX)(t).map(i);return n?DB(this.add(mY({fields:t,flat:e}))):RB(t,e)},sortRef(t){if(!t)return t;const e=PB(t.op,t.field),n=t.order||CB;return n.signal?DB(this.add(uY({fields:e,orders:this.signalRef(n.signal)}))):zB(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:t,type:e});this.events[n]=i}return this.events[n]},hasOwnSignal(t){return(0,m.nr)(this.signals,t)},addSignal(t,e){if(this.hasOwnSignal(t)){(0,m.vU)("Duplicate signal name: "+(0,m.m8)(t))}const n=e instanceof EB?e:this.add($B(e));return this.signals[t]=n},getSignal(t){if(!this.signals[t]){(0,m.vU)("Unrecognized signal name: "+(0,m.m8)(t))}return this.signals[t]},signalRef(t){if(this.signals[t]){return DB(this.signals[t])}else if(!(0,m.nr)(this.lambdas,t)){this.lambdas[t]=this.add($B(null))}return DB(this.lambdas[t])},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],i=wW(n,this),r=this.lambdas[n];r.params=i.$params;r.update=i.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return!t||!(0,m.Kn)(t)?t:this.signalRef(t.signal||WV(t))},exprRef(t,e){const n={expr:wW(t,this)};if(e)n.expr.$name=e;return DB(this.add(hY(n)))},addBinding(t,e){if(!this.bindings){(0,m.vU)("Nested signals do not support binding: "+(0,m.m8)(t))}this.bindings.push((0,m.l7)({signal:t},e))},addScaleProj(t,e){if((0,m.nr)(this.scales,t)){(0,m.vU)("Duplicate scale or projection name: "+(0,m.m8)(t))}this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,$Y(e))},addProjection(t,e){this.addScaleProj(t,MY(e))},getScale(t){if(!this.scales[t]){(0,m.vU)("Unrecognized scale name: "+(0,m.m8)(t))}return this.scales[t]},scaleRef(t){return DB(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){if((0,m.nr)(this.data,t)){(0,m.vU)("Duplicate data set name: "+(0,m.m8)(t))}return this.data[t]=e},getData(t){if(!this.data[t]){(0,m.vU)("Undefined data set name: "+(0,m.m8)(t))}return this.data[t]},addDataPipeline(t,e){if((0,m.nr)(this.data,t)){(0,m.vU)("Duplicate data set name: "+(0,m.m8)(t))}return this.addData(t,zG.fromEntries(this,e))}};function WV(t){return((0,m.kJ)(t)?XV:HV)(t)}function XV(t){const e=t.length;let n="[";for(let i=0;i<e;++i){const e=t[i];n+=(i>0?",":"")+((0,m.Kn)(e)?e.signal||WV(e):(0,m.m8)(e))}return n+"]"}function HV(t){let e="{",n=0,i,r;for(i in t){r=t[i];e+=(++n>1?",":"")+(0,m.m8)(i)+":"+((0,m.Kn)(r)?r.signal||WV(r):(0,m.m8)(r))}return e+"}"}function BV(){const t="sans-serif",e=30,n=2,i="#4c78a8",r="#000",o="#888",s="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:n},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:t,fontSize:11},trail:{fill:i,size:n},style:{"guide-label":{fill:r,font:t,fontSize:10},"guide-title":{fill:r,font:t,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:t,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:t,fontSize:12},point:{size:e,strokeWidth:n,shape:"circle"},circle:{size:e,strokeWidth:n},square:{size:e,strokeWidth:n,shape:"square"},cell:{fill:"transparent",stroke:s},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:true,domainWidth:1,domainColor:o,grid:false,gridWidth:1,gridColor:s,labels:true,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:true,tickColor:o,tickOffset:0,tickRound:true,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:true,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:o,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function YV(t,e,n){if(!(0,m.Kn)(t)){(0,m.vU)("Input Vega specification must be an object.")}e=(0,m.fE)(BV(),e,t.config);return IV(t,new FV(e,n)).toRuntime()}var JV="5.24.0";(0,m.l7)(Ps,i,o,s,a,l,c,u,f,h,d,p)}}]);